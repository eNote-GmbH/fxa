

  #integration - remote account create 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '573630567bcc750c6691@restmail.net',
    authPW: 'a0e332947ef7c033bad4dbe2d45d7e69bbefe43f7731a82b7ab2680ef0525a36',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '540ef2438638472d9cafa33a78f0ed2e',
    sessionToken: '826f34e6684442dfdf7b2328b1965e86b95b28a942ef442f217cb3e05786deac',
    authAt: 1705108635
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '573630567bcc750c6691@restmail.net',
    authPW: 'a0e332947ef7c033bad4dbe2d45d7e69bbefe43f7731a82b7ab2680ef0525a36',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '540ef2438638472d9cafa33a78f0ed2e',
    sessionToken: '1d067a8076f7ce186acda6009d4aa1c0d08314605870c0abeef13bb4cd1b681a',
    authAt: 1705108635,
    metricsEnabled: true,
    keyFetchToken: '2e88b0ce825af279ea59d9bfd332eefedd5850388ec081631db0f881bab599d1',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="156c44217ff9714bde765badb76667dc6a6864a3d9af9414ccbbbc08675110d7", ts="1705108636", nonce="nH0oRq", mac="EHE84e7gRKKZ72G6wffgyj0U1E3Gyyfs16kmXnG2Q8Y="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ unverified account fail when getting keys (829ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'dcabbbcbd3dfef561565@restmail.net',
    authPW: 'f8ee7850030dd9c7776384c2cb28a89db9e3983b26e0e040e008675114f2476d',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bd42553def1b4a1db36d0c2a6c431ee3',
    sessionToken: '5a0890deab8779500ca498f29b5619cc893243f5cfdee6648d4f14deb02ee430',
    authAt: 1705108635
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="51f2a5cc5be0f2f3003ebab294291f920793cd9121aa30a0078947d79269e349", ts="1705108636", nonce="QLaOsK", mac="igxwJHRS2DK2VLiRFNfj0vhwHKuthXROsRinEF72A+E="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dcabbbcbd3dfef561565@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bd42553def1b4a1db36d0c2a6c431ee3',
    code: 'c4d48c93fb68162843023c2a2bc14832',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="51f2a5cc5be0f2f3003ebab294291f920793cd9121aa30a0078947d79269e349", ts="1705108636", nonce="I79DFt", mac="iJHoENCM3TLx6Gu3XhQguDS7OP3CvZ3t9rpmOEiPY9s="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dcabbbcbd3dfef561565@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create and verify sync account (289ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb5ec5334f33349bb4e2@restmail.net',
    authPW: '8071de60f526ea9b99cd3281bb02d759e4eb872f330291a7e5856b9550937ff9',
    preVerified: undefined,
    service: 'abcdef',
    redirectTo: undefined,
    resume: 'foo',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '580d958b8df441f2a52219f360f4ba10',
    sessionToken: '1b84d01cec519cf395dc21f985cea4f1fb3e402fc65a33f1c7a8e1fa455d6576',
    authAt: 1705108636
  }
}
    ✔ create account with service identifier and resume (223ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b7e0f741ee2fd88e6c6f@restmail.net',
    authPW: '4d8e8cd0d27972a1aa46f1f81f978dcb9b6b4a119d7142047370ddc3546333d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4fc3cdb5fe6d4b119ddee109f0b0cf34',
    sessionToken: 'ed462dcbf9dee66bbfcfec6a8a96221d9630851b9bb54b7e68a160a4bb72f87a',
    authAt: 1705108636
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="626d2090ad6e8f21f714fa6e3104e7f1d2d4e7e99bbd07e60bb0ffd9b3447b9e", ts="1705108637", nonce="s-24rk", hash="HpbVZ27aYISbEFGU3/8DdAkorgsPU5zkCTHceMw08VA=", mac="RDa7PqZS4rfdrTpp+9lqKE0tHyUu6aTiqGdvSo/C070="'
  },
  json: {
    email: 'b7e0f741ee2fd88e6c6f@restmail.net',
    authPW: '4d8e8cd0d27972a1aa46f1f81f978dcb9b6b4a119d7142047370ddc3546333d4'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'pt-br' },
  json: {
    email: 'b7e0f741ee2fd88e6c6f@restmail.net',
    authPW: '4d8e8cd0d27972a1aa46f1f81f978dcb9b6b4a119d7142047370ddc3546333d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '225ee2abae964bc399bdd7d7315a3e80',
    sessionToken: 'cecfa82941b72ab30f7408ff86c8088d959a2ca2c195bd06c0c82f29af0f5cf3',
    authAt: 1705108636
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bb6fe1a567de6a7498f889831913d68e23cc514f4871330990d946c4786522e7", ts="1705108637", nonce="SslNAl", hash="HpbVZ27aYISbEFGU3/8DdAkorgsPU5zkCTHceMw08VA=", mac="A+MIByG8pnfRn8iWXHg+yWMo+AcqySU+W/chk61vGeM="'
  },
  json: {
    email: 'b7e0f741ee2fd88e6c6f@restmail.net',
    authPW: '4d8e8cd0d27972a1aa46f1f81f978dcb9b6b4a119d7142047370ddc3546333d4'
  }
}
!!! response success { body: {} }
    ✔ create account allows localization of emails (755ms)
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2634b887a1beae42ebbc@restmail.net',
    authPW: '6aabeea948a5950e300dc137b286db86c29a75df2cf504a76f5bb71b9557a631',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2634b887a1beae42ebbc@restmail.net'
  }
}
    ✔ Unknown account should not exist
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0725a86ff942e8def01c@restmail.net',
    authPW: '4df9cfc0038c327fdfaaf44873afe23300f7fa8578de46ee66db341bd2b1895e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '503bb392917d4f2fa12401e247fd31f7',
    sessionToken: '91b0c084e47996c42f1296655ede3e4a0ade0b9b602f0861837387772214d17a',
    authAt: 1705108637
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '503bb392917d4f2fa12401e247fd31f7',
    code: '163f8d515fa97cf0e15efb5235018258',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0725a86ff942e8def01c@restmail.net',
    authPW: '4df9cfc0038c327fdfaaf44873afe23300f7fa8578de46ee66db341bd2b1895e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '503bb392917d4f2fa12401e247fd31f7',
    sessionToken: '8b74ab2d15a549d8668bcc76e3d3996490efcd940098f008c8fa0aa86d0a28b1',
    authAt: 1705108637,
    metricsEnabled: true,
    keyFetchToken: '9cc87704cea4e4267fa8b7b94852b53785838b37d481f658a5ad637b75917535',
    verified: true
  }
}
    ✔ /account/create works with proper data (456ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3fb4f3d5b34ae939e75c@restmail.net',
    authPW: '4e42045e9f69d3e70da289dac9f40dd37db53f02f9af3656fc99a4aa23de8026',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '27043ec7ed5e4bbeb081bd87c6dccf10',
    sessionToken: 'be5855d7a4f29871bead017dddb0eaa741ab1749e4d2809cff6e112c84f17625',
    authAt: 1705108637
  }
}
    ✔ /account/create returns a sessionToken (193ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '666a9384057aa01f9385@restmail.net',
    authPW: 'e8cdad170869737f37ca9a3664d0f11d99b3234846b84a6c0339e012dfa20f9a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9e8296e29a934a93b3a01b14f3307d50',
    sessionToken: 'db00f43103eb6a45d1373c068989b8ed95711e78216bdc8189ee87d66269905a',
    authAt: 1705108637,
    keyFetchToken: '571615746173edc92e46e66cea0d78a79a347151688a0d38b3815bec2a26112a'
  }
}
    ✔ /account/create returns a keyFetchToken when keys=true (194ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1ecd33acf640e5128aa6@restmail.net',
    authPW: 'b7d530ac80f3979fd818815a3d3b42f3a92d1319ae0c77119ced746021fe5237',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a5e7ef5893cc4ea6a741122894dab18e',
    sessionToken: 'a811ec098269cf6d53974adde705a06a2af7d82f1e5292dafe314de0c9c1ef95',
    authAt: 1705108638
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a5e7ef5893cc4ea6a741122894dab18e',
    code: 'acf36d776bf786f53eb77e0345603dc1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1ECD33ACF640E5128AA6@RESTMAIL.NET',
    authPW: 'fb2539a8d3f515593e0022f6a1c29a5ae89ffb2a5ad1d24b335bb1fd6f8dbbf9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 101,
    error: 'Bad Request',
    message: 'Account already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1ecd33acf640e5128aa6@restmail.net'
  }
}
    ✔ signup with same email, different case (210ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e85d81803d490d3aeedc@restmail.net',
    authPW: 'a5975a8959c798ce659db454e99994a40190f1dddf42fec114ae445648c1c6c6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6297555d196d42a9a9375acbecd32fde',
    sessionToken: '9f17002bc796c0829998a4bb1ec2725ef557b22166adb9b134eea76113433e01',
    authAt: 1705108638
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e85d81803d490d3aeedc@restmail.net',
    authPW: 'a5975a8959c798ce659db454e99994a40190f1dddf42fec114ae445648c1c6c6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4b58ade96032406cb9db061ea896a3a6',
    sessionToken: 'b10d90e69fb4e0647373f53d5472242ee746163d31e1d08d55e6d00a18dabafd',
    authAt: 1705108638
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4b58ade96032406cb9db061ea896a3a6',
    code: '6203f3606e332c95bec3f005abf94ae7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ re-signup against an unverified email (428ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c43cfece25eb2b466f0c@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'http://accounts.firefox.com.evil.us',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c43cfece25eb2b466f0c@restmail.net',
    service: undefined,
    redirectTo: 'http://accounts.firefox.com.evil.us',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid redirectTo
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '86408a1f1ba187e8fc51@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'https://www.fake.com/.firefox.com',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '86408a1f1ba187e8fc51@restmail.net',
    service: undefined,
    redirectTo: 'https://fakefirefox.com',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ another invalid redirectTo
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac4111fe0615c1978ca3@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2904b5d81e814025986a50c74786ff41',
    sessionToken: 'f93666c5c0a237376717012d1f8d3cd9591a7ea83a80fc6e1de8d12e9a934b65',
    authAt: 1705108638
  }
}
    ✔ valid metricsContext (194ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5aa851e1a937e25c1f23@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {},
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '74fd02d5f48a4366941dd5bfc7125316',
    sessionToken: '6063fceebb4b8e9dac1208551c5b28cc1a2ce327ae29b9e98edb260d43668ff7',
    authAt: 1705108638
  }
}
    ✔ empty metricsContext (187ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fde486d9f38143682361@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: ';',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'foo',
      utmContent: 'bar',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypoint
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '79bcc527e6ba1f15d2eb@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: ';',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypointExperiment
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '99940f1585081b31fd98@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: ';',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypointVariation
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ec4632d51c8dfd40eea7@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: ';',
      utmContent: 'bar',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmCampaign
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '12b161f3ddcd43b5691b@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: ';',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmContent
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '46d2c0f0c4916ed3f3ba@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: ';',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmMedium
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '152c2c608f75c8ad7914@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: ';',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmSource
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b261e73247cc3d6eeb41@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: ';'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmTerm
!!! request {
  url: 'http://localhost:9000/v1/account/create?service=bar',
  method: 'POST',
  headers: {},
  json: {
    email: 'c88ecdfaab23dc28063d@restmail.net',
    authPW: 'a6651b4cb084a9a7c88552f05f340c7882a233ddaf8829ac86e30101a31d2642',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cc605655d0514cb092d8d644d426ece3',
    sessionToken: '7d48c856bbc533a516a9e24abc2c41ed1150198af025910bef9dc87f55bb55ac',
    authAt: 1705108639
  }
}
    ✔ create account with service query parameter (197ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2275c5340fe23293c38fӒ@ᘮrestmail.net',
    authPW: '3b6fcfd50a9552d4d8319aa7d0dad717cdbfe01f21e4c3d56c3d88269f31bb5c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f7dbb9d121f841bdb70d5e5509149fa2',
    sessionToken: 'e7811ff108316beea9026f20fff59c082910ea19264e641c6bfad823f96b5507',
    authAt: 1705108639
  }
}
    ✔ account creation works with unicode email address (192ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '71bd7da8b3e50a651a7a@restmail.net',
    authPW: '790c5a355fc8316debc2b245e80e2d17f57a07eec296945fe89980852e08c63c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: { flowId: 'deadbeefbaadf00ddeadbeefbaadf00d', flowBeginTime: 1 },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with invalid metricsContext flowId
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6f0a00a84668fa45c5ff@restmail.net',
    authPW: '2e3a5671ac52eec471ea4c9085d2b1a560fc9d062fac12eac8b1f5b68c09f2a7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowId: 'deadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00d',
      flowBeginTime: 0
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with invalid metricsContext flowBeginTime
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '20ff37cf2f01c6d7727a@restmail.net',
    authPW: '1c76ad544fdf9f2a1f3eaf53bfbd3eae9db268a7d352ef814d5d3bd7eebcdf23',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108639409,
      flowId: '219d95a415f0e6a291a586e5b7497fa66280bc974568b6ddd1d57c109f264212'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '736def9f4cb249e48b98b7f2ee50f850',
    sessionToken: '7164c685a338107a8735f2085260ea6c07fc1caf277b8e992469ad27bc383ffe',
    authAt: 1705108639
  }
}
    ✔ account creation works with maximal metricsContext metadata (195ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fdfb43c61e6c9dec0ce3@restmail.net',
    authPW: '7605604da8a9eaef0995b47dc48c8e042db5f87a72c46eac0ab4cc6a633ad70f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {},
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd1f70e10b45144b4a45bf72fcb768c2a',
    sessionToken: '3b812636971cbf50ef9ecbadb267b016c72a386e843ab2945a491eca58b90e7f',
    authAt: 1705108639
  }
}
    ✔ account creation works with empty metricsContext metadata (194ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e4218dbe4c1113dad295@restmail.net',
    authPW: 'b4917683e8423f508973da14531d78afedc0ae279ef26afd30771165f9b2d9da',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowId: 'deadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00d'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with missing flowBeginTime
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '766349bd1d62602bc72e@restmail.net',
    authPW: 'd42931358b1e8468387f619eed535ddd7d4613ea3a4d6762a23ea79b6756aae2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: { flowBeginTime: 1705108639804 },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with missing flowId
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '39444bb7bd97d62fa38f@restmail.net',
    authPW: '548c3eeb99ee41be6b5c9910de8ac3f17441452bb9096d0c939eb3f7ca1a8edd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1f0b988e1d4f43f0873e222ba29cfd19',
    sessionToken: '3af3bd5c9399b3c7f4cf99b45c4ddd06b4e51e974355bb7a3ad5b15539605845',
    authAt: 1705108639
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1f0b988e1d4f43f0873e222ba29cfd19',
    code: 'a6971c0bc0e759ab89ab41e7bca1205b',
    service: 'testpilot',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6e272999befa31cf576515e7a70ff803b7810d48241c74a59429aa05fcdad4e7", ts="1705108640", nonce="L3KmmS", mac="I/gV+vKhp/WD2tBQdYYAVrlzoo5Q3oN046RFewhhsY0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '39444bb7bd97d62fa38f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '39444bb7bd97d62fa38f@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b6d0fa3733b3e50966232aca9eceea77b18644b656dbc4a8cb9076ee6622018e',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create account for non-sync service, gets generic sign-up email and does not get post-verify email (266ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'decb2309d898d46207d4@restmail.net',
    authPW: '737fdee8a86f1804493a13e2a72fedf6e675dbc30d26e9f5405bcb38044a8b90',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2b1e5b1385fc4e739cc03de086d1a262',
    sessionToken: 'aa641dd36ccba223a5f2db5bf47b272eb745855c719b9d85930213854ee0a58c',
    authAt: 1705108640
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2b1e5b1385fc4e739cc03de086d1a262',
    code: '8068102ad2bf22546187a6a32316a958',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c4b48c2a8ea1ce566a5741ff908d4b638aea1393d2c95604bc0c9f2acdf0c185", ts="1705108640", nonce="7xJwbS", mac="bZBL/KFDXCM1UyWzlGAnhWIOC7raiGNqxzRIvW6kQio="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'decb2309d898d46207d4@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'decb2309d898d46207d4@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '6996677614c8767a8bd9e99b99d3682eaf1f45ce47ef71f7c0d8fecb9c88d45c',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create account for unspecified service does not get create sync email and no post-verify email (257ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bdf2e723a56ab9767926@restmail.net',
    authPW: '30272a66f0858e2e8969aa75e6f50847617d8172cee08528ab203139675563a6',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '110d4e0816e7491682712555956cae22',
    sessionToken: '139596682dea0624ab696b1b299647419a5892cd3693627947def1a28e535447',
    authAt: 1705108640
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '110d4e0816e7491682712555956cae22',
    code: '2ce927f5b10740eab25a3761cf233002',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: [ 'test-pilot' ]
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="02e6bc158078e737a2a8ffd36f5573d58541229832b05195d44880e572425094", ts="1705108641", nonce="Dxm8RZ", mac="sDf+bl7st5lZLpBCmfuDJ1w8fVbEXGQhOhesfR2fgDw="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bdf2e723a56ab9767926@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create account and subscribe to newsletters (247ms)
    - maintains single kB value for account create with V1 & V2 credentials
    - maintains single kB value after account password upgrade from V1 to V2

  #integration - remote account create V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0ea6371ed7c21280ba36@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0ea6371ed7c21280ba36@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0ea6371ed7c21280ba36@restmail.net',
    authPW: '0786805544ce948344b9d5b32b6da88bcf4da391aa61656abf9db6010ff4f532',
    authPW2: 'aab72382e2a48b6cd99d905a402b01dce21229b3633f9c183bdfee5c9085d7b6',
    wrapKb: '475f764a9199903b53a87c550aaae524be4a3c8f5fe99a8ea44e7e23c06794e3',
    wrapKb2: '253544a9387d1f133961108feac053d0fedf15c701fda5fed05799cd82032f13',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f652580efcbed173a487ede02dd30afb4dc349420481aa2a4e01b68f8f99101b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '66003ce1b5ae416aaebc1af7f0ab109c',
    sessionToken: 'bd3dbe6f36811a39b46e3ad9ac2c889d3f5d1e3ece9ddaa04787b3d721ebfb7b',
    authAt: 1705108641
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0ea6371ed7c21280ba36@restmail.net',
    authPW: 'aab72382e2a48b6cd99d905a402b01dce21229b3633f9c183bdfee5c9085d7b6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '66003ce1b5ae416aaebc1af7f0ab109c',
    sessionToken: '8d0b813b7858cee8b1f5f565020d120b528ee40b9004ec7533300bf8727c4fc6',
    authAt: 1705108641,
    metricsEnabled: true,
    keyFetchToken2: 'f40d66201e87398570a446ef09ac4c09ea314f8d3ce491b091ca630598941071',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9079fd32e5a2c4a4fc2871d836f5ae2b521a3f2a69ccfe3a5e9e52c02574e7ca", ts="1705108641", nonce="hrksCb", mac="7EIF+MX2CCkIjpn16Em7CDh+1zSQdTZ5HD3MLYACLKY="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ unverified account fail when getting keys (689ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '99f5e5c099960ed6f7c0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '99f5e5c099960ed6f7c0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '99f5e5c099960ed6f7c0@restmail.net',
    authPW: '73071b9355aa52df174ce8e828d0fd8711d557cab21b3390afc457066a92b448',
    authPW2: '27f8b1e577ce316b794ebf676596c6d09775d10614d2927f383616bd6fa18f3f',
    wrapKb: '62eb2d7077b7d6f63b10fe2787b4f03c689339c2e596668976eded9ba3d11b89',
    wrapKb2: 'e3f77460a7f62c517bbff8a86024eed78e674197610c9885c36d968b6b6cdc8d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3171a2ec968afd2809639b9b4355a338e0a50d7db9207dfc55561268aefece57',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd489662ae7f94c5c97f4665ef5b3ee21',
    sessionToken: '87bbed99baf3793b4fe9d690bde786871828a6178c704d0d04059090d3a24135',
    authAt: 1705108641
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="67727f822a9d7a9052f10f837a69a61b4269a8ef5f4ed70613235cd1f7ec2484", ts="1705108642", nonce="aqkRiT", mac="d924P+FMgBWxAw7KdBC7mBsxh/w6ym2L99J9AsmjUI4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '99f5e5c099960ed6f7c0@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd489662ae7f94c5c97f4665ef5b3ee21',
    code: '583d517ce712a9831bfb6d4d0f831c37',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="67727f822a9d7a9052f10f837a69a61b4269a8ef5f4ed70613235cd1f7ec2484", ts="1705108642", nonce="iyExBV", mac="SzngwB74VEWIKjo10m+dl2l+uferSu6vCnn12fQoL7I="'
  },
  json: true
}
!!! response success {
  body: {
    email: '99f5e5c099960ed6f7c0@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create and verify sync account (520ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6023cb4fb093f9ff217b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6023cb4fb093f9ff217b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6023cb4fb093f9ff217b@restmail.net',
    authPW: 'a0a5a05b0ccc10ffff4a35783096fbf15ebfe70e063172ade72897a2aca485f3',
    authPW2: 'b83bec92010384e814f7cc7759d9cd92ec9776b4ed938ec9f1dcb839d5b6c081',
    wrapKb: '5c3e34bbd4d02b1b25f93a97537de86dfc5f198c53cd9648163c6f9241cee0e9',
    wrapKb2: 'ba342451a27b802574d06fe607f3700e0176756f3695611e7c12cae26ac8e765',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2e403c5025905c17d820ce90d6eabe8d7f44c3fd0f8f16da58d1373cba0234b0',
    preVerified: undefined,
    service: 'abcdef',
    redirectTo: undefined,
    resume: 'foo',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '401412a9503542de9df9d7210d8f8339',
    sessionToken: 'a18f66adf8d26aa92bc062b00811671c44400b5ff44cc35a1e115666a80aa9ac',
    authAt: 1705108642
  }
}
    ✔ create account with service identifier and resume (464ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3c4f337165e2753fd0bf@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3c4f337165e2753fd0bf@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3c4f337165e2753fd0bf@restmail.net',
    authPW: 'd142711102a6d7e68100c290f037395c62d0711fdb5bb2d445976ee1bd9efe7e',
    authPW2: '9ea904709c29b01af5edb7f6d0f1c427889c1aff0697462324999076848faba5',
    wrapKb: '08be159854b7e66a7d9522160f64dd6aa9ad2258d12e0beb1b08c3058f4eccbb',
    wrapKb2: '1f517e5fa8c67b4607ef6600affc2c5906e27200157b52362a74383de69828f5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bfd37397811e84b0bbb564116440ba5af67972f698e116575e0a0b4a11939006',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '775374e639004215a8d6622570127b5e',
    sessionToken: '760b7ac72a81674e14dc396ebb28eb9e00ddf8d822a09b5c367835b6274cb619',
    authAt: 1705108642
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="14ed49ec07736959233b38966d0266a0e5e8d9d0ccdb2abfe0c3f4c7e58d6383", ts="1705108643", nonce="Pdtdhe", hash="QM4yEK9YjUF0A6E6HRJ3cSq7pQ53PV6oq6zXOhAQ+UQ=", mac="JupPRrZvtYONFschLv5x4M0fmF40Hd8F8g7PMYTVWio="'
  },
  json: {
    email: '3c4f337165e2753fd0bf@restmail.net',
    authPW: '9ea904709c29b01af5edb7f6d0f1c427889c1aff0697462324999076848faba5'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3c4f337165e2753fd0bf@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3c4f337165e2753fd0bf@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'pt-br' },
  json: {
    email: '3c4f337165e2753fd0bf@restmail.net',
    authPW: 'd142711102a6d7e68100c290f037395c62d0711fdb5bb2d445976ee1bd9efe7e',
    authPW2: '890a94b510e4a05ba4740a3734805f3d5da8485d928623fc7f59cb2dba811ebb',
    wrapKb: '7070a49808899dff9a585afe29108f26bd59ca2caa26070345f4a0f8008adecf',
    wrapKb2: 'd8829a3d42ee972bf9429c51600b38112b0fe9ac41e86dcdd9d151937160049c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:94c4523bcd204f1717af55da70e7b1bf91204eba6407502f61655bcffd7e858a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bbbfaa3160d14c7db00e28d4e44bc426',
    sessionToken: 'e64550eb97c3b76191c2240f157a35484d21f4e5974e9ab1ca94a38b92b9bbb5',
    authAt: 1705108643
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="27523d4cd5ca31c7119bee272063d1f1325e7a389a6e870d144762fcd62b57d7", ts="1705108644", nonce="CSex_A", hash="j+C9CAi4zhjgJHTUTN4LT2NcHQDEVFYtKyLUw6eTyiY=", mac="Jv+sAykcis1cyTwMTq7H1waamckvxNYlZkepQOa3Vj0="'
  },
  json: {
    email: '3c4f337165e2753fd0bf@restmail.net',
    authPW: '890a94b510e4a05ba4740a3734805f3d5da8485d928623fc7f59cb2dba811ebb'
  }
}
!!! response success { body: {} }
    ✔ create account allows localization of emails (1401ms)
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6f2192bd1fcb4925cc81@restmail.net',
    authPW: 'a52b5ba6e8ffd1845652344eee28582da194980768c2a2613eb8f13c7da4bfd9',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6f2192bd1fcb4925cc81@restmail.net'
  }
}
    ✔ Unknown account should not exist
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2de1dd8aec94d0fdba50@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2de1dd8aec94d0fdba50@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2de1dd8aec94d0fdba50@restmail.net',
    authPW: '8b2334007e07d866fa80c2b7ed3dbc5695dbb0eb6da0449b1a4e4e0a1e85025d',
    authPW2: '5586a7de0a485c5d64f1cae958a27d42f219288d9ccfd4b98499d9a31ac1f83f',
    wrapKb: 'efa14ff43eab3bac6abc27dfccb7dd5edba121b8019a2ff911efb6e3fbed8161',
    wrapKb2: '0f32e2240ca1ca62bdd34b5b476e6cef274120e4a79031a612bd582a61dd4ab6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1b60a92fb2a470731208156e356d289558d40c2ddaf365a794fccadd2f34fa7e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8881ab48f34b43688037ec7204a6fc5a',
    sessionToken: '2b175f2cfab8bd0ff9545b50ee63e96f2de16115719d6880549a99b114c5f03a',
    authAt: 1705108644
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8881ab48f34b43688037ec7204a6fc5a',
    code: '1b6645f92499c50ec1395186bfedba1c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2de1dd8aec94d0fdba50@restmail.net',
    authPW: '5586a7de0a485c5d64f1cae958a27d42f219288d9ccfd4b98499d9a31ac1f83f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8881ab48f34b43688037ec7204a6fc5a',
    sessionToken: 'f3067a7e4430a9ae4f8b1e19bdf8f3859cf56bd9175e5aca469fb31ca7518ff5',
    authAt: 1705108644,
    metricsEnabled: true,
    keyFetchToken2: '1a02b6cfaf49ad8ba4ab82bc52223e482ff8c0467628407c286de398025d39fa',
    verified: true
  }
}
    ✔ /account/create works with proper data (715ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7b4fc67bf85ad14e76c5@restmail.net',
    authPW: 'fce0ee755f9b09167b24dad16b949899d2f90930c1db41cbfef26944ad643213',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '266bc947a54347dcb82fe7913e645b86',
    sessionToken: 'db86bbb3c6bb52fcb21af1765ebcd442b5b21846ff68dae414d7dec7567fc56b',
    authAt: 1705108644
  }
}
    ✔ /account/create returns a sessionToken (198ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8dd86b39bdb89c7f7928@restmail.net',
    authPW: '9bbcc6d856848d4ab115dcedfa1b20f7cb41cb03aeeca844de699651d089833f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '31bccba0276d44b29d6f1b5c998c78dc',
    sessionToken: '3f20ec8b2cb833e4902093689f9549e0d0f2cbba893de5802dd0e14883f6dd33',
    authAt: 1705108644,
    keyFetchToken: '4c88125b04f4c7b0d7deee2301471e4c6c2f70916ebc05c99d66c54541ac7f65'
  }
}
    ✔ /account/create returns a keyFetchToken when keys=true (196ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e7254b0265eac2de0065@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e7254b0265eac2de0065@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e7254b0265eac2de0065@restmail.net',
    authPW: 'c86173c995d005d3388fe6f6874d731beec8269d04aa93bb5a45ba7e7c046bb6',
    authPW2: '5cae705af337180865d811493cde29f2be351c64235bb1d2409f52f8d52d8dbe',
    wrapKb: '28c833996b7fb9822ac5e8752127adfba523a078300376a404fce9c56c439062',
    wrapKb2: 'ab45e0994679c5c035639170477059dd12ed1207d5e239664643c17f84dbf190',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3899e45c3989f27e7b96296f8f1945fbc27601bf6391c37b8ef2fc8288a9a293',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4450fbdff9814582a49815d2f092b546',
    sessionToken: '50f5986de953ebcfac33f9008590199838261099688178bb9d2ad92683b4edf8',
    authAt: 1705108645
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4450fbdff9814582a49815d2f092b546',
    code: 'b00a08a1fede1b2c358988e8c9e8fa09',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'E7254B0265EAC2DE0065@RESTMAIL.NET' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3899e45c3989f27e7b96296f8f1945fbc27601bf6391c37b8ef2fc8288a9a293',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3899e45c3989f27e7b96296f8f1945fbc27601bf6391c37b8ef2fc8288a9a293',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3899e45c3989f27e7b96296f8f1945fbc27601bf6391c37b8ef2fc8288a9a293',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'E7254B0265EAC2DE0065@RESTMAIL.NET',
    authPW: 'd2d832459235df311df4fe68c04647de8d1b17e0fe248d096aa412a6cfd62047',
    authPW2: '5cae705af337180865d811493cde29f2be351c64235bb1d2409f52f8d52d8dbe',
    wrapKb: '6307864cf0c0c457bf2ec82c17ea34a517e827567a3dbf4f4ee0ddd8c04cabc3',
    wrapKb2: 'b54bd0821b3a60e82a5f9d6a5218a7c34ad0092222cd00024f32188c2b531852',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3899e45c3989f27e7b96296f8f1945fbc27601bf6391c37b8ef2fc8288a9a293',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 101,
    error: 'Bad Request',
    message: 'Account already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e7254b0265eac2de0065@restmail.net'
  }
}
    ✔ signup with same email, different case (626ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3e4b4b5d8be9c50dcb36@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3e4b4b5d8be9c50dcb36@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3e4b4b5d8be9c50dcb36@restmail.net',
    authPW: '5db7a1e160cb63237c1b11f7c9293f3567214026a0b0e4c66b4aa89b17f7fdb8',
    authPW2: '46ea809af2bf64f1917894a3ff9b8ed4e6a311aa1f960c3cb2a7dfcc52c25725',
    wrapKb: '37f82000249d0b2c9cfb3f54838d4e20ac44af21106d5e4926147fcb8c954da3',
    wrapKb2: '1a55abe567074a11f339e9eb35b73ee33a672c6d57867dfda4e90e36ff44b1fb',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d3f243e0e93edefe7791d1faeb790347e1de1e859e738b46b9d9d433834bd3e1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd285bd27eaf1405d9db5ea7cb276abf8',
    sessionToken: 'e80b70344a18461e243e70c3fdf843a9bc7da792e0f1d376e578764978200bdb',
    authAt: 1705108645
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3e4b4b5d8be9c50dcb36@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d3f243e0e93edefe7791d1faeb790347e1de1e859e738b46b9d9d433834bd3e1',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d3f243e0e93edefe7791d1faeb790347e1de1e859e738b46b9d9d433834bd3e1',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d3f243e0e93edefe7791d1faeb790347e1de1e859e738b46b9d9d433834bd3e1',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3e4b4b5d8be9c50dcb36@restmail.net',
    authPW: '5db7a1e160cb63237c1b11f7c9293f3567214026a0b0e4c66b4aa89b17f7fdb8',
    authPW2: '46ea809af2bf64f1917894a3ff9b8ed4e6a311aa1f960c3cb2a7dfcc52c25725',
    wrapKb: '5baba4bd9c151e8b3c8e6da3a81548c75cd93d4b2cf25059918050818ca4294d',
    wrapKb2: '76062f58df8f5fb6534cbb1c1e2f3804cafabe076b1973ed137d217cff75d515',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d3f243e0e93edefe7791d1faeb790347e1de1e859e738b46b9d9d433834bd3e1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e4aeae9e0e324447862aed800ba6ac35',
    sessionToken: '73000c3afff684f911d81bd8ffd038eb6c55c92a825abace06d34e22f580f360',
    authAt: 1705108646
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e4aeae9e0e324447862aed800ba6ac35',
    code: '65a63b160d055184d89785bc5c8e6afb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ re-signup against an unverified email (997ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '477382a191aa7936b428@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'http://accounts.firefox.com.evil.us',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '477382a191aa7936b428@restmail.net',
    service: undefined,
    redirectTo: 'http://accounts.firefox.com.evil.us',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid redirectTo
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd8997738a12b067c57e9@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'https://www.fake.com/.firefox.com',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd8997738a12b067c57e9@restmail.net',
    service: undefined,
    redirectTo: 'https://fakefirefox.com',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ another invalid redirectTo
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '474a712e451aa5991d23@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'afc5d470882d4e5dbd94855f5e5fc046',
    sessionToken: '6f8923a4e894aac7f810d9215b97a241613338075ec476525f4448d56efb24f8',
    authAt: 1705108646
  }
}
    ✔ valid metricsContext (201ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '69919d673cce02f8a382@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {},
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4679e855d5ec47029e87bd9aeee9210b',
    sessionToken: '7157893f35b6980fd4153f195c6f99e7a4b0465e8d7ae8d85bcc2b63ae129307',
    authAt: 1705108646
  }
}
    ✔ empty metricsContext (188ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bbfdd627578385e769d4@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: ';',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'foo',
      utmContent: 'bar',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypoint
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'af270acf42aa3271ca59@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: ';',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypointExperiment
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0bd54f0f96c4acd1e9f5@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: ';',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: 'blee'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid entrypointVariation
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cdbf7332daa6350072f3@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: ';',
      utmContent: 'bar',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmCampaign
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd2d4f54ff91d8eb3a9a5@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: ';',
      utmMedium: 'baz',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmContent
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '43fb0ea5b4312cc99a4c@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: ';',
      utmSource: 'qux',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmMedium
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0915767e3056fef50e5f@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: ';',
      utmTerm: 'wibble'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmSource
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1831856f62297ec1f01e@restmail.net',
    authPW: '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      entrypoint: 'foo',
      entrypointExperiment: 'exp',
      entrypointVariation: 'var',
      utmCampaign: 'bar',
      utmContent: 'baz',
      utmMedium: 'qux',
      utmSource: 'wibble',
      utmTerm: ';'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ invalid utmTerm
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7d2d794f7a905632d8b3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7d2d794f7a905632d8b3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?service=bar',
  method: 'POST',
  headers: {},
  json: {
    email: '7d2d794f7a905632d8b3@restmail.net',
    authPW: 'a58dfaab7da5f8596a8dbcb9d9524e0702b8a7eda3e66bbcdad4d6e3eba25d58',
    authPW2: '312522ee4bf79e28de4aae45f917c90e763466684676139d0c797bc397934bc8',
    wrapKb: 'd3393f17e0a9fe31c16b55adbe93bd36eec7014b3a6da0bb18cd876a2f85d086',
    wrapKb2: '0c54910d9b9ebfad97bf575447b8c6ec52516a5deca50ba3261e9989aebea092',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ac591a25b6895421f83513a7bac6f8eb3cdd67a7a6fed99031d8a5910b627c06',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f74b276b4d2e4d099a55cd4a59fc6c6e',
    sessionToken: 'b24a3bab6f066e82f5963ac449d7c070b8539cd455e75322d96b094d82d34acf',
    authAt: 1705108647
  }
}
    ✔ create account with service query parameter (455ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cb03dfcfcc82f15d9560Ӓ@ᘮrestmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cb03dfcfcc82f15d9560Ӓ@ᘮrestmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cb03dfcfcc82f15d9560Ӓ@ᘮrestmail.net',
    authPW: '9f8f83ad07b00aaa224a203f041fc2bfeea178fe7ce10e045794be892a2c8a50',
    authPW2: '0c00626261a694e761f9d098e70879ec3fafae46bddf0ac9b70aa002ff95697c',
    wrapKb: '146dad1642e47e038558804059185b99d9221551729c33919bd7db75e2ec0ffb',
    wrapKb2: 'd9208b9ff5fd9b82ea4d1428322dcd7499d1f9e2c62dbac42f25ebd6a6636685',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:902bcaca462a26ebc9c4091ad8bcfdcbb865962542feb6ccae646ab59de3a7e3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'dc6b8efe2e184351aadecafc569a2611',
    sessionToken: '0956673db1e320e96a637fad3dea88bfa6d74c9b9ee9f0b46b09735c4a452b53',
    authAt: 1705108647
  }
}
    ✔ account creation works with unicode email address (457ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1b1ff6f38464740d6e70@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1b1ff6f38464740d6e70@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1b1ff6f38464740d6e70@restmail.net',
    authPW: 'f95b8b04d91179ef9bfc5852a628b6202d72f09e6ee5a48ed62837574da45c20',
    authPW2: '5d493a996927f0c1195b607400b36495b5be777a1a5a1fd8d22250d20400661a',
    wrapKb: 'a120d19055b1a6638eb4054410799386bfcd9c76cd185378f4e0ea3496e637a4',
    wrapKb2: 'd2830fb81b1ce80a3ef3000ef2f57612b205f77ce84f43497f91a59117371145',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c84ee3a2d565bbd862e31c074738013f9478f63402cbfa791141343a1cf93c67',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: { flowId: 'deadbeefbaadf00ddeadbeefbaadf00d', flowBeginTime: 1 },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with invalid metricsContext flowId (138ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '60d43bbfe00bb269f47b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '60d43bbfe00bb269f47b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '60d43bbfe00bb269f47b@restmail.net',
    authPW: '0f4d4d194a1313c8032955d2a98b2ae2dfbb92fd090789d8ba1264a6ff48f201',
    authPW2: 'a1b909fc1c84307023b9dcf12052b638fd200f73bc2bf95239d3a84257865f7d',
    wrapKb: '4de3c9a576079bf45e08042d31e6adf674cad591299684168dfb86619b142562',
    wrapKb2: 'dbc6e91d63fd35d5bcec8549b267ce6523e7787628b6b5284913707bcfb50593',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f7f12110e5f32297d24d73b0e8b382b7435384ae969650443a55955584e84750',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowId: 'deadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00d',
      flowBeginTime: 0
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with invalid metricsContext flowBeginTime (150ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0b1c42e99e36c43d0e06@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0b1c42e99e36c43d0e06@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0b1c42e99e36c43d0e06@restmail.net',
    authPW: 'f8d1b1089c3b3125e236ec98574880fbc3da5a5c79a362e26e430268d424ffc7',
    authPW2: 'e485f57ade6d0750094dea2c6bf68b050f825847942d4cfc8e0008ce2dd96da6',
    wrapKb: '799ece60b8d6640c619837d6780856e402e62b5bbaa6631ec8c9d4d6bd61ae7b',
    wrapKb2: '7d96a019c4a9102b40027c2cf6e16fa1b2195a84e2c23f6efc05557e7658bee5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6659d906f7766da01d85548456afb27ff03a836036ed3ba1bbdaf242f5a987e2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108648129,
      flowId: 'efb76ce127fa0e151bdd22035e15e6b9b72e30e121cee1a684bf85ffdf05feec'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c273f46943b44d7faadd4ae0a16b8233',
    sessionToken: '48b3b1e1b242b504973042ed35b05f2f672cd84d5d77cfadc93d4cebdb315d3b',
    authAt: 1705108648
  }
}
    ✔ account creation works with maximal metricsContext metadata (461ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0a71c17eb3e749608668@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0a71c17eb3e749608668@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0a71c17eb3e749608668@restmail.net',
    authPW: 'ffbea1030b73d0bc8005fe19c20a78eca1fd0f15f55d16d021f12fdc9a964328',
    authPW2: '31ce57d530c5a2f3f6e1e306e75706a6ec8f8d8f5362ec0bdbdbf2897a225c9c',
    wrapKb: '52faeae42f0e6d0489871685672bba7d66d02a4cd33ca43e03cae5f82f102ec4',
    wrapKb2: '8614b02e952908e4a79889531135c7067ba51119ad70ad5f98ccc05d38ba541d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5f3160517118fe4e7df86a0f4eb1253b8b83c27b571fde12395471e878978f10',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {},
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e8ec408046cc4383ba46fea8c23163d9',
    sessionToken: 'd822b23d94774f784c551e30cb52273ac8fcd716b43c77d1b5ae04eea1782fba',
    authAt: 1705108649
  }
}
    ✔ account creation works with empty metricsContext metadata (448ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '241f16d02d70bf725204@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '241f16d02d70bf725204@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '241f16d02d70bf725204@restmail.net',
    authPW: 'e0b5cad2327cbb66fd901bed2c46765874841aed55bacc688368e3620b12470f',
    authPW2: '6071b154287b7d69de8858594f53243bcd2404e3ebc955744692ead063baafe3',
    wrapKb: 'a392a28ee017dc977746b2124c15d283ee04807a07e728b470a431327ec71371',
    wrapKb2: 'c3df718614921c0ac434e5799082ee936bd402924cc6afe6f49c3ce37b6eecd8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bb19c9a1c2e20d7b753ddbbcc6ae2ad683006f597ec984d32c1b36b52f8015d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowId: 'deadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00ddeadbeefbaadf00d'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with missing flowBeginTime (138ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5ed7513b0f39a8178694@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5ed7513b0f39a8178694@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ed7513b0f39a8178694@restmail.net',
    authPW: 'f5a4270cb2993aa3deb51fea5d56fe2c5748f86d1a540edb03feff93fbf66c9d',
    authPW2: 'dff5ddf06eea0977a9349b712b301fffc792eccf8c2ffd1d67c725286020ea28',
    wrapKb: 'f8fc2a53901eb9ac8d9f7474f9c0ccdef1bb07815b778ce55867d9ca5844ef2b',
    wrapKb2: 'b5968bb78d477e8b4656af9094c1806fa2873f646ea667271af84757172fcbc6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c334affb25096d4d1dcbe8b7003f2109d04e746ccad80fe9c9dd96c891fd4bae',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: { flowBeginTime: 1705108649177 },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account creation fails with missing flowId (146ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3a7795a3b0f6be212da5@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3a7795a3b0f6be212da5@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3a7795a3b0f6be212da5@restmail.net',
    authPW: '753ac8585c1200576c3f2e47e7a0f33c8c800bb84950d07503fdc42e35778653',
    authPW2: 'da231ed1c74092b9b203ec194ecd7b0f13acc332d7232efd4ae7fd131c6fe7f8',
    wrapKb: '577b70dfdff01014245d49fa9a595c6af1a96281ed09b2cc0f63b7668cca04c8',
    wrapKb2: 'e232300b1e09cd37021d200927d31a998578066bf557a7e0982529f3b0b00959',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7492ad719c226659f8ab21bbd7cf03302d1936ff9e45cbfaecff98e2227eedeb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd0fb16149f7a439a98b0250af125354b',
    sessionToken: '9c03be6293f27a73deaa7dd4c84323eca2e3a25e1c9827591972c63ea95ecd5a',
    authAt: 1705108649
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd0fb16149f7a439a98b0250af125354b',
    code: '30f6c24db445f58681b783934ccf5069',
    service: 'testpilot',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="25db48c91afa5e54abc8fbad8b8ddd5d90578fe2a93974878b3e833aff96b37e", ts="1705108650", nonce="3hDD_G", mac="F2W0LPU1vGVPIMf8U8HxT60msopLchTRVoDl2vqyrOI="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3a7795a3b0f6be212da5@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '3a7795a3b0f6be212da5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '864b74824c5d8e23e9113ad5e485429e59f96e769a69c86517acc6685ab32e65',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create account for non-sync service, gets generic sign-up email and does not get post-verify email (530ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8c509c1c21111fea63c2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8c509c1c21111fea63c2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8c509c1c21111fea63c2@restmail.net',
    authPW: '56bd05b298622b2d41398845c63b679bd2c673c7778c14e4dae00e1b281a7b43',
    authPW2: '0df7e97ba13db8025c3a7878dd2bd6084d68dc571239a8ebd65cdcd5c49cc96a',
    wrapKb: '90774ce00150bd33f5efdd5e19bfba35d0cd6051353b291ee1cbbf23f5071ccf',
    wrapKb2: 'db07999d17d9d94a9005c5823ae0cee03ede3e504c6aa88cf16c2849ffc0b5e2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:846697c0e592243012f8228b21bd19cb614d9f163e9a4fb9dd84dcecc7af1951',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ee310cf6a0f2419483c976a2e7a15bd9',
    sessionToken: 'e5cfd0395bb839ae13248af4d900d1d98d645264ec3a0526fe7f6f81bcc1a099',
    authAt: 1705108650
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ee310cf6a0f2419483c976a2e7a15bd9',
    code: '6d62fec1780acb23e3dbc51853953627',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="19b3a83c55c5401ef8db3363f0d1b7a76f3a77b6ba9240e2ff6a8f2a7f7348a4", ts="1705108650", nonce="r4mxca", mac="CZ6KV0qQumTp7Kpsd0gdykr/Uw95UXSt9kBbVBXscq0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '8c509c1c21111fea63c2@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '8c509c1c21111fea63c2@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '09d342a7abbc9087f5d0690d145af29a78fce80ef46750715838f38e9958afc2',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create account for unspecified service does not get create sync email and no post-verify email (514ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '34c3357a1304013d320d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '34c3357a1304013d320d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '34c3357a1304013d320d@restmail.net',
    authPW: '113ce81bfceedde1d17b844fbcbcf996c8b7e0391073bc390268ea584ac9c222',
    authPW2: 'd599f374b698a8dad7107e44406376ed7e8eb5efe595d46a1014fe9cfa56dc5a',
    wrapKb: '35d8b0aa2cab403b530d5e7b3d926fe15433e41c12da8f2f4019facdc14682fe',
    wrapKb2: 'f2bb71c598b15b838849264f5376ab848764971d98e7bf97cf57a68a01c2d8fc',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0b4af7d14dd4f1a6ecc34c17c0a6c759cc764cd99236615ba60c2f865893f4ae',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '723e917bb16d42ee9f79ffe8d2246964',
    sessionToken: '35a9f35a83fe939168d722a3d198ae0c2aca54975e49fe588d283007eb9996e7',
    authAt: 1705108650
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '723e917bb16d42ee9f79ffe8d2246964',
    code: 'cfa7ca879378216d4409240bcbb9fbf1',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: [ 'test-pilot' ]
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6f7c6fd7d1b9a1ddc8f98589f1ac7fec0863c814cf6924d62f54f60ae039d5b1", ts="1705108651", nonce="sL1JZt", mac="hdtMNZS1qrjEjpBFuMNMopu7pQZc1ElhF/DXtGhxQbg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '34c3357a1304013d320d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create account and subscribe to newsletters (511ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '82c5fc90b05dbea586b8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '82c5fc90b05dbea586b8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '82c5fc90b05dbea586b8@restmail.net',
    authPW: '61619559636a14dd94cc6342b0fe3a1e4965db33c493c7ef08fee9ea96311b0a',
    authPW2: '06c09c64818e0822dce84280469c2c824365e256f5ad4a748ab0a4773271248b',
    wrapKb: 'c2dd37cde428495b24aab3ac4c3a911cacb46bb40a153f9ef0ea4efe09df8c17',
    wrapKb2: 'dd2a5d039075c9f72d7b0a8ab3791ab2b65aaec44693f4b1a108e3f799c67db7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1552d15c1ace4e6ab9942c78ecfa3efc',
    sessionToken: '77f9dd24f6060efd86b4f63a4d13bc56815f39c7e215d1023549649246d2085c',
    authAt: 1705108651,
    keyFetchToken: 'd71b09e7189d30cad871f78f730a1fb5651b4fb7cdb07ea9154cd1f816582152',
    keyFetchToken2: 'bf9ef58ec3f781a36a5faa14085c878ab350db1951ed49f22fbd4abcf8e45070'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1552d15c1ace4e6ab9942c78ecfa3efc',
    code: '4f78db4cbed94424797015a572fcec05',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a4fc4610df321ae51ad9e625600eb2f99a3dfd4357a034fe09743c3e47511c0d", ts="1705108651", nonce="hKkgiR", mac="cscEIhFdMcqSLluERFdwa8H5gdQwlf/EKCnbYf9Lim0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'c67574ca4195edb003823a5ae608d9683b2f2476925f184112b79c621abedd39a721426067984d3d37d0754c232c6c1e011bca7ffd93b175fa0289e4771a996f7359f40421568a935c057c24e3ec0f57b5a5378a4df1de1838656a9bb0189d70'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ee811b4517bca5e506380a1756dc33ac10aa27a850c35be56558366548119861", ts="1705108651", nonce="x0TMkZ", mac="/1gW4pLhWKvFH94FwCjhTGz0RYzgRmkmA6QJpH/VOS4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9a3081fa3a564eb01f00a6008bd6af46fc19096c3382f9d702e0274219872cd4329e595fa726ddab8742f7ca08ca45e3360098d03830f2c680e0eb03f40d953ce1448feec0098a621ad9252e1f7e1352269df269951e8ef1cf2b48d0c6d7fa65'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '82c5fc90b05dbea586b8@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '82c5fc90b05dbea586b8@restmail.net',
    authPW: '61619559636a14dd94cc6342b0fe3a1e4965db33c493c7ef08fee9ea96311b0a',
    service: 'sync',
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1552d15c1ace4e6ab9942c78ecfa3efc',
    sessionToken: '31fbdd1b2e7839dd749ba39d3ecf2dad614c8ac8ba6768494a4cb9162734b934',
    authAt: 1705108651,
    metricsEnabled: true,
    keyFetchToken: '5ff33aa0a0bcc3df9506dc08741813f307fc73576764042df7e82b61f25282e6',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="610b7c5f094876784ca4dc61499d3412518d329a794315ffc8fa0890f8b86389", ts="1705108652", nonce="6jFZJl", mac="ChgP45RgX9nMUrA/ztMXt0cPuN9/m3vGIEX7MD1Pixc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '791fc51616c97bdd27e1fa1a67b9e3191cf1cc511edc252c047f3c79bc8849d7b2c817546ddaaf4403f13b904d14cd0ba72f68e412f2672e48329bfffb344fec3e6e392908a6969db13e4435c076628ef5afb611a51adab9397d637f944567e6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '82c5fc90b05dbea586b8@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d210d83ddd9c7fd1a2496e3dc5944b6b5766e4a4a0cc5dddf1f4f409722d0abf',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '82c5fc90b05dbea586b8@restmail.net',
    authPW: '06c09c64818e0822dce84280469c2c824365e256f5ad4a748ab0a4773271248b',
    service: 'sync',
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1552d15c1ace4e6ab9942c78ecfa3efc',
    sessionToken: 'acede5ea624c40ad0e2fe11b9accca3d2be4ff9cf76436a4b9d885f5e8ed6ee7',
    authAt: 1705108651,
    metricsEnabled: true,
    keyFetchToken2: '0ef7611a658e859a50144718f1e94afb662958577d9a22c78bedc5668cee674e',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="334755c517957fb5ac64ec37cf41d0df63fab9e6d3d6a17bcb1e928816c14a92", ts="1705108652", nonce="E0-ltH", mac="za1EyRNiv56uxeVlZ6JuPWxsMMQhgdH56pIoj8yY4qw="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '1540df9de7a8e3ec64a7a32b7b347347003cb2f85133effd7d3634a2448d14d32a4110ffbb472c9d0a6a0c34ccadb757964ccc5371e2054e8d05e0ff89f8d29517bd7e31955ac56f284c4f4f6946616669f6deab18af673ad18d73169a8246ea'
  }
}
    ✔ maintains single kB value for account create with V1 & V2 credentials (1076ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3af94d4606bfd24e8304@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3af94d4606bfd24e8304@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3af94d4606bfd24e8304@restmail.net',
    authPW: 'b9f129567218925fdacf782026a072764c3c9d7c102ac33343848c433f609e91',
    authPW2: '5967bab3d508678be1e2ec6c5feb10dafc234508fcaef497806d8aac6e9fc5e0',
    wrapKb: 'f81eb834c7927c02c973b86d85d4bfe1e2ed1e4f4462d41ad23ae06de2438d4d',
    wrapKb2: 'd2488f2157d96ca16c6434689c3068a8172ce7bd16b8511c9a42e05598dfe0ac',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'beb92a32972742258642e58ee93335cf',
    sessionToken: 'ad6c120d787aa0deb1978d6e045619eab49083ed636108ee1be9ea9cf5bf1fd3',
    authAt: 1705108652,
    keyFetchToken: '7058db0032fcbbcf06d4c0f0738430163d25295390f60eff8f352f42a428ec34',
    keyFetchToken2: '2cdaa6057aa183ba3d0e36729b95adbff3065d4b79cf8a80a903f6db33d976ab'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'beb92a32972742258642e58ee93335cf',
    code: '5ae833ef8ab7567257afffede6d42380',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9326606cc34c6ef2955c050c297f3425fafdd8c35aa3afca306427e92ad55f85", ts="1705108652", nonce="vZDvFi", mac="++RJa/b7dwdHTeL6A+DF2tnkHXE97x2SYLt87HHPrjg="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '77838d8791d0e0c3893ffcf6d3621edb0188c8281d623357c5d1ca6ed4c44df93fc16e7c3c179e2e9396908b910e6c7fbd3ef6172af9e07e6d74e4d73b0721b5bb6ad2b09ebf8087d7ee0bd3d6b0d21c5c1284d292c921ea8eba7b76da3559de'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '3af94d4606bfd24e8304@restmail.net',
    oldAuthPW: 'b9f129567218925fdacf782026a072764c3c9d7c102ac33343848c433f609e91'
  }
}
!!! response success {
  body: {
    keyFetchToken: '64909bbb36a6dd747adb8f5714164a8169b0043867c0453837ef90051e3d9f50',
    passwordChangeToken: 'dbb4e1932d2029a003546a4a846657a075b97bfaad40862940c186c374d65a32',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3af94d4606bfd24e8304@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f9ba14061920b9a8e430e12fd8d0cfb5864d007793782a157037d0a98dd28210", ts="1705108653", nonce="_f3W4o", hash="Loj31R9WVF4VJAXdBY8cVcrz+9Pvd4mJix0ivNUgJkI=", mac="bN2RNN9K1MEIN1Jz9o4T3cqNSf8Ga2MGUmhMX1b6krI="'
  },
  json: {
    authPW: 'b9f129567218925fdacf782026a072764c3c9d7c102ac33343848c433f609e91',
    authPW2: '5967bab3d508678be1e2ec6c5feb10dafc234508fcaef497806d8aac6e9fc5e0',
    wrapKb: 'f81eb834c7927c02c973b86d85d4bfe1e2ed1e4f4462d41ad23ae06de2438d4d',
    wrapKb2: 'd2488f2157d96ca16c6434689c3068a8172ce7bd16b8511c9a42e05598dfe0ac',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3af94d4606bfd24e8304@restmail.net',
    authPW: 'b9f129567218925fdacf782026a072764c3c9d7c102ac33343848c433f609e91',
    service: 'sync',
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'beb92a32972742258642e58ee93335cf',
    sessionToken: 'cd928f0bfdb5074bd0a3c9bec4dc5920bd2d8a9090b56221e9c6a6315ba469ac',
    authAt: 1705108653,
    metricsEnabled: true,
    keyFetchToken: '38b34d1e61f8b22af35de0496c9c77983b198de4cd227351845d8e75fbec9fdb',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="98ce6f9b4062b2b1be27ca7ef1bc9e4e75d45b6dcb400c421f6e765818f42427", ts="1705108653", nonce="bBwo0g", mac="iHaZWcz9LHdo99WxBSf1N5IImBNLvhWIuM9028RtevE="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'd04efbf4b3f3e0215bc8f883429478d783eb79d5a151ba04ac27a8d34af053d0ddcaf490a25660013f7aefa0397d29b9668e37ded45d29127e595daa625c7d4c7590a9d3a803c3b475d5773bfb7d90994f73961c0d86505645a13a5aaafdf5fe'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3af94d4606bfd24e8304@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e7ec13428ad445bb123cc8a33b4f5f53ce40afd54998948fbf74a7babb295ab0',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3af94d4606bfd24e8304@restmail.net',
    authPW: '5967bab3d508678be1e2ec6c5feb10dafc234508fcaef497806d8aac6e9fc5e0',
    service: 'sync',
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'beb92a32972742258642e58ee93335cf',
    sessionToken: 'a9c628ddcc1f9a801beb2cf8ae4e7eadb6ca50d497b73766c4def63a4aa558cb',
    authAt: 1705108653,
    metricsEnabled: true,
    keyFetchToken2: '9c7f50513c191aa42aaeed88c925d30fbb985f5bb223b070bcf6c7fc4914d300',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f1ae76aed5ae16c888c249b843995e76b66c673d7294367f7af0747cd05c9761", ts="1705108654", nonce="ssn2ml", mac="Y//qGFfHeSTfGL0rrr2uBCwhEYWYqiEmyqJQEcO1jkE="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'f61c202c0d1de49694eca0ae19f291313d19471e74e2844eccd6fadf7f960c7d07fa273cb353ea8f8e0af87359ea92198b603048b2666914e23abf18d1d26c00d03327e11573d2eb43b103137c23f1b21e21e9ad94e3782050d4313e8f2e4a59'
  }
}
    ✔ maintains single kB value after account password upgrade from V1 to V2 (1751ms)

  #integration - remote account create with sign-up code 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3431f0a01ea68a8d2397@restmail.net',
    authPW: '574de1a6c43a02202f4f0dc6604ffdeab32d8a61fa8eec455b795101544aad77',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: 'ff4be0c5204b4c6da9c676b455f29de2',
    sessionToken: 'd26144eee5745460456e07fdf2e1c2c2ee7ca917a6218ac0073dda619c7fe9d9',
    authAt: 1705108653,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6905499667e90c9fa70fa38bda74ba13614b19a5c457c8aa61485bada78556f2", ts="1705108654", nonce="WVauWa", mac="lOJNAWFUIXS8aJe/y5d+1iJqij350x8Sn1OsSOa4h6k="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3431f0a01ea68a8d2397@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6905499667e90c9fa70fa38bda74ba13614b19a5c457c8aa61485bada78556f2", ts="1705108654", nonce="leuKtw", hash="2aq51t7MDUJ5uOM8oKfKh88ll93SicEVyrz2Nkb0r2M=", mac="g2NnDHX8Y6G92/QENmRkbS+Pu/9//3wE1OhiHEs05po="'
  },
  json: { code: '677599', service: 'sync', newsletters: undefined }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6905499667e90c9fa70fa38bda74ba13614b19a5c457c8aa61485bada78556f2", ts="1705108654", nonce="d3feYS", mac="YOvUzqBUjVcRFKThq59jYk4YRV02Y7/JZH4i7Z4DNKE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3431f0a01ea68a8d2397@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create and verify sync account (300ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '99d3c8a4b6bacd674598@restmail.net',
    authPW: '8de5d9dd235f0efc7a8731f0a67fc546952f2b503019c670d1654b67350e8636',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: 'ae31656ab9af418d8d089db66adb3b0c',
    sessionToken: '5dc649545539231802733a4e7ff7f0b4a3f336e8f162525ccf11aff3b426ede3',
    authAt: 1705108654,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2dbdd532f768e4f5351078a1681d3153c2fd502391b9087a78bb029662207880", ts="1705108654", nonce="j4FY5e", mac="INRzHFcS0HcFhJyJgduwRAgcyRzkrmW7FCMF/alizBo="'
  },
  json: true
}
!!! response success {
  body: {
    email: '99d3c8a4b6bacd674598@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2dbdd532f768e4f5351078a1681d3153c2fd502391b9087a78bb029662207880", ts="1705108654", nonce="YXFF39", hash="oxwI1YxE+5DHOkc/qY6q6YIjD3u/sk0Eha1rKyEyV/c=", mac="8InBAuHKdsJdZdGl0VuOsnvNZTCIYMRN1NFOzW3P4lQ="'
  },
  json: { code: '201197', service: undefined, newsletters: undefined }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2dbdd532f768e4f5351078a1681d3153c2fd502391b9087a78bb029662207880", ts="1705108654", nonce="SBCQOi", mac="rirGvKJkZu5MDJt/Y+6wWtMDtJq+ueR1dlMpgw71xag="'
  },
  json: true
}
!!! response success {
  body: {
    email: '99d3c8a4b6bacd674598@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '99d3c8a4b6bacd674598@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '4dc99b7798cc804705573b06e1513c739bf2af103919b378817c0c50f4bfe476',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create and verify account (285ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5f722072195d14110c4f@restmail.net',
    authPW: '10e2783e1b2d9ad6fb61557ca282c98aa8239763f5cf842818ee874de11f2c37',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '6919a9ab913542e98f3efbf6172c0d3b',
    sessionToken: 'b4711651801f2b667fe454b8a68f7a85f7b1818caa5f5b12e029b4dfe8212a6e',
    authAt: 1705108654,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0b476aced62c59993b2d699634318cf12e1df328681426d7884ffb49d78bd47f", ts="1705108655", nonce="YdcP3d", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="DUPCmMydIrxeGyFv2g6TW6Y4WE3sLBcwuVkVWnAVR24="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0b476aced62c59993b2d699634318cf12e1df328681426d7884ffb49d78bd47f", ts="1705108655", nonce="K1KsBS", hash="V465mxAwC4q8YVFHtTw/WC1IufvbG1azx/2475II2x0=", mac="PKqOCz3UZ2nRERwNdB4GcYMJYluc+JEcurhA9PQo7Ck="'
  },
  json: { code: '885699', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ throws for expired code (251ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c397e8410f5db3cc1c19@restmail.net',
    authPW: '5dca4f59f1f0fa7a0bbe475377121b9eb5654b3cd8587c95b4003644d9a6a46b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: 'b1358d3e769b466e85e6e7885a18a72f',
    sessionToken: '301c6045e3a5ef21b3282dfabcb061375944c346f0871b7f2d2cfcd5eca04f6d',
    authAt: 1705108654,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3012134ab523240d65d81bee7cfebd9c9b9650931e1445a5821bd4b1cdcd458a", ts="1705108655", nonce="ciP21K", hash="f5tA+qd6sILH4Ae+7igk1iIsKH5Zr3HaiUCgXnRq3Lw=", mac="rNJny+somG27PYip6zEfI6y3VCm7qBe2ZU7OP0kZReI="'
  },
  json: { code: '9826951', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ throws for invalid code (197ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6c36ae2cf78b9a4528c3@restmail.net',
    authPW: '2eaa081cfe9b5bfba16c907552704b44ae478ae2f7001640c019fc2ffa7e4dbe',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '2e9af1f1cdb642d6ade52af865de0288',
    sessionToken: '3cde547e1625b7891a6dccb6419b30ef9061c275c33afe1cbf32b6b5c8bdbcab',
    authAt: 1705108654,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ccaddffcb989b1802ccd1c83469c15ca90631a19973d64d685be38159cbdf06", ts="1705108655", nonce="hUr-Rl", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="7FBp2FK7LCtbr0OBl8hmNX2fpf+Tw2pt+TBwKxsa11E="'
  },
  json: {}
}
!!! response success { body: {} }
    ✔ create and resend authentication code (231ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3394a54390e4de834c96@restmail.net',
    authPW: 'ea7a4809baee3e5cbd298a252bf56d61146a9bb6e7228722ad9ba4674689dc0a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: 'edca155e5db943ab95ffdbc187cce86c',
    sessionToken: 'bc88d98c3d9d6cb171cefa1bc9ed0309a96948d9653cf9e3dd5c1fc69b27efb7',
    authAt: 1705108655,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eee3b61eb0419719f89033f002100878f502f87a66689d8c7cf41109b4457da4", ts="1705108655", nonce="Owvmet", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="33RVliJ4CVt9BHo3DaTQDw/6qeK2WlUd2VAMMwlCu00="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eee3b61eb0419719f89033f002100878f502f87a66689d8c7cf41109b4457da4", ts="1705108655", nonce="adVI4c", hash="/iDG1ftd1Gl3ZMC3klavP/LxpCuqss66BPAADd7gWDE=", mac="E4VnW4q3XdYTTg5ZyxCoMcyY/KNlIQ2z0WfzqQIwU+Q="'
  },
  json: { code: '862690', service: undefined, newsletters: undefined }
}
!!! response success { body: {} }
    ✔ should verify code from previous code window (257ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0035a7ae9a28fed91c3f@restmail.net',
    authPW: 'a8a5bfa30a18610fcd9c38d3adfe41f96629d7ebbf2179ca6496f094c8a6de6d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '5b9922121eff4d22acd5345365a64efb',
    sessionToken: 'f10300e55e12b07793ab680a7a3bf289d83bd343597a5f2311578c4aca266932',
    authAt: 1705108655,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="542c0be9d9bec2d3b180be859c2fdff261dfa28d58375ffdfc4dcb9b4e1beb51", ts="1705108656", nonce="t7XJi3", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="DdI0VUdpcfLAwewiEpyxhP7udr5if4oZO/QKip+sOZs="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="542c0be9d9bec2d3b180be859c2fdff261dfa28d58375ffdfc4dcb9b4e1beb51", ts="1705108656", nonce="SAva37", hash="DicIbuc4QzLL62rhmu7RJ4EObHovjZuHIbYGC6TY9p8=", mac="XLuPa6/GGUINoAsU8He1i3MIFLZGUvNxcrFZlIyrCmA="'
  },
  json: { code: '458668', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should not verify code from future code window (240ms)

  #integration - remote account create with sign-up code V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '13c53585d9f8453bf911@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '13c53585d9f8453bf911@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '13c53585d9f8453bf911@restmail.net',
    authPW: 'b16937557dd79579ce421a69be503b54bad258bf6aa4ad3bb6cfaed382cf9ffd',
    authPW2: '714421d40ba12ff114ec76279697dac3a838193899b1395d3505967e8b45f533',
    wrapKb: '0034a1a135cf6ef234681ba1eebe870b914533cfeae9c2084dd3a693acd0517a',
    wrapKb2: 'c1bced8f14e303179a41a60b7f828768a78a3e2397a6c77c800c625f1c253226',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0ad27f90773faa3f7620e18d610f88298c607fe1dc8de493f5f9708a6b4b1063',
    preVerified: undefined,
    service: 'sync',
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '80d0cd35eb394f6c89af079d04838a52',
    sessionToken: '89042bb54e8aa6ca70f6df285b9dd6c196fd830c7b16c3a988fe4b1623992abc',
    authAt: 1705108656,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2ca382b122e220eb3134c37a4e4e5dd897fbb2224b4b1cb5161553445c3f3bba", ts="1705108656", nonce="ZBqnKs", mac="/StwE6P6Lr88izbmOu+FbBDa8yO699DBDwzWYj8e/Fg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '13c53585d9f8453bf911@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ca382b122e220eb3134c37a4e4e5dd897fbb2224b4b1cb5161553445c3f3bba", ts="1705108656", nonce="-IRcVT", hash="BdaQnY8W9lK6l+++Qay5MyRjdy3V6CB4M9Y3f8jk0XY=", mac="xuO/nG00BMRIUnErBVGOwSrywDzS2X0Jr2QqGpkmkb8="'
  },
  json: { code: '436506', service: 'sync', newsletters: undefined }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2ca382b122e220eb3134c37a4e4e5dd897fbb2224b4b1cb5161553445c3f3bba", ts="1705108656", nonce="7uo8eM", mac="OeiDjZrDO6Bci9KOzzk8RYE8gyTUudZ7C5puRn6ZPKw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '13c53585d9f8453bf911@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ create and verify sync account (555ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'aafe124db591f702e00b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'aafe124db591f702e00b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'aafe124db591f702e00b@restmail.net',
    authPW: '76a4942f8c61065b95d4c19ab670a70a7659f8e42c1b4d80390de0fff806d1eb',
    authPW2: '69194b9b57c180cf80efd82eff08e1166fc9d8934f2023e653a09c5606e6dc51',
    wrapKb: 'a2a2cb69ccbcba523b4eab6a26d6735698e51ed663126c585d853d5d898fac97',
    wrapKb2: 'f0cbc4506aad6ff584f0a7cec5d4b0b48741373f81b306fe108122b50f887655',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:736dfaf4f5b4fae69ffe4e430b5d0f99ec06c2ec7c6f688620803e7bb2e4ec9d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '1b842cd958584a2c8cf4997e065b8101',
    sessionToken: 'f24dc1269bcfa650238a21fd4cb17f9a88a0987c649f994fcefaad217ba6346f',
    authAt: 1705108656,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e2734fd17455444747bf825431fbbb318b15c6a4203924eeaf6a72bb224e9e78", ts="1705108657", nonce="ajYxyJ", mac="wZDiA5t28xamQbJD86qeDMp0jhxNiP8jLvsoweor/CM="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'aafe124db591f702e00b@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e2734fd17455444747bf825431fbbb318b15c6a4203924eeaf6a72bb224e9e78", ts="1705108657", nonce="1MBbVr", hash="mqLvzFuHi6BolB+pXa3wODC0TouVCr9rK0/liFB2hL0=", mac="Myp7a86K+JKI/PJx102ofHUwLKe5XPSYDC3n9d7YIuk="'
  },
  json: { code: '052520', service: undefined, newsletters: undefined }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e2734fd17455444747bf825431fbbb318b15c6a4203924eeaf6a72bb224e9e78", ts="1705108657", nonce="TtKefw", mac="MNOK3vbdOUxg8zNtZyzDPOXhHHoBrfvb/KS1L8LOMaY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'aafe124db591f702e00b@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'aafe124db591f702e00b@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '75e77ce699dbb1a4b682da075ec1f7a80ba2aee7a07fc1ae98c335df59972538',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ create and verify account (521ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1fe03e9db6fd7d66d473@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1fe03e9db6fd7d66d473@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1fe03e9db6fd7d66d473@restmail.net',
    authPW: '0e09acd68484b75015f0ae1a8e7d848784b90c673c6f2a0facb7e1e7fa32b38b',
    authPW2: '1a90c274e2a5d39beae8821741152924443212b381b24f5d75827c8c1addcdd0',
    wrapKb: 'a77bf7b7b3ec2e33a6bbeb41d889bdf5f292cc85f207c92a42c85d9a69f8d519',
    wrapKb2: '3da0b38363ed64118187bca1ebf6fa121bf11f2373b631dce5f99d0b065729c0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9f8ef95ae68ab97b99e935bc042697631852f4870891d68f52d51ede8ac08317',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: 'e8d50c6f01e946cdb724c4b0280feaa1',
    sessionToken: 'c952bd7d3d23aa7bb0c09afda7ce96a95417c95a2e5a6c12632006b700faf849',
    authAt: 1705108657,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="987d349a8c728e0209242143dc0a72e397fb4a708cc5d9cd282cc30687e6c395", ts="1705108657", nonce="txQp4U", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="recJ0+KxilvhR2mkKf86CelIVAcmByA23vQw7FpdrrM="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="987d349a8c728e0209242143dc0a72e397fb4a708cc5d9cd282cc30687e6c395", ts="1705108657", nonce="_HJbBE", hash="mKtge+QM/3eyIlTtCHXLbXEa1EmcsWQx/ddQcyCbqD8=", mac="Oyd2UhqchN6O4p+aB8Z7O1MfFaWaq+ObOSXC73s4kDI="'
  },
  json: { code: '678359', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ throws for expired code (497ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c6d7ae37fee1fe32ca1d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c6d7ae37fee1fe32ca1d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d7ae37fee1fe32ca1d@restmail.net',
    authPW: '9f25e2c0aa2dd79acfaa4e53af158cd053f967cc2fe117807c7b69aa821cba26',
    authPW2: '103a58c64986528498992be33a13a32973d6ee5cf1a6f76f0624faacf33714f4',
    wrapKb: '4c8222c33037128f3a6533cb7688cc58817821556a0a342d7293a89110ed0d9b',
    wrapKb2: 'e827076c11121c716a1b9a39646137217c97a592bd79353aff61ef06bbd27d63',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2f2f088d4a9882180e496542e3d61e3dca2d7eea3a441fc870ea5e3101842e94',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '9102a7256dc54d529b90dbe7241d1616',
    sessionToken: '02f6868c1ae49905bf32d4086096497ed3616c55f786f2b5975e9987dd914305',
    authAt: 1705108657,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="031c31e3cb7ff62c8eb1fbf501633e01748d9bf2d2986b23c138051d50f3c027", ts="1705108658", nonce="eDpNfn", hash="jkZeMXgu7mo4972MP+lg57p/uPwhf17blJwavm+cmqc=", mac="wMD5nWEq8q6oUb4/dpei3nXiJCPUdSj6ve3tN++weZs="'
  },
  json: { code: '0287721', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ throws for invalid code (458ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a39b12846a3d9f530717@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a39b12846a3d9f530717@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a39b12846a3d9f530717@restmail.net',
    authPW: '4d04101a92c3cf42ec5d8191a70243195a7570294585b965ad241c0e6cd7e869',
    authPW2: '022072fa7527872044fd3c708337fee852706567d9e9d3e6f875a493c6f49b12',
    wrapKb: '2688d9dabba740fe7d8d36910987706a3cdb52265c7b1ecc85c4b5688e143bf4',
    wrapKb2: '96a313d18f5c0a399735e03808a338002f176933ebbf05d9d3b3b69fd2b99f62',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ff401781c5e9c992035afb0cd00db647b76e01cc41bbf2eb8f58de0ec43862b5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '085189b3f2f0406cb18fc21ee7057def',
    sessionToken: '667c700abdc3995e767e6a0a35834ebb09e61417c63a8518e382886f1b04f172',
    authAt: 1705108658,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3263ec07b326206abbc331ad982babcdf8f2d2d06018c389ee22a2c662df178a", ts="1705108658", nonce="EHcrtb", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="y0aveHBbfv20xXBQOCiHVq9Oi0ELxDfUEEicCn072mU="'
  },
  json: {}
}
!!! response success { body: {} }
    ✔ create and resend authentication code (492ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b651fdda18a09aa123b3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b651fdda18a09aa123b3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b651fdda18a09aa123b3@restmail.net',
    authPW: '03231107d550ded60cff0e23f53223bcd2194a4e582ab44f3701959a1ed2ee15',
    authPW2: '2a9d96257eaed9fac1a473da0fad9a5d5008e060dfe371cb41351cfa10ffbe32',
    wrapKb: 'e36fc5684b7fa6b972a3d6029e14d8154afc83453279b2aa4448506a2d89ef35',
    wrapKb2: 'e6d8c93cc1f7a0e3ce358756a7679e7a1f97ab8673761f1a2eda7c788ff9971a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:670419f01c6b2ad58ee22a04a8941b58d36df6356ef8d1a4a5b88df68e3cc179',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '3f8822227b0e4e67a5ffa04e1db5cbab',
    sessionToken: '69905482267173fc2853b54ac45ec94ec54643133aabbbe13f5f469fc1d33e28',
    authAt: 1705108658,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="311195dfe49a6fe5fc502540f1d563b99330fe38487f7b98a47fad1d26f940e8", ts="1705108659", nonce="D_gffd", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="0DdJzs6gxhZARwUv7MU7QEtrpxc+PN2D8MMrooM4qdM="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="311195dfe49a6fe5fc502540f1d563b99330fe38487f7b98a47fad1d26f940e8", ts="1705108659", nonce="geoyCb", hash="XiMUPJbxJPoNnmG5He/Q6eXET++NT9RYz6I3t/l5ui4=", mac="SwhTjoaW7zDStEZ/leZy5yXX620YBPKma1D4o4khjFc="'
  },
  json: { code: '448169', service: undefined, newsletters: undefined }
}
!!! response success { body: {} }
    ✔ should verify code from previous code window (510ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '19b5c921319dd41375f4@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '19b5c921319dd41375f4@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '19b5c921319dd41375f4@restmail.net',
    authPW: 'dd4aec2d0a39961224f70bc94ea68d2d5296e56409d9302bb273ec83930cf3fb',
    authPW2: '35cc11257cefdea3b7ff22996225e6485ca8049d22ae09e0c3f138a2245fffa7',
    wrapKb: '33aa691b442baa633886db8ac57f1e4e80e71af7f4bad2c6b4daa6b613e555af',
    wrapKb2: '4f6ea9567a5efc47210dc6074fed01762519ad5bf84f43e1b7e73e8f792d356a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b1e7d7305e73f0d6ac19888b104e76e7ea398cc27f8a710c1d0231358e4a52e9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: 'email-otp'
  }
}
!!! response success {
  body: {
    uid: '59240556ffe04aeda04b84b4125cffca',
    sessionToken: '270261aa544479aed09d366f6b827e37ccda17d3909f56400e311c0fed1948d3',
    authAt: 1705108659,
    verificationMethod: 'email-otp'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1a7bc07c40c6e02757574dff2f2d96df2286871baeca3868b64eadf1f3dff2c1", ts="1705108659", nonce="UO3l6y", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="a+3JdN19qF2q7TT3hy0S7VKgSJTQiZtqNJCJdfs3WtU="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1a7bc07c40c6e02757574dff2f2d96df2286871baeca3868b64eadf1f3dff2c1", ts="1705108659", nonce="zWnuY2", hash="K27xWPKjC5VJGQOboSFfTFkcWBDKWskrvIQQUyFlYY8=", mac="KN8AnFuKp7onNbPPX/9oAkkx1Q04GEkW6vMYtwwaJAk="'
  },
  json: { code: '598112', service: undefined, newsletters: undefined }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 183,
    error: 'Bad Request',
    message: 'Invalid or expired confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should not verify code from future code window (500ms)

  #integration - remote account destroy 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd6e3f7532698c7db7f02@restmail.net',
    authPW: '70c8d84efd67436e6f58e57c67096328abb3e94e34381c2c2decb02488dc9614',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '646c42d7f36e46868b9a446ea1e741e8',
    sessionToken: '92063f3a5cf90c127358945f2055f9d3f04872955a7b5e9a5cd362143ed797c2',
    authAt: 1705108659
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '646c42d7f36e46868b9a446ea1e741e8',
    code: '19fd8931b22d069618ff294d67b10b03',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="15f7db67955811dc322e7a646cb7437fe85f1cd31550ca0373e102c1d4d091ce", ts="1705108659", nonce="CQDZJp", mac="neH41nz8B9vGX4ARwtEpS5zt38GRfPIkAEwEGM7FUQs="'
  },
  json: true
}
!!! response success {
  body: { state: 'verified', uid: '646c42d7f36e46868b9a446ea1e741e8' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="15f7db67955811dc322e7a646cb7437fe85f1cd31550ca0373e102c1d4d091ce", ts="1705108659", nonce="4MYptK", hash="Rs5ossiGsgp3OklptO3oOwMIPuOg9U2zvXTtOjuf0gY=", mac="PU15Bm8ETwKHX3CfCuZ6RtPU+EsT/c5PgWCaQ/dMsfo="'
  },
  json: {
    email: 'd6e3f7532698c7db7f02@restmail.net',
    authPW: '70c8d84efd67436e6f58e57c67096328abb3e94e34381c2c2decb02488dc9614'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd6e3f7532698c7db7f02@restmail.net',
    authPW: '70c8d84efd67436e6f58e57c67096328abb3e94e34381c2c2decb02488dc9614',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd6e3f7532698c7db7f02@restmail.net'
  }
}
    ✔ account destroy (432ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6ed09593e4b9f370771a@restmail.net',
    authPW: 'd7038e3672ad5075b4ac4db162d0ea7e4ad4cb12134cbfd8977d775c786c2b88',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a4d5720326084121b97b0a1cad36438b',
    sessionToken: 'be86e21b69fa3a28f00de28ad62cd7f3b9b23e3ee421363ebc7dd61d89b73ad5',
    authAt: 1705108659
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a4d5720326084121b97b0a1cad36438b',
    code: 'c0584c5d5046ea823b9dbbbf615b4d0d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3f720c666a85b4d3cb9afc07cca48ac7f343907a5f2a77948a6b086797a30cf5", ts="1705108660", nonce="WpnsQo", hash="+2V8FedWiaeIgGOLTfxkD8xdsM4fJQ2Vzdix9z66UMI=", mac="KvTR640HBvnPaR86AKKSHVi+yLGLVMkLEpEJeXmHI3I="'
  },
  json: {
    email: '6ed09593e4b9f370771a@restmail.net',
    authPW: '0000000000000000000000000000000000000000000000000000000000000000'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6ed09593e4b9f370771a@restmail.net'
  }
}
    ✔ invalid authPW on account destroy (359ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f5977ee4bd290101e5d2@restmail.net',
    authPW: '092af44cba60d0e6887352971aef494c27dcc88b98553fae6acd3c54a0dfc97c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'df39239bfff243a1940923627d77caa9',
    sessionToken: '85d57f70710f189994d4c38fa68865d5331c9c647e6834c0504259fa52dd03aa',
    authAt: 1705108660,
    keyFetchToken: '58115ced6962200a53f407f1a53e43e6f095753c7cac1015b00c4e29c9376bba'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'df39239bfff243a1940923627d77caa9',
    code: 'b56378af4108b688411da58d653c2581',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="14c313a0e44cc272350e9d362457c2f3416b8f9392a399ffb555cebe98bdf55f", ts="1705108660", nonce="qL2jtw", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="ob5KOp/5/bUXvqhIb++JH89fLTrxnqiAiLEqZBvFgQY="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAAA/4SURBVO3BQQrk2rIgQXeR+9+ydw0EHaMDQplV9z/CzP5grbX+uFhrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u1irbVuH15S+ZsqTlROKiaVqeJE5Y2KSeWk4kRlqvgllaliUjmpmFT+pYoTlZOKE5W/qeKNi7XWul2stdbtYq21bh++rOKbVE5UTip+qWJSmSomlSdUTiomlZOKJ1ROVKaKJyomlZOKN1ROVKaKSeWNim9S+aaLtda6Xay11u1irbVuH35M5YmKJypOVKaKE5WpYqqYVN6omFR+SWWqmFSmiknlRGWqmFSmiqliUjlROamYKiaVE5VfUnmi4pcu1lrrdrHWWreLtda6ffgfo/JGxaRyUjGpTConKk9UPFExqUwqU8UbFZPKVHGiMlX8UsWkMlVMKv/LLtZa63ax1lq3i7XWun34H1fxRsWJyn9JxaTyhMpJxaRyUjGpTBVvVJyonFSs/+9irbVuF2utdbtYa63bhx+r+CWVE5WpYqqYVKaKk4pJ5YmKSWWqOFF5ouIJlW+qeENlqphUpopJ5aRiUpkqvqniv+RirbVuF2utdbtYa63bhy9T+ZcqJpUTlaliUpkqJpWpYlKZKiaVqWJSmSpOKiaVE5Wp4ptUpopJZaqYVKaKSWWqmFSmikllqnhCZao4Ufkvu1hrrdvFWmvdLtZa6/bhpYr/EpVfUpkqJpUTlROVE5UTlScq3qiYVKaKk4pJ5URlqphUnqiYVL6p4v+Si7XWul2stdbtYq21bh/+MZU3KiaVJyomlaniRGWqmFSeqDhROamYVCaVX6qYVE4qTiomlb+pYlKZKk5UTiqeUJkqvulirbVuF2utdbtYa62b/cELKk9UTConFScqU8UTKlPFpHJSMalMFZPKExVvqEwVk8pUcaIyVUwqb1Q8ofJGxS+pvFHxN12stdbtYq21bhdrrXX78JepPKHyhMoTFZPKScWkMlVMKlPFGypTxaQyVfxLFZPKN1VMKk+oTBWTyjdVPKEyVfzSxVpr3S7WWut2sdZatw9fVjGpvFExqUwVk8pJxUnFExWTyhMqJxVPVLyhclJxUjGpPKHyRMVJxYnKGxW/VDGpTBXfdLHWWreLtda6Xay11u3DSxWTylTxhMqkMlV8k8pUMam8UfEvqUwVU8WkcqLyRMWkMlU8oXJSMamcVEwqU8WkcqIyVUwqU8WkMlVMFZPKVPHGxVpr3S7WWut2sdZatw8vqUwVk8pJxVRxojJVTBUnKicqU8WJyonKScWkMqm8UfFExYnKGxVPqDyhMlVMKt+kMlVMKlPFGypTxTddrLXW7WKttW4Xa611+/BlKlPFpPKEylQxqZxUTBUnKpPKGxUnKlPFGypTxTdVTCpTxaQyVZyonFRMKlPFEypTxUnFN6mcqPxNF2utdbtYa63bxVpr3T78ZRWTylQxVUwqT6icVDxRMam8UTGpnFScVEwqJxWTyhMVT6hMFScVJxX/ZRWTylQxqfxLF2utdbtYa63bxVpr3ewPvkjliYpJ5aRiUjmpeEJlqphUTiomlZOKN1SmikllqjhRmSq+SeWk4m9SmSpOVKaKSWWqeENlqphUpoo3LtZa63ax1lq3i7XWutkffJHKScWkMlWcqJxUnKicVEwqU8WJylQxqZxUTCpTxaRyUjGp/EsVk8obFZPKN1VMKicVk8pUcaLyRMU3Xay11u1irbVuF2utdfvwYxVvqJxUPFExqTyhMlU8UfGGyknFpPJLFZPKVDGp/E0VJypPVEwqv1TxN12stdbtYq21bhdrrXWzP3hBZaqYVE4qJpWp4g2VqeJEZap4QuWbKn5JZap4Q2WqeEJlqphUpooTlaniRGWqmFSmiidUTir+pYu11rpdrLXW7WKttW4ffqziROVE5Y2KE5WpYlKZKiaVqWJSOamYVCaVqeKbKiaVk4pJ5URlqphUTlR+SeVvqjhRmSomlZOKNy7WWut2sdZat4u11rrZH3yRyhMVv6TyRMWJylTxhMpJxaRyUvFNKicVT6icVEwqJxVvqJxUPKEyVUwqU8WJylQxqZxUvHGx1lq3i7XWul2stdbN/uAFlTcqTlSmiknljYpJZar4JZWTiknlpGJSmSomlaliUpkqJpWp4kTljYpJ5YmKN1R+qeJEZar4pou11rpdrLXW7WKttW4fXqqYVE4qTlSmiicq3qiYVE4qJpWp4omKSWWqmFSeUHmiYlJ5QuWNijcqTlSmiknlpGJSeaJiUjmp+KWLtda6Xay11u1irbVu9gdfpDJVTCpvVHyTylTxTSpPVHyTylRxojJVTCpTxYnKVDGpTBWTylRxonJSMalMFW+oTBVvqDxR8cbFWmvdLtZa63ax1lq3Dz+m8kTFN6mcVEwqU8WJyjepTBWTyknFVDGpPKHyTSpTxRMqU8VUMak8oTJVTCpvqEwVb1R808Vaa90u1lrrdrHWWjf7gxdUnqiYVL6p4l9SeaJiUnmiYlL5pYpJ5aRiUpkqJpU3Kt5QmSpOVP6mil+6WGut28Vaa90u1lrr9uHLKt6oeEJlUpkqTlSmihOVk4onVKaKE5U3Kp5QOal4ouKJikllqjhReaJiUnmi4gmVqeJEZar4pou11rpdrLXW7WKttW4fvkzlpOIJlanil1SeqJhUpopJZaqYVKaKqWJSmSomlROVqeIJlZOKSeWNiknlpGJSeaLiROVEZap4o+KXLtZa63ax1lq3i7XWun34sooTlScqvkllqjhReaJiUnlD5Zcq3qiYVE4qJpUTlScqJpWpYlJ5QuWJiidUpopJZar4pou11rpdrLXW7WKttW72By+oPFExqXxTxaTyRMUTKlPFpPJGxYnKVDGpfFPFpDJVPKFyUnGi8kTFN6l8U8WkMlX80sVaa90u1lrrdrHWWjf7gxdUpooTlaliUpkqJpWpYlJ5omJSOak4UTmpmFSmihOVNyomlTcqTlROKiaVJyqeUHmi4kRlqphUpopJZao4UZkqvulirbVuF2utdbtYa63bh39MZaqYVKaKX6qYVE5UpopJZVKZKk5UTiqeUDmpmFR+SeUNlanijYpJZaqYKiaVb1KZKn7pYq21bhdrrXW7WGut24cvU3mi4qRiUpkqpoq/qWJSeULlm1Smim+qOFE5qThR+SaVqWJSmVSeUJkqJpVJZaqYVE5UpopvulhrrdvFWmvdLtZa6/bhyyomlaniROWbVKaKSWWqmComlanib6o4qZhUTiomlanim1ROKiaVqeKbKk5UJpWpYlI5qZhUpooTlUllqnjjYq21bhdrrXW7WGut24f/uIpJ5URlqjipOFGZKiaVqeIJlanib1L5L1E5UZkqJpWpYlI5qZgqJpVJZaqYVJ5QmSqmil+6WGut28Vaa90u1lrr9uEfUzlRmSomlaliUnmj4pcqfqliUpkqJpUnVE4qJpWTikllqphUTlTeUHlC5UTlm1Smijcu1lrrdrHWWreLtda6ffgylROVqeIJlaniiYpJ5QmVqeJE5aTiROWJiknlm1SmiicqJpWTikllqphU3lCZKiaVqWJSeaJiUplUpoqp4psu1lrrdrHWWreLtda6fXip4gmVJ1SeUJkq3lCZKp6omFROVH6p4qTipGJSOamYVJ5QmSomlScqJpUnKk4qTlQmlZOKv+lirbVuF2utdbtYa62b/cEXqUwVJypTxYnKExWTyknFpHJScaJyUvGEylQxqUwVk8pUMak8UXGiclLxhMpUcaJyUvGEyknFicoTFX/TxVpr3S7WWut2sdZatw8vqZyovKHyhspUMalMKlPFico3qZxUnFS8UTGpPKFyUjGpTBWTyi+pTBWTyhMqJxWTyhsqU8UbF2utdbtYa63bxVpr3T68VPGGyknFEypTxRMVJypTxYnKicpUMak8oTJV/JeonKicVEwqU8VJxaQyqZxUnKicqEwVJyonFd90sdZat4u11rpdrLXWzf7gi1SmihOVJyq+SeWNiidUpoonVN6oeENlqnhC5YmKJ1ROKk5UnqiYVKaKSeWkYlKZKn7pYq21bhdrrXW7WGutm/3BF6mcVPxNKicVJypPVDyhMlVMKlPFicoTFZPKN1VMKm9UPKEyVUwqU8WkMlVMKlPFpDJVTCpTxRMqU8UbF2utdbtYa63bxVpr3T68pHJS8YTKScWkMlWcVJyonFScqJxUPFExqUwVU8U3VTyhMqmcVPxSxRsVk8qJylTxTSq/dLHWWreLtda6Xay11s3+4AWVk4pJZaqYVKaKSeWJihOVqWJSeaJiUjmpmFS+qWJSOamYVE4qnlA5qZhUTiqeUJkqJpWp4kTlpGJSmSomlaliUpkqvulirbVuF2utdbtYa63bhy+rmFSmiidUpoo3VE5UpopJZaqYVE4qnqj4L6k4UXmi4qTiRGWqeELlCZWpYlI5qZhUpop/6WKttW4Xa611u1hrrZv9wQsq31TxhMpU8YbKScUbKicVk8pJxYnKExWTylQxqZxUnKg8UfFfojJVTCpTxYnKGxVvXKy11u1irbVuF2utdfvwUsUvqUwVT6hMFScVk8ovVUwq/5LKExWTyqTyRsX/JSonKicVT6h808Vaa90u1lrrdrHWWrcP/3EVv6TyhMpJxaQyVUwqT1ScqJxUPKEyqUwV31RxojJVTCpPVEwqU8UTFU+oTConFVPFN12stdbtYq21bhdrrXX78JLK31RxojJVvFExqUwVJxVPVEwqk8o3qUwVJxWTyknFpDJVPFExqZxU/EsqU8UTFZPKVPFNF2utdbtYa63bxVpr3T58WcU3qbyhclIxqUwqb6i8UXGi8kbFN1U8oTJVTCpTxVRxojJVTConKm9UvKEyVfzSxVpr3S7WWut2sdZatw8/pvJExRsVb1RMKlPFpPJExYnKVPFExaQyqXxTxTepTBWTylRxUjGpnFQ8oTKpvFExqZyoTBVvXKy11u1irbVuF2utdfvwf1zFEypPVJxUTCpTxYnKicpU8UbFpHJScaJyUjFVTCpTxaRyovJExaTyhMpUcaLyhMpUMan80sVaa90u1lrrdrHWWrcP/+NUnqh4QmWqmFSmiqnijYpJ5URlqjhROal4QuVEZap4QmWqmFTeqHii4kRlqjip+KWLtda6Xay11u1irbVuH36s4r+k4gmVqeKJim9SOal4QmWqOKmYVE4qvknlpGJSmSomlX+pYlI5qfili7XWul2stdbtYq21bh++TOW/pOJE5aTiCZWp4kRlqjipOFGZKr5J5aRiUpkqnlB5o+IJlaliUjmpOFE5qZhUTlSmijcu1lrrdrHWWreLtda62R+stdYfF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbt/wGjKxCbxFyf9AAAAABJRU5ErkJggg==',
    secret: 'JZFHOU3WKVIWGQ2NGRDG2SCMMQYUG2CU',
    recoveryCodes: [ 'h3am11jmhz', 'r0a9j4n8xm', 'qq4stkbv9e' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="14c313a0e44cc272350e9d362457c2f3416b8f9392a399ffb555cebe98bdf55f", ts="1705108660", nonce="PqXxDO", hash="kyWVT0/mVtanr2HtzypXGUiylKtMbzWcTuVJZzUBrzI=", mac="cby0yleI82B7xE8iYpXdwBHN8irbXCNevp5ZPbFWh/s="'
  },
  json: { code: '841254', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {},
  json: {
    email: 'f5977ee4bd290101e5d2@restmail.net',
    authPW: '092af44cba60d0e6887352971aef494c27dcc88b98553fae6acd3c54a0dfc97c'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to delete account with TOTP without passing sessionToken (501ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3134349c2645a535de61@restmail.net',
    authPW: '4c6b68f8eb8e514498c4ff677520b4393526dd03339257af811ee9e998481760',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0156f579fe2e4b3d8ffd1eeb5f813035',
    sessionToken: '9a4ada17c20a0f7b2bc21d83a8e1b29ea0d13c653361d4a4ce07bba6ce7e22d5',
    authAt: 1705108660,
    keyFetchToken: '98d2d85cd8fbf30bde993d3a6a1eb07599640574f272f7fa396e12ca2aee58b3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0156f579fe2e4b3d8ffd1eeb5f813035',
    code: '169e3f8f8a34d2edd6e478ef576de46b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="547f4e43330cadb744c1b460e3ff8c631e8c706c2cd3dfcd643a3e5cff30b8c3", ts="1705108661", nonce="myllgS", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="Zho0zvRSmdW+/+eYOHGsEPtjOraASE6Xp5YkaDi+gyQ="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAAA/GSURBVO3BQY7gRnAAwUxi/v/l9B54qIsbIMhZSXZF2B+stdYfF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbth5dU/qaKSWWqmFSmiknlpOIJlaniROWk4ksqJxUnKlPFEyr/JhWTyhMVJyp/U8UbF2utdbtYa63bxVpr3X74WMWXVE4qJpWp4qTiDZU3KiaV31TxhMpU8UbFicoTFZPKVHGiclIxqbxR8SWVL12stdbtYq21bhdrrXX74ZepPFHxhMpU8YTKScWkclIxqbyhclJxovI3qTxRMVVMKlPFpDJVTCpTxRMqv0nliYrfdLHWWreLtda6Xay11u2H/7iKE5WTihOVqeKJiknlSypTxVRxojJVTCpfqjhReUNlqnii4kTl/7KLtda6Xay11u1irbVuP/zHqUwVU8UTKicqX6qYVKaKSeUJlSdUnlA5qZhUTiomlUnlpGJSmSrW/+5irbVuF2utdbtYa63bD7+s4jdVTCq/qeJE5UsqT6icVDyhclLxRMWk8kTFpDKpTBVvqEwVX6r4N7lYa63bxVpr3S7WWuv2w8dU/iaVqWJSmSomlaliUjlRmSomlaliUpkqJpWpYlKZKiaVE5Wp4gmVqWJSmSp+U8WkMlV8SWWqOFH5N7tYa63bxVpr3S7WWuv2w0sV/2YVJxWTylRxUnFSMamcqEwVJxWTyhMV/6SKSeVLFScVJxWTylRxUvFfcrHWWreLtda6Xay11s3+4F9E5aTiCZUnKiaVJyomlZOKSeWNiknlN1U8oXJSMalMFScqb1ScqJxUTCpTxaQyVUwqU8WkMlW8cbHWWreLtda6Xay11u2HX6YyVTxR8V+iMlWcqEwVX6p4QmWqmFROVE4qJpVJZar4UsUTKlPFpDKpnKhMFZPKVDGpTBVfulhrrdvFWmvdLtZa6/bDx1SmiknlCZU3KiaVE5Wp4gmVL6lMFZPKVPFGxaRyojJVvFHxhMpUcaJyUjFVTCpvVEwqT1T8pou11rpdrLXW7WKttW4/fKziiYpJZap4Q2WqOFGZVJ6oOFE5UfmSypcqnlA5qZhUvqQyVUwqk8pU8UTFicoTKicVX7pYa63bxVpr3S7WWutmf/AhlZOKJ1SeqDhROamYVKaKE5Wp4gmVqeIJlZOKSeVLFZPKVPGGypcqTlSmihOVqeJEZap4QmWqeONirbVuF2utdbtYa63bDy+pPKFyUjFVnKh8SeUJlROVqWJSmSomlZOKqWJSOak4UZkqTlSeUDmpOKl4Q+WkYlI5qXiiYlKZKiaV33Sx1lq3i7XWul2stdbN/uBDKlPFicobFScqU8WJylQxqUwVJyonFU+ovFExqTxRMak8UXGiclLxhspJxaTypYoTlanib7pYa63bxVpr3S7WWuv2wy9TmSqeqJhUTlROVKaKqeIJlaliqphUTlTeqHij4kTlpGJSOVF5QmWqmFTeUJkqJpWTiknlN6lMFW9crLXW7WKttW4Xa611++FjFScqU8WkMqmcqEwVJyonKlPFVPFGxaRyUnGicqIyVZyo/JMqTlTeqDhReaLiCZWp4kTlpOJLF2utdbtYa63bxVpr3X74ZSonKlPFEyonKicqT6icVHxJ5aRiUpkqJpWpYlI5qThRmSp+k8pUMamcqLyhclLxpYpJZap442KttW4Xa611u1hrrdsPv6xiUnlC5aTijYpJ5YmKSeWNiknlROWJiicqTlROVE4qvqTymypOVL5UMan8pou11rpdrLXW7WKttW4/fExlqpgqJpWTihOVk4oTlTdU/qaKJ1SmiidUpoqTiidUTiqmiknlpOKkYlJ5QmWq+E0Vv+lirbVuF2utdbtYa63bDy+pnKhMFScqJxUnFZPKVDFVTCpvVPxNKm+oPKEyVZyoTBUnFZPKVDFVnKicVEwVJypTxaTyRMVU8U+6WGut28Vaa90u1lrr9sMvq5hUTiq+VDGpvFFxojJVTConFVPFScWkMlV8qeKJipOKN1SmiqniROWJiknliYpJ5aTiRGWqeONirbVuF2utdbtYa63bD/8yKr+pYlJ5QmWqOFGZKk5UTiomlTcqJpWp4kTlpOJE5Y2KNyomld+kMlVMKpPKScWXLtZa63ax1lq3i7XWutkf/INUTiomlaniROWJiknlN1VMKlPFpDJVnKhMFZPKExUnKlPFpPJExaQyVZyoTBWTyknFpHJSMalMFf9mF2utdbtYa63bxVpr3ewPXlCZKk5UpopJ5YmKJ1ROKn6TypcqJpUnKp5QmSp+k8oTFZPKVDGpvFHxhMpvqnjjYq21bhdrrXW7WGutm/3BX6QyVTyh8qWKE5WTihOVqeJEZaqYVE4qJpWpYlJ5omJSOal4QmWqmFSmihOVk4pJZaqYVJ6oOFGZKiaVqWJSmSreuFhrrdvFWmvdLtZa62Z/8ILKVDGpTBWTypcqTlT+TSomlZOKSeVvqvhNKk9UTConFScq/6SKf9LFWmvdLtZa63ax1lq3H35ZxaRyUvGEyqTyRMWXVE4q3lCZKk5UpoonVCaVJyomlTcqnqiYVKaKJyomlaniCZVJ5Y2KNy7WWut2sdZat4u11rr98FLFExWTyonKVHFS8YTKScUbFScqJxWTyqQyVTyhMlWcVEwqf5PKGxVPVLyhMlWcVJyo/KaLtda6Xay11u1irbVuP/zLVXxJZaqYVJ5QmSreqJhUTiomlScqnlA5qTipmFROKiaVk4pJ5aRiqjhReaLiCZWpYqr4TRdrrXW7WGut28Vaa93sD15QmSpOVP6mikllqphUTipOVKaKJ1ROKiaV/5KKE5WTiknlpOJEZap4QuVLFScqJxVvXKy11u1irbVuF2utdbM/+EUqU8WkMlWcqEwVk8pJxaTyRMWXVN6omFSmii+pTBWTylRxojJVfEnliYoTlaliUjmpOFE5qZhUpoo3LtZa63ax1lq3i7XWuv3wMZUvqZyonFRMKk9UTConFZPKVDFVTCpfUjmpeKLiCZUnVJ6omFSmiidUpoqp4qTiROWkYlL5my7WWut2sdZat4u11rrZH7ygMlVMKicVX1KZKk5Unqg4UZkqTlTeqHhDZaqYVN6o+JLKScWk8kbFicqXKv5JF2utdbtYa63bxVpr3X74yyomlTcqpoonKiaVE5WpYqp4omJS+ZLKlyomlS+pnFRMKpPKVPGEym+qOFF5ouJLF2utdbtYa63bxVpr3X74y1SmikllqphUnlB5ouJE5UTlpOKNikllqjipOFGZKiaVqeINlTcqJpVJ5Q2VqWKqOFGZVKaKJyp+08Vaa90u1lrrdrHWWrcf/mUqJpWpYlI5qZhUpooTlaliUjmpmFSmipOKk4qTii9VPKHyRMWk8kTFpPJGxYnKExVPVPxNF2utdbtYa63bxVpr3ewP/iKVqeINlaliUpkqnlCZKp5QOamYVE4qTlSmihOVNyreUHmjYlI5qThRmSomlaniCZWpYlJ5o+KNi7XWul2stdbtYq21bj+8pDJVPKHyRsWk8obKGypfqphUpoqpYlJ5ouJE5UTlpGKqOFF5ouIJlROVE5Wp4o2KSWWq+E0Xa611u1hrrdvFWmvdfnip4kTlpOIJlZOKE5WpYqo4UXmi4kRlqphUTlSmiicqTlSmikllqphUvlRxojJVTCpPVLyhMlVMKlPFEypTxRsXa611u1hrrdvFWmvdfviYyhMqU8WkMlU8oXKiMlVMKm+oTBVPVHyp4kTlb1I5qXiiYlKZKk5UJpUnKqaKJ1SmikllqvjSxVpr3S7WWut2sdZaN/uDF1SmiknljYpJ5YmKE5Wp4kRlqjhReaLiDZUnKr6kMlVMKicVT6hMFZPKScWkclLxN6lMFZPKVPHGxVpr3S7WWut2sdZatx/+YRWTyqRyUjGpnKicqEwVT6hMFZPKVHGiclLxRMUbKm9UPKEyVUwVk8pUMalMKk+onFRMKlPFExWTym+6WGut28Vaa90u1lrr9sPHVKaKSeWk4o2KSWWqmFSmipOKJ1SmihOVJ1SmiknlROVLFZPKVHGi8oTKVHFSMamcVEwqU8WXVJ6o+NLFWmvdLtZa63ax1lq3Hz5W8YTKVDGpnFS8UTGpPFFxUjGpTBVTxYnKVDGpnKhMFScqb1RMKl+qeEJlqphUnlCZKk5UTir+SRdrrXW7WGut28Vaa93sD15QmSreUJkqJpUnKiaVL1WcqLxRMak8UTGpTBVfUnmiYlI5qZhUpopJZao4UXmi4gmVL1V86WKttW4Xa611u1hrrdsPv0xlqnhC5aRiUplUpopJ5aRiUplU3qiYVN6omFTeUJkqTiomlaliUpkqnqiYVE5U3qiYVE4qpop/s4u11rpdrLXW7WKttW72By+ofKniSyonFScqT1S8oTJVnKg8UfEllaniROVvqphUpopJ5YmKE5UnKk5UTireuFhrrdvFWmvdLtZa6/bDSxW/SWWqmFROKk5Upoqp4gmVL6lMFScVk8qk8kbFVDGpPFExqUwVk8pJxaTym1T+L7lYa63bxVpr3S7WWutmf/AfpvJExYnKScUbKm9UTCpPVDyhMlVMKlPFpPKbKiaVk4pJ5aTiRGWqeELlSxVvXKy11u1irbVuF2utdfvhJZW/qWKqmFSmihOVk4pJ5aTipGJSmSreqJhUTlSmijdUpopJ5aTiROWk4kRlqphUJpU3VKaKk4pJ5aTiSxdrrXW7WGut28Vaa91++FjFl1ROVKaKJyomlZOKJ1SeUJkqJpUTlScq/qaK36QyVUwVJxWTylQxqZxUvFFxojJVvHGx1lq3i7XWul2stdbth1+m8kTFExWTylTxX1LxRMWkcqLypYoTlaliUpkqJpWp4qTiSxVPqHxJ5aTiSxdrrXW7WGut28Vaa91++H9GZaqYKiaV31QxqZxUTCpTxZdUJpUnKiaVqWJSmSomlS9VPKEyVUwqU8WkcqIyVfxNF2utdbtYa63bxVpr3X74f07liYpJZao4UZlUpoovqXyp4ksqU8WkMlWcqJxUvFExqTxRMalMFZPKExVvXKy11u1irbVuF2utdbM/eEFlqviSylRxovJExYnKScWkMlWcqDxRcaIyVZyoTBWTyhMVk8pUMamcVDyhMlWcqHyp4kTlpOKfdLHWWreLtda6Xay11u2Hj6n8m1ScqEwVJxVPqJxUTCpTxZdUpopJZaqYVKaKNyomlSdUpooTlaniCZUTlZOKSeVE5aTiSxdrrXW7WGut28Vaa93sD9Za64+Ltda6Xay11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa6/Y/ZED/T39zuvoAAAAASUVORK5CYII=',
    secret: 'F5CTCRDQMNUU43JROB4UYR2HIN2DKSJR',
    recoveryCodes: [ 'ajchpwc4fm', 'e0scvxaexr', '38vsx3xvh2' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="547f4e43330cadb744c1b460e3ff8c631e8c706c2cd3dfcd643a3e5cff30b8c3", ts="1705108661", nonce="MWt-Xp", hash="Ha/R1YbsJCZwRyRES0T3RzuPiHY73IWpqmsnRHdvEq8=", mac="Cb2pV5kya+wYalRzkeQsyk7P1HZ0wqXfHLKdYfatOhk="'
  },
  json: { code: '141409', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3134349c2645a535de61@restmail.net',
    authPW: '4c6b68f8eb8e514498c4ff677520b4393526dd03339257af811ee9e998481760',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0156f579fe2e4b3d8ffd1eeb5f813035',
    sessionToken: '74277a20fed477bdf4df3d697a50f943547a9b4fb9ec52eced6434b111f948a7',
    authAt: 1705108661,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3fef7f630e50ac680af2d41c63178616aae2e82eb4033ec58f861af93aeca097", ts="1705108661", nonce="fVF3Dz", mac="9fqnniezXZfJ4FMgjBFSNrHHihJdtwnaTrIOK5cohEo="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3134349c2645a535de61@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3fef7f630e50ac680af2d41c63178616aae2e82eb4033ec58f861af93aeca097", ts="1705108661", nonce="u_6eLB", hash="zzglUsrdWVqssdEvc0dyIAvs99lQjRX/4bPppnAkkec=", mac="PtE7aPo++ULBtsksHDSKb02ayC7sNq/of4W8OBi6WSc="'
  },
  json: {
    email: '3134349c2645a535de61@restmail.net',
    authPW: '4c6b68f8eb8e514498c4ff677520b4393526dd03339257af811ee9e998481760'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to delete account with TOTP with unverified session (635ms)

  #integration - remote account destroy V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'adb5954b524af86d25c0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'adb5954b524af86d25c0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'adb5954b524af86d25c0@restmail.net',
    authPW: 'c08ce86e0a39bc49ed0611627c9247a03b62bfbda50c7aa3f109cc34658db2ba',
    authPW2: 'e61a8f7bc8caeb4923067fc49a9b1e0f02e835e2bc20165d0e4efa1a2484efd8',
    wrapKb: 'ac4743c74ca23842dbc191d33aa8916254989d361ad08e09cbb667a0bed2f2a2',
    wrapKb2: '7792c232495ec8f2db957a0e52433ccb61109cb4a74a43421c437aeb8959f1af',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:256882429c79bef22cf8f9586e82362127cbb43219431a6ce6f9d74e0be47b79',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f94c3543fb0446968726410f3d1dffd3',
    sessionToken: 'ff55f541835e1bc899a2565b854ddc983142ee61fe4f9d5eb36513784c4d2f30',
    authAt: 1705108661
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f94c3543fb0446968726410f3d1dffd3',
    code: 'dcef242db0f2ce96f99a735acb24e304',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5f20479b196553c6dd397d7b5775db2f6e0dcf5da2aa3a718d75c96cb4f0286d", ts="1705108662", nonce="qeG3rn", mac="OtTBhoBU02+mMlZq3iDdIA4B/kWS/HLt5RPZf5Kb8ok="'
  },
  json: true
}
!!! response success {
  body: { state: 'verified', uid: 'f94c3543fb0446968726410f3d1dffd3' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5f20479b196553c6dd397d7b5775db2f6e0dcf5da2aa3a718d75c96cb4f0286d", ts="1705108662", nonce="Uxe2Hc", hash="CsGam9sZPKM2tN4h+uaHE7zoGZr7iWTYapCJdr9aj9Q=", mac="chpiP1BwZbJeGuSUK35siHm8At9WWQqWif5KVgq+28s="'
  },
  json: {
    email: 'adb5954b524af86d25c0@restmail.net',
    authPW: 'e61a8f7bc8caeb4923067fc49a9b1e0f02e835e2bc20165d0e4efa1a2484efd8'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'adb5954b524af86d25c0@restmail.net',
    authPW: 'e61a8f7bc8caeb4923067fc49a9b1e0f02e835e2bc20165d0e4efa1a2484efd8',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'adb5954b524af86d25c0@restmail.net'
  }
}
    ✔ account destroy (691ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ea57218570cad8150bf8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ea57218570cad8150bf8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea57218570cad8150bf8@restmail.net',
    authPW: '0601f80bc7e0814d581a9190179dd552cb355f0237cce3ac168d28bc65730497',
    authPW2: '20d71d772fc92b330d1c973196d44f964b1af32d1b7c0edd44b13277edd0659f',
    wrapKb: '03fadea8e465487d4df7769f51dbd2b78c9f2144078dae0663d275651ebaa787',
    wrapKb2: '30133b496af1b3ec55a56a53573a787e6954398c38d5a0e1b63c53702ae5ed66',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:754039c97b6386e447b515eea190ea4bc9b1f7c22d135850456f4bda4866639f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1ec9df1f16cd407d8a72f373a9bc5686',
    sessionToken: '86ea2b8acb2235c2526481cf90c64df81a0a9cd51a92b1b942f13f78a9d5d1e4',
    authAt: 1705108662
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1ec9df1f16cd407d8a72f373a9bc5686',
    code: '0c0fdd1946ddfbd1870d30be6c512d84',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="662b112eb57f57570978b453ef4d633c4aae7a05faf261ff4f9a056e4af7d24f", ts="1705108662", nonce="KXAdq_", hash="DKBc+D4TJUdQiZEH+jjZZ7ramfXJz8G+QtZVBLZ6V5I=", mac="TeBO2wq53TVsoQfYzly+Q+9UxHqJ3PELh34tP5FI+xo="'
  },
  json: {
    email: 'ea57218570cad8150bf8@restmail.net',
    authPW: '0000000000000000000000000000000000000000000000000000000000000000'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ea57218570cad8150bf8@restmail.net'
  }
}
    ✔ invalid authPW on account destroy (608ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ef0c94762ecd510d8071@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ef0c94762ecd510d8071@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ef0c94762ecd510d8071@restmail.net',
    authPW: '37562e8f9dde38cbc0c1104574882a1ece5991179261e0696d103204ed4ee633',
    authPW2: '981ce22c0dcefde2fc91867616eacc8e69b0ca0a4ca377a9b41e494ee7e15625',
    wrapKb: 'ccd933653801d95f9dabd52453de16495b8b4fbb81d2e40f25c4c6a9a450e28b',
    wrapKb2: '6f8a5c7f83c7daa5b08aeaff354873522ddbe35e13b416464695afa5af9a0db8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0e3a3b90c9d4b864b8fccbd4583795da727785b7acc90c0f30c2c3d70e5d8692',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '23e3debccf9a40b885c18a9724fe5e0b',
    sessionToken: '2ec69fe801f59719489b282d877aad2109aa3b09ffd90f22dcbd9920e8638c87',
    authAt: 1705108662,
    keyFetchToken: '27f16d974d6120fdd6f1abadec0140c0d5f49e30a6cde46556a35e0423cbad5f',
    keyFetchToken2: '57c58e89cb371b60909417c3a6346aadbc898f2872ef498afb129d3f886ba459'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '23e3debccf9a40b885c18a9724fe5e0b',
    code: '1a526f32f2eafbc3ed1ac0a1d775952e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="72d51bf654a17c3a6355f5c7ddec0240368d23fdc76b396d49f275b28fc85f68", ts="1705108663", nonce="dAUBSQ", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="1++UX/WkKXK0JtTKv28VLAvmu4lBUhwdsMqAsBAnPNs="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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VDyh8kTFico3qZxUPKFyovJExRsXa611u1hrrdvFWmvdPryk8psqpooTlaniJ6lMFZPKVDGpnFRMKlPFpHKiMlW8UTGpTBWTylRxojKpnFScqEwVU8WJyonKVPFExaQyVXzTxVpr3S7WWut2sdZatw9fVvFNKk+onKhMFVPFpHJSMamcVEwqU8WkMql8U8UbFZPKVPGEyknFpDJVTCrfpPJExRsqv+lirbVuF2utdbtYa63bhx+m8kTFGxU/qeKkYlKZKk5UpopJZap4QuUNlaniRGWqeKJiUpkqTiomlROVqWKqmFQmlTcqJpWpYlKZKt64WGut28Vaa90u1lrr9uE/TmWqOFF5omJSeaJiUjmpmFSmiknlmyqeUDmpmFSmihOVqWJSOamYKiaVJ1ROKiaVqWJSmVROVH7SxVpr3S7WWut2sdZatw//cRWTylRxUnGiMlVMKlPFpHJSMalMFZPKVPGEyhsqJxUnFScqJypTxYnKScWk8obKicobFZPKN12stdbtYq21bhdrrXX78MMqflPFScWkMlWcqJyonFRMKlPFEyonFVPFN1VMKicVk8pJxaQyqUwVJxWTylRxUnGiMlU8ofJExTddrLXW7WKttW4Xa611+/BlKn+Tym+qOFGZVKaKE5WTijdUpopJ5UTlpGJSOal4omJSmSomlaliUjmpmFSmiknlpOIJlanimy7WWut2sdZat4u11rrZH6y11h8Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u3/AZ4/L/H5HeRFAAAAAElFTkSuQmCC',
    secret: 'GRDEINC2OZAW24TVNJTW45CRJ53VEYSH',
    recoveryCodes: [ 'mwrsqeb5xk', 'h70g07x6ac', 'fy2t69vrq2' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="72d51bf654a17c3a6355f5c7ddec0240368d23fdc76b396d49f275b28fc85f68", ts="1705108663", nonce="41hMDz", hash="0cjSDZXE6AkgLyOUwDj/tNroCycE+EbDQLpQhSYCsts=", mac="mV5Cook1BMtOcRyAq/cnBMCr1cpGAtkeFPiHNQPkrUQ="'
  },
  json: { code: '451391', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {},
  json: {
    email: 'ef0c94762ecd510d8071@restmail.net',
    authPW: '981ce22c0dcefde2fc91867616eacc8e69b0ca0a4ca377a9b41e494ee7e15625'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to delete account with TOTP without passing sessionToken (731ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '30657c3d5b5bbbeb4d38@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '30657c3d5b5bbbeb4d38@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '30657c3d5b5bbbeb4d38@restmail.net',
    authPW: 'c9f5a94c73315eba8eb7f8ed828878f3a1eed3fb4af26ee2d4a6618e57f15773',
    authPW2: '12f458aa24e75cd55516a35f46843cecf82be240c5c8a6cc07f4707f92fc356d',
    wrapKb: 'dd160b12bf960c74bc735dc8f0e9d7afeba82da3c83ca0e678c2fac63d52d39e',
    wrapKb2: '2f76ca77273e43545da5bd14066a9ef76bdc46de438cd1a8e9d6ff28fd1675af',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c0403df3284edfdca21b7e810d1edee8cd178fdddbfe4b4c60cc5f2e3b4c8f83',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f08b17360cf6428387ce6a03977ba687',
    sessionToken: 'edadfe688dc2f278dbe5dc5acee02dc7d5c7475d4c4d42044d3ce9d5497bcce3',
    authAt: 1705108663,
    keyFetchToken: 'a39272864ca0f6477e8b3c21e8106f189705c4ddc8ae7f1bbf7cf9a89999869a',
    keyFetchToken2: '437a24c889ec321f56bb74b11ebb9b1397bd9edafa239201e27f0d15e2e41067'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f08b17360cf6428387ce6a03977ba687',
    code: 'b2224f94f9aa77ad27153340102c4ed9',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cf837da571e464e02c267e7efaa62a5eb2bbf28382beace0cedd859de0bd8f0c", ts="1705108664", nonce="HftpL-", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="Utq8N/jh3nhlYmT7LRBviQQ7sDSRBadTZ5TB1+kuxRM="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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L6lMFScqX6qYKiaVSeUNlanijYo3Kk5UpoqTiknlCZU3VKaKk4oTlaniSxdrrXW7WGut28Vaa91++FjFl1ROVKaKE5Wp4gmVJyomlaliUpkqpooTlScq3qiYVN6oeENlqpgqnlCZKiaVk4ovVUwqU8UbF2utdbtYa63bxVpr3X74ZSpPVDxRMalMFVPFpPJGxZcqTlSmiidUvqTym1SmipOKN1TeUPmSyknFly7WWut2sdZat4u11rr9sP6PikllqjhReULliYqTiidUpooTlaliUpkqJpUTlaliUvlSxUnFpDJVPKFyojJV/E0Xa611u1hrrdvFWmvdfvgfU3GicqJyovJExT9JZaqYKiaVqWKqeEJlqphUpopJZao4UTmpeKNiUjmpmComlaliUnmi4o2Ltda6Xay11u1irbVuP/yyir9JZao4qThROal4Q+WNikllqjhR+U0VJxWTypcqTlROVJ6oOFF5ouJvulhrrdvFWmvdLtZa6/bDx1T+zSomlaniCZWp4kRlqphUpoonKiaVk4pJ5QmVqWJSmSq+pDJVnKhMFU+onKicVEwqJyonFV+6WGut28Vaa90u1lrrZn+w1lp/XKy11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3/wcPbgt/vhxZ3gAAAABJRU5ErkJggg==',
    secret: 'OFDEOTBTNJ5EIZ2XJ5MS6UZYINVFEU2X',
    recoveryCodes: [ 'gv7yrcz4qf', 'zfdyk3j315', '7at3sqr8yc' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cf837da571e464e02c267e7efaa62a5eb2bbf28382beace0cedd859de0bd8f0c", ts="1705108664", nonce="rBdaiu", hash="wVrTIdZ8ViUCDIpMqQ37rIn9jwiMgBsp40qKDCZDk/I=", mac="BFmYc99Vn6dkaLw9v11H1hFznBcxbhoB5NWuINHt7Gk="'
  },
  json: { code: '617266', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '30657c3d5b5bbbeb4d38@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c0403df3284edfdca21b7e810d1edee8cd178fdddbfe4b4c60cc5f2e3b4c8f83',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c0403df3284edfdca21b7e810d1edee8cd178fdddbfe4b4c60cc5f2e3b4c8f83',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c0403df3284edfdca21b7e810d1edee8cd178fdddbfe4b4c60cc5f2e3b4c8f83',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '30657c3d5b5bbbeb4d38@restmail.net',
    authPW: '12f458aa24e75cd55516a35f46843cecf82be240c5c8a6cc07f4707f92fc356d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f08b17360cf6428387ce6a03977ba687',
    sessionToken: '81ef9528b02f3feea00a0ccf525a5bf0e5b5a4d2129a7a00fc5b40d4f080b804',
    authAt: 1705108664,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f84c897b4f11a4e7e890efd3f00a6c6c14c20da42d00bb2b83364df0784c911a", ts="1705108664", nonce="geI1bw", mac="0faAWELus4KUo7WvRITL5JShvUATesOc+SNsG+YCm+M="'
  },
  json: true
}
!!! response success {
  body: {
    email: '30657c3d5b5bbbeb4d38@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f84c897b4f11a4e7e890efd3f00a6c6c14c20da42d00bb2b83364df0784c911a", ts="1705108664", nonce="38h4_O", hash="i/kSt700VIvIlZ8LIBpkS3U5UXJ9+8dz7x7aO8v8TIw=", mac="fQntzJGeFMRojDNBb4yzwUDoGAuZlmlsCqMryramXsQ="'
  },
  json: {
    email: '30657c3d5b5bbbeb4d38@restmail.net',
    authPW: '12f458aa24e75cd55516a35f46843cecf82be240c5c8a6cc07f4707f92fc356d'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to delete account with TOTP with unverified session (1007ms)

  #integration - remote account locale 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8fd0df76540196635378@restmail.net',
    authPW: 'c155e75fc53634f4ac5565791268388d66857cbad57f9d8ed91bfb3f058c1d20',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '841ac26816504667a39e3ac6aa96f2a5',
    sessionToken: '57fe2bd67eee435cf61a5a9b78a45037253360c1956e16c1502e16e534d1a369',
    authAt: 1705108664
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '841ac26816504667a39e3ac6aa96f2a5',
    code: 'a8471f75a3263926299e41e43c20d33f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6783bbec42dc3310597dd77e598b5f9aff90e967d82beb9a395ff0f78443d73a", ts="1705108665", nonce="xHQGYy", mac="h8mOw5luBZMxGVnS2F24QTroyqqRqoKuNA6yc9SAu2c="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: null } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8fd0df76540196635378@restmail.net',
    authPW: 'c155e75fc53634f4ac5565791268388d66857cbad57f9d8ed91bfb3f058c1d20',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '841ac26816504667a39e3ac6aa96f2a5',
    sessionToken: '71775ca9db2390dba4da73bf4384b1971930b82692525b84894f70c8cd3e4fe3',
    authAt: 1705108664,
    metricsEnabled: true,
    keyFetchToken: '33e5ccd1931e03bc51c45a1f823ea0e1dc744fbc370539c23c34676984c1fd37',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    'accept-language': 'en-US',
    Authorization: 'Hawk id="2930470ca60c25df607c2e08e8c7aa8398b508279ee81c09e3484334a19331da", ts="1705108665", nonce="vaBCQP", hash="O6JRQmGoLxJICs+RKVC+CL3Han/uNmWkDdtCbKLtKrA=", mac="3H7yFmaIeD26Xtdjby7LqvKbK2egCL1Ovu6YptMwYOk="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 1000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiODQxYWMyNjgxNjUwNDY2N2EzOWUzYWM2YWE5NmYyYTVAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjU0NzMwLCJleHAiOjE3MDUxMDg2NjU3MzAsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjY0NDE1LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY2NCwiZnhhLXZlcmlmaWVkRW1haWwiOiI4ZmQwZGY3NjU0MDE5NjYzNTM3OEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIzZjhmYmUxOTEwYzEyNzUxNDY3Y2ZiZWMzMDNjZGU0YSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjY0NTA5LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY2NDQxNSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.t1wG0XSu-kue69VK_x5xKpiDuMLJ0nf7Y_1TNEX5TCnjzsE7C0uSVniyNFQX-iFhg01GIsJ8DVx9ZpDUdSWZ4V4pUjx2pn0l2ZNaO7OboB5sM4IbduPwp-u5JSalAw4nCID2hckXSYbi2J6ufpr2EehNu7vKeMqmD8VMEQFwi1eo01PX9OY4V2zPT0OTBhhBJMDlpt3uv3IJP37zEY6PdyA5qxSv7sOBNAFsx9owux6juRd5vDecchlVmwNMN2LFhVd-pCfEwrY67Z9YOUnjcvuARTp19hcIK7GD_xElBW1-lifSh6Yz-MLQsLigcsn_gQPOVIUIvjtT4eg_wSMw9Q'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2930470ca60c25df607c2e08e8c7aa8398b508279ee81c09e3484334a19331da", ts="1705108665", nonce="z_jEmE", mac="f8R89xOYw3fIOqllsxLTPi5+8MUBMw5bmqFOH2b4MXc="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US' } }
    ✔ signing a cert against an account with no locale will save the locale (467ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {
    'accept-language': '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  },
  json: {
    email: 'cd2c8f641c2d1078e081@restmail.net',
    authPW: '6c8064347991a72877bf3db955fcb49926948c586d98f81a64027831d8adbc33',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd4f0603fd9c24faea701801db5a3efeb',
    sessionToken: 'b36dfe3b8293378acdb23f8be22f08fda2eda5bdd4e996418de8ba9e9f2ef92b',
    authAt: 1705108664
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cb23ccb28ddff5710df931cafe5f4ff7253b91a466401248c92ef6702c28f922", ts="1705108665", nonce="UBk_a-", mac="cM2yIA5Y3fme9N2UodPlfi/Dq/J0MGd1OnEWq2U9Eaw="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: null } }
    ✔ a really long (invalid) locale (192ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {
    'accept-language': 'en-US,en;q=0.8,0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  },
  json: {
    email: '411b7d55d3740c4a5fe7@restmail.net',
    authPW: 'bb119f0159274d8e6be465af723d9146d0fc242a4ec8867559c5a07f6741174b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ea49f01a486441b9a7ade9191d15f69b',
    sessionToken: 'fb921d6c041bb28937ab76e7e88ea9de8c8e5c925f38a0d79c20ad2e6960f623',
    authAt: 1705108665
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="70eae1c7138ee90457e1013ae6dce6b8101bd7689bd9d5792b1be54b14e44bb0", ts="1705108665", nonce="MZXaCy", mac="5IfBeLXNJiNnAUs984Q2fHPHfdHCEsZMusG0T7Mt5tU="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US,en;q=0.8' } }
    ✔ a really long (valid) locale (192ms)

  #integration - remote account locale V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a346c946eaf310c71b5d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a346c946eaf310c71b5d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a346c946eaf310c71b5d@restmail.net',
    authPW: '5a50cd42b522419124cf9869be1e60d488730ad02bd2f165e88b01a5817e1ff5',
    authPW2: '485a4a779c4503517b11d49cca877f7b3c90befea4a0ce105e7cf31e981f9c22',
    wrapKb: '2679d823504864ca1069ef756c718cce7950e356b98585f6d940bce16d07fbae',
    wrapKb2: '31d0769120022fa9f11e11afd5dbcb3da0dc9a6a1cda413693cbcb55926a28b2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:46974d5baa205c054ef231c46a70da7ccccc294624a3b72956a0d3329ab65a35',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eed9f55a71b74fc48606b6f7eb3bbdd3',
    sessionToken: 'ef5a1d9c0805e0611b1245d21743de8e814a545cf22db3205f428e55fd57d84a',
    authAt: 1705108665
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'eed9f55a71b74fc48606b6f7eb3bbdd3',
    code: '8704127220be97b48c9f152a7e63a47d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="27e163f7ebd6bac9623c9adb33aebd83be1793aa377dc2b192b5e85acfc08c95", ts="1705108666", nonce="pRk_l3", mac="Ku3yrEl04P/eUU44T+p4L7G60v5LwFs4NTMDP1Fe1S8="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: null } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a346c946eaf310c71b5d@restmail.net',
    authPW: '485a4a779c4503517b11d49cca877f7b3c90befea4a0ce105e7cf31e981f9c22',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eed9f55a71b74fc48606b6f7eb3bbdd3',
    sessionToken: 'e811bfb0e867e49fd512dc58842c15b77b0fc3af8e049a31a6ed89ae76578d22',
    authAt: 1705108665,
    metricsEnabled: true,
    keyFetchToken2: 'f50eead6218ef670d74d031c0e98de2790b877660b21fb97cc47946cb29f0d1d',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    'accept-language': 'en-US',
    Authorization: 'Hawk id="e7d7c254e1be95f52beadf69cb2da55ad6e05b4e79b4160b548412a4b4c2c26e", ts="1705108666", nonce="zI7AlD", hash="O6JRQmGoLxJICs+RKVC+CL3Han/uNmWkDdtCbKLtKrA=", mac="pM5EduGLk0bGlpwxuiA5kqa+AWqWDi+7KEwcufZfR3U="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 1000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZWVkOWY1NWE3MWI3NGZjNDg2MDZiNmY3ZWIzYmJkZDNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjU1ODk1LCJleHAiOjE3MDUxMDg2NjY4OTUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjY1NTkyLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY2NSwiZnhhLXZlcmlmaWVkRW1haWwiOiJhMzQ2Yzk0NmVhZjMxMGM3MWI1ZEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI1YWNmNzRjZGQyYWVlYzA1YTdjMzI2ZGVlMjM4OTg3MCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjY1NjczLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY2NTU5MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.RvuXE-H-muFLJofOVhwYOi-TZ2J6DXKXTb5AnnJtO47S29RqSwLT8mH3y_IfZaN81uLWPDdBeJScxdcCKpbubNWje56tejSAU_M15KvsaH35oZ8WtbrC88LeoONIe-Sy34MI1wFXxAGCHxGMRqSSVVGI1tQKfUTq76EdVuAzDZ4OAT0IiIfN4uDq-ektIxeZ0vN4JzAfMQ6qb5IGr2lm9jISz-ZadLIL8PMFzA3Bn3Ri4_bDgqVZMDum48qJyAXwre5vgJWeedCNdrfN_Mz2cfnlKcxTbzKZAOgJP7KXDwKnFRYY2vcp5COUFIuH74icmylXiZjhIWtEgfe8CAVgXA'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e7d7c254e1be95f52beadf69cb2da55ad6e05b4e79b4160b548412a4b4c2c26e", ts="1705108666", nonce="i4DNEI", mac="5+8pxh7spb6AFQ6aWLNMmSlJcUViA5WV1++LRTo3ze0="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: null } }
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e7d7c254e1be95f52beadf69cb2da55ad6e05b4e79b4160b548412a4b4c2c26e", ts="1705108666", nonce="qKkPgK", mac="x+7J0KUKZm6ULIaROqaPJf0BsIIx/gkX1SwVWJS3MHU="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US' } }
    ✔ signing a cert against an account with no locale will save the locale (752ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bba77c636fda7e204888@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bba77c636fda7e204888@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {
    'accept-language': '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  },
  json: {
    email: 'bba77c636fda7e204888@restmail.net',
    authPW: '5d63cfccf8d24797b70be03f6a6144d6f8a106e4f7cf6a37c62760acd6c707d5',
    authPW2: 'bcec85607b345eb507953324a97d68d71b00d1efb1d844cceccd53b5421a79c5',
    wrapKb: 'ed6b5783e4ed328c748c6dad56d60fe6f26815d3ddb7abd89a2e7426006d1736',
    wrapKb2: '02df94c13e8b023f2cafab91d1ac79068d9115071a2168e31f02f0b021a03fcd',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e998baa4dba15a70ca7880d125af779a7849bfd9f9cebd49946ae354323301ce',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '86980bc688ef440fb78fab3a80bb3242',
    sessionToken: 'cbfc22df030914aa32018b3a15b18ae4de9cad7927dedac0b11f59486444f6d7',
    authAt: 1705108666
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5b4d6d62af3e9046750f1a621c41d642ccd522440deca0581effba2535250d34", ts="1705108666", nonce="K54gbw", mac="kfR3fFk7jPJH1QGk/kiogbqkuv5uSXt8nGrxX8ULabw="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: null } }
    ✔ a really long (invalid) locale (459ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd1f6b71c08bbb577bf17@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd1f6b71c08bbb577bf17@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {
    'accept-language': 'en-US,en;q=0.8,0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  },
  json: {
    email: 'd1f6b71c08bbb577bf17@restmail.net',
    authPW: 'ce0a862c952ba2d079af1cc8f7b7d3ab848acaf56066358399e67f70404e878b',
    authPW2: '18208016230bb5c91f339164e0ea2c9cd8778a55c8196f4fb80afa4e9af9c05a',
    wrapKb: '26c20877eb1aa998ff1413173dc696794573146b3afd32e29b37fbb148583b7b',
    wrapKb2: '8d90a02addd42856200d69c08e278efe1e0c5bb06861aab665bd1ab4bd4a3ddb',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:10a67a06c91a9ef1be204cbf13f54c0ddd5a95f0a0d4d623016eb0e314a3cf48',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '57a8150b0c5947d9895589e97b92f793',
    sessionToken: 'e7c443276df0b2e1b8c9117949e122dc7a2ddd59951f80bea1976b388368406c',
    authAt: 1705108666
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8a5253ac6d3a1f49a9d39f7bcb6bcd0cb506de30486ec6da71a750a9395689da", ts="1705108667", nonce="Xaxo5u", mac="5f9iiCIa60i7LWJ8rR9xo+htp8CyjyX4C3Syas3zfNU="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US,en;q=0.8' } }
    ✔ a really long (valid) locale (459ms)

  #integration - remote account login 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c65208c3c121090fc0dc@restmail.net',
    authPW: '3e2cc1f9e3a28735b9b38f48c85d0afc866ca39d551f138c2c68b4af9c6b78de',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd644a3bab0624cb8bd9f45a81c63a81f',
    sessionToken: '1778a1feb1e7afd7a3483624233a0b819ac2602f2bb2cdb2c2637f01cfe94592',
    authAt: 1705108667
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd644a3bab0624cb8bd9f45a81c63a81f',
    code: '4d28046732556492bba3b5a7b94551c3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c65208c3c121090fc0dc@restmail.net',
    authPW: 'ae7be10487c0881479eb9e417dc33550c2a2dbf26e8dae5bd298cb72b71980fa',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c65208c3c121090fc0dc@restmail.net'
  }
}
    ✔ the email is returned in the error on Incorrect password errors (373ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '154d0e0d6c293562cdce@restmail.net',
    authPW: '696cf2ad095da32da1c316ffcdaffbf3bdfaeb5aeadb282b2c3b67da213bee4b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a5b6c41f09eb46ad9896565e40170c1b',
    sessionToken: 'db66e3e9866236b3adebc768f805b41dfd21364ada7e18e8b4fe79ad7538eb7a',
    authAt: 1705108667
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a5b6c41f09eb46ad9896565e40170c1b',
    code: 'c5b35888d1efb8a18d280ced188d30b7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '154D0E0D6C293562CDCE@RESTMAIL.NET',
    authPW: '3baeedcb662e8630129fe0f9581242ab5b2ad4fdc0b4f3254c69b95a0f49b675',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 120,
    error: 'Bad Request',
    message: 'Incorrect email case',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '154d0e0d6c293562cdce@restmail.net'
  }
}
    ✔ the email is returned in the error on Incorrect email case errors with correct password (361ms)
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '747d1b385c967cbbeb13@restmail.net',
    authPW: 'cb84087531c75043242628d0be67aa7ceed04bb852a721347a16d71e3466390d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '747d1b385c967cbbeb13@restmail.net'
  }
}
    ✔ Unknown account should not exist
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '05ac9757cc3a4d69269b@restmail.net',
    authPW: 'fcb80e0f986823005b6001e082ce434c8b94a17c69cc89508f34c2de22cf89cd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd01f991a4b1a46eeb29b242a6e367f97',
    sessionToken: '1fccc584b2a1090f48a51fdaf33a3caa3a476b70f78c19289f149bc5a8fd39bd',
    authAt: 1705108667
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd01f991a4b1a46eeb29b242a6e367f97',
    code: 'e5acde4acbe7b0d9d3742b584fec40f5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '05ac9757cc3a4d69269b@restmail.net',
    authPW: 'fcb80e0f986823005b6001e082ce434c8b94a17c69cc89508f34c2de22cf89cd',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd01f991a4b1a46eeb29b242a6e367f97',
    sessionToken: '2e7cd411b59063b104a1b5a4071cf7b365f685313265e804885fda3fee90635b',
    authAt: 1705108668,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ No keyFetchToken without keys=true (408ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '81e5ec2bc63a501b53f9Ӓ@ᘮrestmail.net',
    authPW: '3ffbea2e175b9343d7edcc2840078103e33a13e64ff5789e16d28e4dac0776c1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2b065091026040de9c0da345c4446579',
    sessionToken: '69e119b01baccba5f91a87b51dceeea1f14d0b842395c073ce263e990a502978',
    authAt: 1705108668
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2b065091026040de9c0da345c4446579',
    code: '44879b8bbbf3bf10193d84223c6d0a27',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '81e5ec2bc63a501b53f9Ӓ@ᘮrestmail.net',
    authPW: '3ffbea2e175b9343d7edcc2840078103e33a13e64ff5789e16d28e4dac0776c1',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2b065091026040de9c0da345c4446579',
    sessionToken: '9a9903f5d8b3bf8ad518c378785b0e080d3feda84e3048e394eac4c6a20404c7',
    authAt: 1705108668,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ login works with unicode email address (449ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '130a77cad0fbc095f5b9@restmail.net',
    authPW: 'cf07ad70839af05670b97ec12f331585b9d499604dfe5d0dacc651e1dbd7d639',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'adc68221f59445ab8f0170ee433bc2b9',
    sessionToken: '2b4e1042a61a3424c79483fd46e86437ea8c2eefb8e04b419d82d84b25e265d4',
    authAt: 1705108668
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'adc68221f59445ab8f0170ee433bc2b9',
    code: 'b64003a7c71aa58f83746085af875642',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '130a77cad0fbc095f5b9@restmail.net',
    authPW: 'cf07ad70839af05670b97ec12f331585b9d499604dfe5d0dacc651e1dbd7d639',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef',
      flowBeginTime: 1705108668724
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'adc68221f59445ab8f0170ee433bc2b9',
    sessionToken: 'ea1ca0dccbffd8f98e5b5e39a31dc111488429db7e7a31bf046d814525128be5',
    authAt: 1705108668,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ account login works with minimal metricsContext metadata (404ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '44f945acd325ca2b154e@restmail.net',
    authPW: '9649a1df1b5134139a6a09d32692086957cac7b56e1c2baeda24163fd743236d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7909700dd91a4ac9b757ad083e8759d2',
    sessionToken: 'f22186f564d014d1bb86f95b8cbe4c9d5727ddf21dfcf90fa7a80ca5096a0f7b',
    authAt: 1705108669
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7909700dd91a4ac9b757ad083e8759d2',
    code: '88d7cc3740033a2f840a2aff5ca008f5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '44f945acd325ca2b154e@restmail.net',
    authPW: '9649a1df1b5134139a6a09d32692086957cac7b56e1c2baeda24163fd743236d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0',
      flowBeginTime: 1705108669142
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account login fails with invalid metricsContext flowId (248ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf4b06be68127c479459@restmail.net',
    authPW: '3847695d18e6de8f504250a778c86c3371caa4fd51b303633c8ce59d203d749e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eeb7558daeff4e9bb8b7cd6589f3b9a3',
    sessionToken: '1180cfca4829edfdbaccdd6d0776822ea3270c5dfd47a6996d5c795a19bd1b2c',
    authAt: 1705108669
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'eeb7558daeff4e9bb8b7cd6589f3b9a3',
    code: '0d73efbf3ecb3f16e4eef4641622cee3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf4b06be68127c479459@restmail.net',
    authPW: '3847695d18e6de8f504250a778c86c3371caa4fd51b303633c8ce59d203d749e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef',
      flowBeginTime: 'wibble'
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account login fails with invalid metricsContext flowBeginTime (255ms)
    can use verificationMethod
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4f5e3afa83fa6a356ba3@mozilla.com',
    authPW: '79c8f545f5c32a7cc17b08e9d79c07065aae4dad2952c678451ca166412ac53f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4b813f4b16d7471591fda1ca3f3962f8',
    sessionToken: 'df3db54d4f562fc5a48e523ef4e8e7be9ee3bccace047d6dc9f0f318ac0c1f13',
    authAt: 1705108669
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4b813f4b16d7471591fda1ca3f3962f8',
    code: '862e0c5e736314e729be2d6e653770ed',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4f5e3afa83fa6a356ba3@mozilla.com',
    authPW: '79c8f545f5c32a7cc17b08e9d79c07065aae4dad2952c678451ca166412ac53f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'notvalid'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
      ✔ fails with invalid verification method
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fca3e389031514343755@mozilla.com',
    authPW: '5cba3fe2d0cba1aad0ad67d1d159f251dc61b8992066f7edfde4e35fd8b15fbe',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b58527fa0775406a854974826b6782c5',
    sessionToken: 'dd2619fb8c959ecdfbbe59e3b46b58d36cdc5366c6e92e220c1b0ac344fab81a',
    authAt: 1705108669
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b58527fa0775406a854974826b6782c5',
    code: '9e0a9b2cec666c5e1ab7466d53b5ba66',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'fca3e389031514343755@mozilla.com',
    authPW: '5cba3fe2d0cba1aad0ad67d1d159f251dc61b8992066f7edfde4e35fd8b15fbe',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email'
  }
}
!!! response success {
  body: {
    uid: 'b58527fa0775406a854974826b6782c5',
    sessionToken: '154385b0f831a950dcf34edeefe15e79ef5a52774ac5d02dde2fd88f3e12ac73',
    authAt: 1705108670,
    metricsEnabled: true,
    keyFetchToken: '340bf760d20c01b6ba5a8d98396eca32a9f891015b41c363210da53b70e2df52',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33b2c624d72ea6ec9e2f89a21df1aed8c7eacaadf67d67bbd9f7ca75269deae4", ts="1705108670", nonce="S563PE", mac="QN0h0RweiVwrIARKvmi6qMILOe3Af+Z3ynQk2Q+PBgE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'fca3e389031514343755@mozilla.com',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b58527fa0775406a854974826b6782c5',
    code: '41d55c53286587b0f657a8807c292b94',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33b2c624d72ea6ec9e2f89a21df1aed8c7eacaadf67d67bbd9f7ca75269deae4", ts="1705108670", nonce="VXZ0RE", mac="U0jAvWIBV2gxnrFpD1pjJXzgIf8dfGbIbsw2wagJXk4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'fca3e389031514343755@mozilla.com',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
      ✔ can use `email` verification (241ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd4372bd33e6798110a6a@mozilla.com',
    authPW: '9c33acf1b0ccaf4f14c0a6ce6b9990a2e4b088bffd820f467dc74721edf0c179',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9b1fea4902494811bd63f39f42e4b762',
    sessionToken: '71493424ff1039d660779de447f4b13675ab984b9ff5cd7505796544996078ce',
    authAt: 1705108670
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9b1fea4902494811bd63f39f42e4b762',
    code: '7e5095ddedc384cc191a87cdfa049b90',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd4372bd33e6798110a6a@mozilla.com',
    authPW: '9c33acf1b0ccaf4f14c0a6ce6b9990a2e4b088bffd820f467dc74721edf0c179',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email-2fa'
  }
}
!!! response success {
  body: {
    uid: '9b1fea4902494811bd63f39f42e4b762',
    sessionToken: '013b27db2d1d6acb4aeb0c9dc107292a94750855cd8b76c19720047bef64ee6b',
    authAt: 1705108670,
    metricsEnabled: true,
    keyFetchToken: '1308946444dddaeb5ec32c07d32f4aee622586759ee907881727bc62c7d8b4d1',
    verified: false,
    verificationMethod: 'email-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="54e9e8458a7995c00a64cc8e94cb060ddef8b515f0783b0d0e7caf1aee0e9097", ts="1705108671", nonce="t9KHDW", mac="F4isLgw2q0Q8gXeACdn+1JX7m5y4FmoIRcLethA8fQ4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd4372bd33e6798110a6a@mozilla.com',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ can use `email-2fa` verification (203ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a4f7efbd9dfa7a8f3e60@mozilla.com',
    authPW: 'f898842af85ec4b223fa883e2418ff2554a17ac20b7915ba5db2e2ee6d5a1672',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1743772afc394a4f83223c30685c9bde',
    sessionToken: '63471ce64dda6803a337bf4ed18902f5e33e27b8c56a5e61ecefc9fabe7ac12b',
    authAt: 1705108670
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1743772afc394a4f83223c30685c9bde',
    code: 'ada173d93efce7492358b6d105702fdf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9b66802c5ff1d6841fb3@restmail.net',
    authPW: 'c3ff205257f55682d1f7661af2e621e9b985cabdbc28130df002034f847d28fb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '90e54b35cc2046d49ce4d55f301e0123',
    sessionToken: '8d6538bc9ef3e362a7a02ba1c1b5f307311e2a16af561a1e7fd02f93f1e8980f',
    authAt: 1705108670,
    keyFetchToken: '55b9cb3db5ff7b63ebab840276ee604ff8b160581d525808171c6ad5bc21e7f4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '90e54b35cc2046d49ce4d55f301e0123',
    code: '806ba911f85a5a9a0970e312ae7a2396',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="590a2b3b58d8a3d0028b0822c140d85270f2953964ce59d8041d4153e49e3005", ts="1705108671", nonce="lktJII", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="09Ub0dOmYqcnkNGNilk8acVgmVViD5Uce5imeSCnAzg="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JNFW2TRTJZFVMOKVJJYTCV2JGNTTSZLF',
    recoveryCodes: [ '8d9v29b1xa', 'avw5pxgd0n', '9q87phhrh5' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="590a2b3b58d8a3d0028b0822c140d85270f2953964ce59d8041d4153e49e3005", ts="1705108671", nonce="ekZUHH", hash="I66V4MleC7367cuxctiYCT6QZa3xfL+/kMMZhyfz3+s=", mac="ANrdSqMXXvC5HQAAXNKHpDqu/8zMhMIByGIhfJT8IWM="'
  },
  json: { code: '119816', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9b66802c5ff1d6841fb3@restmail.net',
    authPW: 'c3ff205257f55682d1f7661af2e621e9b985cabdbc28130df002034f847d28fb',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'totp-2fa'
  }
}
!!! response success {
  body: {
    uid: '90e54b35cc2046d49ce4d55f301e0123',
    sessionToken: 'c3d87952ce050972d8dd2ae05a37c5a1a37e9b9235cb580ec92bafd4bb22e559',
    authAt: 1705108671,
    metricsEnabled: true,
    keyFetchToken: '1f9a3d9d0ef2fc81582a05870473bb00f371174bd4809d66528aeb6d5be3c19d',
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e6cc8691bd072317b6056647fb256c0c0e604e92b1f4cc2836689780909005dc", ts="1705108671", nonce="B-EH-9", mac="0j85Lv6qhnaHb7cyC4T728X9rn8DtayHr0kj7Hc8lfg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9b66802c5ff1d6841fb3@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ can use `totp-2fa` verification (638ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3a471e8bdaead42634a6@mozilla.com',
    authPW: 'ba40206e3abeb9bb28813ba6f5cc4efc11e21ed71d7dce3bf7d35fc38d188ce3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5340f7676a184d85a59dfc6e2132bad5',
    sessionToken: '6dde8a959c2b1111110be99efa9db7305a1a48e2cc944e87f97ce131a174aaa3',
    authAt: 1705108671
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5340f7676a184d85a59dfc6e2132bad5',
    code: '8b6a18cd8d178cbf90c6f4e46b858784',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3a471e8bdaead42634a6@mozilla.com',
    authPW: 'ba40206e3abeb9bb28813ba6f5cc4efc11e21ed71d7dce3bf7d35fc38d188ce3',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email'
  }
}
!!! response success {
  body: {
    uid: '5340f7676a184d85a59dfc6e2132bad5',
    sessionToken: '6a34ce5cf428f5bf0677ad4491de1a04af5de36af014192000ef8dd73449733c',
    authAt: 1705108671,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fc046350d00134a7eaeffc39360013c488ce771f51eb604c29aa88a07422592f", ts="1705108672", nonce="JWCNqJ", mac="VyNeNUBFTfq9x3WuOvQuPlpDfnIko15Se1cQpg3vatk="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3a471e8bdaead42634a6@mozilla.com',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ should ignore verificationMethod if not requesting keys (209ms)

  #integration - remote account login V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3162c65c60ebc1f1c53a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3162c65c60ebc1f1c53a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3162c65c60ebc1f1c53a@restmail.net',
    authPW: 'd1195ccc99c187b2feb8fcc07743985a5d1b01fce9f515769db5a1289236e783',
    authPW2: '651abb38f09575fea6cfbb75094ec7c79c1256384e855ff06ff66dd6044dfd18',
    wrapKb: '267ffa477dc7ae0a8dccdcdc0519986d8d978cea357c33de3883b12ad675d9f7',
    wrapKb2: 'cbdb593b5105a541ed8c56aa7e46abc6e954438ccb9f3987507cf6449359139c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:65b643d9c960a2d70b91b82d9bba8b75685def48b2485152b8fe279ea6ada363',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7ca355aeb4eb4982a9ea691af99227e6',
    sessionToken: '3ece26b2c927fc1c75b85e20bd0c3e3922055e6c01aae14987a59bba380f567e',
    authAt: 1705108672
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7ca355aeb4eb4982a9ea691af99227e6',
    code: '6059fcaba197ad043b76ed62ee5a54c7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3162c65c60ebc1f1c53a@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:65b643d9c960a2d70b91b82d9bba8b75685def48b2485152b8fe279ea6ada363',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:65b643d9c960a2d70b91b82d9bba8b75685def48b2485152b8fe279ea6ada363',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:65b643d9c960a2d70b91b82d9bba8b75685def48b2485152b8fe279ea6ada363',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3162c65c60ebc1f1c53a@restmail.net',
    authPW: '8eb6eaa2bdec607e2d472848c6c313a7bce1f54ebd3ab39b8a76508c1bd1ae3d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3162c65c60ebc1f1c53a@restmail.net'
  }
}
    ✔ the email is returned in the error on Incorrect password errors (823ms)
    ✔ the email is returned in the error on Incorrect email case errors with correct password
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c573084a19f53ceb66e9@restmail.net',
    authPW: '870f6c527055502716124ed777fbf56e7fdbd02f680dd947881a4765ebc26dc3',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c573084a19f53ceb66e9@restmail.net'
  }
}
    ✔ Unknown account should not exist
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '252ca428a577fabde362@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '252ca428a577fabde362@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '252ca428a577fabde362@restmail.net',
    authPW: '5f05112fedb9ac57a31aa5328cffa09aad39c0e92a3bd232bef97180b5f0ad0b',
    authPW2: 'de6836893dfd54f71c58bef2f6cf0ab50325d7722bad648e9ac195fbcd95ea90',
    wrapKb: '57000b6ea5c18a87c10b919d80141236a724f34d42d4e7d0fc0d0d0949abc149',
    wrapKb2: '8e5f328dbe21e0e0b1ffed7afb2048f48c3abbc73861ff9a810e03036b8bf0e7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a19cb1daa80bdd9297dbe0eab0e0816cd0e419c6036038823bbda0c4ced7a170',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9fa9e66d21d546deae53566f02ae4124',
    sessionToken: 'f103240776d338c2e392cafc5dfbb597b5bea56bce892f5540e2a635f2dc057d',
    authAt: 1705108673
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9fa9e66d21d546deae53566f02ae4124',
    code: 'd0d2ca8a858d60c19d80010055a56695',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '252ca428a577fabde362@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a19cb1daa80bdd9297dbe0eab0e0816cd0e419c6036038823bbda0c4ced7a170',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a19cb1daa80bdd9297dbe0eab0e0816cd0e419c6036038823bbda0c4ced7a170',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a19cb1daa80bdd9297dbe0eab0e0816cd0e419c6036038823bbda0c4ced7a170',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '252ca428a577fabde362@restmail.net',
    authPW: 'de6836893dfd54f71c58bef2f6cf0ab50325d7722bad648e9ac195fbcd95ea90',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9fa9e66d21d546deae53566f02ae4124',
    sessionToken: '3896d467f62e34caa125674886aa04036f49a7803da11de53ccedfee540a2544',
    authAt: 1705108673,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ No keyFetchToken without keys=true (825ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '439e254627d7de58715eӒ@ᘮrestmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '439e254627d7de58715eӒ@ᘮrestmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '439e254627d7de58715eӒ@ᘮrestmail.net',
    authPW: 'a12538bb9efe99c07d79e0eaa865c4f24c44f1ff55bbda2bd82ea8118ffc72d4',
    authPW2: '6b381c46f90459460832e3f0eb284e47ca71944049a1d9936abdf01cd5104f71',
    wrapKb: '7ab0760caf6a330ebc1f83de6f251dbca494a4724b77b69798bfbe66a4ef659a',
    wrapKb2: '6e08e2f8ff43b36b9eab332f69cdd3b0c46bb7e5e3918e6e48f313940361a439',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ad90cd7749236284415feb22c0f77c83fa57a389ddcbeb762e09832cecb4930',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd353541f8eb84f5ebec3e859066b0daa',
    sessionToken: 'e3fc4fa38c7683173009abb46429e2ff764b079d604414159a01b1345ad481c7',
    authAt: 1705108674
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd353541f8eb84f5ebec3e859066b0daa',
    code: 'd78420a6520aeb89ba9f285661ae57df',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '439e254627d7de58715eӒ@ᘮrestmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ad90cd7749236284415feb22c0f77c83fa57a389ddcbeb762e09832cecb4930',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ad90cd7749236284415feb22c0f77c83fa57a389ddcbeb762e09832cecb4930',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ad90cd7749236284415feb22c0f77c83fa57a389ddcbeb762e09832cecb4930',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '439e254627d7de58715eӒ@ᘮrestmail.net',
    authPW: '6b381c46f90459460832e3f0eb284e47ca71944049a1d9936abdf01cd5104f71',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd353541f8eb84f5ebec3e859066b0daa',
    sessionToken: '1ff9305d17f5cdf51e4338cad364c74eb30fae62746f2ba9d009977746f706fe',
    authAt: 1705108674,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ login works with unicode email address (816ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bce234ac5334af7992ca@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bce234ac5334af7992ca@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bce234ac5334af7992ca@restmail.net',
    authPW: '660e4e111b8ef4e0bffcbe1e8d82cccd2f010fd512af21a50f9c7d0d5dd0a9c2',
    authPW2: '1f6bfbabbceb14f33f7667eed7b93bdad1d3b9713213e9d4310213e0d87fb413',
    wrapKb: '50cdc50ec63f536eae1ac284655230cccc7b324f7e5bd746384d0eda0a2a1013',
    wrapKb2: '1d86897bdcc2bfaf05e98e4f018262867e545bf9eae951ab79b2d2bd8f904f8c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cae1ba3d630c2d170ec397b0cd14ad5d73ff293c545abffde74b2e45be48d79b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '84f209de6eb6424db4cdb2ca3b114f5e',
    sessionToken: 'fc41094d84f61959cff147f845467fc3ad91f1f47096c26ffd3d1308a6bf33a0',
    authAt: 1705108674
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '84f209de6eb6424db4cdb2ca3b114f5e',
    code: '80005e4bc65385c5a87463014d4256b0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bce234ac5334af7992ca@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cae1ba3d630c2d170ec397b0cd14ad5d73ff293c545abffde74b2e45be48d79b',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cae1ba3d630c2d170ec397b0cd14ad5d73ff293c545abffde74b2e45be48d79b',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cae1ba3d630c2d170ec397b0cd14ad5d73ff293c545abffde74b2e45be48d79b',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bce234ac5334af7992ca@restmail.net',
    authPW: '1f6bfbabbceb14f33f7667eed7b93bdad1d3b9713213e9d4310213e0d87fb413',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef',
      flowBeginTime: 1705108674904
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '84f209de6eb6424db4cdb2ca3b114f5e',
    sessionToken: '4b9f9c2dfa308fd4b79e22076d5f661d21767a61288e174fe91bb2487c34c54e',
    authAt: 1705108675,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ account login works with minimal metricsContext metadata (800ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '68055df1f2cf9b9942ca@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '68055df1f2cf9b9942ca@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '68055df1f2cf9b9942ca@restmail.net',
    authPW: '80dd451530584f082b20d454eb453493f4ae345e20954a3684d6c0367155080e',
    authPW2: '5cf82aae5e17dec5398b598461269729ef47a59cf9a8e74c87a552256288efe7',
    wrapKb: 'cb4486aef7295109b2142e00825e8d0a0e93ee02038e54856ffed707338198aa',
    wrapKb2: '84a9785ea536a289449a3220024db3d267db449c5f48dba6c65b89d43bd5baaf',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8b1776e2d0c674e820b43c662e129f8115024ed9650019a8be6050b9fcbc06ee',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '94aa28e566a841d1b7d2c4957875fb55',
    sessionToken: 'dc4aefe9f09b94233b81c3bb0498443f8a74c628c3cdc8a244f4fcd715e0ebe4',
    authAt: 1705108675
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '94aa28e566a841d1b7d2c4957875fb55',
    code: 'ecb9405d7723c2da543c803203f89926',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '68055df1f2cf9b9942ca@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8b1776e2d0c674e820b43c662e129f8115024ed9650019a8be6050b9fcbc06ee',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8b1776e2d0c674e820b43c662e129f8115024ed9650019a8be6050b9fcbc06ee',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8b1776e2d0c674e820b43c662e129f8115024ed9650019a8be6050b9fcbc06ee',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '68055df1f2cf9b9942ca@restmail.net',
    authPW: '5cf82aae5e17dec5398b598461269729ef47a59cf9a8e74c87a552256288efe7',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0',
      flowBeginTime: 1705108675709
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account login fails with invalid metricsContext flowId (613ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3690653561c675ce80f0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3690653561c675ce80f0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3690653561c675ce80f0@restmail.net',
    authPW: '5e7fd13308b8cbecbd5f542c5b6961820f7efb681eb9dc978e2fb9f50fdc2121',
    authPW2: '695c1977de4945f6e8542c1cbda9c6c77008384898582bd3d6729e640bd0d97a',
    wrapKb: 'f7182b31b8ecde3654880ee356bbb9a626075a3a266bc7471182aab58fe4fc5f',
    wrapKb2: '3e3a5542fd60f3266d642e1779d5df69c69171dbae97be2b81844928c2863026',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1a35e75f41e6359e16a5f7d43c702ec7a9247fa1bd1bfcc9f8a79f67898f5283',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bbfc289d563745e5859e988debcb8c27',
    sessionToken: '1befcff4c91ab4bda1e73c0ac2092898ce825b58c02d876e496a346dcb796308',
    authAt: 1705108676
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bbfc289d563745e5859e988debcb8c27',
    code: 'dd96e5d301de0e42c23e5629995184fe',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3690653561c675ce80f0@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1a35e75f41e6359e16a5f7d43c702ec7a9247fa1bd1bfcc9f8a79f67898f5283',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1a35e75f41e6359e16a5f7d43c702ec7a9247fa1bd1bfcc9f8a79f67898f5283',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1a35e75f41e6359e16a5f7d43c702ec7a9247fa1bd1bfcc9f8a79f67898f5283',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3690653561c675ce80f0@restmail.net',
    authPW: '695c1977de4945f6e8542c1cbda9c6c77008384898582bd3d6729e640bd0d97a',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef',
      flowBeginTime: 'wibble'
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account login fails with invalid metricsContext flowBeginTime (620ms)
    can use verificationMethod
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a38a808d807f2bc54eb2@mozilla.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a38a808d807f2bc54eb2@mozilla.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a38a808d807f2bc54eb2@mozilla.com',
    authPW: 'b3207bba55a38794a0b522f03ac059ba88520a3abac2b756ce8621e064698772',
    authPW2: '4093727a9466578549cec2fe5e0e4cbe6357e7fae182af2c9c79f52f6171a496',
    wrapKb: '892d38c6e052c250ba979c7b83ab060099a1f444acbe7f30c70e2bafdbe38b6c',
    wrapKb2: '9fd74f190a6989e78298a625ba91de91c7e30454cf1eef35731d230feecd4a48',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5217b0b11697cef9af1b4a4f21583ad0bc7101c24716c58809fbcdb01f8beba8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7431463098eb4835b22d433372b26b22',
    sessionToken: '03fb4e9a7dffdcb8e8448532873ea3529ce3a5ec4d9d713a6e70043c2b5f6322',
    authAt: 1705108676
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7431463098eb4835b22d433372b26b22',
    code: '3ef6d4063952a8d68206f1462da99561',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a38a808d807f2bc54eb2@mozilla.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5217b0b11697cef9af1b4a4f21583ad0bc7101c24716c58809fbcdb01f8beba8',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5217b0b11697cef9af1b4a4f21583ad0bc7101c24716c58809fbcdb01f8beba8',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5217b0b11697cef9af1b4a4f21583ad0bc7101c24716c58809fbcdb01f8beba8',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a38a808d807f2bc54eb2@mozilla.com',
    authPW: '4093727a9466578549cec2fe5e0e4cbe6357e7fae182af2c9c79f52f6171a496',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'notvalid'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
      ✔ fails with invalid verification method (143ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '232234716803f630249d@mozilla.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '232234716803f630249d@mozilla.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '232234716803f630249d@mozilla.com',
    authPW: 'ba5cd0e48b0f01c0a5a5ca078f30d13098d11733d8df2fc225d64efbc76dff24',
    authPW2: '0e3540733efc8e209593344f0469decc3c349dd539a51a50b27826e1e588b4e9',
    wrapKb: 'e1dee12095f9bf9035ee377b4a82625b0c7aae57b9562331a99cf37c2723fd93',
    wrapKb2: '0bef88871c02a99d81ed1fc5841e8e7b11df7da8af98b7f4a753ad0350c0736d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8ba275d5cf8f96f583e40d28e931c996dc70926817a919965485a9d02070eb47',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '56672fdfb42c4b04837b3412ef0eb1fb',
    sessionToken: 'ab79b5bd8e7b284b16f1488ccbb45d62481c763b2213552fc1c7a43555f8c2b7',
    authAt: 1705108677
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '56672fdfb42c4b04837b3412ef0eb1fb',
    code: 'daf8d26bea1ff4112b156938ad80ce27',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '232234716803f630249d@mozilla.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8ba275d5cf8f96f583e40d28e931c996dc70926817a919965485a9d02070eb47',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8ba275d5cf8f96f583e40d28e931c996dc70926817a919965485a9d02070eb47',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8ba275d5cf8f96f583e40d28e931c996dc70926817a919965485a9d02070eb47',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '232234716803f630249d@mozilla.com',
    authPW: '0e3540733efc8e209593344f0469decc3c349dd539a51a50b27826e1e588b4e9',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email'
  }
}
!!! response success {
  body: {
    uid: '56672fdfb42c4b04837b3412ef0eb1fb',
    sessionToken: '53163630b41e1ed087ce4e66f81ceb4e659fd565abc8eb090ea7c4f9aa4b579b',
    authAt: 1705108677,
    metricsEnabled: true,
    keyFetchToken2: '3003c9fad777123c359089e3d74bc855167ef350ca16be6fb38ae3fe3de499c3',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="24a5137ba7a89a86afed88a6cf5f74e59a2012ad672dc3d380291d5cc0a0dd14", ts="1705108678", nonce="FytzQ5", mac="nckxXP1nCGuo+qNjRgE9x96Uf0R7tNmHSZstc1yXnfA="'
  },
  json: true
}
!!! response success {
  body: {
    email: '232234716803f630249d@mozilla.com',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '56672fdfb42c4b04837b3412ef0eb1fb',
    code: '39f577fed6347a4515957357315fd591',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="24a5137ba7a89a86afed88a6cf5f74e59a2012ad672dc3d380291d5cc0a0dd14", ts="1705108678", nonce="FTOiij", mac="X2INQXAgO7I7FE+CbJvBccJq8GIJlRt91ctN6CTJSxE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '232234716803f630249d@mozilla.com',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
      ✔ can use `email` verification (371ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b9ba19e2ea188a3cb6fd@mozilla.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b9ba19e2ea188a3cb6fd@mozilla.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b9ba19e2ea188a3cb6fd@mozilla.com',
    authPW: '4450f56150bc588a1e3494275ce8a5e7b2e0f0ca3875df0034d003de52b1e80a',
    authPW2: 'a7457425049d56d9ba0e5fe86e60bbeb275a43641e1573e846e2e24a11403a51',
    wrapKb: 'bead6c0f087d2a176a62ba11d89ecea2268ade6ee3056d7602d64d940f3e8898',
    wrapKb2: 'bec68fc246c069613f662ace388c039537baa930b0380102cfecc07e3bf35fbe',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0f983882e9af857e74c94c658549cbaa785142283a230b0ec542a5eba6d052f3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e346855fabd64663918e839a7f21f02d',
    sessionToken: 'd9524a03951a4a4fbb3c9e55af133f0b0e10d9ac7d7a9ef5f9ffd80533090050',
    authAt: 1705108678
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e346855fabd64663918e839a7f21f02d',
    code: 'ee11c7be2cde7be5caf19b6c1cc6f08e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b9ba19e2ea188a3cb6fd@mozilla.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0f983882e9af857e74c94c658549cbaa785142283a230b0ec542a5eba6d052f3',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0f983882e9af857e74c94c658549cbaa785142283a230b0ec542a5eba6d052f3',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0f983882e9af857e74c94c658549cbaa785142283a230b0ec542a5eba6d052f3',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b9ba19e2ea188a3cb6fd@mozilla.com',
    authPW: 'a7457425049d56d9ba0e5fe86e60bbeb275a43641e1573e846e2e24a11403a51',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email-2fa'
  }
}
!!! response success {
  body: {
    uid: 'e346855fabd64663918e839a7f21f02d',
    sessionToken: '15924332c4fcfb02769f775e0ec226e269ee01e7450570b8bd537576b0b76949',
    authAt: 1705108678,
    metricsEnabled: true,
    keyFetchToken2: 'bfc585c1e672af80f7239410c1fb087a3e872d2b7b44c53ae1dcff5b84a1de12',
    verified: false,
    verificationMethod: 'email-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8e9fa0bad152483cbb2a077aaeb361c376f019406768d0ec033a55e7c8fb9d20", ts="1705108679", nonce="IBPdi-", mac="zet/zMj0CfxTaHevwWqWXx2U+5S5FeOBMG9OApxqrEI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b9ba19e2ea188a3cb6fd@mozilla.com',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ can use `email-2fa` verification (354ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2ae9ce073bd709908811@mozilla.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2ae9ce073bd709908811@mozilla.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2ae9ce073bd709908811@mozilla.com',
    authPW: 'bf9138f2271f7a3c306d7358c8736e34e3632c7d4418a0b11c55147e99dfd963',
    authPW2: '168b3bb4f26df645faa0f481c565ad626459e94826f0259769600ae09581a734',
    wrapKb: '0aaea55b160c55c3c9023de9c8735c8a459f08209c95b53d62fe6f6bf70ea4b7',
    wrapKb2: 'e802c6693f17976f4f16757edc73908a1bedad666fcafbba3d3a6cdd6bd3b7cf',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4ce4752a4c86b6369005a77df9e8d70c1c2da7f7f0fcb17fcb70495c005c8b22',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e6fe922eb66749f8b3a88c96d1ae8e8a',
    sessionToken: '6ff71d82ffab31396dc44e1cc1c7d2d40ad08a1d1364395c37529eec5b311b98',
    authAt: 1705108679
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e6fe922eb66749f8b3a88c96d1ae8e8a',
    code: '8e0981dbe9c7bc95aa539aca0608b0fd',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b25a6e26a453aaf41f55@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b25a6e26a453aaf41f55@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b25a6e26a453aaf41f55@restmail.net',
    authPW: '2e9c4004133a08f043a33ac1211d8ea8c002b985c175e65af347b30f4c76e5c3',
    authPW2: 'f29482ef21f70fe878acc2ffcdf3d95616f6ce0fc6558c367cde47ac4d64313d',
    wrapKb: '3564b8279c600edd2e52dde5364e40250d74a4454c8708165a34be22776bfde3',
    wrapKb2: 'f530762300183982dc5c42ecfa5fe3a0bb3cadbc87e97556799acd85673e5819',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9e514c8aff987e25a2d026bf90ceb4b2fd0f6271400f2a2b320d501f299a2c0e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '356a847d05964f38a9a635e0f0735d40',
    sessionToken: 'b032993c712243d70ec692a518d3bc8a02c5cafb7c6df8298715f1e58b31a405',
    authAt: 1705108679,
    keyFetchToken: 'e8b376c7619a451897c4ced1d8e1c65598b2e0ac714d52d00cc438c56ba78928',
    keyFetchToken2: '7bb36d7a650ad03d2d32e045bf2d3ef4f440d09affbb8e4ca8707483595d25f5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '356a847d05964f38a9a635e0f0735d40',
    code: 'a5a199c74737ae629b5b58f7cda9255c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3babb649b510305ba2f05bca9fe24397086144e64158d13b2ed552ff5f8003dd", ts="1705108680", nonce="PiHz3F", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="hnGja9MMHg6gfNdU8hFHx8I769waacU7SXVDyFHJ6pE="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'NU3G4QLCKBWGS6CGMNXXISKJMRDCWN2M',
    recoveryCodes: [ 'wzqz6kwf2g', 'aga60pjn23', 'vxtcebmk4a' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3babb649b510305ba2f05bca9fe24397086144e64158d13b2ed552ff5f8003dd", ts="1705108680", nonce="2r3oDW", hash="CiNYGQCfXH7mRthLn1mxMI5uho56NKg1cdza3oyEp/c=", mac="QTkp7pImxMlrKhsVorUc03IGaACdCTe4yl5HLKRbgIs="'
  },
  json: { code: '824292', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b25a6e26a453aaf41f55@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9e514c8aff987e25a2d026bf90ceb4b2fd0f6271400f2a2b320d501f299a2c0e',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9e514c8aff987e25a2d026bf90ceb4b2fd0f6271400f2a2b320d501f299a2c0e',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9e514c8aff987e25a2d026bf90ceb4b2fd0f6271400f2a2b320d501f299a2c0e',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b25a6e26a453aaf41f55@restmail.net',
    authPW: 'f29482ef21f70fe878acc2ffcdf3d95616f6ce0fc6558c367cde47ac4d64313d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'totp-2fa'
  }
}
!!! response success {
  body: {
    uid: '356a847d05964f38a9a635e0f0735d40',
    sessionToken: '76908713259aa5b05fa4453482876c051dd36ff5fc7e9024c3d9570bf5200d62',
    authAt: 1705108680,
    metricsEnabled: true,
    keyFetchToken2: 'b30c9762b49138fa0ae4b153437d8c956115994f3390f972bf0fcc18f336f57e',
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="86e27a0d185e0a3fd20bd3c2f006864c4b241f281606f4903f0380a8bd9f8531", ts="1705108680", nonce="Y5nv5X", mac="G1tu/JHAap6nWNQ5FTpMLhwoARg2t05pnQWvBIWM8Zk="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b25a6e26a453aaf41f55@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ can use `totp-2fa` verification (1044ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bf87707572d10196d13c@mozilla.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bf87707572d10196d13c@mozilla.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bf87707572d10196d13c@mozilla.com',
    authPW: 'd2e32ed71267e2e279454d1bfedd245948e5c3c7466271a7b0607b0d4d2e2bb3',
    authPW2: '4324c90812703cecaece6e75d652dac250df0590360ea151dcfb548cf5da10c0',
    wrapKb: 'd98434d7dd5814c59783bbc413005f8fcdd37922f125546d111ab5f54c90b12f',
    wrapKb2: 'c4be1cbdd4a5fbba8f587ff735d8821c9ecfd6d1a294b111116a3078c919ff29',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:963fcf72299e9116adabc551d6a8c59b3dbfefe0bf077f3b3f1c4fabc9a081f0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '68737f0622df49dab07c92c1fd250dda',
    sessionToken: 'ea46153531a107ec7aa95fecba626808b35d79194c6d0ce40485d71f3e0ff477',
    authAt: 1705108680
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '68737f0622df49dab07c92c1fd250dda',
    code: '89c1cba46bf2b8f96383c281da950980',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bf87707572d10196d13c@mozilla.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:963fcf72299e9116adabc551d6a8c59b3dbfefe0bf077f3b3f1c4fabc9a081f0',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:963fcf72299e9116adabc551d6a8c59b3dbfefe0bf077f3b3f1c4fabc9a081f0',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:963fcf72299e9116adabc551d6a8c59b3dbfefe0bf077f3b3f1c4fabc9a081f0',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bf87707572d10196d13c@mozilla.com',
    authPW: '4324c90812703cecaece6e75d652dac250df0590360ea151dcfb548cf5da10c0',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: 'email'
  }
}
!!! response success {
  body: {
    uid: '68737f0622df49dab07c92c1fd250dda',
    sessionToken: 'ee5a50043646e1ed269d3e6fd575f2ac9eabba120c5778f1d60a176a7a4b451b',
    authAt: 1705108681,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="77101d4293c6df4ba2044208876416bff99ca9c2056f99ae4b518d35a27672f0", ts="1705108681", nonce="meZv9N", mac="KZxvPP+yq4jnglOxHYivfzC7HHeQQer7Tj89sa34iIY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bf87707572d10196d13c@mozilla.com',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
      ✔ should ignore verificationMethod if not requesting keys (342ms)

  #integration - fetch user profile data 
    when a request is authenticated with a session token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '29ccefdbe202a306d3ea@restmail.net',
    authPW: 'fc6715b9649d15d493b8e9c13f20b8f025220368c673085e3b914dd88d4dfe8c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bb8c15ed9bcf4d058c368cda27ba65d7',
    sessionToken: 'a0f67603777aef9937772777e7bf232b6ca2f47a1e7cd492892fcf5172f33f40',
    authAt: 1705108681
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eff6d4e21c52416b4865b579df33f3cfaf92fb7e43c297d7e51f02c3a948f572", ts="1705108681", nonce="z4ThXW", mac="eUPX6G4hlFLsgJ6Qvb9r+zgWSOKS/iAchBiAoXk9ngo="'
  },
  json: true
}
!!! response success {
  body: {
    email: '29ccefdbe202a306d3ea@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108681287,
    metricsEnabled: true
  }
}
      ✔ returns the profile data
    when a request is authenticated with a valid oauth token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '793f4113033000634cee@restmail.net',
    authPW: 'e3d7893b5ee80208c547c87028b0ab502fca511c8b6f10f128381a87a28eac01',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b908e519aa3743ec984dc96593a94d8e',
    sessionToken: '410154308457392f4db8b056acff388060e6a7808af0f1156223c97d4ddedb3e',
    authAt: 1705108681
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'b908e519aa3743ec984dc96593a94d8e',
    code: '146c9e593d7cd2995e6fc44899f0a97a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6041f5635a4ee2e16b23992becfc2e67a231163303ceb421b3cb28137015d7fa", ts="1705108682", nonce="ZF8p7C", hash="dJXbaCdycuqR2HI6NrzOe5zkuAkH3t41hBNUGMH2two=", mac="eaPJmkn6vK4QMeIU52oMrX/KcOrH0OQtyWJHDGMfZaI="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MSwiaWF0IjoxNzA1MTA4NjgxLCJqdGkiOiJlNTQ5Yzc0OTNmYmVjZTgwMzFhN2Y4ZWJiMTcyYjcxNzg5ZmNiZGY4NWFhNjZhODY4ODg3OGRiNDliOWQyZTA0Iiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiYjkwOGU1MTlhYTM3NDNlYzk4NGRjOTY1OTNhOTRkOGUiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MTQ5OSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODE1ODJ9.niug-u6nNMzGWdC1pxEbXCMOH1BXJkq3RLTHJhhh5HQHGTADIoR8DO92OTfQcgQtK4InnlEkDg0QR3tb8weTq6r2v5Q_rwR0eklzonY2TJtytq4huLtgOEKgNOVS-AR4IBs7YTeUV6VmU2tLsYR5545iFS9Bwjb8GQnH5SJvNqa6bH-G_aaG4V6sI2fD_qGJ6ncdJWeaUQ4nLNjPt9B2QkhqyQM7XufN46StRHx0EnV751qTX3CD1Vf8bRDUBphqo9_bguDHbCbSsX_BlahCcvJC_yRD-rgVk1yF3jDR9reO9jq9s_9faStgP5nHAReENXYXyZXWvN1KwW22fMTeEw',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899,
    auth_at: 1705108681,
    refresh_token: '2a87bde45eebcfaf6278662578efd25669ce272b18c85c7f9b1ebceed92f95be'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MSwiaWF0IjoxNzA1MTA4NjgxLCJqdGkiOiJlNTQ5Yzc0OTNmYmVjZTgwMzFhN2Y4ZWJiMTcyYjcxNzg5ZmNiZGY4NWFhNjZhODY4ODg3OGRiNDliOWQyZTA0Iiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiYjkwOGU1MTlhYTM3NDNlYzk4NGRjOTY1OTNhOTRkOGUiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MTQ5OSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODE1ODJ9.niug-u6nNMzGWdC1pxEbXCMOH1BXJkq3RLTHJhhh5HQHGTADIoR8DO92OTfQcgQtK4InnlEkDg0QR3tb8weTq6r2v5Q_rwR0eklzonY2TJtytq4huLtgOEKgNOVS-AR4IBs7YTeUV6VmU2tLsYR5545iFS9Bwjb8GQnH5SJvNqa6bH-G_aaG4V6sI2fD_qGJ6ncdJWeaUQ4nLNjPt9B2QkhqyQM7XufN46StRHx0EnV751qTX3CD1Vf8bRDUBphqo9_bguDHbCbSsX_BlahCcvJC_yRD-rgVk1yF3jDR9reO9jq9s_9faStgP5nHAReENXYXyZXWvN1KwW22fMTeEw'
  },
  json: true
}
!!! response success {
  body: {
    email: '793f4113033000634cee@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108681582,
    metricsEnabled: true
  }
}
      ✔ returns the profile data (252ms)
      scopes are applied to profile data returned
        scope does not authorize profile data
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '063c21d7001bda1d60f0@restmail.net',
    authPW: '3d71063b9633adf286934a6f6313e01a17d7dc9a6ff80c4c0bc66d480688b384',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd288e029ad29450c9caab031380f2a2c',
    sessionToken: '0dc98437048ac0fe78943957ea27b0a9ce70bdb13a139511121185888745c913',
    authAt: 1705108681
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'd288e029ad29450c9caab031380f2a2c',
    code: '0f7968f49f4f9b031c8b5db3cb6c14ef',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="92c346fa6c0023b510bca8858844f6c25e5acc0827f1234a0cc825015f6353f7", ts="1705108682", nonce="1muW6P", hash="fi7RtmJ37aj7Vq3J8fCzTISHf5S7WXWt1lb13Cdx268=", mac="SqXcVRa7IisYrnl40TI/9QYM2J9DMiutLZqQzB0KUyo="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'preadinglist payments'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MSwiaWF0IjoxNzA1MTA4NjgxLCJqdGkiOiIyYjljZGM2MDJiMjdhYWFkMzQ5OWNiY2VmYjViODExNTYwN2Q2NjI1NWIzZjA2OTNiYWUwNDUxYTAyZmNiZmFkIiwic2NvcGUiOiJwcmVhZGluZ2xpc3QgcGF5bWVudHMiLCJzdWIiOiJkMjg4ZTAyOWFkMjk0NTBjOWNhYWIwMzEzODBmMmEyYyIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjgxNzQ2LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4MTgzNH0.Ewj5aMMEo7kNP1N3nIh-wl2Rfa9ddZTxTNHB-pBu7XQW7A6x0iEjJvCG6uFP1ATVrY60LuGXiaoNjMPBnmduRthXHyyl_yiQtuVuRId_CJvgTEfofGUxdRa3PFOTP6mdcdwL2uoomaDKVNl0TJ5T0mdcgBrtR979FmBqG8rnZxjOnK4zQve3LufFn1uEu5oJFmcFbHK5DLhWBuu_X7H5wXnervVnQUs_U7Z0_pplLpgMC4aco49SpKwAIjy6AnvVDlCXRmO0xdA46sL-j6b_pXltFLgMCfadoxh0MAGerg6kIq1728KmKzFTgYBHq6Ko-WOcv1IJvMoL9Il8CJzNJQ',
    token_type: 'bearer',
    scope: 'preadinglist payments',
    expires_in: 21899,
    auth_at: 1705108681,
    refresh_token: 'd660b91e8b30649bc3bfbed694647b9a595f0d4c92430ff7e201e54252a2c9ef'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MSwiaWF0IjoxNzA1MTA4NjgxLCJqdGkiOiIyYjljZGM2MDJiMjdhYWFkMzQ5OWNiY2VmYjViODExNTYwN2Q2NjI1NWIzZjA2OTNiYWUwNDUxYTAyZmNiZmFkIiwic2NvcGUiOiJwcmVhZGluZ2xpc3QgcGF5bWVudHMiLCJzdWIiOiJkMjg4ZTAyOWFkMjk0NTBjOWNhYWIwMzEzODBmMmEyYyIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjgxNzQ2LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4MTgzNH0.Ewj5aMMEo7kNP1N3nIh-wl2Rfa9ddZTxTNHB-pBu7XQW7A6x0iEjJvCG6uFP1ATVrY60LuGXiaoNjMPBnmduRthXHyyl_yiQtuVuRId_CJvgTEfofGUxdRa3PFOTP6mdcdwL2uoomaDKVNl0TJ5T0mdcgBrtR979FmBqG8rnZxjOnK4zQve3LufFn1uEu5oJFmcFbHK5DLhWBuu_X7H5wXnervVnQUs_U7Z0_pplLpgMC4aco49SpKwAIjy6AnvVDlCXRmO0xdA46sL-j6b_pXltFLgMCfadoxh0MAGerg6kIq1728KmKzFTgYBHq6Ko-WOcv1IJvMoL9Il8CJzNJQ'
  },
  json: true
}
!!! response success { body: {} }
          ✔ returns no profile data (243ms)
        limited oauth scopes for profile data
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'ae0116949da83f301e89@restmail.net',
    authPW: 'fa58dec78197a9490793a233316fce125861b1885d85fc54d28ad33df6e5ee0d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b3a29e1aee38462e920771bfde1b455f',
    sessionToken: '6e2bb4420230da6569b4f9b6995c410b2879e87e2e0cb98e6173bc00872eb1d5',
    authAt: 1705108682
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'b3a29e1aee38462e920771bfde1b455f',
    code: '6a044e7ddeb578ab54f70f7b8018cbf0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="aae3a16dfc584bfa6581053f211063103774f3d42379e3c241c4d9ed9a0b03e7", ts="1705108682", nonce="v75fc4", hash="yebzjR3J3hYSp0h7r9qqetpM0CunZEhOavNW0NZyUEU=", mac="4HzVcWkpUagtp/C4nKTwNGKBu8JcW1AAopSDRbA+Rxs="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiJlMmIyN2I5YzExZTc5ODQxYTliODk3ODk1NTkyMjQ3MTU2NDk3ZTA5MDk1ODNkMmM1Y2YzNDlkZmUwYjMzMDU2Iiwic2NvcGUiOiJwcm9maWxlOmVtYWlsIiwic3ViIjoiYjNhMjllMWFlZTM4NDYyZTkyMDc3MWJmZGUxYjQ1NWYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MTk4OSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODIwNjV9.WFRJCjHqxwSwslCs4vWlK-M2QuaHc3qcxJ9U07-viNPrbDNXo8D3dQqeW3SiVtfE7ZwzIqYlbmf56ELr1_Jo8X029qSXVzFegeJSj_4JfFc18SqU3jzYc0XnRE9w9mdQJe3SC2cwv4SbT2A9Ctrt7zxfWOUw4aI2RGQuh__HQPA9JBSwcsAoymL46IH7uNWEs-8hQRRcQ5EF4a1ETHmzTKLKZOOIKbCymMWBV6FM6DM5PNT99UO5DT0P6T7dO7yStxCkuz4xAOaO-z41aU7vvRW81sLHPOulqz9VB5oANgWeoWs6GAk08ot6fRMH8nfDAOWp3XtZnCJvMaHHp8EMng',
    token_type: 'bearer',
    scope: 'profile:email',
    expires_in: 21899,
    auth_at: 1705108682,
    refresh_token: 'cd8efcc965eb4b92a78e00835d77ec76fd5cdd5415fa86305854933c8320d2fe'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiJlMmIyN2I5YzExZTc5ODQxYTliODk3ODk1NTkyMjQ3MTU2NDk3ZTA5MDk1ODNkMmM1Y2YzNDlkZmUwYjMzMDU2Iiwic2NvcGUiOiJwcm9maWxlOmVtYWlsIiwic3ViIjoiYjNhMjllMWFlZTM4NDYyZTkyMDc3MWJmZGUxYjQ1NWYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MTk4OSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODIwNjV9.WFRJCjHqxwSwslCs4vWlK-M2QuaHc3qcxJ9U07-viNPrbDNXo8D3dQqeW3SiVtfE7ZwzIqYlbmf56ELr1_Jo8X029qSXVzFegeJSj_4JfFc18SqU3jzYc0XnRE9w9mdQJe3SC2cwv4SbT2A9Ctrt7zxfWOUw4aI2RGQuh__HQPA9JBSwcsAoymL46IH7uNWEs-8hQRRcQ5EF4a1ETHmzTKLKZOOIKbCymMWBV6FM6DM5PNT99UO5DT0P6T7dO7yStxCkuz4xAOaO-z41aU7vvRW81sLHPOulqz9VB5oANgWeoWs6GAk08ot6fRMH8nfDAOWp3XtZnCJvMaHHp8EMng'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ae0116949da83f301e89@restmail.net',
    profileChangedAt: 1705108682065,
    metricsEnabled: true
  }
}
          ✔ returns only email for email only token (230ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '12d2cab118a4f4f2b61c@restmail.net',
    authPW: '5ea3687589f6dc28305bc5870ecf0a28cdcacc4fd5c1988d9bff9b24579e988b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9aff9c97fd894eb5a80bcd7b941b6db6',
    sessionToken: 'a829b311a9c5ec4f8b5a26c3005deffa3e277b1dd316b9660b28702f8e02ab17',
    authAt: 1705108682
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '9aff9c97fd894eb5a80bcd7b941b6db6',
    code: '89df17e71102b1aa9848ca9e5670d3d7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8c823140cccceab87dc5b178a3ee3f9bae68681652c7d92c6d04bfd8f885a838", ts="1705108682", nonce="d4Wsu_", hash="dAR28RHTKpca6zkOWP2jjOyRT1eZPrZhBpc2hI2W5C4=", mac="5owlYtll3sG09o0qmoneKMV8Wj4Pr43d3tTTQMRGMoU="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:locale'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiIwMDg5ZDZjN2JhNTJmMTIyYmRlNTYyY2U3ZTZmMDIwNjViZDEyNDkyYWIzYWU0ZmQwYzQ5ZmVlMWI3NWI0MzMzIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjlhZmY5Yzk3ZmQ4OTRlYjVhODBiY2Q3Yjk0MWI2ZGI2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODIyMjUsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjgyMjg5fQ.cuH0rpfezUSl9Cghh60yslsdYvO7FRt5YtX6QBsAwHPp7zaGXlCBRDZ96zW9LPK3Nmy47fPj1Q3IFLCrdF7LzABn2s_u8xLn0JzqWxtkH_RS_UHqm_b1a9dALKFRlD1vPlqquSWQFBmWx62h4MiThq742p9-fwigRgk1Umk9rj2HAr7QN13shtdG2rMIkFVwqykmi-SbDu0CroI4xM_2wwjUWY-zSkpqB53F4Wz0zum-i9OoUJLiqQwjPXCIVAeDagkGojAZPVIDhGQv506yMMgcVpNRJxAbc1Szf_O1nQ1GeIPQESmOdWd_C8YwDNykXONGGZrbtOzP-INsHIPClA',
    token_type: 'bearer',
    scope: 'profile:locale',
    expires_in: 21899,
    auth_at: 1705108682,
    refresh_token: '0f97e5676698b1d436e2cb1af4c7437b4c50f329327943a0b766d9c52b47022e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiIwMDg5ZDZjN2JhNTJmMTIyYmRlNTYyY2U3ZTZmMDIwNjViZDEyNDkyYWIzYWU0ZmQwYzQ5ZmVlMWI3NWI0MzMzIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjlhZmY5Yzk3ZmQ4OTRlYjVhODBiY2Q3Yjk0MWI2ZGI2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODIyMjUsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjgyMjg5fQ.cuH0rpfezUSl9Cghh60yslsdYvO7FRt5YtX6QBsAwHPp7zaGXlCBRDZ96zW9LPK3Nmy47fPj1Q3IFLCrdF7LzABn2s_u8xLn0JzqWxtkH_RS_UHqm_b1a9dALKFRlD1vPlqquSWQFBmWx62h4MiThq742p9-fwigRgk1Umk9rj2HAr7QN13shtdG2rMIkFVwqykmi-SbDu0CroI4xM_2wwjUWY-zSkpqB53F4Wz0zum-i9OoUJLiqQwjPXCIVAeDagkGojAZPVIDhGQv506yMMgcVpNRJxAbc1Szf_O1nQ1GeIPQESmOdWd_C8YwDNykXONGGZrbtOzP-INsHIPClA'
  },
  json: true
}
!!! response success {
  body: {
    locale: 'en-US',
    profileChangedAt: 1705108682289,
    metricsEnabled: true
  }
}
          ✔ returns only locale for locale only token (224ms)
        profile authenticated with :write scopes
          profile:write
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'dede1e9919ddf4de3159@restmail.net',
    authPW: 'c530aeb378df291cc9cc168e53d8457e2814b18602ed00d5c36d70e71bc93c4a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6eb5f449900d4f95ad336fe6c76890ee',
    sessionToken: 'f1ef7bd459ab815c04fb05d3f2b1cd2b05d1f24b464e5cdda9560ad0c931526c',
    authAt: 1705108682
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '6eb5f449900d4f95ad336fe6c76890ee',
    code: '8002f8cb6d4427ef40c7d48572a9c8be',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="977d2eb97d6d35d026213bf6843651b76de8e38e8e6aa5540b4037ef6c8d9c00", ts="1705108683", nonce="W9kObO", hash="0q8Pgm5n5aAWhO14Pj5niTQlxr73JkLAoLS80JHLU8I=", mac="YSgkOWAjkH/NqBbA2E7ne9gjIGgKLdwAUd9y9v90iR0="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:write'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiIwYTcyMjlmNmUwNjliM2ZjOTA4Y2U3MWJlZWNmZWJkYzFjYmJlNzUxYTUxOTQxMmYzMzIwZjdlN2RjOWZkZmE2Iiwic2NvcGUiOiJwcm9maWxlOndyaXRlIiwic3ViIjoiNmViNWY0NDk5MDBkNGY5NWFkMzM2ZmU2Yzc2ODkwZWUiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MjQ0MywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODI1MTl9.T-Mb0F2fOMVpJesSn9JhQy5RrCFPEmE-nATL5G76-D0dqIWPsZ0VCdcPOpNxXHKQ9nD_8L_Dn04uqXeAKqz6IwsqRBNrjToc3g8tpoSLkEqxSrYdejdFbz9mi9iFJCjZvBsD6Pg0COw-Y15hasFGGDkoEG_KyvNnZhNErbw1GQexg1GJGaoiTE8gbQqdjiJ4jmssn_U59U9oFtiMjq4uxvZee14aTFU9z2w1Uyrxx1ffzoCg69W0G0j_H_eIEWtTcqcBMlzeW4YqLdErKLmIqI53zUf-Ce32UuMAbafvlUw5X7d8XFkkYmdGzH6DxDG3Ov77P1RikR_sKctLVgG1xg',
    token_type: 'bearer',
    scope: 'profile:write',
    expires_in: 21899,
    auth_at: 1705108682,
    refresh_token: 'e352954666f456316d7dbd2b03d3a103ccca2fc1278c6558d3298dd3cd208943'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiIwYTcyMjlmNmUwNjliM2ZjOTA4Y2U3MWJlZWNmZWJkYzFjYmJlNzUxYTUxOTQxMmYzMzIwZjdlN2RjOWZkZmE2Iiwic2NvcGUiOiJwcm9maWxlOndyaXRlIiwic3ViIjoiNmViNWY0NDk5MDBkNGY5NWFkMzM2ZmU2Yzc2ODkwZWUiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MjQ0MywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODI1MTl9.T-Mb0F2fOMVpJesSn9JhQy5RrCFPEmE-nATL5G76-D0dqIWPsZ0VCdcPOpNxXHKQ9nD_8L_Dn04uqXeAKqz6IwsqRBNrjToc3g8tpoSLkEqxSrYdejdFbz9mi9iFJCjZvBsD6Pg0COw-Y15hasFGGDkoEG_KyvNnZhNErbw1GQexg1GJGaoiTE8gbQqdjiJ4jmssn_U59U9oFtiMjq4uxvZee14aTFU9z2w1Uyrxx1ffzoCg69W0G0j_H_eIEWtTcqcBMlzeW4YqLdErKLmIqI53zUf-Ce32UuMAbafvlUw5X7d8XFkkYmdGzH6DxDG3Ov77P1RikR_sKctLVgG1xg'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dede1e9919ddf4de3159@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108682519,
    metricsEnabled: true
  }
}
            ✔ returns profile data (228ms)
          profile:locale:write readinglist
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'd9a975ef044c71d508a0@restmail.net',
    authPW: '288279b78dfa4659bf5cc83b422ef69c9d3169a664c9a57f97b5ed85ba2552cc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cbcf1d94081648e699490ee380979e6a',
    sessionToken: '6cbbcf5c48d499cdf4037d4c7311af37f9c78f16a7160874f2d79174f7b61c79',
    authAt: 1705108682
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'cbcf1d94081648e699490ee380979e6a',
    code: '991ba68eb5622595a266ad438872ea80',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="71485d079907e72d5d5e6fe6f67d5eb1b04986cf1cae1e01d8f52ddc92ebe832", ts="1705108683", nonce="9_Fr5L", hash="tmwbErAafsrSs0xngjpvgXlQ/ATz3BjWp3M1YTUE7cc=", mac="BbU8yQwTmi2ckPQbRtzpUuTYsnFfTgK5v9nZ8BpAmZA="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:locale:write readinglist'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiI0Zjg1ZWU1YTVmMTRjMGVjZjcxNTc3ZTZmNGQxYjBiY2E2NjljZWMwMzJiYjc4N2EwNDhjNjFhYzIyMTg1NGZhIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZTp3cml0ZSByZWFkaW5nbGlzdCIsInN1YiI6ImNiY2YxZDk0MDgxNjQ4ZTY5OTQ5MGVlMzgwOTc5ZTZhIiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODI2NzIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjgyNzUyfQ.YHNazcHjgbEdRO_yENmI2Zs9cAUS-oE5m5bkta6qRTpKpOny-3NHOdWaFpSSwFJizSxJUzqU4U9FFHnMbU95YzyctQIfzsII5m4efcA1JYG48tbBhumxpu5yLYVL9zx7BV0HggR3fBQxGomfCkfI7s7_CIVYdgWNlAcmehYM0Ig1XNrbJyz-QVpXMOob4ANoyLOQ44xjT5ZmTYSKJqj7-7uRAq8BFdAt-WTxZ7kjEZ0l2a58SlmoatJzdilZwBLYbu9Yuj4UNoobc_6y_nqmULjAJTQMo7sp1z3QXcMTgr8EhmzPIKXtrRSOMRL5jybV666ThQchMM478WakQpVhgg',
    token_type: 'bearer',
    scope: 'profile:locale:write readinglist',
    expires_in: 21899,
    auth_at: 1705108682,
    refresh_token: '70bc937407ef24fb60c9b5a5e99e7fb1038be8941d624a3ba412c075596db320'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MiwiaWF0IjoxNzA1MTA4NjgyLCJqdGkiOiI0Zjg1ZWU1YTVmMTRjMGVjZjcxNTc3ZTZmNGQxYjBiY2E2NjljZWMwMzJiYjc4N2EwNDhjNjFhYzIyMTg1NGZhIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZTp3cml0ZSByZWFkaW5nbGlzdCIsInN1YiI6ImNiY2YxZDk0MDgxNjQ4ZTY5OTQ5MGVlMzgwOTc5ZTZhIiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODI2NzIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjgyNzUyfQ.YHNazcHjgbEdRO_yENmI2Zs9cAUS-oE5m5bkta6qRTpKpOny-3NHOdWaFpSSwFJizSxJUzqU4U9FFHnMbU95YzyctQIfzsII5m4efcA1JYG48tbBhumxpu5yLYVL9zx7BV0HggR3fBQxGomfCkfI7s7_CIVYdgWNlAcmehYM0Ig1XNrbJyz-QVpXMOob4ANoyLOQ44xjT5ZmTYSKJqj7-7uRAq8BFdAt-WTxZ7kjEZ0l2a58SlmoatJzdilZwBLYbu9Yuj4UNoobc_6y_nqmULjAJTQMo7sp1z3QXcMTgr8EhmzPIKXtrRSOMRL5jybV666ThQchMM478WakQpVhgg'
  },
  json: true
}
!!! response success {
  body: {
    locale: 'en-US',
    profileChangedAt: 1705108682752,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (233ms)
          profile:email:write storage
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '199daa257df99fb59f5e@restmail.net',
    authPW: 'e55e3b0b54c329face246166a7e233f82e5c5be5088009ffc8fc93b333b9f418',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ae73c990417c46b1b27c0da55e175286',
    sessionToken: '060059008d12123be1f6c78d04194ee14e43ad034770f5011c187bf2f92be92d',
    authAt: 1705108682
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'ae73c990417c46b1b27c0da55e175286',
    code: 'e98ab95fb751ecd90dc3435a12c7c43c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d582ab345be1b63da66cd3a45d32e38871678a2183ab6dda1670307eff15e2a7", ts="1705108683", nonce="MgEuqC", hash="GjoreVEj7xkco9RxQII1L8HfUXA2AMfiblASqu7Xk7s=", mac="f5Ov5U2Nzi0BdZM1w7paoHJc8YORU4IOnQex2HKunKA="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email:write storage'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIyZTFmMDlhOWY1MjAxYjdmNjNlYjhjNTI5MTI1NzhkYWRjNmUyN2YxMGIxNWI3YzhlNTZiYWEzODgyZTkwMjUwIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHN0b3JhZ2UiLCJzdWIiOiJhZTczYzk5MDQxN2M0NmIxYjI3YzBkYTU1ZTE3NTI4NiIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjgyOTA3LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4Mjk5OX0.OsCDD1vGKWA5JglHj68GWUZp2T0rciL5C_3jevrORD9WWQAnKdamN0lha6UImXAFN_DNezVf7Y0lLnrGYFgGd4N-0YkYn9etU6831rDu3LnzlDyMw3HGXrz6exIX_pdUvGMVl19smI8tYCG2a4_d_XEQgM_jPSqR-foSvPTsu7RGJRE0_6cTHgvO563t3OguS5Dc5aufhh-ns_K9yxbf1c_4_VHlS-55Ek7hllNBOJrP04W3cGKoe_LsDZ6uip5p_xfsZX8cf2aaXOctPCKjbEPwUdVgoFLp9mIvh2wAQBss7mkZIEPEP0uPLRs0w-JIGKHqMyoNtmrXb51TL5sLhw',
    token_type: 'bearer',
    scope: 'profile:email:write storage',
    expires_in: 21899,
    auth_at: 1705108682,
    refresh_token: '6fd77706909348b1aca833a8aea1e1cd10336580725eaf3935be9630a30e5dc2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIyZTFmMDlhOWY1MjAxYjdmNjNlYjhjNTI5MTI1NzhkYWRjNmUyN2YxMGIxNWI3YzhlNTZiYWEzODgyZTkwMjUwIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHN0b3JhZ2UiLCJzdWIiOiJhZTczYzk5MDQxN2M0NmIxYjI3YzBkYTU1ZTE3NTI4NiIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjgyOTA3LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4Mjk5OX0.OsCDD1vGKWA5JglHj68GWUZp2T0rciL5C_3jevrORD9WWQAnKdamN0lha6UImXAFN_DNezVf7Y0lLnrGYFgGd4N-0YkYn9etU6831rDu3LnzlDyMw3HGXrz6exIX_pdUvGMVl19smI8tYCG2a4_d_XEQgM_jPSqR-foSvPTsu7RGJRE0_6cTHgvO563t3OguS5Dc5aufhh-ns_K9yxbf1c_4_VHlS-55Ek7hllNBOJrP04W3cGKoe_LsDZ6uip5p_xfsZX8cf2aaXOctPCKjbEPwUdVgoFLp9mIvh2wAQBss7mkZIEPEP0uPLRs0w-JIGKHqMyoNtmrXb51TL5sLhw'
  },
  json: true
}
!!! response success {
  body: {
    email: '199daa257df99fb59f5e@restmail.net',
    profileChangedAt: 1705108682999,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (272ms)
          profile:email:write profile:amr
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '2cc8980c3574473c042c@restmail.net',
    authPW: '8918884b02250de1700b9a6f1584af4e04e771e51b43a6df0ae28353294904b3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '22864a17eab144cfb61ae37be4e4044f',
    sessionToken: '9ec3bdb9553ff63ffc6a47cff463e40e06db1394126ecfa1d4ceed7024185ef5',
    authAt: 1705108683
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '22864a17eab144cfb61ae37be4e4044f',
    code: '0896b9ef672dc17a7cd58c6a56b1536b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ab3139ea518bb5e214875606625c68fb33fb626f27494e521cea7f7cfc3b142", ts="1705108683", nonce="joIMOM", hash="Hoa4bMu6ESKxjNrHTRwBYCQ/DHNqRGF9JTy0chVcU9A=", mac="LHqJts+OLsf5DI9N/T5YlbxO+IUyVu8WEEurHMNH0ks="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email:write profile:amr'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIzY2UxOGRjMjA1ODk2NzQxMzQxZDEwMjBkZjhmMDQ0NWVmMjZiMTdjMDAwMGM5MmNmZDhiODhlMjg2MzM5YjQ3Iiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHByb2ZpbGU6YW1yIiwic3ViIjoiMjI4NjRhMTdlYWIxNDRjZmI2MWFlMzdiZTRlNDA0NGYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MzE4MywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODMyNzJ9.Y6RwDgBd5WN4JCwsXU5pzzxYEEZHGHiG24RlMGtQLWw7Y3DVh-yJKxZOwJYOUj9oVgmbpKDBnlZ_shtV_wNBKQUKkQzyu7NsXZLvXyNwU0Eu7OwcNnI58Ukmo34EeefUWj70MUh7vgSlVYVirEXw_fEBPJhPg0bR3VuO0_ZOhvk7qa4C6lTl9_kwsINM0Fh2RAFwA0lQJwFDEEVmYpJyaroMrkmiZTQUCSeGsMB25bHEbTPw3lfauyTTgu4cw_CY1QZK12ICxlSqWLv6qvolWRfcldW9I0I6BIrXIViPXE8Ztxolrkp6XWYE39mMHnedUIcbFuxl5hmgljqZsiGmPQ',
    token_type: 'bearer',
    scope: 'profile:email:write profile:amr',
    expires_in: 21899,
    auth_at: 1705108683,
    refresh_token: 'b80cd30c790f62405ccc4179c6307bca3f095eeb7236a420d7fee09ec91179ba'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIzY2UxOGRjMjA1ODk2NzQxMzQxZDEwMjBkZjhmMDQ0NWVmMjZiMTdjMDAwMGM5MmNmZDhiODhlMjg2MzM5YjQ3Iiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHByb2ZpbGU6YW1yIiwic3ViIjoiMjI4NjRhMTdlYWIxNDRjZmI2MWFlMzdiZTRlNDA0NGYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MzE4MywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODMyNzJ9.Y6RwDgBd5WN4JCwsXU5pzzxYEEZHGHiG24RlMGtQLWw7Y3DVh-yJKxZOwJYOUj9oVgmbpKDBnlZ_shtV_wNBKQUKkQzyu7NsXZLvXyNwU0Eu7OwcNnI58Ukmo34EeefUWj70MUh7vgSlVYVirEXw_fEBPJhPg0bR3VuO0_ZOhvk7qa4C6lTl9_kwsINM0Fh2RAFwA0lQJwFDEEVmYpJyaroMrkmiZTQUCSeGsMB25bHEbTPw3lfauyTTgu4cw_CY1QZK12ICxlSqWLv6qvolWRfcldW9I0I6BIrXIViPXE8Ztxolrkp6XWYE39mMHnedUIcbFuxl5hmgljqZsiGmPQ'
  },
  json: true
}
!!! response success {
  body: {
    email: '2cc8980c3574473c042c@restmail.net',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108683272,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (247ms)
    when the profile data is not default
      when the email address is unicode
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1d32193eb5a814987fdeӒ@ᘮrestmail.net',
    authPW: 'c3e7db611104d7a4e5570b956f3ab74a638a03a07ed512ea3e87be0127c6873b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '85ec86bb8bb348cd87cd14745ccf37bc',
    sessionToken: '665e6a6443168c4d530bd930afe374b334caa9f9f1b5faab993593e4a88d40ed',
    authAt: 1705108683
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4cfb9090b10c4950987d04c05284d888044f5d5ad51d296551766885fb0240d7", ts="1705108683", nonce="Xjj1c_", mac="QHAz1pf10/eESoSk2S6UbTJc3DAYSnulwCR+n14bczc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '1d32193eb5a814987fdeӒ@ᘮrestmail.net',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108683426,
    metricsEnabled: true
  }
}
        ✔ returns the email address correctly with the profile data (193ms)
      when the account has TOTP
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'e9a58c598e1b10d7a64e@restmail.net',
    authPW: 'ca2029689f8b1c042536da1e8fa6ffda4596fee6fc67e316491f2bd098aec72e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1ca36d5ccbff4981ae8a8909ba2923e1',
    sessionToken: '00db01aee1dd0cc38ede90ca15f64001331bbd47e13bddd64c6cdb703698c1fd',
    authAt: 1705108683
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '1ca36d5ccbff4981ae8a8909ba2923e1',
    code: '238e75e0a5217c8a7a763205ffaafed4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a424b729d20815710b1276b559100774fcbfd3307347360a3c5b83f5d5321b78", ts="1705108684", nonce="yXyljb", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="uaAoOz0ZNiBkLMOf53rSXZ6Wgya6zugLHe36wNh4ztw="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JJTUCMCHPI2W23CPM5DFM3LSGRMDA4T2',
    recoveryCodes: [ 'wt01wr3n87', 'jaafac992p', '7r5bztzc28' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a424b729d20815710b1276b559100774fcbfd3307347360a3c5b83f5d5321b78", ts="1705108684", nonce="FpX0KR", hash="sm8mF5rXyg8D4Dj1JPdf1H7dAXrbKGw3ZTRXkfOzBSc=", mac="Sh3AhuUOxMqVXQAriWlOhjQP2wD577AWyrEUIo4m3ag="'
  },
  json: { code: '919565', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a424b729d20815710b1276b559100774fcbfd3307347360a3c5b83f5d5321b78", ts="1705108684", nonce="kayjuy", hash="dJXbaCdycuqR2HI6NrzOe5zkuAkH3t41hBNUGMH2two=", mac="uCRZtfLlwbU5fQaGgtI0U/qPovSJGMFKyOfUX4PzD7c="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIwYjQzZGI4MTBjMDk3NjhiY2IxZTNhZGYwNTczMzJhOGRkZGVmMjY0MjVjNGUwOWRjMGYwNGVjYWRmODIwMWUxIiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiMWNhMzZkNWNjYmZmNDk4MWFlOGE4OTA5YmEyOTIzZTEiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MzYxOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODM4OTh9.P6MjpjF_B9Q49Ms8Iezk1Zc8-ZGZ46cfIsXPK9jEF-9Rt_tPqNxEz4H3p4NzI1S1FPypa_Rr_gKh7ycIRUlJfTayVsZgJhatxPXfY6NRmAvmL9bIzGt3-KLnIQA-mxa5KrN6ZE07gqFipYLw3Vk9WEd8gepgF8tYowttNWDE1QmMTnqb3LnBLn4O8IlgZnOIzEIqXORHlp1-xrJ6jEJhMKW3lcaE_CUpog0qZ8n8Ue6CDrXwGBBcJx7Qei_XPj32LnZngfzcuZYKpJZhgL3xsz-JzJh-KGDffy8fOa2ftdAR-9Xg_rz9kmW2k7RoYoqgkDYEqaNk_wOIdA1R08CASQ',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899,
    auth_at: 1705108683,
    refresh_token: 'dab1bfa054dd62c73c3be49e605e746ecad600a8025dc9fb09000f1dce1725f5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4MywiaWF0IjoxNzA1MTA4NjgzLCJqdGkiOiIwYjQzZGI4MTBjMDk3NjhiY2IxZTNhZGYwNTczMzJhOGRkZGVmMjY0MjVjNGUwOWRjMGYwNGVjYWRmODIwMWUxIiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiMWNhMzZkNWNjYmZmNDk4MWFlOGE4OTA5YmEyOTIzZTEiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4MzYxOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODM4OTh9.P6MjpjF_B9Q49Ms8Iezk1Zc8-ZGZ46cfIsXPK9jEF-9Rt_tPqNxEz4H3p4NzI1S1FPypa_Rr_gKh7ycIRUlJfTayVsZgJhatxPXfY6NRmAvmL9bIzGt3-KLnIQA-mxa5KrN6ZE07gqFipYLw3Vk9WEd8gepgF8tYowttNWDE1QmMTnqb3LnBLn4O8IlgZnOIzEIqXORHlp1-xrJ6jEJhMKW3lcaE_CUpog0qZ8n8Ue6CDrXwGBBcJx7Qei_XPj32LnZngfzcuZYKpJZhgL3xsz-JzJh-KGDffy8fOa2ftdAR-9Xg_rz9kmW2k7RoYoqgkDYEqaNk_wOIdA1R08CASQ'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e9a58c598e1b10d7a64e@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email', 'otp' ],
    authenticatorAssuranceLevel: 2,
    profileChangedAt: 1705108683898,
    metricsEnabled: true
  }
}
        ✔ returns correct TOTP status in profile data (473ms)
      when the locale is empty
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '408b13ed1e4d336196cd@restmail.net',
    authPW: '848a823e74c11bd0ff205a0123577234360fb9bb47e41e50bb6461094b04b8df',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7c93979367644e9ab05cbe455251ebf7',
    sessionToken: '07c7a6d292d16374b5e669d7b5bd0eb91a29f76eb8ebe59db167b9f0272b58ce',
    authAt: 1705108684
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7c93979367644e9ab05cbe455251ebf7',
    code: 'ccbc14eab968e47aebd8dd1a45a0b52c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="19d907ecfd16c36d0b3b2afd1b2b5bd5e3fcdcad484970fb279a09c677da56a6", ts="1705108684", nonce="mm0zq2", hash="BmmZ7Vt0DcHXEBi0YhnH2UWfcb7OTVlEgv+HI9nJ1e4=", mac="N4LrghOrxw2RCRg9kBWdKu5E/gQ/zo7jPO2LRW7Rlv0="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    scope: 'profile:locale'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NCwiaWF0IjoxNzA1MTA4Njg0LCJqdGkiOiIyZjYyY2RjMmNmZWRlNzExZWY5MWRlODFlNjVjNGM0MDU1ZTRjNGEzNTBkNTRkYjQxYmIxYTRiZTcyNDljZWQwIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjdjOTM5NzkzNjc2NDRlOWFiMDVjYmU0NTUyNTFlYmY3IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODQwOTIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg0MTY3fQ.Cdxw0PTFSrjabeJQ4sWb4hPuPJJBvnvjMzDBJyiBJZKvV1jyQF2-3vDqQIWza3Dg50lEQ-IEvccHmnY1AmppglqEq6_MXwb-IRbijLrPTFXdUaYmk7fu4YXCxjCF_2rv10AW2GcXkb4oSP4ttHstpwo6jwHeFbuBxsJ3JecgPNhC-4m4SfF7cyFelRGd3XVlXLcRKAJWit2spNoA8uIJvYC_g3J3DgCK_EJgQ1WwMj-Gx-gFOhsJHNL7CMO194IexBVI3bgTkVWiLiIEYcW6wXhC2HHYNg4YtAusFE-t21Cfjg8OiOiPpVk3iIsbPHVXd7gRlaFqyWlFw9_zDVkvFQ',
    token_type: 'bearer',
    scope: 'profile:locale',
    expires_in: 21899,
    auth_at: 1705108684
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NCwiaWF0IjoxNzA1MTA4Njg0LCJqdGkiOiIyZjYyY2RjMmNmZWRlNzExZWY5MWRlODFlNjVjNGM0MDU1ZTRjNGEzNTBkNTRkYjQxYmIxYTRiZTcyNDljZWQwIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjdjOTM5NzkzNjc2NDRlOWFiMDVjYmU0NTUyNTFlYmY3IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODQwOTIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg0MTY3fQ.Cdxw0PTFSrjabeJQ4sWb4hPuPJJBvnvjMzDBJyiBJZKvV1jyQF2-3vDqQIWza3Dg50lEQ-IEvccHmnY1AmppglqEq6_MXwb-IRbijLrPTFXdUaYmk7fu4YXCxjCF_2rv10AW2GcXkb4oSP4ttHstpwo6jwHeFbuBxsJ3JecgPNhC-4m4SfF7cyFelRGd3XVlXLcRKAJWit2spNoA8uIJvYC_g3J3DgCK_EJgQ1WwMj-Gx-gFOhsJHNL7CMO194IexBVI3bgTkVWiLiIEYcW6wXhC2HHYNg4YtAusFE-t21Cfjg8OiOiPpVk3iIsbPHVXd7gRlaFqyWlFw9_zDVkvFQ'
  },
  json: true
}
!!! response success { body: {} }
        ✔ returns the profile data successfully (224ms)

  #integration - fetch user profile data V2
    when a request is authenticated with a session token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '20621367ec78d0610b5e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '20621367ec78d0610b5e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '20621367ec78d0610b5e@restmail.net',
    authPW: '673e96353b3b30944668bdf54b6133458e7a3102c77e6a3261400a89a8a8c4c7',
    authPW2: '5d134ca7263dbf3164740f97ff9222ab484b1be571301a2dcc0b35c4bd13b8f1',
    wrapKb: '2295a7a93eb67c7b8e644a4cdf93a7b64e10ed6748d0e9b4d01e4b30596c9611',
    wrapKb2: 'cf528f6fc5511d3258fcadbcb8e5e9d3f7f66212a62139980f23a70e3efa393b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5c93887b00ef1bd07e728f715ab5a8ccdb9a6622578256a3fcbb136b0f3e6f2a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f9b5123769474a30a3726f0718e01fba',
    sessionToken: '56df6edb25231f4015d81caf9fa9dff8c91f1a77bb3e9c6a2c6c6f86c9a83124',
    authAt: 1705108684
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c0b93baa2aa1f5a58dbf87c29af4dfc079da80a15fbef91ad810c90f8e4ed527", ts="1705108685", nonce="KQYCDk", mac="64JJUBHc1W7RWXQDq/fgu60lhtLZVc+fbTiMg7SD40g="'
  },
  json: true
}
!!! response success {
  body: {
    email: '20621367ec78d0610b5e@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108684647,
    metricsEnabled: true
  }
}
      ✔ returns the profile data
    when a request is authenticated with a valid oauth token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e1bcb7cee666cef32a8c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e1bcb7cee666cef32a8c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'e1bcb7cee666cef32a8c@restmail.net',
    authPW: '1a38102627632d3664e581d148dee6db40bb07d58704c0e1194500f3612f691f',
    authPW2: '557262aee3b7f7ec759ba2c174187d415c72ad6424aa2b68eb2b563a2a34b15c',
    wrapKb: '22fb4d2fb290c121df69500762db6acfcc66b708130dabf98b062347c181c3c2',
    wrapKb2: '7dd9c7ed8926073bc8a6b397b06d873bb4d1be5ca7856c6670664fbade03f8ec',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d6b3925e3abcb939b8fc023bb66eb67bc9ad5a91c676b2e4db370893a0508182',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '86061cb2d18e4178aba12e06f8f786ce',
    sessionToken: '2d279e4b5eb719d4b67ed64c68fa59dbb3683d51781f452479bc4d23730bd59e',
    authAt: 1705108685
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '86061cb2d18e4178aba12e06f8f786ce',
    code: '2c83ae7c84105d377bcc2483d2196d1c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="951da763cc3bb3988567878105aa04042b931dbc05d98c91b009386b2d7f2033", ts="1705108685", nonce="tlHf7Z", hash="dJXbaCdycuqR2HI6NrzOe5zkuAkH3t41hBNUGMH2two=", mac="hX/1zmOSjYJ2yYq7u6c/42GZvN8AZOomkHKGRph8/4I="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NSwiaWF0IjoxNzA1MTA4Njg1LCJqdGkiOiJmOWFiYTdiYzA0ZjJjNjRkMmQwNmEyNTNkY2FjZDkzYWUyODA2YmVkYTM0Nzc4MTc3ZGM3NzkxYTRlYWYzMjFhIiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiODYwNjFjYjJkMThlNDE3OGFiYTEyZTA2ZjhmNzg2Y2UiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NTExNywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODUxOTl9.gOmEhEH36fNof3z743_Mse14d92CiZoSQEw0kfrkccyeJaYwShdLv4-30HdIJWWkKaM0Unmeh8PXVoxuZo_9T4aKzV506LY0QYuTuRHMs6_TMLdLa_c2SIJXM9HcJ7XhP2qZQYcQxgwDVvEDiWx_0_SK1hnYG2PG5phLQtFaAFfggE22rGbnKnrz7YWMLcnEinYAmNdFM1z9iKh9r2fOxlYxBql7FQMakx2BVZ0WEMO_NE7tW7VyZQbvjj73gehaBzpVPHaXCQKSBVNXGQP1V26B7Fq9Ipr4ps1aR4wnawDo4AEdxNInqNlso0SH_1nGmgXN6ILmK04Y27qqxy2I1A',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899,
    auth_at: 1705108685,
    refresh_token: '9774c1ae877fa07f64a3a62ee56ace147a219b1d1e8053e2ef01d89af8f5d6e4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NSwiaWF0IjoxNzA1MTA4Njg1LCJqdGkiOiJmOWFiYTdiYzA0ZjJjNjRkMmQwNmEyNTNkY2FjZDkzYWUyODA2YmVkYTM0Nzc4MTc3ZGM3NzkxYTRlYWYzMjFhIiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiODYwNjFjYjJkMThlNDE3OGFiYTEyZTA2ZjhmNzg2Y2UiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NTExNywiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODUxOTl9.gOmEhEH36fNof3z743_Mse14d92CiZoSQEw0kfrkccyeJaYwShdLv4-30HdIJWWkKaM0Unmeh8PXVoxuZo_9T4aKzV506LY0QYuTuRHMs6_TMLdLa_c2SIJXM9HcJ7XhP2qZQYcQxgwDVvEDiWx_0_SK1hnYG2PG5phLQtFaAFfggE22rGbnKnrz7YWMLcnEinYAmNdFM1z9iKh9r2fOxlYxBql7FQMakx2BVZ0WEMO_NE7tW7VyZQbvjj73gehaBzpVPHaXCQKSBVNXGQP1V26B7Fq9Ipr4ps1aR4wnawDo4AEdxNInqNlso0SH_1nGmgXN6ILmK04Y27qqxy2I1A'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e1bcb7cee666cef32a8c@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108685199,
    metricsEnabled: true
  }
}
      ✔ returns the profile data (509ms)
      scopes are applied to profile data returned
        scope does not authorize profile data
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e7f58be606dd1d8d5df8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e7f58be606dd1d8d5df8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'e7f58be606dd1d8d5df8@restmail.net',
    authPW: 'd4f346802db913f9b54ab3f851d1e0272f2634ba78d0a62fda9735f0b67c5232',
    authPW2: '8e846db9d3f4b14592db32f827da1ff70d9d81572187e4a469bf786586323b06',
    wrapKb: 'a37fa9400ce10ee8e0d504eb58796da17cc44c3861c8e1f5094b555bce714519',
    wrapKb2: '39010ec4340f900c9e1469a7e054f96d539011c8facc9daabb27a05d9174c27a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8baec04f1eca836f5dae34012cc780a0b5e653402556bc92c006623b1bc25f0d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '687a6a0d7ab4436c8521939a2378d535',
    sessionToken: '537b1abb593f329638a6579d7ec8cdb4581ef2df8b932a56333d5e68bb7f09a1',
    authAt: 1705108685
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '687a6a0d7ab4436c8521939a2378d535',
    code: 'ff8b586530a0ed46576aba89d5e3b229',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3b0739c52cac216b6f60c6b94fc62f71ec9287742e9c7b0e45c29596ae8c739a", ts="1705108686", nonce="XjwyrF", hash="fi7RtmJ37aj7Vq3J8fCzTISHf5S7WXWt1lb13Cdx268=", mac="yx5StwYReZpV3ESkCl01DS5EgRsCT7ZcnQU0rAiKrc4="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'preadinglist payments'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NSwiaWF0IjoxNzA1MTA4Njg1LCJqdGkiOiIxYTBiODEwZDc0MTAwMmRjNjgzNDBkMmYxYWRlYmU5Y2I4MmEzYjZhM2Q1NWY5YzM4M2JhNjAxMmQyNjI5ZTc3Iiwic2NvcGUiOiJwcmVhZGluZ2xpc3QgcGF5bWVudHMiLCJzdWIiOiI2ODdhNmEwZDdhYjQ0MzZjODUyMTkzOWEyMzc4ZDUzNSIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njg1NjMwLCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4NTcwOH0.NAC84LK63tUmU8NRHzufzc-7qtvrlaOaaU7hwqCcdpfuen2rg3p4ePRIz-Goqk1LZ8TMZzshxgbX-k9SL_QCXTcGlD3JOyAzYSdh7M0Ih0OGiUE8wKK4yPcp1OE27MqNcufwupQkF-0JDPNZpgmdawr8ztTUEISeOPkHVThNpk43Dy5Ie_L_bLCvZvs6MhOygFHLTL7evA4X2Nib9vUeLtY9wonPieHjthU3SAT3olvJGCz19DYuqvYZelnqgMEUa3Sv3RrSGFzrzU80D_O5dSurs_b53yvopMzX3hD6Cb3V1PuQpJcPwxR-SM_VSGUgC8HuAP2jRePtvQw2_a3QWg',
    token_type: 'bearer',
    scope: 'preadinglist payments',
    expires_in: 21899,
    auth_at: 1705108685,
    refresh_token: '1fdd6dbbdd846dea95430933cdc1d3d3c75d20b525fbf2479752c6c380b2ef45'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NSwiaWF0IjoxNzA1MTA4Njg1LCJqdGkiOiIxYTBiODEwZDc0MTAwMmRjNjgzNDBkMmYxYWRlYmU5Y2I4MmEzYjZhM2Q1NWY5YzM4M2JhNjAxMmQyNjI5ZTc3Iiwic2NvcGUiOiJwcmVhZGluZ2xpc3QgcGF5bWVudHMiLCJzdWIiOiI2ODdhNmEwZDdhYjQ0MzZjODUyMTkzOWEyMzc4ZDUzNSIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njg1NjMwLCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4NTcwOH0.NAC84LK63tUmU8NRHzufzc-7qtvrlaOaaU7hwqCcdpfuen2rg3p4ePRIz-Goqk1LZ8TMZzshxgbX-k9SL_QCXTcGlD3JOyAzYSdh7M0Ih0OGiUE8wKK4yPcp1OE27MqNcufwupQkF-0JDPNZpgmdawr8ztTUEISeOPkHVThNpk43Dy5Ie_L_bLCvZvs6MhOygFHLTL7evA4X2Nib9vUeLtY9wonPieHjthU3SAT3olvJGCz19DYuqvYZelnqgMEUa3Sv3RrSGFzrzU80D_O5dSurs_b53yvopMzX3hD6Cb3V1PuQpJcPwxR-SM_VSGUgC8HuAP2jRePtvQw2_a3QWg'
  },
  json: true
}
!!! response success { body: {} }
          ✔ returns no profile data (502ms)
        limited oauth scopes for profile data
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cf6a30b2bbe29055a234@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cf6a30b2bbe29055a234@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'cf6a30b2bbe29055a234@restmail.net',
    authPW: 'f921adc4b29f4f92dbb963bab9b28c07a77ecd6880917b7d32eff430e4d35c76',
    authPW2: '5cb21037e60c7b7a6823a3354f034538c200095ddc712d798ac228b6c938f2b2',
    wrapKb: '2599e3941d153f066c642a5b9a00154979d29695b384ec1ae8d6a3a8a4155a79',
    wrapKb2: '609073be0aef76a65a2c9114bb09cbbcff6e44e6412e6a09fba14c20e9b1fcd6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0c6738e35a36ffdeaec8936ada45583e5a7429b1a2f82dec4da9b8f0531100a8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9e78152a2c5b4633b084750d2b7211b9',
    sessionToken: 'cc792eddf62126f141620320f6ba101d958f2c2a66b5b90c43554fadab5436f6',
    authAt: 1705108686
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '9e78152a2c5b4633b084750d2b7211b9',
    code: '5b7a2e4c230484aebf87345008aef8b6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c68b5d64ac39d6f85af37bed432705db3ca84ac4522962a517266c8aec287a88", ts="1705108686", nonce="E6wl4B", hash="yebzjR3J3hYSp0h7r9qqetpM0CunZEhOavNW0NZyUEU=", mac="GkBlnk57F5AXc/XkPH/XfBfIqJuVOlOCCeWTwL3L1B0="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NiwiaWF0IjoxNzA1MTA4Njg2LCJqdGkiOiI2MGM4ZmE1MmY1MjQ5ZThhYmQ5M2MyMDkxOTcwZmY4Nzc1MjVmMTJjYzA2MDAyMjA2MWRiNWY5Zjk0MTgxNzMxIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsIiwic3ViIjoiOWU3ODE1MmEyYzViNDYzM2IwODQ3NTBkMmI3MjExYjkiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NjEyNSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODYyMDF9.KZ2aURRuhYTMkjhHoYUItljmr1kiO3PHrm5eqYIHtwUaJy-WvcIx6efa0U7tRPp6j4Dktw2S-pMZLH307G7LmJGUggKrxK1TpP9RpCtAnHRAoeFsTZeJYUyd0VxEojUbEgiQApY6_TWG2tElffyNaduyCHb7qgyludyFbALQReEFQu-0ogkBgqUIEaadYuLgnkLn02CLPnXXKBY2KOdNMrNPFEljtrX---9Qg8sTcwbO5GoNj-pxxIvZrz1zsjk0pFJfOGjOZEUDXNIdU9AiPnNSGU7X-mj4a-e38ToiOBCFFnXyr76a6IpJE49j_99Caf3mmFHuv3a475WNfdgk_A',
    token_type: 'bearer',
    scope: 'profile:email',
    expires_in: 21899,
    auth_at: 1705108686,
    refresh_token: 'c9e8df69c39a984d755d24c5102cb926f62c63aa0163877a91c57fd2ffb8b042'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NiwiaWF0IjoxNzA1MTA4Njg2LCJqdGkiOiI2MGM4ZmE1MmY1MjQ5ZThhYmQ5M2MyMDkxOTcwZmY4Nzc1MjVmMTJjYzA2MDAyMjA2MWRiNWY5Zjk0MTgxNzMxIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsIiwic3ViIjoiOWU3ODE1MmEyYzViNDYzM2IwODQ3NTBkMmI3MjExYjkiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NjEyNSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODYyMDF9.KZ2aURRuhYTMkjhHoYUItljmr1kiO3PHrm5eqYIHtwUaJy-WvcIx6efa0U7tRPp6j4Dktw2S-pMZLH307G7LmJGUggKrxK1TpP9RpCtAnHRAoeFsTZeJYUyd0VxEojUbEgiQApY6_TWG2tElffyNaduyCHb7qgyludyFbALQReEFQu-0ogkBgqUIEaadYuLgnkLn02CLPnXXKBY2KOdNMrNPFEljtrX---9Qg8sTcwbO5GoNj-pxxIvZrz1zsjk0pFJfOGjOZEUDXNIdU9AiPnNSGU7X-mj4a-e38ToiOBCFFnXyr76a6IpJE49j_99Caf3mmFHuv3a475WNfdgk_A'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cf6a30b2bbe29055a234@restmail.net',
    profileChangedAt: 1705108686201,
    metricsEnabled: true
  }
}
          ✔ returns only email for email only token (492ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c26065dafee625c80a75@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c26065dafee625c80a75@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'c26065dafee625c80a75@restmail.net',
    authPW: '5dc2337cd0a6bed345a24d0a2deeeb7463e7fadfc857a3439308abbbadd0b664',
    authPW2: '7a16952ef3381ac1855aaf9e7e98d010138263f55e9eef5004a0ed3a2c8c27ae',
    wrapKb: '889e0b3f57f682dfeabfe89b4f11592816e899257a35637995f97475b45d3a44',
    wrapKb2: 'c00a21fe9470f71a6ae658c86de852e1667362735ef659b95af6e22c8ba46a45',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b13eb4dd5a15ed3b622e423b1d3d17cfeb4beec705225e367b9fd2f8b61d34c0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '60a683ba1a6a4a30bc0a7bd2e1319f66',
    sessionToken: '1c2106d77ed34fa8705c5f669290c5dee6f81938949a955fe91b10f54fba17cb',
    authAt: 1705108686
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '60a683ba1a6a4a30bc0a7bd2e1319f66',
    code: '3ce3b28f5484a327dd9cff11a50aaa40',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a5cfa48b6521dd8fd34db890b382dd64a4df2d098966f0a50244d25f6caaa842", ts="1705108687", nonce="_o1UZp", hash="dAR28RHTKpca6zkOWP2jjOyRT1eZPrZhBpc2hI2W5C4=", mac="EKa4K2VuhH787KLWEPHrhFqZO4RTdnBe5N+Qyhx+Dc4="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:locale'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NiwiaWF0IjoxNzA1MTA4Njg2LCJqdGkiOiJhZTRiZGUxMzk5ZDViMmQ1N2IwNmU1OGQ3YWFmNWRkMTM2ZTI5YmZlZWUzZjJmMmY5ODlkMmM1OTlkZGUwMWQxIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjYwYTY4M2JhMWE2YTRhMzBiYzBhN2JkMmUxMzE5ZjY2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODY2MTYsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg2Njk0fQ.ESEKdP6vn3NgxLUtu6tuqyU5SXjR7Tx2GDbzFhoVd_Ocb8ueppRQLoZlTSXt4VsklTcrtIKsTj21ukY1o04uCZokkmoY6MreXFZcWYmC1PeJcGA3i1nY7U02LM3QIe-xwDyz3VA_JXDFgMOdYJzc17lQNWYZa2BbQsPdgY6s8Q17ysJh0fyzZYXSvt0OooTqFhVJPfgYGeaPorjWIhBiRhUA8lxPcNEsJGYDGUSbQBgBaSqqlfwx-h8j-QYYWWq4oV94A2KHQlnMhjsUQ_e1i17uaYMO2LJFIrPuW3d-hdamyzGLArfYdGmLmeteQyZxWWR1gIdtuvoyHdFyFs_QCg',
    token_type: 'bearer',
    scope: 'profile:locale',
    expires_in: 21899,
    auth_at: 1705108686,
    refresh_token: '0d62f8b3b4b51436b4e1477e481c05d1ce70d2ff655866a35a8088f47fd38800'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NiwiaWF0IjoxNzA1MTA4Njg2LCJqdGkiOiJhZTRiZGUxMzk5ZDViMmQ1N2IwNmU1OGQ3YWFmNWRkMTM2ZTI5YmZlZWUzZjJmMmY5ODlkMmM1OTlkZGUwMWQxIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjYwYTY4M2JhMWE2YTRhMzBiYzBhN2JkMmUxMzE5ZjY2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODY2MTYsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg2Njk0fQ.ESEKdP6vn3NgxLUtu6tuqyU5SXjR7Tx2GDbzFhoVd_Ocb8ueppRQLoZlTSXt4VsklTcrtIKsTj21ukY1o04uCZokkmoY6MreXFZcWYmC1PeJcGA3i1nY7U02LM3QIe-xwDyz3VA_JXDFgMOdYJzc17lQNWYZa2BbQsPdgY6s8Q17ysJh0fyzZYXSvt0OooTqFhVJPfgYGeaPorjWIhBiRhUA8lxPcNEsJGYDGUSbQBgBaSqqlfwx-h8j-QYYWWq4oV94A2KHQlnMhjsUQ_e1i17uaYMO2LJFIrPuW3d-hdamyzGLArfYdGmLmeteQyZxWWR1gIdtuvoyHdFyFs_QCg'
  },
  json: true
}
!!! response success {
  body: {
    locale: 'en-US',
    profileChangedAt: 1705108686694,
    metricsEnabled: true
  }
}
          ✔ returns only locale for locale only token (491ms)
        profile authenticated with :write scopes
          profile:write
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'aefdb38f43f85adfa062@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'aefdb38f43f85adfa062@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'aefdb38f43f85adfa062@restmail.net',
    authPW: '3979574f9c89ca9781867741201033eda9e946ba59aeac514d62ae25c3759621',
    authPW2: '15ca5f893c5178c186e455cdd07cc9b82cffc1e39d42642ff21ea4eb7ff50a3e',
    wrapKb: '8d9ed7ef7fc2d93631888cee30523fbbbeac56d8affbd8a36b00fa0d64040f73',
    wrapKb2: '2b43c71dad20b878b470a91c581b68e78e03f9fa41b5b9237f75f07b26eff8d3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:651427feaacbdcf8e494fe12a36fe2bdd37cfb34031f6c146af32507b0ecbe56',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f80099816e8e4b0cae249f849e77f733',
    sessionToken: '45c71e72fa560a7b1b215c7f21e6cb3015189876e4f0c70f873b990f6dbea0f8',
    authAt: 1705108687
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'f80099816e8e4b0cae249f849e77f733',
    code: 'b315c4d36f5c222a6ebb76957828ce64',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fd0b37e8db328a72e32e2da219295ca2386dc7e6c75a747fb75f9663c864cd56", ts="1705108687", nonce="RrNthN", hash="0q8Pgm5n5aAWhO14Pj5niTQlxr73JkLAoLS80JHLU8I=", mac="9yTM2/DZmi1c1stczs7tvGWT2uEgXJ8+saqW5wRUVV4="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:write'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NywiaWF0IjoxNzA1MTA4Njg3LCJqdGkiOiI2NzExYjEyZmM2YmM4OTdlMTYzZGM4M2M1OWNiZGQ3NjY0NDQ2ODc4NmYxOGY3NzgxYjZhODIzNzk0NDc1Nzc3Iiwic2NvcGUiOiJwcm9maWxlOndyaXRlIiwic3ViIjoiZjgwMDk5ODE2ZThlNGIwY2FlMjQ5Zjg0OWU3N2Y3MzMiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NzEwOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODcxODd9.ZzUyRB8tXio1W5WhtYyDFmlGQFGmTd3NWKkeJ4WnJ-wJgayEBho_XDVCsdmWT3k8BAoFg3VnlvUA-DfZEj_vij5GQ9J4KidlqRfr6EhfrumXeL_HtEdAnTUeQxcOFCYhRGqjMZErvwoZMBaCoeGaHDYAj5CaleXkORAMIlWoEHG50CklHiXMaXpVH44JWeGGYiPc6e7WCDaXtqBz0Khv63LrT1n98Z2WSMZyHX_YPdC5du66m6BBBe2ulTTMdGcNrODMbUamK47qZoYFNbszD1SFgg2qA2lIJAmp0mdOxPsjMMWoRo2DoNDf51HjQdDSqqX-Gy-Jryly08mLg8xW0Q',
    token_type: 'bearer',
    scope: 'profile:write',
    expires_in: 21899,
    auth_at: 1705108687,
    refresh_token: '7a7a3f8fb5f147e394554a9aea4789e574e0ba2bc89b9b206e19a9390400f38b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NywiaWF0IjoxNzA1MTA4Njg3LCJqdGkiOiI2NzExYjEyZmM2YmM4OTdlMTYzZGM4M2M1OWNiZGQ3NjY0NDQ2ODc4NmYxOGY3NzgxYjZhODIzNzk0NDc1Nzc3Iiwic2NvcGUiOiJwcm9maWxlOndyaXRlIiwic3ViIjoiZjgwMDk5ODE2ZThlNGIwY2FlMjQ5Zjg0OWU3N2Y3MzMiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4NzEwOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODcxODd9.ZzUyRB8tXio1W5WhtYyDFmlGQFGmTd3NWKkeJ4WnJ-wJgayEBho_XDVCsdmWT3k8BAoFg3VnlvUA-DfZEj_vij5GQ9J4KidlqRfr6EhfrumXeL_HtEdAnTUeQxcOFCYhRGqjMZErvwoZMBaCoeGaHDYAj5CaleXkORAMIlWoEHG50CklHiXMaXpVH44JWeGGYiPc6e7WCDaXtqBz0Khv63LrT1n98Z2WSMZyHX_YPdC5du66m6BBBe2ulTTMdGcNrODMbUamK47qZoYFNbszD1SFgg2qA2lIJAmp0mdOxPsjMMWoRo2DoNDf51HjQdDSqqX-Gy-Jryly08mLg8xW0Q'
  },
  json: true
}
!!! response success {
  body: {
    email: 'aefdb38f43f85adfa062@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108687187,
    metricsEnabled: true
  }
}
            ✔ returns profile data (497ms)
          profile:locale:write readinglist
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e4a0b6c3bc622e661f08@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e4a0b6c3bc622e661f08@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'e4a0b6c3bc622e661f08@restmail.net',
    authPW: '709a816ed2ed3a2de2ef74a5fbfb077903364de4ae91e54758cc103e04abb489',
    authPW2: 'd741b97c6692e0aab32614ef421835dc88b46c5e66a6e34f23126c1f4e82bc64',
    wrapKb: '5302a3c228d95b1a293b04fc18212e5e37c7f41e68c58c9fb55afdab8ca885a9',
    wrapKb2: '9556b28070cb9ea91c20632f52db799a8de034b9e7e77dd8dc6d0c00b43522f5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:15aebf1f42731090b80601d127b6ed795b2d2a2f408da54d03508859eb65d260',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '18e9136ac20640b9b0c7354519bc9dc0',
    sessionToken: '92cb46908b86dcac53c6e894b3e6cd6a3b6b6245c4551394dbba8a905323d8f3',
    authAt: 1705108687
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '18e9136ac20640b9b0c7354519bc9dc0',
    code: 'a7a2020a72ec4a49a4031ac550595b3a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ed673f1331c330f67f349cea14413f5abf66e1f47e7726e3f57535bf6a73984", ts="1705108688", nonce="tiwJsC", hash="tmwbErAafsrSs0xngjpvgXlQ/ATz3BjWp3M1YTUE7cc=", mac="0UtYG5YTQ3tb7DYnCBstxDgjGB52qEUZpndPX9nI9j4="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:locale:write readinglist'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NywiaWF0IjoxNzA1MTA4Njg3LCJqdGkiOiJmYjU3ZDUzOGI4NjU0YTNmMDJlMGRjOWM5NDQ4MGEwOWM0MmVjYzUwMGUwMjZlMDQ1ZDg4NjUzZDU4NmIzYWE0Iiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZTp3cml0ZSByZWFkaW5nbGlzdCIsInN1YiI6IjE4ZTkxMzZhYzIwNjQwYjliMGM3MzU0NTE5YmM5ZGMwIiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODc2MDUsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg3Njc4fQ.NgE8jehWD6yxwiLzNYsQPB4rq6JahRF06to072SDNDPaa0xSa08cDgK_LH5yg6Ps9TIebzcGcBexuU9byfhrzI1gtUGb512ZJX9D67j40lud2XduPXzsYpiLJFEVa_TG5REWlqebLF_kq73DRxBEuvVdhdtkWMCe4EQazjOMW0J17Ss_pu1ulBd9bK-IDhvSgZuTGIZWgxsBxBaa12jaQf0IDO0QadPQtU904vId0T-2FjR7lm_OyUlDG73uJpa8fdkyEwe5KQdk56Ii49HaWdUrrNSEGrb-55vrMfY_hauBVtj1L7fWWsGcLLboi_gBl0rUzHjW3OtT7f3goVpxNA',
    token_type: 'bearer',
    scope: 'profile:locale:write readinglist',
    expires_in: 21899,
    auth_at: 1705108687,
    refresh_token: 'd1bdf4810a39f31fc5b547a588f8b455280ccca33617d0391d4ff56a0da5ff02'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4NywiaWF0IjoxNzA1MTA4Njg3LCJqdGkiOiJmYjU3ZDUzOGI4NjU0YTNmMDJlMGRjOWM5NDQ4MGEwOWM0MmVjYzUwMGUwMjZlMDQ1ZDg4NjUzZDU4NmIzYWE0Iiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZTp3cml0ZSByZWFkaW5nbGlzdCIsInN1YiI6IjE4ZTkxMzZhYzIwNjQwYjliMGM3MzU0NTE5YmM5ZGMwIiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2ODc2MDUsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njg3Njc4fQ.NgE8jehWD6yxwiLzNYsQPB4rq6JahRF06to072SDNDPaa0xSa08cDgK_LH5yg6Ps9TIebzcGcBexuU9byfhrzI1gtUGb512ZJX9D67j40lud2XduPXzsYpiLJFEVa_TG5REWlqebLF_kq73DRxBEuvVdhdtkWMCe4EQazjOMW0J17Ss_pu1ulBd9bK-IDhvSgZuTGIZWgxsBxBaa12jaQf0IDO0QadPQtU904vId0T-2FjR7lm_OyUlDG73uJpa8fdkyEwe5KQdk56Ii49HaWdUrrNSEGrb-55vrMfY_hauBVtj1L7fWWsGcLLboi_gBl0rUzHjW3OtT7f3goVpxNA'
  },
  json: true
}
!!! response success {
  body: {
    locale: 'en-US',
    profileChangedAt: 1705108687678,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (487ms)
          profile:email:write storage
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd8ab49d296910a2a19d3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd8ab49d296910a2a19d3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'd8ab49d296910a2a19d3@restmail.net',
    authPW: 'b881798e42afd4ae23afeae691326636cb59b023a33976670a8571a545c3c3af',
    authPW2: 'c045e30847dec18d8912c4fc5023a710992779c3a15044b1f00d7d9aac9461a3',
    wrapKb: '77493568bbba21f2e2a192da10ccb7889639df0c9c6c806aaa098b3a28949c67',
    wrapKb2: '26886abea390fdc3fbfa32e7b846b670327058d2511f1f633238cd492a352b5b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c7a8afbfea6a29976ea89cd21184492d070634db22ccbeb041c702d3ded54b43',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7bd3652daa0442249f4206e3c9f7909f',
    sessionToken: 'f528490421c9b746378062adcd5659f626f9ee6a9927c23b7910347c354fb68a',
    authAt: 1705108688
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: '7bd3652daa0442249f4206e3c9f7909f',
    code: '40aa887ba79079625dbc890b8219d8d1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5dc582363057d89962aa30b580ce61300b6c37a28d23fdf73f477e4a043b0271", ts="1705108688", nonce="ufTSq2", hash="GjoreVEj7xkco9RxQII1L8HfUXA2AMfiblASqu7Xk7s=", mac="Ko01MAT8wQBlBdyuxExZ5eDAZIa2gIQEQP6QdP2k+w8="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email:write storage'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OCwiaWF0IjoxNzA1MTA4Njg4LCJqdGkiOiJhZjRkMzQ5MmRjZmMwNGM4ZTA2ZTcxYTA5OTNkYjY0MGE3YzM1NjBlMjk2MWQ0ZTgwMjE0MWUwMjQwYzllOTMyIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHN0b3JhZ2UiLCJzdWIiOiI3YmQzNjUyZGFhMDQ0MjI0OWY0MjA2ZTNjOWY3OTA5ZiIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njg4MDk0LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4ODE3MH0.BGAjbf6z5X4Ve84ZeC9dab3mQrIfHGx2xR7YygnuDKTkiKWSVCoBoaGZQRkxlpj5O2HqNLAkFPBkrWTBOfPv8ZiSz_74HdJgpwLMk3VwbVfudBa6dD4uFf-Jmx2SMhiuxzFC1xvf89oZlLOkCYqPVGsyapKrt-IsP8iGLGpsH2hUVaNe-swFMjZbcY4csPpg8tWkQOtNLlvy9wiBe9UUhfWiJGsUJBHkP84ZXxl7DhxBL2y-UXzARk8IxXk350aYslZoMyEh3kGJ04h-KvO7F5fHeKBuG03bdwYvk8nZZBzGeNWBixRAzUyJz2Ob86gJ24rpq95e3VhFdDyefmHiQw',
    token_type: 'bearer',
    scope: 'profile:email:write storage',
    expires_in: 21899,
    auth_at: 1705108688,
    refresh_token: 'dfe73ea88abd814755f48138f480222a4d9b3713c4484ef68dfdd60aa37a173d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OCwiaWF0IjoxNzA1MTA4Njg4LCJqdGkiOiJhZjRkMzQ5MmRjZmMwNGM4ZTA2ZTcxYTA5OTNkYjY0MGE3YzM1NjBlMjk2MWQ0ZTgwMjE0MWUwMjQwYzllOTMyIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHN0b3JhZ2UiLCJzdWIiOiI3YmQzNjUyZGFhMDQ0MjI0OWY0MjA2ZTNjOWY3OTA5ZiIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njg4MDk0LCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODY4ODE3MH0.BGAjbf6z5X4Ve84ZeC9dab3mQrIfHGx2xR7YygnuDKTkiKWSVCoBoaGZQRkxlpj5O2HqNLAkFPBkrWTBOfPv8ZiSz_74HdJgpwLMk3VwbVfudBa6dD4uFf-Jmx2SMhiuxzFC1xvf89oZlLOkCYqPVGsyapKrt-IsP8iGLGpsH2hUVaNe-swFMjZbcY4csPpg8tWkQOtNLlvy9wiBe9UUhfWiJGsUJBHkP84ZXxl7DhxBL2y-UXzARk8IxXk350aYslZoMyEh3kGJ04h-KvO7F5fHeKBuG03bdwYvk8nZZBzGeNWBixRAzUyJz2Ob86gJ24rpq95e3VhFdDyefmHiQw'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd8ab49d296910a2a19d3@restmail.net',
    profileChangedAt: 1705108688170,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (492ms)
          profile:email:write profile:amr
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '210f6cfe5a88b6fefeac@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '210f6cfe5a88b6fefeac@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '210f6cfe5a88b6fefeac@restmail.net',
    authPW: '450d6a1617dfabae428676ceeeb1a2b2fea1c6022dc45072c2f2f748e7f2a5b0',
    authPW2: '25589aac0409f64a3523971a30c8bd4a31aec7cb1b4e3e58d96ec1b0c049dc83',
    wrapKb: 'ba8e72b110b8b0e84701c61a93ae96520cb8a0f108bfee9ff8520b34298210d8',
    wrapKb2: '7348fa371c4028d2b7571195854878591927b8c4a5a9df3bec76f4c5bf2fa18f',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:31110a52a61547d05c9dd50574da5a5dacaea78ea1621b8919addd07c09b2fc3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c6fb9f3991f0445c9369cb2237c437f6',
    sessionToken: '7ff193b90e9aa6d6c65fd4ccb1730fe18731e65ddee7116aef3696134906df92',
    authAt: 1705108688
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'c6fb9f3991f0445c9369cb2237c437f6',
    code: '6e7a1a9a49a675ff104b0e5b1e8637ef',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c7b53b1bc884d46c68e662e512ff4360463f33664db47b0519f32e6ce7e496d1", ts="1705108689", nonce="24gH63", hash="Hoa4bMu6ESKxjNrHTRwBYCQ/DHNqRGF9JTy0chVcU9A=", mac="wX6BqVvkqY8HGQIUiU28/KWpxwvy0clQi37o1lzCxWc="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile:email:write profile:amr'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OCwiaWF0IjoxNzA1MTA4Njg4LCJqdGkiOiI2NjAwZmZlZjA4OGVhNjJmZDg1YTZjYjA5MTQzY2JkZTVhZmZhOWJkODAxZDZmNmQyZDRiNjA3OThiZmY2YmZiIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHByb2ZpbGU6YW1yIiwic3ViIjoiYzZmYjlmMzk5MWYwNDQ1YzkzNjljYjIyMzdjNDM3ZjYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4ODU4NSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODg2NjR9.Qgxs8ETLXumwsz2c7aCORwaoO34xa8_o4D6av7HMGr1BhnMYMx7JawpA-OWhJkyaYVp_0libaUpKE58h3_ZPOp0OVhGoZlEQdR7LT4h76xz4FsRuO14Wkp94dG4FF8E1oQx9EFdIVONBk7UwYqAoFWcU93oviRBAKb3udVYdfWDaqdLvdz4-V8KvvcCP-0B0MvExEOybVrfJqbZTQRFy_uWZ2RNcBYDEBOOo3CCGbkftL1Gbg-CRtGa5nSXHnzKs1Igai7i99yvSIDrMzjmTmuOzkJfpI82idosl1Ic9XHzeK4IxJcutPxWlRx3BMkwej-_FIFRiLYdzA8kH3c0e_w',
    token_type: 'bearer',
    scope: 'profile:email:write profile:amr',
    expires_in: 21899,
    auth_at: 1705108688,
    refresh_token: '73bdf2c78a2b29b1c3dbf1d45595bf6538a4a3b5a935ad4542d9dc0e2b61c8b3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OCwiaWF0IjoxNzA1MTA4Njg4LCJqdGkiOiI2NjAwZmZlZjA4OGVhNjJmZDg1YTZjYjA5MTQzY2JkZTVhZmZhOWJkODAxZDZmNmQyZDRiNjA3OThiZmY2YmZiIiwic2NvcGUiOiJwcm9maWxlOmVtYWlsOndyaXRlIHByb2ZpbGU6YW1yIiwic3ViIjoiYzZmYjlmMzk5MWYwNDQ1YzkzNjljYjIyMzdjNDM3ZjYiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4ODU4NSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODg2NjR9.Qgxs8ETLXumwsz2c7aCORwaoO34xa8_o4D6av7HMGr1BhnMYMx7JawpA-OWhJkyaYVp_0libaUpKE58h3_ZPOp0OVhGoZlEQdR7LT4h76xz4FsRuO14Wkp94dG4FF8E1oQx9EFdIVONBk7UwYqAoFWcU93oviRBAKb3udVYdfWDaqdLvdz4-V8KvvcCP-0B0MvExEOybVrfJqbZTQRFy_uWZ2RNcBYDEBOOo3CCGbkftL1Gbg-CRtGa5nSXHnzKs1Igai7i99yvSIDrMzjmTmuOzkJfpI82idosl1Ic9XHzeK4IxJcutPxWlRx3BMkwej-_FIFRiLYdzA8kH3c0e_w'
  },
  json: true
}
!!! response success {
  body: {
    email: '210f6cfe5a88b6fefeac@restmail.net',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108688664,
    metricsEnabled: true
  }
}
            ✔ returns limited profile data (495ms)
    when the profile data is not default
      when the email address is unicode
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'eb598ff1f282b4dba64cӒ@ᘮrestmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'eb598ff1f282b4dba64cӒ@ᘮrestmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'eb598ff1f282b4dba64cӒ@ᘮrestmail.net',
    authPW: '5eb5d2e6c2fe77d1e74b279e9969afeecd3f69f619eac11a44d58e4188740e5d',
    authPW2: '81fa9790b9f1429709c7418b543b8d09bf5b0e0a74a3cebb898e27b86779b1eb',
    wrapKb: 'a605eaa4bca547b0b876dc7ffdb7cb1068cf36010342d930efdc2f885c4e5391',
    wrapKb2: 'e9c98b402fc16478d739365c64190867cbc9cfce6de659e709e54127433ebda4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:996e99d357ea7eccf3a77d3d44c184905ef61200bde5016a8c3e04ac856c8e19',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bc5b8810ba564418a579177807aca499',
    sessionToken: '0e4ccc5f678004adac8fc660c60541e7caabfb1969a2349629da9cb2c377828f',
    authAt: 1705108689
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a1067d3126d7d6a016a423e94dc734d10edf61d9e6e03628226bcdeb8d39fe71", ts="1705108689", nonce="m8gREF", mac="jXilZ8KLe0PSKHbRwvoQ20pqyqaYIdXkLgfQTXKEyqI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'eb598ff1f282b4dba64cӒ@ᘮrestmail.net',
    authenticationMethods: [ 'pwd', 'email' ],
    authenticatorAssuranceLevel: 1,
    profileChangedAt: 1705108689082,
    metricsEnabled: true
  }
}
        ✔ returns the email address correctly with the profile data (459ms)
      when the account has TOTP
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '83a00f0fa623be5deae9@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '83a00f0fa623be5deae9@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '83a00f0fa623be5deae9@restmail.net',
    authPW: '03d86601d31fe5e2f56a09e17b87a040a8cef150ee1db513fd70e82c220088d6',
    authPW2: 'a4a78cc10a85ab065147015bac308b12ac67d7dd0d117660a758500dd4e798c9',
    wrapKb: 'bdbccc4f20601d50c64bf951826cf63752b4841d6282be5efaa3f3773e0e739c',
    wrapKb2: '93843093812a067df09f9c475075c11b5e3fdbfa93b6f55c6b87bfdb32f57690',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7181382fc1ef47ba4bc2236a222650230eb2796efc1b75b221bbd599988d21ad',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bf2234773a15463a8f68414739530dd3',
    sessionToken: 'da436af1513ec8f7ce228f1f24c24f19a981984e1640544372e85037e7b9e803',
    authAt: 1705108689
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    uid: 'bf2234773a15463a8f68414739530dd3',
    code: 'c1aedfafa8f7171d39e0ba6045113c2a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d027b5f71839ba1edc7f6ff4af6db02bd70760c0d886164001ca642f5422015a", ts="1705108690", nonce="qlU73s", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="1kAHltKMgp6agHnONKvc3HWHz1DXmIWYFLfA6jcUmxU="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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qUwVU8WkMlVMKicVk8pUMamcqEwVJyonFZPKVDGpPFExqTyhMlX8JJWp4gmVqeInXay11u1irbVuF2utdfvwZRXfpHJScaLyhMpPqjipmFQmlW+q+CaVNyomlaniRGWqmComlZOKqWJSOal4o+I3Xay11u1irbVuF2utdfvww1SeqHhDZaqYVN6omFQmlScqJpWp4kTlCZVvqjhRmVSmipOKSWWqmFQmlanipGJSeULlDZWpYlI5qXjjYq21bhdrrXW7WGut24f/OJUTlaliUnmjYlL5l1WcqDyh8kTFpDJVfFPFScWk8kbFicpUMalMKicV33Sx1lq3i7XWul2stdbtw/+YiicqvqniCZWpYlKZKk5UpopJZaqYKiaVqeJE5URlqphUpoqpYlKZKiaVv0llqnij4iddrLXW7WKttW4Xa611+/DDKn5SxaQyVXyTylQxqUwVT6g8UfFNKlPFicpU8YTKVDGpTBVTxRMVJyonFW+ofJPKVPHGxVpr3S7WWut2sdZatw9fpvI3VbyhclIxqUwVT1ScqLyhcqLyhMqJyhMVk8pUMalMFb9JZap4o+KNim+6WGut28Vaa90u1lrrZn+w1lp/XKy11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3/wMobQyQVfO6FAAAAABJRU5ErkJggg==',
    secret: 'GFEG2TLSMI2E6ZTTG5YXIZKUMJVXCR3S',
    recoveryCodes: [ '59e0wq0d3w', 'yc6g7tbj0c', 'xed9fx5ckx' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d027b5f71839ba1edc7f6ff4af6db02bd70760c0d886164001ca642f5422015a", ts="1705108690", nonce="ZYLS1u", hash="tQmpaJc6QmMO/lcStQYbZ88bvV4zg2zFtdRGfADA/6Q=", mac="u5NNrSVUk911rZC5Zrtcp4GoaxyBy/kB0xMiOT0M2jY="'
  },
  json: { code: '130190', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d027b5f71839ba1edc7f6ff4af6db02bd70760c0d886164001ca642f5422015a", ts="1705108690", nonce="kqZ2Xi", hash="dJXbaCdycuqR2HI6NrzOe5zkuAkH3t41hBNUGMH2two=", mac="NCRd6wBYoLzx/ZdVeSWEJ7nu4nxfb4ITRR0aouRuE3I="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    access_type: 'offline',
    scope: 'profile'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OSwiaWF0IjoxNzA1MTA4Njg5LCJqdGkiOiJmOGM2NTg1ZTcxYjJjMmI1YWUwN2U3MDM3NzNkMGM1MGRmYjI0OGIyODc3Mzg0Y2RmZDQ1NjQxNDI3MTMxZjU0Iiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiYmYyMjM0NzczYTE1NDYzYThmNjg0MTQ3Mzk1MzBkZDMiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4OTUzOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODk4MDR9.Y2BsvucIuIobAD23aR3mwgJJobH0brE5ja4ZjRSSdsSeKTuA2ItZTxEgHx---K2mp-DpbTaxaVRkFdmPNWVO-qZO1DsZDm6yelnbwHOxOIWs-hXq-BJ-nK3eB104ZwxCOLxYGYbLe85DSaQnDzwX4cFfh-C1InQvTXZWhZvL30l4pqI3rbAdibaAdA_iGYYSVnIpliKm66NvrfA9CmbjF6j1_7DHkHFoaQzNE6ECvLeBop6Bmd6TJCC-2F9EfnFO4cUTRp2YFHsrTAFa4bTU2OfLYCSazRXt9Q_8YOanDGoQU-7-AcLMGVWJhAK3quELdTyO043JDCnNuUFahLw-xw',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899,
    auth_at: 1705108689,
    refresh_token: 'a98815493e5f2841daed52402c2bb6539270344e3dac59e44f860228b858537c'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU4OSwiaWF0IjoxNzA1MTA4Njg5LCJqdGkiOiJmOGM2NTg1ZTcxYjJjMmI1YWUwN2U3MDM3NzNkMGM1MGRmYjI0OGIyODc3Mzg0Y2RmZDQ1NjQxNDI3MTMxZjU0Iiwic2NvcGUiOiJwcm9maWxlIiwic3ViIjoiYmYyMjM0NzczYTE1NDYzYThmNjg0MTQ3Mzk1MzBkZDMiLCJmeGEtZ2VuZXJhdGlvbiI6MTcwNTEwODY4OTUzOCwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg2ODk4MDR9.Y2BsvucIuIobAD23aR3mwgJJobH0brE5ja4ZjRSSdsSeKTuA2ItZTxEgHx---K2mp-DpbTaxaVRkFdmPNWVO-qZO1DsZDm6yelnbwHOxOIWs-hXq-BJ-nK3eB104ZwxCOLxYGYbLe85DSaQnDzwX4cFfh-C1InQvTXZWhZvL30l4pqI3rbAdibaAdA_iGYYSVnIpliKm66NvrfA9CmbjF6j1_7DHkHFoaQzNE6ECvLeBop6Bmd6TJCC-2F9EfnFO4cUTRp2YFHsrTAFa4bTU2OfLYCSazRXt9Q_8YOanDGoQU-7-AcLMGVWJhAK3quELdTyO043JDCnNuUFahLw-xw'
  },
  json: true
}
!!! response success {
  body: {
    email: '83a00f0fa623be5deae9@restmail.net',
    locale: 'en-US',
    authenticationMethods: [ 'pwd', 'email', 'otp' ],
    authenticatorAssuranceLevel: 2,
    profileChangedAt: 1705108689804,
    metricsEnabled: true
  }
}
        ✔ returns correct TOTP status in profile data (719ms)
      when the locale is empty
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4cfd2652c7b5e3f7e5d2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '4cfd2652c7b5e3f7e5d2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4cfd2652c7b5e3f7e5d2@restmail.net',
    authPW: 'dc3f628886b58632fcbca0600e13a2460a845216464326183c7b4c909341eee1',
    authPW2: '6f136f76ac9bab80ad1429c4b41f940c4e677ee9904e93b47c0de9744386699a',
    wrapKb: '9fd5df9b711c28ebece850e8eae5875dc5b0f271dc92475d0a29c904aac59a7c',
    wrapKb2: '18ed0f7aa2396f0acd1bf81c8f1bd3813ade664e50d4e71cb6c6853f60471197',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:caaaf9a18c66c122e1d142698fdb831db6e90919831c1f89f97c3088c0c252e6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5f4fda1acd4f42cf80b07226ad7fb1d6',
    sessionToken: '6e967de023ebe21b9564a5de20f531e2aa256ab8aacebf5b4adda091aa72a066',
    authAt: 1705108690
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5f4fda1acd4f42cf80b07226ad7fb1d6',
    code: '9a210a3e95f6c3e6897b08e7d0bc4ca6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fbd81544c7801eafae246c8b01d7bbcc5cd5b35e4908bb01c9ab02a905158934", ts="1705108690", nonce="MTJiK3", hash="BmmZ7Vt0DcHXEBi0YhnH2UWfcb7OTVlEgv+HI9nJ1e4=", mac="HdD/9bF1gM7PjUpZ+yVC5LMUj9NWpbCcpHrQ0YulzjA="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '98e6508e88680e1a',
    scope: 'profile:locale'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU5MCwiaWF0IjoxNzA1MTA4NjkwLCJqdGkiOiIxYzU1ZWMzNzMzZTgzNjlhYWQ2MDQ1NTM1ZDAzZmEzMDYwMGNjOTg5MDhlMDk4M2YxZGI3NDcyYTZmMDA3OWNhIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjVmNGZkYTFhY2Q0ZjQyY2Y4MGIwNzIyNmFkN2ZiMWQ2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2OTAyNTcsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjkwMzM1fQ.cWjVy7493caGvF5_yRBnyajOEBxO0q5migBf8FDV7G6qRaV1xDYlPMPbClGc__6WcU1lrbG_clm0CHCRTk3fpsD_SpOp22_LegfrVNCld1SuVLf0afDLkGtgs4eu_ako35WWa2ehRlISxp-KrakxP4b9BYqHhl_CV6kRrQI5e_QlBFXU1Ht1F7NlKRNSylVLTm5_NX7E-XK16OllhGCHHB6VePKfQ6qlSQjzd9PPF8KgLRhjAg4GKwtX1xUJI_ABbtmJhsv__LwwLLEh4CRzv4l11jPcYictXCuAbT3VK20DWtul90x_k7ACCsgE8F1wwQYzpfWIdkxqClgoUZHKrw',
    token_type: 'bearer',
    scope: 'profile:locale',
    expires_in: 21899,
    auth_at: 1705108690
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/profile',
  method: 'GET',
  headers: {
    Authorization: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiI5OGU2NTA4ZTg4NjgwZTFhIiwiY2xpZW50X2lkIjoiOThlNjUwOGU4ODY4MGUxYSIsImV4cCI6MTcwNTEzMDU5MCwiaWF0IjoxNzA1MTA4NjkwLCJqdGkiOiIxYzU1ZWMzNzMzZTgzNjlhYWQ2MDQ1NTM1ZDAzZmEzMDYwMGNjOTg5MDhlMDk4M2YxZGI3NDcyYTZmMDA3OWNhIiwic2NvcGUiOiJwcm9maWxlOmxvY2FsZSIsInN1YiI6IjVmNGZkYTFhY2Q0ZjQyY2Y4MGIwNzIyNmFkN2ZiMWQ2IiwiZnhhLWdlbmVyYXRpb24iOjE3MDUxMDg2OTAyNTcsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjkwMzM1fQ.cWjVy7493caGvF5_yRBnyajOEBxO0q5migBf8FDV7G6qRaV1xDYlPMPbClGc__6WcU1lrbG_clm0CHCRTk3fpsD_SpOp22_LegfrVNCld1SuVLf0afDLkGtgs4eu_ako35WWa2ehRlISxp-KrakxP4b9BYqHhl_CV6kRrQI5e_QlBFXU1Ht1F7NlKRNSylVLTm5_NX7E-XK16OllhGCHHB6VePKfQ6qlSQjzd9PPF8KgLRhjAg4GKwtX1xUJI_ABbtmJhsv__LwwLLEh4CRzv4l11jPcYictXCuAbT3VK20DWtul90x_k7ACCsgE8F1wwQYzpfWIdkxqClgoUZHKrw'
  },
  json: true
}
!!! response success { body: {} }
        ✔ returns the profile data successfully (490ms)

  #integration - remote account reset 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3d93fafe1e0bda4a9335@restmail.net',
    authPW: '1f415e1add40a453130fa6775392e9e700d02a9931193f4bca254b98770ffa98',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6b18ee77e5564ea7bd636e62641d4036',
    sessionToken: '07a27372b739c8329c869cfe5e86ca4851536e46b9a285ab539502fe00baf0d8',
    authAt: 1705108690,
    keyFetchToken: '7c750c7d541f0ca829e6fccb28d7eea44289b1c2a2541d2a70d0bb0c77f608a6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6b18ee77e5564ea7bd636e62641d4036',
    code: 'cf97cd0343c8b8c8c61af706e46be51b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5e9a9a21238c1af79218e7fee3e40f2edc241cc6c6f24e0806f907330ff18b38", ts="1705108691", nonce="zAbz-y", mac="YkjH9QQ6nnheIKfU/vfC/RpJhG0009wGroXGtZ9p9/M="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '167747ecf871c8ea85bf91731bde1a44fb9718a1cc1d1a0c44c242f48dd50893ec5451a46404ec766c9472db065378b478d5740e4ce178902fcebaa1ce27fce5f389f5dba05fe94792b85ce276c2c336c982096db25091da328edf269dd3d34f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3d93fafe1e0bda4a9335@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '0d2c301b6e43aa1d362cdbb22e3a9bd2ad178fbeb062d6746509c8c43fcaeb59',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4d73bd01fc2318b96bf6478eaa884d517f3cfd007e36aaf956cce433810ef648", ts="1705108691", nonce="DAvUEs", hash="jAEPuXe2WHoT4IsD+r8yrvCN62aW5xpFcMNR1Ztyru0=", mac="HA9j+mPKoo9JgsbK26iyxBGsDtyVULCLcgbCqT+XgvU="'
  },
  json: {
    code: 'f6d2d5d0e6da4e179668a4533fdc0940',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'd8f64e2c3d56b79849fbf3dc4137dc0839eca15166c7b75e4d597593ff66dfb4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7568d99ec63e7bb2a1ae206fd9a5dfe4beb4612084f106bfc0ccf1320ee0141c", ts="1705108691", nonce="oLBBMb", hash="kAcK9//BelDOuZVAF6Hcg7ASNeK2zzj66GMYXCQ9vR0=", mac="a/BOfUTfYZab4bNoXiBbfP/h/JJv/6bR4WqEUWqxCHw="'
  },
  json: {
    authPW: 'bca94fe75187d346a62cf0b1b85cbb6927e41591f0bbbce7b5ea9aa7877bc4dc',
    sessionToken: false
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3d93fafe1e0bda4a9335@restmail.net',
    authPW: 'bca94fe75187d346a62cf0b1b85cbb6927e41591f0bbbce7b5ea9aa7877bc4dc',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6b18ee77e5564ea7bd636e62641d4036',
    sessionToken: '72ec97a5c179a4e8dc3c888788ccf3a8f2bdcebeea4f2a105ee115b527d44786',
    authAt: 1705108691,
    metricsEnabled: true,
    keyFetchToken: '5c71d3ec240a9026ca5d049941ccfab15538b87bc6d0ca61a7ec3831fdcb0eaf',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="24be235f3f286fee07cf25d4e89238e9628b4516dcca9701342ccf5e0918f198", ts="1705108691", nonce="g14C1Q", mac="hIpuQQ41uP+6WISA6yKWCfIHRcB1UqEgmlYEF52d9Ec="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '5292bf31462193c90267a5b0012ff99007f59b7f42c5acc94d077d63c34459b587f3d0c38ab654495900381585a03dd590344d497690c36127d6f6377c3d3c961888358e9cd1b408958d3538b58341732fede66ea21ad2dfc7e9e65b6feae0e6'
  }
}
    ✔ account reset w/o sessionToken (717ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '079148f10892cf83ac0c@restmail.net',
    authPW: 'ac7d0692335ab7bfda50bf7a4d9cb36badd5621265a27c531edaca6fa55fe2d9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '21790efa23bc46979dfa2731610b7e3b',
    sessionToken: '616258e47e28d1b0e38b54e28584b7c12b7e5d65d585d0ce5c4a8688ff2d6a60',
    authAt: 1705108691,
    keyFetchToken: '83e567f0bb0061eb343fb77c5ceed0579e8aace429db486851a15460ecd47f3c'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '21790efa23bc46979dfa2731610b7e3b',
    code: '7fc9e360c768defddb0c34aa91a6b237',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="954db2ebf254d4743147be572bdc56aedd806946485912cd6a5e01ea0e1748e7", ts="1705108691", nonce="NoH2Sh", mac="oISWVN3eSPllNCiHFZl1euXfNdMy6dg3lFeIdm1AVq0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9efbf1107c36f9da6b662b54f5c4ac3433223156eeb37b303fedbd16bb19f80d91d5c8ae1b6084fb735f03ae8de35d6418ad86e3c68f76263a12f7a6e4136010f4077855d8fd3526f9f41668c3959058c7b9112fd4832788314a547e708c6c7a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '079148f10892cf83ac0c@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '23e375b381a2c9349ff993c52da6dcdc4580210775fcfe8c07fc4ea8c3526a7c',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="07e7fc577a2fee404e2d383e6ebac4a2ece4f7d282273ab658920e29d7d48407", ts="1705108691", nonce="1BBWyb", hash="AbSmPiWiexTZGMq/MNdIvEt6K2NrSj7mgZ/KJ6UTtMg=", mac="51EiTV/u3JPY8dEodI3D4J/9jNmealJOuKwGX4p31z0="'
  },
  json: {
    code: '5677bb3d087d6db442fc984bb9f11f30',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '9fc081e761247baf50e363bcd4cb3a8cf8045de653d1f059b68b822a736ccaa3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cf17d4fe7a51703523f34ad283ad168e198c9f82cdb0d8b7c13a3af217faade3", ts="1705108692", nonce="vq0lGW", hash="1NJ4O89gi8SOI5Pgoqr+S3D/zKUou7xxCH5cIGA0AT4=", mac="zsv93eEjriY1Fas0BHx/wcR9VF0xAheSoSevyccbE3g="'
  },
  json: {
    authPW: 'e158c2617c8e6063746df13d0b01907e9fbd9a170d0bbe1a8dfef0563dd33509',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '21790efa23bc46979dfa2731610b7e3b',
    sessionToken: 'ab9a23535895e7cf3c41c4dffa7f54c6ec26c5824ab0218cc6ca6cfec04e3c21',
    verified: true,
    authAt: 1705108691,
    keyFetchToken: '58c258d7f31027460a4810e0a460ecb66287340924846be504571b42749f918d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '079148f10892cf83ac0c@restmail.net',
    authPW: 'e158c2617c8e6063746df13d0b01907e9fbd9a170d0bbe1a8dfef0563dd33509',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '21790efa23bc46979dfa2731610b7e3b',
    sessionToken: '203224205eeacb07f9fa4974cd7189b8a0735c5d980acd9ab3fe36bd7970c92f',
    authAt: 1705108691,
    metricsEnabled: true,
    keyFetchToken: 'eba025f6d8d8a3f0f54a22783602953e9c9089c88c125b2de2c01ec79294e104',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="239949b42d70aef14eb9b89a6ecec6ee6e4c1044872eb44754e22059a2c1420a", ts="1705108692", nonce="D4aqAN", mac="lWyDciJzQ6r2dCgb0qujMLWFUaov1rgTkSSeNz0tSG8="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '68bf36166c93d03b39f6d8c335da6ec3e9cd39c0c13396f0512e778e25781fbda54df39180234c84882e0e6841a19abf253eca93ee37e2a93409df82b92e756cf8e6fc6e3e7f84f26f9f0415edffb4b8488c3a735ace676505eaa1b6cbe820e2'
  }
}
    ✔ account reset with keys (841ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '90652277ef84bd9f6776@restmail.net',
    authPW: '2251c23e1d33b8a79b80842f4a156c895fbcd244ed23b2f1bbea5f8525df51b4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a0027b2de8e3438891477d7cd505a729',
    sessionToken: '381d71639c496b7654083b2d847c0412e5b047680021580c069e93511967c470',
    authAt: 1705108692
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a0027b2de8e3438891477d7cd505a729',
    code: 'f182b643de9410055d0e8bef8989c170',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '90652277ef84bd9f6776@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'ec616d0f86068c753a98fed820d78c48728c4f3d46d4395229f17e305987013d',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8d4a2365109b3dfbee3cf47257c2b20ec30b513664eea75f9d1a80af196083b8", ts="1705108692", nonce="LNSBZJ", hash="awfdH8Inz28DHgvc2yYrjWu0XF2NwQ3qlF+XAM5zFLs=", mac="q+ZeKSKY1qiQckcypPhuZ/EKNS20nEDzv3DnUnHpa1Q="'
  },
  json: {
    code: '8989c406d9f03fc62de5cbe94839f78e',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '07d3eaeb804ad441f317fe876a68b9f64df9ab6483ad3ff0fc4c1fd367b62b0a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ee85e8c2d60a82cd3b99f42d954797ea4f71ab579e714138df4940b0995491ed", ts="1705108692", nonce="GVUv0H", hash="OZGaOFjnzseDk/Al+1fimKimeOkCBo9pkTDRlglKxWg=", mac="XHawU1P3xr/AGQkUpffLBCR59uyorai9aavx/YJ+3OI="'
  },
  json: {
    authPW: 'dddf614d7aca16210d5013a366496b82a78a5478ad73ccd50a3372ee663a136d',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'a0027b2de8e3438891477d7cd505a729',
    sessionToken: '7bad53d28a048521276aaa51c14a63bfb1240843356ae8c10986f2df1498468d',
    verified: true,
    authAt: 1705108692
  }
}
    ✔ account reset w/o keys, with sessionToken (453ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '795a3c9c2eab54477da5@restmail.net',
    authPW: 'bb5b3de59fd2316707ffab5cda34409b1ced1eaf43b63ea10c810e613c217072',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cb848e0da1cc4899a3aa0602cb774f22',
    sessionToken: 'ae210e74f726b555d02bd7527f0c6c82a86164eb1f77085d092899e2df124c9e',
    authAt: 1705108692,
    keyFetchToken: '25dfa1224e8b0d96f833ad02ed1025b7133b78c50b6ad54c9bd9ed4150c3fb5d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'cb848e0da1cc4899a3aa0602cb774f22',
    code: '8c0516a0b3bfc8c68ca1293b8ae5e7a7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '795a3c9c2eab54477da5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'c3ca273295de210aa36a06b6c0b860e324aaca875ad547e81c710a9236b77fb2',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '795a3c9c2eab54477da5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '9118ddc82840c6b27a82638ef6d7462c910e22ebfc80e8cab6e6733e963623f0',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d8ba4d4b4f8420fc070e036b860255c411239241e9f70d1b74a7c7e48978c9e9", ts="1705108693", nonce="oTfP7x", hash="UmKHLOIDOg3AQAoEPm06+1ctwOVz6e+om5jn4BSQghQ=", mac="rCd6Jy0ELlocEyl3sp06wseeIwPr0izOEeD1zSoJV9g="'
  },
  json: {
    code: 'e0f55f6cbc3106f7298aabe7fd4a93d1',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '517257410df80dad37ceaf2b52a2db3270d993440cee823fd9e51037c0991c5f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4d4708fbb76358ac70756cb6c0ddbf9c4da06a29fd5e1d12e4924adb262f5f16", ts="1705108693", nonce="ektAAo", hash="HeRrvkR5uMXDzLwegH7ukrHoErvaMk2hKyzZyyC1KTY=", mac="YQlr4bO5Z8z0hsKJGi6hDjCwNXV6TmmnYa7zAL+rboQ="'
  },
  json: {
    authPW: 'eae43d31078c9c0b7df92b610666c43ed1d931c14abd1e6e07ee12304c4f431a',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'cb848e0da1cc4899a3aa0602cb774f22',
    sessionToken: '4c4b31b1fb68dcf801a645599f0d9d4605532559acc6b57e9c25f7a40fae7b7b',
    verified: true,
    authAt: 1705108692
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d8ba4d4b4f8420fc070e036b860255c411239241e9f70d1b74a7c7e48978c9e9", ts="1705108693", nonce="gokIAf", hash="G0L2h2SCmwKQv/d6M7rJxWEh1R94g+pToUza6bfMfes=", mac="BjrOKA6o0MaglHDXKDNfFT7FrLVkCW0U0cremzyFlXE="'
  },
  json: {
    code: '9a040a665799937bb60d3ab4d1c8296c',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ account reset deletes tokens (571ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd892e822e6cc34289620@restmail.net',
    authPW: '5f5bf613b8cbe0a3bd47b5ce5dd44a40e7bb0388a3feb599c34a4abd6160c981',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3b652572fc1848c5ad0ff9e118565431',
    sessionToken: '41c5e548f7fbb8abbd4290c7d744003cdd39d1079912e959c72c233bd9891fc2',
    authAt: 1705108693,
    keyFetchToken: '0f323cd13776f4eeefea5f22e3d59358d6b0a8ac0e28f9eb8476371066e79892'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '3b652572fc1848c5ad0ff9e118565431',
    code: 'b1420f9a680c311f231a826742f06b8f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="45280df5533b42814fe637e9e244dc334c9eb75c0c93b61128f786975e4429f7", ts="1705108693", nonce="lW5Zpz", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="GWC7B/ObXIhCOeUXuCLB9Hx7dEzejL2YamaGAhaQ0H4="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiM2I2NTI1NzJmYzE4NDhjNWFkMGZmOWUxMTg1NjU0MzFAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjgzMjIzLCJleHAiOjE3MDUxOTUwOTMyMjMsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjkzMTI1LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY5MywiZnhhLXZlcmlmaWVkRW1haWwiOiJkODkyZTgyMmU2Y2MzNDI4OTYyMEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI0MDgyZDBmOGEzYjc5NGMxNGUzN2U5NGIwNDljYWI4NSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjkzMjA2LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY5MzEyNSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.SNLJB_GuWR4zpltwsiHCLKqpuzAPVmc9ppsaudgtP1UFpKqgvMmBb44vUe5H1vBled_8YxCdPKr3e2ssyR0ntjKALolRyXAkpIqN3ZDTqwoDPIx3YHdry-QWpQaQxZxUNrJw3eCTV9I7TMm9TxrhiWIK7tp9qs8vPXHRtqwbSvkzSwgR0PcOjfbGZ9vHecu3pbmJoxdPbsYRcMN6E0VtbvVOKwuYGOINpc0t7SM71z9OCJrve7uu-ODTDiDk4Ced1K-KnHaehOVqPg9fK-bdxQj-_VQnYeGcXHsNFEn6uzUmtmy6JcZqfY7HPPOVO5QyPNCeqeZbLnpvVXm0av-QoA'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd892e822e6cc34289620@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '14e9c5409a170cad9bb658855f1ec2977030862fd27d5f72b9e9006d4fa5a7c6',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e56d32f4fab2b76e278fbc8e1fc5eb7c90961b004a07649a30c0ca93c8b73b02", ts="1705108693", nonce="Regf9c", hash="yrTAD+uwqI0+thUgHwiPWx/4eUuF38P5BKnY3hlkAkk=", mac="kQfFLeDpXtAm9wm2Yuwz75kGSf1tkaskCgW7SEMTdBg="'
  },
  json: {
    code: 'a5ff87539a1f4584d68a84408a01770d',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '1dbbdacb4743ac34cce2ff9c7d81ada43c820783ed7112484d1dcde938dd9f9f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7abf908905d8824683a7c6a1983cadee096f0aee5270b4ad31ec62a04354e29b", ts="1705108693", nonce="J_fEOA", hash="Vp0jiEO4GVhFEItTPHMblblHvzq+AGqgpM8wqOqtezs=", mac="TQJK64YOi8aO7c3r/7iz9Qe3OAvKghPfkLIoO6bPqQI="'
  },
  json: {
    authPW: 'a26e8ecc9a84d92795dac2bbbd68005f41061d41d98f60fc054c9431c658e2f1',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '3b652572fc1848c5ad0ff9e118565431',
    sessionToken: 'd9afbcda3ca9282c32fd7ca18aedca60f8cc70dfedec0074a760b36594554ffb',
    verified: true,
    authAt: 1705108693
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7521f554eef84f26dcd607bf3b411f023966f1f38ffe9d3c4bae33ee4e79b069", ts="1705108694", nonce="kctPG-", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="qMH/baxKGqQUO7JhSIiSjx3d1Rzd1LyuslNWBKTItZw="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiM2I2NTI1NzJmYzE4NDhjNWFkMGZmOWUxMTg1NjU0MzFAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjgzNTE1LCJleHAiOjE3MDUxOTUwOTM1MTUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NjkzNDY1LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY5MywiZnhhLXZlcmlmaWVkRW1haWwiOiJkODkyZTgyMmU2Y2MzNDI4OTYyMEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI4NDBhYTZjYjg0YmUzYjE2YmIwZjk5YzM2OTYyZDM3ZiIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NjkzNDY1LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY5MzQ2NSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.DqgY_j0SG7emvKW29tLOs6dEADAgpZ0eH6N2GqRa3IlvHWIzFh7bJZlDJcslIuSKcVFACxw_bEqcOgnNF7AbCpE24qY8WrFGLcd8suA__09JZOy8OkRNvw4IQcTnvqyn213SI4hZoTizTaxda7tdYRuCSrRpzveL6gzfZ6ZbpazDB-l1g6c9fgCxBOIjJPrTMIxpt02E9V_azcoh9zUYVgh9J09JdAzGv6dtOOf55ufYmMCySHFAUAORQp0Fx9feUZd356uxXx2ZYNkxwFOBMsGOH_OlLLkl0_-W7nyR8cbyqR1HWkQuUYzbqyya8DSGiz2a7Bac0srwr0TknawBBA'
  }
}
    ✔ account reset updates keysChangedAt (523ms)

  #integration - remote account reset V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c6d338c1e32c8389c757@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c6d338c1e32c8389c757@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d338c1e32c8389c757@restmail.net',
    authPW: '705b8a6326642cc8441c6a643592546e14185a3cabe59829c26649388989ab59',
    authPW2: 'bafe6e08f2f62437fc4fbdba5a286a1aa33374c0915628261b0e0d29dee29a5e',
    wrapKb: 'f67537b4e40f224c4ab65f076522f9cfee16f7d894e83d23cf9fc4a8baf15532',
    wrapKb2: 'cd65f33c6d152d440e4db45ad4d6f00cef02c03d71fda2112094b91cf0627d53',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4b0733ee90724f98b76d93442a9d269ee1ccf0842821c28a3827d8b6bf42f49a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '10baefbcda8e449894c2c2669408c41f',
    sessionToken: '7938f86f285a7cefa4e3fa53bd7a8b6311af761d9193d7b032b3b3b1544bcebe',
    authAt: 1705108694,
    keyFetchToken: '59051a5871100b34b8c6afddaf71c8a0c3a8e6ae703d78eadba9b0407d83fff1',
    keyFetchToken2: 'f35d2f185c773c2d04fd440aa7392ebed4ae7f701ad766f299172ab09e3d331f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '10baefbcda8e449894c2c2669408c41f',
    code: 'c338c026503fe8eb4f14c4bb33fe7a70',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0e692cc6d37679f1f690b16db5b08d7c9d76e5d5c6a21d1555ab371965e4a1f5", ts="1705108694", nonce="gkkT0c", mac="fCTNyqiboBewnTGPa2T+BdhpdHl5ExtnURumaki9VVc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '4c68d37d39386439934b3b704acac740efad7c64232333e8e44e0784fcfcba761282dbd2aa20fb371fd73dde81905f6c45061df364ec230954cbfedcddac50312eed2933fd0f114cde1d37b8c8e39505c350250446a3c845c763cc1a10e815e2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d338c1e32c8389c757@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'a20eeefd8bdef01a493334585d61a66e9e3adf762ea71b6a5a139c36c718f18b',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="72636cc24049d3faa8d2fd257fb0508f6beaafd1daa1d25de563c2d96511b2ea", ts="1705108694", nonce="nl0-8j", hash="oCgJJaASyRMBjBm2Nc7FEIgLGHokOa/j9HYFjX8Lu98=", mac="d8mNbhkSYQUZ/lYAhlRul8bDOpbosC7y/kqzz5Y8G0E="'
  },
  json: {
    code: 'aff37098eee7c3392f6acd30f49e8672',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '5a89bc952398a9b255255fbdb0e56ec604400b8b6639b5cc0f68398d6778e75d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="00769bd82256420e7618ef4f7f685d2fa4fd973506963ba203a6842904ba9bb9", ts="1705108694", nonce="Gg4__x", hash="NlJ4mkGKX8F5K2h1+QRMuNgsj8mlc0FEiuRXSa08IDM=", mac="eIAr10LrKBjtfPaIKSwsSg+apTu5CQLSPGLXSByKhYA="'
  },
  json: {
    authPW: '0a20c74867fe97bb788b7ac18fffc2e3f849ebc0b99c06c4146cad5283370c9f',
    sessionToken: false
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d338c1e32c8389c757@restmail.net',
    authPW: '0a20c74867fe97bb788b7ac18fffc2e3f849ebc0b99c06c4146cad5283370c9f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '10baefbcda8e449894c2c2669408c41f',
    sessionToken: 'c15ecc00862853a8b949b281ce21ef42a4c2e4c9c1ce5b55e666f1e38c08d31d',
    authAt: 1705108694,
    metricsEnabled: true,
    keyFetchToken: '6598747d12fe5cf9bcaad5f1464b91ae50d585b2994609ef24b4d952f9490f63',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d338c1e32c8389c757@restmail.net',
    oldAuthPW: '0a20c74867fe97bb788b7ac18fffc2e3f849ebc0b99c06c4146cad5283370c9f'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'f36ebfbf229fa5fb0d8b084c3fa9f1b7fad8c3bbb7f71213f60e4a27cf265080',
    passwordChangeToken: '49615b3fef4813bdf452bccfe9d629cebb84b03165bd38c0f46b91302d537a74',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4251ec846946e83d7bbbd5816ad40e7d7c950e526ec3a2b5b091a2b1dae2467e", ts="1705108695", nonce="0kPN9g", mac="zzzcUw7NqfDyCBCRwON5c80XJ4zThxB9wfh+0VfFHqg="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'cbf53e62826fec20195d54458051fd41769785bcaced590273fe9aa2d17a69ce577aa79990268411714203af9b5711fddb2f3c94867c98d6e609d671124904add1e1ce79f84aafd2889126bb09c47b26ca0bd6090732ea3d8b9e6e1d8b383fc9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c6d338c1e32c8389c757@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="16873d48a65ff63fe5a4429ca94392e4ebaa4d08a9b19fdcdbfb50d028291051", ts="1705108695", nonce="wNA02M", hash="/q9+PWu3+0kuIsEchzX6inDN69PQ5BMGgO9s+OQBZyg=", mac="l9tmFyqgu0lIZSOuIDg/TzdON+AwNAf998eXesjT8/s="'
  },
  json: {
    authPW: '0a20c74867fe97bb788b7ac18fffc2e3f849ebc0b99c06c4146cad5283370c9f',
    authPW2: '2b8cee6238d1e3f69f4c8cbdc18889e73f6de104dba6fa4015280d0b060e12e2',
    wrapKb: 'c4f551fc8f85e7f8c8a8b1408062d7f905aa9dce870b4e374183a31e117b6bdb',
    wrapKb2: '8dc8472f3e034efc5a381c6864d1703ea63b341767111c9191c61ffbf30d3339',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:93a058163e27e91a6dd494a227dd45731119ea949fb28739ee3f1e706de242ab'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c6d338c1e32c8389c757@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:93a058163e27e91a6dd494a227dd45731119ea949fb28739ee3f1e706de242ab',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:93a058163e27e91a6dd494a227dd45731119ea949fb28739ee3f1e706de242ab',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:93a058163e27e91a6dd494a227dd45731119ea949fb28739ee3f1e706de242ab',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c6d338c1e32c8389c757@restmail.net',
    authPW: '2b8cee6238d1e3f69f4c8cbdc18889e73f6de104dba6fa4015280d0b060e12e2',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '10baefbcda8e449894c2c2669408c41f',
    sessionToken: 'c9e2c83b5ce4dc16fa0ef955d2456be3a38c1cdb5e2012923a831bdabf8fe540',
    authAt: 1705108695,
    metricsEnabled: true,
    keyFetchToken2: '969e427a8b39d7cc3843be4d27e2af68be5041ff1f9241efdc4a066e7c02abf3',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5d3cb0d7f452df9a64331afa1cbd4bad947f2856a8898ff2c12a4e36a5233e0d", ts="1705108696", nonce="5L4c_N", mac="j++d666JxlKoBmUeChXcifJZ5hA2sL5+p025VQeejCI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '0eccc580881a8c2f73870f132f05dac31690f8d103afb605e3418ced7a8dbd239a3e534b2ffd783bd199b95c3b81682f406a937c7c2771200ef90fa8e5d5bfecf474b92066262504c94f7d2b787b10726c35654f8eaf83fca59d1b24b35fc86d'
  }
}
    ✔ account reset w/o sessionToken (1938ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1540028adf959f9faf5b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1540028adf959f9faf5b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1540028adf959f9faf5b@restmail.net',
    authPW: 'e2eb81a4c8bd0937386ca213d793ff693e6b8fc75f4623180af20f2614c6f970',
    authPW2: '73e464906d6227987c1d29ebc880b54af40cd5d9d06e73b32608f319c3670a09',
    wrapKb: 'bae49e8a55fb69234f95a72d2c48a6126f526b3afed8d006c3b021de6d814278',
    wrapKb2: '987ea54e32d1b7f57b37372c8243629257aa15b27886ca3d46cd8b5d23631821',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e4d9a3330f7b3b1728f9ff7328a87b7a535a9b1b9e7483828cab7682c659001d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8cef22b4c68a4f9989fe4ad2bc2bea27',
    sessionToken: '2401a1449347fffb8c049a1471126c81aaf441895b77ade47ef7cb1e2dbcc917',
    authAt: 1705108695,
    keyFetchToken: 'f595b5d6c6b544140d794116b8608a80be1b1a7fb8e371614353c63c03461b07',
    keyFetchToken2: '8044e22066fdbadb2f8892873261a9ad337de293ef45aa8272e11c78ec29f048'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8cef22b4c68a4f9989fe4ad2bc2bea27',
    code: 'ac47ff78356fd5aa1fe0330d1ad0798f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a4d4f0e78e42458c85bfc975158a3f37c5f59ed6e1ee71b8010ac91c739c5d09", ts="1705108696", nonce="f5snCJ", mac="F9O7a9GNZ753KK+LpYSYVznQcon4c7NH/Z2jiYI/zdA="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '117b77af9e58972bb6ba8222bed4997d4cbb0ef209606104bdcf20c2042a16d156b409595cf569b125fef1d44cadcb7c0f52dd78ea8e429b5804ce4cf7e93366e0c9a9ea538750d86664fed38f313ba57ff6a3c09c989fec319126ac7aff3f37'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1540028adf959f9faf5b@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'cfbf4c22f0483f0ab6ef69203b7122c5f7d034e8e64abe86f067abfc6e9e1074',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3503d70041eb0f0d0fe5369001370f41918702e82a8698219d7ba865bc748ad", ts="1705108696", nonce="p8C8Vh", hash="vXYop/AducLwjxRfhHm+BenNLGsprcMXpUmSDGSJpgM=", mac="XpFv/lCpaW7eRy0iuaGF7yd1ZuFnOPN9AhXtxABLItc="'
  },
  json: {
    code: '8975c0be765a65e0e1ac965a40cb3799',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'ffe30ac17cbea19ec2717da7625d06cebaa5aad8efaedd796d30aba5f4f1e259'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3a7dd2e7156f81b045a12df5e19af100eb29a0dbbbd3eefb0cdf4358cb1f7276", ts="1705108696", nonce="gurfNh", hash="2nRtMRqc5PrhfCveOG+TF29aGW9RYv+fnLj4CWDL9yo=", mac="bOKT4La+GXmfYKGhH+jZeXyxllRIm0CMUOHZRHoVzv0="'
  },
  json: {
    authPW: 'a27e6b56ce4fd72cb7c5e06b61b20f5758bb2d97e3819d30ab38564fafc196cf',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '8cef22b4c68a4f9989fe4ad2bc2bea27',
    sessionToken: '0181257cd550fcbf16b39fa1a6b3ff0d10784947bef6a23210d4cb6ec56a4d1f',
    verified: true,
    authAt: 1705108696,
    keyFetchToken: '04cd461d8dede7e0da90da29bd493fbd38132cb3fd79f089c992ef76e2658851'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1540028adf959f9faf5b@restmail.net',
    authPW: 'a27e6b56ce4fd72cb7c5e06b61b20f5758bb2d97e3819d30ab38564fafc196cf',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8cef22b4c68a4f9989fe4ad2bc2bea27',
    sessionToken: 'd8b04f0409377bafe860cd3cd148f6211c5e7cd391e2999e9a54f9bdcd02468a',
    authAt: 1705108696,
    metricsEnabled: true,
    keyFetchToken: 'c58d33fec50912500af726d693f50ba01624eae60557487c3831c349031b2091',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1540028adf959f9faf5b@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! status { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '1540028adf959f9faf5b@restmail.net',
    oldAuthPW: 'a27e6b56ce4fd72cb7c5e06b61b20f5758bb2d97e3819d30ab38564fafc196cf'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'da9c7361fa5594d3d54e21d1bb25c08f41b48cb56e2277692df46b9a55d2d800',
    passwordChangeToken: 'a4b79fb57e17216c0dfba69dbd84e2c3983e9353bdf262284900860116c323d4',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="45a143a86e613a4e28d0f91952fd6c7aa6a848de47dc181453dce962e43ca397", ts="1705108697", nonce="1TQ1Eq", mac="YnNmmnZ3fJcwdR9cm+5ftM6p4tHtLf+SGUupzaRIJq4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'fe2d22dbeecd05f268224f0d03dd88ac00db4637bc5eb95b7d203310a7c8fd12c69965c2f53dedc58b651666bcf638f69f5be17820a139b7f4d634a0dd69bc16b1b3eb0ccae043bb4eafbe1664fa43d4201b3d713e0b99987f0a87f91164ab01'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1540028adf959f9faf5b@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="faf1fee4b031a4f2e3f5c6975866bb62b498272a08575fc1a6c0b727ac6b694a", ts="1705108697", nonce="fdEp7G", hash="OOP1c89A8dhs/6p5wof9DwZ4/LNXsdBp4kaZZKpQGvQ=", mac="sP+A6Tmt5ymUVft4KsyM35boqPUq8b7b9u5XLFrpw78="'
  },
  json: {
    authPW: 'a27e6b56ce4fd72cb7c5e06b61b20f5758bb2d97e3819d30ab38564fafc196cf',
    authPW2: '14e317ce875d759aaac1fa2c21a42a6b3fc3ab6f9f562510270a8141a6cf1131',
    wrapKb: '75fd4c4ab0f68264cf11efaebb3cdb2dd68f08f7ea36e55e9aadf84b1604b6fc',
    wrapKb2: 'e81a837151ba222fbb10c0d6248f7be8603744d570f91417637d5b65d4744090',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4a1debdca1bace50b3be6eaa59b477c8ff7a55d07e81a081cce786beb5248c0c'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1540028adf959f9faf5b@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4a1debdca1bace50b3be6eaa59b477c8ff7a55d07e81a081cce786beb5248c0c',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4a1debdca1bace50b3be6eaa59b477c8ff7a55d07e81a081cce786beb5248c0c',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4a1debdca1bace50b3be6eaa59b477c8ff7a55d07e81a081cce786beb5248c0c',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1540028adf959f9faf5b@restmail.net',
    authPW: '14e317ce875d759aaac1fa2c21a42a6b3fc3ab6f9f562510270a8141a6cf1131',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8cef22b4c68a4f9989fe4ad2bc2bea27',
    sessionToken: '35c61d4b78e38434709aa563204d56fa0ee58dc07e185698e112466c077108c8',
    authAt: 1705108697,
    metricsEnabled: true,
    keyFetchToken2: 'a39e1caa501b85a0b3263e6c088039a4b19d151ca22934136a8911c8033f0279',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="87bd7becfee1924093c3cb4acddfe84ce279ea1328a1810191727e845697cf30", ts="1705108697", nonce="h84Tjs", mac="TghforfjwnK5ObQ45hFRJZXEXCDgL2zVw8Xcfv9YlEI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '6c27f9a1533f9bbfa5f54fc715c0cc857ba9b99a359ed43f517340213b5b70555e1bd8382f6a580e527932c233ea031cc96568ce742f0dd0cbc178a650c320dd24a1462712fdaf91a900dda6a75f1ff7011d951a89f063466256eff8e093ff88'
  }
}
    ✔ account reset with keys (1975ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c84d204df5d4de9097c2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c84d204df5d4de9097c2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c84d204df5d4de9097c2@restmail.net',
    authPW: '3a78ccc6ff1238c5b3bd2b6a615baced0ea6e4375475b491ee502d3473b43fe2',
    authPW2: '0ba406aa524f7ca24a432641b09717e50d1c0772c56c6243f83cb421678fd399',
    wrapKb: '79c63388eb613d6f805067a9f8168eed6ae508829dc64cfbf6259ce5d43b000c',
    wrapKb2: '6fd6fc5bb515c4977bd7b3ed09bad0a41b5bc6d58c831c828a76bf36ee89a001',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d65b9795774351a2e85cb53e61b1000726a90d884959d15ac3c263ee77aa4dec',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '17621ad56a2a442db696aee69610faef',
    sessionToken: '43be38db324c258fe9a16649baf0f2e4fbd63027109d31c5e95b84188a483ec5',
    authAt: 1705108697
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '17621ad56a2a442db696aee69610faef',
    code: '1bc3b37b4e637fb0b0a7241bdeeca28d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c84d204df5d4de9097c2@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '2eeeda046b94d66fecb437da7bbae32c9cc6977b3bb33e793cd0a271a793ad80',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ca0f4327ef13b3842c974e16988e5dd81037d67471065891ffd77dc65d366eae", ts="1705108698", nonce="ElFJHE", hash="MDgqs99ASTA0QrwRuQQF3BIWTLhScf62yOxhr0z2/7k=", mac="RH2d2PPcU3A19Ra9iKwb1XCSJSZS+Oj6VZSOpqeN18Y="'
  },
  json: {
    code: '93f0eae25d09598802275ec22791f05c',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '20c074793b9cba36162d049beee0695b36453ef6c95d42d8deb7908bc878eae6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0872ff94dec2d999ba2968c792cda6607dbfe2f9495f84c5ba0596aa6710b90f", ts="1705108698", nonce="UH-w3c", hash="4k3QqpamboXZJFRwAHoBD55EVR0BFMPLPVZiIf4jiLc=", mac="A6yOy8B+4trYOHIX4GwuJFMjbfhxh7MpMhJiHqJL2EY="'
  },
  json: {
    authPW: '110b532fe1d35e302974f714e3fab29d11a801d77c6cc3f81d154afd899fb8b1',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '17621ad56a2a442db696aee69610faef',
    sessionToken: 'b005961418d11b94be56194509df4be853464db51814a12eed7c6e61cd947ad3',
    verified: true,
    authAt: 1705108698
  }
}
    ✔ account reset w/o keys, with sessionToken (729ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '89989a6f9897970f102c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '89989a6f9897970f102c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '89989a6f9897970f102c@restmail.net',
    authPW: 'bc3643038cbbc1f651b454a263f896142a4a1017009247d16a6fce21fe11c7d8',
    authPW2: 'e7690047f9b479d96763a8047820088813f31620937cc47742265dffa6e6af26',
    wrapKb: 'b036a6eb5bfa8f414f5784de52b09fb8226ecd22e9bd170e75071306f390124c',
    wrapKb2: '33e75186d0a52bd275372ac0388e7a174bf7d3f76e8421f2cf3f216177a26038',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2d8af7889432dd9afa7d114b87df173c1023d83ca9ab871a592a9f975b0df6df',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '873eb5ef202c4af49ef70f54742d8f9a',
    sessionToken: 'd43d39c964dfc998497d505c47cf17c675585d43aa0ddc7b567a2629b2becac8',
    authAt: 1705108698,
    keyFetchToken: '477fde5f2a790d8342ae6a306d4e8a5ca9934b1fbca5de334b4c923df9bca3ae',
    keyFetchToken2: 'cdce0facae6a70b1636ec583dd1efc9378a12ec455f4487e51aea0151de55a0d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '873eb5ef202c4af49ef70f54742d8f9a',
    code: '52816db1d49f847713d8708c33340978',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '89989a6f9897970f102c@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '25169e0b1ce0acd8b53d7321b3aac826174de869505f53e212a07824040cac9e',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '89989a6f9897970f102c@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '8f9f252e0fc580d192576a028c83ed5e2ffb3a50c9cee7c78483824e75a16acf',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dc52fa3adb3f4ea840b6fd8f5104bf646000db4ea62c2a3a14edd9b5461b3c0e", ts="1705108699", nonce="z9yhS7", hash="6nWatLZXhVcUM12ZVTQHvonGZ5eBSeczIITSuFez3XE=", mac="B9MfGf60CCaxnGtXJKN7CxENC+fmee/5Y4AKaE1R/C4="'
  },
  json: {
    code: '34b3bad2ff34339756ecd62266a6280e',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'a7e112a22b18fb20fc8049301db8babe7bdb1881cdb14c5c582239e2ab4d3e83'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7e1279a1f2daf938798ba2253a3d28f21b70ebd24a79ffa4296f2ab48361843c", ts="1705108699", nonce="SmSxV3", hash="beoyFzMDWnTYf0NTMMLTyMa/rl7U2KAUQXfMEaf00OA=", mac="15HgeDzUBhHiArolxefGqz1JjpyCO50KMaJBZaY7ba8="'
  },
  json: {
    authPW: '1c11f791263cba8a833085f9f00776b0a8c4bfff781e42754637be47c302629a',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '873eb5ef202c4af49ef70f54742d8f9a',
    sessionToken: '539815526ec584c5898f603c9118d20f434898b6b90c24c03b4ee3d0fc49c3da',
    verified: true,
    authAt: 1705108699
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dc52fa3adb3f4ea840b6fd8f5104bf646000db4ea62c2a3a14edd9b5461b3c0e", ts="1705108699", nonce="MwaouY", hash="eVYkbh9CWUndTAJXN3qZPK4QVmqkl9kBWU8H2EP0hMM=", mac="no2rGK7dfiubdoUHENST+PQNPR13Y6uOlPHQ5qh1Iso="'
  },
  json: {
    code: 'd6a1097b9e1f5f26d0379c30c663709a',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ account reset deletes tokens (787ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '05e809dfc68fdaaa3326@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '05e809dfc68fdaaa3326@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '05e809dfc68fdaaa3326@restmail.net',
    authPW: '60fada24f2f97345fdaa2014689bd4de2784121447755d0e65f7654ab0fd9374',
    authPW2: 'ce4e095b93ea7b0eac26ca6790609be7076624445b9296e04915fbab82fa9cef',
    wrapKb: 'bf4973fe087455d1d915dd66c8ad33ac409696ef0b5fb29c51d82ebc53567660',
    wrapKb2: '896ead3ac893ff2e011700f88133be3388d39c5de023094fb8c886ac5f868b46',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3966a3c295519c017b07e4e9ed9c6d2701b6bf446407bb353ccc6a0e28306bb7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'de2a1844c2ef4759bb9bf4a0b70dd414',
    sessionToken: '1ae550f11bb5436757666b7b9c5e599d7e68fb629dbf6a58f947f9337b886760',
    authAt: 1705108699,
    keyFetchToken: 'cff216aa8f4573ed60e8da15c00789f9c02699f37e2b4df390ded607f5347c14',
    keyFetchToken2: 'bcca3a8e05df4826a63e78b393fa0efd27b00c83ed05da6164a1159636bd241d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'de2a1844c2ef4759bb9bf4a0b70dd414',
    code: '5b1334e0ae4c5fe39a501672865d0a40',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fdecdb18c7313725e2009d4784033d6e3a36e374c19cf9779766e494952ae90b", ts="1705108699", nonce="jVrZKa", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="OltFyn7qiy7VUlK2MvcEI0xWjZS+JYlXUiywM2Uhtls="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZGUyYTE4NDRjMmVmNDc1OWJiOWJmNGEwYjcwZGQ0MTRAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4Njg5NTA3LCJleHAiOjE3MDUxOTUwOTk1MDcsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njk5NDA3LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY5OSwiZnhhLXZlcmlmaWVkRW1haWwiOiIwNWU4MDlkZmM2OGZkYWFhMzMyNkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJlMDNjZDg2MGI0MjdhNDI0OGVmNjJlNTVhNTExMjIzMiIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njk5NDkxLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY5OTQwNywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.Ec0KHfmxU4y0ZhsHTIrEtl9S6zOAqVciNxx28H7WgkHMKzDxZ2wpW9Iqy5E_BoMhaTo_4IyqheEwUC6I9sImEX3Vz6rOf_RYWA1x03jSSsmZgN9XEk-jQVY7Bh7npIOf8mWRpYOhy2EWSluB4Ei1sPUyJRqXmPvXfYIACaUmmdicIXf7wt8czSlKHLIgusueTo8Fzf-fFbtTnCEESfQJUj8Ixbx0Ky8_kAMnM7eETNQDzluk6L4P5JrkkQWDVUXJ_SUa6H0RwJmRb9tSgdzEWz3opIdnZRhdMP4g65kKWw3OOGzRe2kZ8DAMlut_V4zOqXxfUIZYz2JU1kNqbz7oLw'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '05e809dfc68fdaaa3326@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'a6dac4468728fdc56da6db671324def44aa7318d2f24a1972cd6159bf4c602aa',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f915abce9f67b0b95f541759eaa2450e486a3a135ebeeac6190e614cb3ed89cb", ts="1705108700", nonce="1Ym_Sp", hash="+kjSMtygTXRBbqj9ooFfJVG6n5my3l38RnG/jsFWjJs=", mac="YR3TdG8Ls43E8PHHLgXwj2rsD1vyyTZBBVkg6XGfJ+E="'
  },
  json: {
    code: '1cf8c7a8dc34d4b0c25921c8b060188c',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'a6c55ae5daf3db5397e97d1e168dc771b01f27aad07c3afbce57f273a6a5f6da'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1d3092f0f5f504c1fccb57a580efaefd9c3bdd9231310f617df0d70680ed7c8f", ts="1705108700", nonce="PoPrzx", hash="Hm3QgOLToODisgM6vkbKa79b//LGcn+Icioudc4Egfg=", mac="zvU0lMlX/7iVc7kvbXxzaGfjJOcQWkPnI+n41Ljl6q4="'
  },
  json: {
    authPW: 'adfc0c7742b7f9e0d004069958710d1b7e9eb9d6f60b471264f668d20e7de18c',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'de2a1844c2ef4759bb9bf4a0b70dd414',
    sessionToken: '72c8b3f7db5c6c5c6b6fc290723fb8dd9e5c7516008ea242a73012fba436e1da',
    verified: true,
    authAt: 1705108699
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="403cf3f0bd5105d291679fcc0bb14dc874813bcf4833d036ae6a8e09668e84ba", ts="1705108700", nonce="6ivVRw", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="b0wO3VrpEL7Y2bdeH38l2Sy45X3mVoWoX0FAziZTpAs="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZGUyYTE4NDRjMmVmNDc1OWJiOWJmNGEwYjcwZGQ0MTRAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4Njg5NzgwLCJleHAiOjE3MDUxOTUwOTk3ODAsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Njk5NzI5LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODY5OSwiZnhhLXZlcmlmaWVkRW1haWwiOiIwNWU4MDlkZmM2OGZkYWFhMzMyNkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI0MTFjYThkODcwYmQwYmZmZGQwZTZiYmY0OGFlMzkyNSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Njk5NzI5LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODY5OTcyOSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.t9-ERmIMfUty0E0LbNuN7GCZhBrG3NVFmJfFYQiMiqpWj0gNImy-HSRVbTS-C-X5Yc4kHqfehFNn8O3K3uuzAgW11qaFIzybGCtewV3AUsJhhB89nAoKSW-OcLNk8h1wTH3BwsEOaiein6GMs0uplg99IhhOFM_ZZEeqNyyykmrUVrwFnbu87aoK0jerWFjpq8bHhEqZ2P4v_8R3_zaiID6RHQr3vs7rRsoLWFa9wdD-KvCNSZJf5ZJr4u6IjioC-HGdug95hOVHy-TaOKNE-ZkQZ0VheqZwLMwt--lpIfQ8IoXljHo4A-52970IJHqC5c9GWmJPKanLwzR5JKbaOw'
  }
}
    ✔ account reset updates keysChangedAt (767ms)

  #integration - remote account signin verification 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cc79b848760bed0b0ad4@restmail.net',
    authPW: '0ca08822d1d142df466f4549a8a4bef13c20894933b95026faec0aedce6a2062',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '341dfe63e2494841970d1b26919648f4',
    sessionToken: '30fac88fb34de748f91a0607526a4fff8fe9a6054ab5a704c8feea611eec2cdb',
    authAt: 1705108700
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '341dfe63e2494841970d1b26919648f4',
    code: 'e9c3c3250ff5fb970fb422608c0efcee',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a2a48fef64ebcdc8f6777aab281f657bf5afe2818077683bdaacf7420ca7d86c", ts="1705108700", nonce="9nYJyI", mac="w4rT4USI52OUOMH4jNZss+8wCwzVWHv9APUeFtdqcTg="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cc79b848760bed0b0ad4@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cc79b848760bed0b0ad4@restmail.net',
    authPW: '0ca08822d1d142df466f4549a8a4bef13c20894933b95026faec0aedce6a2062',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '341dfe63e2494841970d1b26919648f4',
    sessionToken: '328a8b1b165cf29391a9feebc6f45f20385eb8554d4431a116d635cbd134ae84',
    authAt: 1705108700,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ account signin without keys does not set challenge (420ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '24529ef5fff391ac6c8b@restmail.net',
    authPW: 'ad2bc1b3c57c80a89b8d71f95ff1ed425b505559239c80043b4b90ba3b99fed8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '25d34c5f82224c76a9b551ff95bf1562',
    sessionToken: 'ea06360c70987fde6870aeb6cf7ef6e217359c0ff857dd1cbb99ecc824fda7b8',
    authAt: 1705108700
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '25d34c5f82224c76a9b551ff95bf1562',
    code: '5899366f4c4aa2794816649df5d2113e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="21bd212aedef941ca68f6bb1709d721b8b64fa7084cf1704dd8ffd09477abd84", ts="1705108700", nonce="q9fR9s", mac="j/BTuW98cR2za7Nxl4Jpamlb3xKr7jsDqrhv2gFvM3E="'
  },
  json: true
}
!!! response success {
  body: {
    email: '24529ef5fff391ac6c8b@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '24529ef5fff391ac6c8b@restmail.net',
    authPW: 'ad2bc1b3c57c80a89b8d71f95ff1ed425b505559239c80043b4b90ba3b99fed8',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '25d34c5f82224c76a9b551ff95bf1562',
    sessionToken: '04c44c8c08a0a7a7926321f102c3e1373c462c33d7a0df0483ccf7adf0b8a838',
    authAt: 1705108700,
    metricsEnabled: true,
    keyFetchToken: 'd6ac73219270b09b58d479059abd6fbf5473bd1fe06b08a3789cb6200ea89a33',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
    ✔ account signin with keys does set challenge (420ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '752d3b63b6a78b73de97@restmail.net',
    authPW: '74d7de66dcb78fdf6999c018a7ea6ea392b6643520d333b6695b77d8922ef69f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0ff13c78380a4aad9560b2f87f5fe000',
    sessionToken: '68a2b3dbcbe9213d8634e4471d7c3de159375623d49c06e745fe551f5676a9f1',
    authAt: 1705108700
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0ff13c78380a4aad9560b2f87f5fe000',
    code: '5cfbdbcad7bde2ca503c13d2963f3fd1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="acef7285929199152365e783c4dd2b3c988029227e4c939cc9332fb31020de52", ts="1705108701", nonce="YzQ5El", mac="nf76wt0hcWQDjihpUhg+0caEOcYlZPsD4TMZUImVBxY="'
  },
  json: true
}
!!! response success {
  body: {
    email: '752d3b63b6a78b73de97@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '752d3b63b6a78b73de97@restmail.net',
    authPW: '74d7de66dcb78fdf6999c018a7ea6ea392b6643520d333b6695b77d8922ef69f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108700683,
      flowId: 'bdefaf3b12fd980bf2d980a89d49cbeb19d2d8a7c83951875389078a9a80dfe7'
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0ff13c78380a4aad9560b2f87f5fe000',
    sessionToken: '82df264bdf972d4f4c14df4f5a8dcfa3dfc5818ad1d967debaecf7802c69ae4c',
    authAt: 1705108701,
    metricsEnabled: true,
    keyFetchToken: 'ced1f50c5ac2aa2fd35af4773351e5be66b640b5ee970964a53db7bd5015d508',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0671b78351bd40350adf5c8658cb5c9c584db4dbb6a692882e05bc913553abcb", ts="1705108701", nonce="wCqZBB", mac="gmmYn+OZMcLE3hmyHa03OEDCJuztflafLDDGP4kXCmA="'
  },
  json: true
}
!!! response success {
  body: {
    email: '752d3b63b6a78b73de97@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0ff13c78380a4aad9560b2f87f5fe000',
    code: 'b64821ffba79e9cfae4bb4e5b4329a98',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0671b78351bd40350adf5c8658cb5c9c584db4dbb6a692882e05bc913553abcb", ts="1705108701", nonce="xNeSay", mac="w2S5cmt6G+UFQ3OX7nAUNxsPCNmHXGTt4kbqPJq80Fc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '752d3b63b6a78b73de97@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ account can verify new sign-in from email (433ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '22263681304963fe3aa4@restmail.net',
    authPW: '584732328ab1138d72736ddb76c14862751ef60af7d64241b2692cd63195bdc6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '972f2e33bc2340dbbec6b1d24f22096f',
    sessionToken: 'e8483052f56b8baf7173d33f7369b19c4967f0de8800d7c4bf83dbe1829b887d',
    authAt: 1705108701
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '972f2e33bc2340dbbec6b1d24f22096f',
    code: '9a9c0816a066c1b8894f41974b76cd2a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '22263681304963fe3aa4@restmail.net',
    authPW: '584732328ab1138d72736ddb76c14862751ef60af7d64241b2692cd63195bdc6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '972f2e33bc2340dbbec6b1d24f22096f',
    sessionToken: '1e26a50d442e084be9b8e37c47b4bf9686309219fb07d36b8d4fa586bd99ff2b',
    authAt: 1705108701,
    metricsEnabled: true,
    keyFetchToken: 'e0aa661c170887297942011aa65fc72b39f8fe9f1edecfe6bf94192dba4cadd5',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="959122484eb5e29d155d804c305139f3683061313fcf0138ae5d604244a94d4a", ts="1705108702", nonce="MvqXYe", mac="k5OaBAem1gzQKgqpG4ZexX8eo4xUj5z8GRsfxLVmsZU="'
  },
  json: true
}
!!! response success {
  body: {
    email: '22263681304963fe3aa4@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '972f2e33bc2340dbbec6b1d24f22096f',
    code: '9a9c0816a066c1b8894f41974b76cd2a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ Account verification links still work after session verification (422ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '15ade490866ca7e912c9@restmail.net',
    authPW: '11b713a881cbeeb03da5cab6827a254c1dfb85319dba9b185330a38776456181',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '49df82a561a043bcaf330a46bf07427a',
    sessionToken: '6dd43bbfc984e672fff5cb6476141b0621f11eb2ba6c960d4905308d5f3e3dc2',
    authAt: 1705108701,
    keyFetchToken: '6ceb5fbc510af829f5e47ab50d3d7f9102f8c7175caa8a1eab41c3447de9b5c5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '49df82a561a043bcaf330a46bf07427a',
    code: '7bce2ee14a4f96e2faa9e6d9010cf67f',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '15ade490866ca7e912c9@restmail.net',
    authPW: '11b713a881cbeeb03da5cab6827a254c1dfb85319dba9b185330a38776456181',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '49df82a561a043bcaf330a46bf07427a',
    sessionToken: '440ebaa94f17a509f2c06526f268c4285c9089a78cc4cff77bdded6a55c04023',
    authAt: 1705108701,
    metricsEnabled: true,
    keyFetchToken: '39fb218f17a1754335df6f450c872ca1c8d9638453ccc9c9b1da1973ead8136f',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
    ✔ sign-in verification email link (433ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9eff6c434920a361a9f4@restmail.net',
    authPW: '2908862099feb1ec3d3aeadd15ccf3519ac2677984b74b24f3e06e9c4ecb2c3d',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    sessionToken: 'ebe569311e657d4ca0b989f28e1b0ccd93617b7c0b2cdcfcfb8992450571ce2e',
    authAt: 1705108702,
    keyFetchToken: '876e3bc9152a01390c1ad8c8a4278888e1e00e36906b5b8c5c72fc493fb9631c'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    code: '99590acb014d3ff6b6e86478ae030822',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9eff6c434920a361a9f4@restmail.net',
    authPW: '2908862099feb1ec3d3aeadd15ccf3519ac2677984b74b24f3e06e9c4ecb2c3d',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    sessionToken: 'bf6f6d2712f2eb30ef33f485d040ff04678b6c06a413e39ea8b4406bd67be535',
    authAt: 1705108702,
    metricsEnabled: true,
    keyFetchToken: 'c919b7742c5bd564923db314e89aceafa2fde7a6dc0c80cf34e82e3e2d843da7',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9eff6c434920a361a9f4@restmail.net',
    authPW: '2908862099feb1ec3d3aeadd15ccf3519ac2677984b74b24f3e06e9c4ecb2c3d',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    sessionToken: '4b8c6e2528591686db77d101b94d582d57aa48ed62df0e1a6f27c332033e3024',
    authAt: 1705108702,
    metricsEnabled: true,
    keyFetchToken: '27ea5a02e3cdac68a1e536b581cdf3928272f770ab006660d8adc6b6d00a1360',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9eff6c434920a361a9f4@restmail.net',
    authPW: '2908862099feb1ec3d3aeadd15ccf3519ac2677984b74b24f3e06e9c4ecb2c3d',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    sessionToken: 'daa0784f021a7e8c470acca767648db805d6d1787cef6b7946b2549b2b0af271',
    authAt: 1705108702,
    metricsEnabled: true,
    keyFetchToken: '68b92602bcc10719ff709c5e694cb2ba83bd264ade44ccd4700523223a49420f',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e4a92b3ab8c8485fa09009b313f95cba',
    code: '084eeeae08c7b6b2015bd2d7cdabfa5f',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="da0983111232574301c6921b5cfdcb7545b176b4eb1d8bf83397a9b967406345", ts="1705108703", nonce="hjHsky", mac="maWEHxhx1DFKHflDV0Zpb0VbUC8Tuxmt6X2xVxdtbsc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9eff6c434920a361a9f4@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0598629714c2ae3f8a313a50fa237cff118232fb1e0516c9dd26c85d905461c9", ts="1705108703", nonce="jAs0qf", mac="XNLAQSFYawfxpXxLG8tUqvKPuSdNQr8rj48MyDBj9dE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9eff6c434920a361a9f4@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
    ✔ sign-in verification from different client (836ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea75e73e0507e1aa2e42@restmail.net',
    authPW: 'f482757b8b836ccf8949a05212e4fc22304325eab1e8ec143c4014dfb85d4675',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '05e06bfb65dd4f7c82dc4151965e2c85',
    sessionToken: '79f4c400951be433a1b2405fa976ffab8623254b08860748ef9beedc8d4db5d2',
    authAt: 1705108702,
    keyFetchToken: '11422e911bfa2aade587076a898863db57da3821d9098fba633eae7bffc8d631'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '05e06bfb65dd4f7c82dc4151965e2c85',
    code: 'e5f955b6d1def61ee5548afd0752f1f8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b3232b5933400b568132c06ec67f706720e17cc5bb08dfacf39b52f90f5305ba", ts="1705108703", nonce="vmJJA0", mac="ScHn1Igdq7Fb6E3LDWioty0YP6OwWGn99AJsa0YjS6c="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ea75e73e0507e1aa2e42@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea75e73e0507e1aa2e42@restmail.net',
    authPW: 'f482757b8b836ccf8949a05212e4fc22304325eab1e8ec143c4014dfb85d4675',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '05e06bfb65dd4f7c82dc4151965e2c85',
    sessionToken: '33b3c33d21a20a87126f2d42d9b99d1cb3505dbd7852002a62a7c55099268268',
    authAt: 1705108703,
    metricsEnabled: true,
    keyFetchToken: '363cd8d7da39d7d02219e040bc60ae819070c1ab6bc3a120f61674acfee211fd',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6857d4860433cdec6c211843388c7953d4bf46b9bc104dbd0c696523de51ad58", ts="1705108703", nonce="mTaKan", mac="yy2T0tXQezQDNFrbgh4+oWVU+K3QoZswvlbl1yRzXYM="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ea75e73e0507e1aa2e42@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6857d4860433cdec6c211843388c7953d4bf46b9bc104dbd0c696523de51ad58", ts="1705108703", nonce="oNh6OR", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="zGRbJ2jn7Ys3BcWOwKUUhoC3jnDCk2fcTDyC8j/n3+c="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ certificate sign with unverified session, keys=true (429ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0c672c9ee2e13557db0d@restmail.net',
    authPW: '612e5e98e9d644c200830f15cfcbcaba9b91b0af71ac6063356433b28aaf7f39',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'da8573bccc9e4a61b8577c624839b43e',
    sessionToken: '18a486074853e1b5f8c4da7589ad11f758f3a7cb1466a9fbf8d17d6f383ffd57',
    authAt: 1705108703,
    keyFetchToken: 'af2585cfe7796a64517dee10420f23552f8c7ed9c4189f3841ca86c9c531bb2f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'da8573bccc9e4a61b8577c624839b43e',
    code: '6215173c44bb6ef6121d7e5f1e5acf41',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a8f81a51aecf8d0b1a592eedf2ba86c46ff3390ac3e1a9c870aa0fd9b64874d9", ts="1705108703", nonce="eXghRk", mac="+8d/dRrCcPqVhgrUbvzylxzRxzZx5uRZ6KrSVOvXzq0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0c672c9ee2e13557db0d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '0c672c9ee2e13557db0d@restmail.net',
    authPW: '612e5e98e9d644c200830f15cfcbcaba9b91b0af71ac6063356433b28aaf7f39',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'da8573bccc9e4a61b8577c624839b43e',
    sessionToken: 'cf643974868cf1e428302de17ea32992e4bb7a958d18d76727a0249e07761381',
    authAt: 1705108703,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="171bbb5a87647196590cda3919f5f204ddd5fbe5394262dd9d96907e53d8cc87", ts="1705108704", nonce="4u44Au", mac="7dbpBhNBH/alxKwL2t1+Vv9urbidtsT+Bn2yHS5xnFI="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0c672c9ee2e13557db0d@restmail.net',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="171bbb5a87647196590cda3919f5f204ddd5fbe5394262dd9d96907e53d8cc87", ts="1705108704", nonce="GH4VD7", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="t0dxNlutuWxtfA7cSy87YzWdji9qPijqyv3eio8snyk="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZGE4NTczYmNjYzllNGE2MWI4NTc3YzYyNDgzOWI0M2VAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjkzNjYyLCJleHAiOjE3MDUxOTUxMDM2NjIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzAzMzY2LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcwMywiZnhhLXZlcmlmaWVkRW1haWwiOiIwYzY3MmM5ZWUyZTEzNTU3ZGIwZEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI5YjgwZDk5YmU4Y2VlMGU5ZTg4MjhlYzRlMGZlMDc0ZCIsImZ4YS10b2tlblZlcmlmaWVkIjpmYWxzZSwiZnhhLWFtciI6WyJwd2QiXSwiZnhhLWFhbCI6MSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg3MDM0NDcsImZ4YS1rZXlzQ2hhbmdlZEF0IjoxNzA1MTA4NzAzMzY2LCJpc3MiOiJsb2NhbGhvc3Q6OTAwMCJ9.LIZkJx_5yiwcfq6Ak8V_JSzNqYmgArTV0oEk5XjqjN6aPo07jMX2ymSA81oHUp51u_dFuHfR0oxVLrQwMlULjpFVtGx-d3yo5C7z3JnxgHSDUqirAfQuOYoCBuIatgPuvMS3jFEduA1v8U5nuZtByym0-jY6UjOnfzzBeXNlGK2NaqaS7UNDGBqXd8ZgUEJaY8t_PFSZZcgLywkcOz4tyVSSKCapkmPjE6KngU5xMD0agZAFNG-mcU-IjCwfTiwQAPwOqXYIOjO0nC6U0eulhyaiIs8s3Iz8cXYutEpCVdc73blSUx6M0P8NnaoWeIJW12XhmqAtrRTtgVP-L9hO7g'
  }
}
    ✔ certificate sign with unverified session, keys=false (426ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '15dca91645fba9c33114@restmail.net',
    authPW: '0696adefc87fd21e75cc65506d89ea616fa015f802169635ad0fe6af2bb79edc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6fb1fb50ad584ab6b104082faff3e5ae',
    sessionToken: '9f07202755f92daa22218d627eb964e76e13167b85f30331d35049779391a7fc',
    authAt: 1705108703,
    keyFetchToken: 'd9639cc6c584c1287868b6294077c331b3200633855f433db7cf1688fe48525d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6fb1fb50ad584ab6b104082faff3e5ae',
    code: '2fd48d7dba5c1748f55a5f9f11f28a24',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="25492a87cfca33f968b6dc28677a7cf5922cca917c6d28afabd40eff671d08dd", ts="1705108704", nonce="-BXXmC", mac="7z57pqVxJd32dGqa2N7GiLyBdjkxuQW1R0Xi+1ueXXw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '15dca91645fba9c33114@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="25492a87cfca33f968b6dc28677a7cf5922cca917c6d28afabd40eff671d08dd", ts="1705108704", nonce="GN9eVk", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="hepE4Tc5phGoQ5TvrK3JkYWFyQafvB+sfYaGDEkRIM0="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNmZiMWZiNTBhZDU4NGFiNmIxMDQwODJmYWZmM2U1YWVAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NjkzODg2LCJleHAiOjE3MDUxOTUxMDM4ODYsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzAzNzkzLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcwMywiZnhhLXZlcmlmaWVkRW1haWwiOiIxNWRjYTkxNjQ1ZmJhOWMzMzExNEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIyNWNiN2M3ZGRlNTc4Mjg5M2MxMTM2MzQ0YWYyYmY0ZCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzAzODY3LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODcwMzc5MywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.sYcUzqAUFPZ-GKv0YLdklkfTEWqx8IHz620odhc-H5gmL9HrDiEsiYu4m3GB13QRvaUutCofS5aaEa1S5d1phAHdVms_8HmQPG64LMpXaT3NR1VR0__DyNglLju35IDN4gIS8OEEZxE_lnLzJWiALXjgDBBcG0RMRK2B2jtBBxVewrQFeSrCGCsJPpNwca1i7QiFvzK80IITxcM6CCPkktCY9u-3lr_yaGhqyyModcdwugQxtpBn1t6yV8MmjbF-GYqopR8XLS5peCAk33jtfclhGamG5jcq7GX4BSQfhMdL-BcxpjvKoQQK6nMBiqH1mhIPoZi3Q7poIHWPsGykfQ'
  }
}
    ✔ certificate sign with verified session (225ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '04787ef9ac9b63843fe9@restmail.net',
    authPW: '83f72da93e5e0b3c9c34cf2a53589f78f3451c31b1fde6ce61d91633828bd636',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '30c0f9c4e4174690acb6d309140a3562',
    sessionToken: '4341c7c973e83d388556ee7564243154ba4aeabe80dc3e9a598d09b11f78ad24',
    authAt: 1705108704,
    keyFetchToken: 'ace187395d12e46e33abff74fa88d4a75792ef2114439c6eaba5195abfeb7f84'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0f9bde37787d0e494266f0b39dae7b1f5f668de77d97532fddbfb935c67862d6", ts="1705108704", nonce="ae6m4n", mac="NJtnyPggLdroXaiMnmAnOV8PkCEiC6bTjgQSUxOicEc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '04787ef9ac9b63843fe9@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c196517abc150073d344a329f52d8a743e48278cc4e859ad01faae92ddeb1100", ts="1705108704", nonce="Qg5ifu", mac="jmBpB26DPSLl64TR+fyw1WURQbUF3q6QcaItb6a6cqY="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '30c0f9c4e4174690acb6d309140a3562',
    code: '598e0dedcdc29358bafeaa1a26620237',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0f9bde37787d0e494266f0b39dae7b1f5f668de77d97532fddbfb935c67862d6", ts="1705108704", nonce="uFg6iw", mac="yYmynSFRGB/KXZs4bU8QqwFX44jmYv8ITApE8cY8Ioc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '04787ef9ac9b63843fe9@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c196517abc150073d344a329f52d8a743e48278cc4e859ad01faae92ddeb1100", ts="1705108704", nonce="LE-4RO", mac="Lc+788LdQB3VO9sFPE5Xfh6qomCaGXnGR7aZPk7fwNM="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '40bad83aabf7e916796cf006e077023c4b7f216d925879f746b0069860c34c45c51602d7d4974d77870f2554d36e76adc9f2a44acb00c2eca3da8c23908cc987ae0eb4317add405cc0ca8f124197721d5a328edae2ac0889c369a18cb346605f'
  }
}
    ✔ account keys, return keys on verified account (241ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b9752039895cf4e4bd1e@restmail.net',
    authPW: 'a6f7865818a14086165bbb40982fd16ca93b660c077bedc8adbd763fb7df5557',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fe9f8b2057bd4495a53c981798874356',
    sessionToken: '64b5998debaf72715ded5b9e0d527b1bf768d9dbaaa813711fd3a840b54c983a',
    authAt: 1705108704,
    keyFetchToken: 'e7bbd6fd559669dcc7223881d062c863cad707ecb2c977be84b797f7204d0288'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fe9f8b2057bd4495a53c981798874356',
    code: '2d2a41d4a313d15be6b9c452c6f9039e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b9752039895cf4e4bd1e@restmail.net',
    authPW: 'a6f7865818a14086165bbb40982fd16ca93b660c077bedc8adbd763fb7df5557',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fe9f8b2057bd4495a53c981798874356',
    sessionToken: '74451627196a5b003cbfbd531c3644ddce7317b0b573e51f176ab116f763e91c',
    authAt: 1705108704,
    metricsEnabled: true,
    keyFetchToken: '43f1c7a864f97081d74f1c753324a7ce72661fc8f6521549800e89c3a7e4a88b',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2567aa953b93b3c9ff83ed66850ae583588be80f6102e4bd0a3ed0b3d71e4146", ts="1705108705", nonce="dSkxzk", mac="mZGECuXpbkQQqz/lZ/PtzWiMh2ZIUcPlhysaNUeMMQA="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fba53f36dd23c415a39c8bcabb1b940a856f0fd7cc832f9962aff093cde8a4e7", ts="1705108705", nonce="9MqWrY", mac="HMZeNh86Ynstq37o020oKHGRX9HhVl/eQBc49xQe0QQ="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b9752039895cf4e4bd1e@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fe9f8b2057bd4495a53c981798874356',
    code: '1739b6ec2be7c322155adf86d4c36de5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fba53f36dd23c415a39c8bcabb1b940a856f0fd7cc832f9962aff093cde8a4e7", ts="1705108705", nonce="ijLgWW", mac="s77UMQXqc7rRMNfjo6VHPfWkN1Gd7yQPfcc++O+bqUI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b9752039895cf4e4bd1e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2567aa953b93b3c9ff83ed66850ae583588be80f6102e4bd0a3ed0b3d71e4146", ts="1705108705", nonce="kwDkYN", mac="53KXKN+KNh3bgjFebrlIDFK+efC9Ow+MhlP38IyypnA="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'aa54c07e9353b63723abdd0d06c35072ee2eee14f6e58fa7826afe035b52c0fe9371790e97767334972e0f1f84afa1f2211c7396fe6a6cee88448100fed2514f5c818cfb2f46a5327f98dfe3555d1b2b3d87140384ba7ae7bfc89c91fe17433d'
  }
}
    ✔ account keys, return keys on verified login (434ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e74ce7c783c15e7aaf47@restmail.net',
    authPW: '403eb9a24fe844efd8a0e700a7d14815cbe7dd32ddc5e8514357ce64d5e5a585',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '09ad214cf964423589e1eb6ac6c733f3',
    sessionToken: '589bb912ee3af1b274f37bf27f5d8ba1d07533e56ba04979614e73da82c5010a',
    authAt: 1705108704,
    keyFetchToken: 'a171e652faf49cb519eee8fedc0b1c1f25c481817859c8dffd25012d1aa6800e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e74ce7c783c15e7aaf47@restmail.net',
    authPW: '403eb9a24fe844efd8a0e700a7d14815cbe7dd32ddc5e8514357ce64d5e5a585',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '09ad214cf964423589e1eb6ac6c733f3',
    sessionToken: '2334a6e0490d3495c8713b530711f89091c6d49b556d37317393ebddfc488362',
    authAt: 1705108704,
    metricsEnabled: true,
    keyFetchToken: 'c226bf402f8c6a23088af62d7f7418c212efcffb6b20641aac012e3caba1bb87',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '09ad214cf964423589e1eb6ac6c733f3',
    code: '33212df2f929dc5a967c8369ac4acbff',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a895ac969888e5653f8786c722bd8d7ee5ec26f4966aee0b51d1e91bcb87fce3", ts="1705108705", nonce="SCdkV6", mac="XtiNuOiq/AU5fqEhEmPrnqqS0L8CAoHpCFtu1P1C/AU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e74ce7c783c15e7aaf47@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1dde85230c8b2478bef49172029938a1a8325954a7029a3e2d5d5f085413622f", ts="1705108705", nonce="K_VTwd", mac="sBzX6d89RAPNxzstHa5x9mqFZDkfPBAILmXvTz49T5k="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '8f4c1a2cef8bbe1240bf51d918e30649105cb8eeffd726512b1f4ed0687c302d5d193fb7ebee03af55ff193031619d3a5b02899bb4997f011a5fe45706e1c101c5845e45c9cd3fbdec47700ee66a223d5e8fdc1562281fa03474e352b0dfc36c'
  }
}
    ✔ unverified account is verified on sign-in confirmation (417ms)

  #integration - remote account signin verification V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'deb7c8efe5487e46decb@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'deb7c8efe5487e46decb@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'deb7c8efe5487e46decb@restmail.net',
    authPW: 'ff39ce3b7e8b070fb585f4cca18099e265699ac30d3c3cf011b4361a95890081',
    authPW2: 'f82dced1db83b3d2d4f9ab4edb3a128b64ce2a99cb76c173cb08a3f4920f824c',
    wrapKb: '466de3ae7452f343c252b0726ca8050f81909cca9b7724c2c4a360f57e481796',
    wrapKb2: 'c27efde30f7f7d5f1a4d6b5e3707ca4315d6185850699cafad0de658172804a3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0d8a1fb5fdf52a9b1aed3ddd59ff4ff504d3e240086008b30dcfeb1be416073a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '33ec8a379e0840e0a0a0b30a24080dbd',
    sessionToken: 'eb4b5597551af06d03bd09c5858cfb62f25292ecee14e6c0cd424ea9edfe77fd',
    authAt: 1705108705
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '33ec8a379e0840e0a0a0b30a24080dbd',
    code: '4face44a6a9e9e07cfd16bd09ab22887',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dbc0e9420c103c1ab334f4f0da3115956753867dfd41cbdd7db443bb81c674b1", ts="1705108706", nonce="A00vI9", mac="SSE5GscC/WjoSMQrDOd6WB+droikyQuNgT2TEKoA1H4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'deb7c8efe5487e46decb@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'deb7c8efe5487e46decb@restmail.net',
    authPW: 'f82dced1db83b3d2d4f9ab4edb3a128b64ce2a99cb76c173cb08a3f4920f824c',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '33ec8a379e0840e0a0a0b30a24080dbd',
    sessionToken: 'df6d5771bb9e3160e44de2223147f63dc1e9c3e52af2cb5a8f7e4336678c7f7e',
    authAt: 1705108705,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ account signin without keys does not set challenge (682ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9031ca0c6efc29711d2c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '9031ca0c6efc29711d2c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9031ca0c6efc29711d2c@restmail.net',
    authPW: 'e33a899c5b42cfb9edaa5531e4c4252d118d5cb8d7feef9a30f696d69f9fb532',
    authPW2: 'a2c1cd145cf38cf4a9bb6c3ec9f2617848bcbc14a109c543a199e56e1658d811',
    wrapKb: 'e39de4cd6327f4cb62561e93583826784fb7901b240a21b6e4d1089d2c5b1fd2',
    wrapKb2: '7eb2e7e54de2792ce23f0e3c5f903363c10f79744b4e6ddeb82b12b5dfea6e26',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:33aa8425527edade14bea471dc9be7e4aaaa1757331aa2f3e97201db4ee8afda',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'befe1881c66a4355aace71d0a9c6fc02',
    sessionToken: '13f3d5c2632ff468e56756b99353d162bbf1752a2abe9434db31c2f378b5045c',
    authAt: 1705108706
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'befe1881c66a4355aace71d0a9c6fc02',
    code: 'c26eb17b3ea22e9e98566bd845d3e5d8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e874575c8703cfa76fb6874aea64c1cf714720bde93a4294a0f68789b5b01034", ts="1705108706", nonce="VoeiIZ", mac="PkK9aaSbiUEDIIbt0uzuG7ZT5tJ20sWiRtb/ryht+1Q="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9031ca0c6efc29711d2c@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9031ca0c6efc29711d2c@restmail.net',
    authPW: 'a2c1cd145cf38cf4a9bb6c3ec9f2617848bcbc14a109c543a199e56e1658d811',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'befe1881c66a4355aace71d0a9c6fc02',
    sessionToken: 'b2aab41530097a283d7db617a74e0c730cf088a803234592d609386dc656f2a2',
    authAt: 1705108706,
    metricsEnabled: true,
    keyFetchToken2: '4dbd6ef42c017918252ef0f0b96c5c04f22705f5a929d23b3b5003e916e32b5e',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
    ✔ account signin with keys does set challenge (671ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'da59153b5e9964361328@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'da59153b5e9964361328@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'da59153b5e9964361328@restmail.net',
    authPW: 'b436c6f8d15bb8844d3dd779733933426b8f9167d5b215ebbf17478dda7cd96b',
    authPW2: 'b75a31f9edd70268c3065ce0bcfa2562c5d28b6473edee84173004413d1e0b33',
    wrapKb: '88a3512dadd1f7c81bb951e034914e0adc15b9dba27f15e09c46e9ad851996df',
    wrapKb2: '9f19c1e61c15cb66ba38ffc900a504710e8ecb4df24a1aa23e43038f57b4cf3a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:75655238cc1c9db08b98a87e868fdff2a2782fe3719d9fec9656d93ba62ed57f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '68336db6a4c94df19aae3f572e1e61ab',
    sessionToken: '3a60217396e8d335719ee16688709df016310ae59951724b399a1f0f9d57fb98',
    authAt: 1705108706
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '68336db6a4c94df19aae3f572e1e61ab',
    code: '9cfee5f0a892a86ae18251afa040d054',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eb8276ae64c11d05fe3f18f1dbf37fba866a92a927ed7087261982ca7d6813f8", ts="1705108707", nonce="ilTWWk", mac="oSkTZfI7GYjxniMZ2NvsDezwvsQM9gPmeYkCDY3tsBk="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'da59153b5e9964361328@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'da59153b5e9964361328@restmail.net',
    authPW: 'b75a31f9edd70268c3065ce0bcfa2562c5d28b6473edee84173004413d1e0b33',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108706390,
      flowId: 'a4d40e898f3ea68ea1eed98c034def0187cfdf8fad9201e514de99ddc4c20482'
    },
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '68336db6a4c94df19aae3f572e1e61ab',
    sessionToken: '04c9b56067e4436a8ac5725b5f92663ca3db1e78f59ec0c742caaf33c9f5da2b',
    authAt: 1705108707,
    metricsEnabled: true,
    keyFetchToken2: 'f444e8dea0e89b7c29822ab74672ae192e8ef817a9129ef3f34100334a4bb30d',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="279804b6e00b3414c29a98214d4addbcbdf8b96eb182e7c94efe9d064e2dabf8", ts="1705108707", nonce="Du3quM", mac="wS1BAZ6klF+uEJrReW7CPcT6Jtm88lPUzJmQmBc9ayM="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'da59153b5e9964361328@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '68336db6a4c94df19aae3f572e1e61ab',
    code: 'e65bfd3a1e9bb932a100b189c324508b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="279804b6e00b3414c29a98214d4addbcbdf8b96eb182e7c94efe9d064e2dabf8", ts="1705108707", nonce="bVKwGI", mac="bl/tek1cj0JNixZC08vrqCVu3Si8Dgl4782KUquf4zE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'da59153b5e9964361328@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ account can verify new sign-in from email (699ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9b72703a32d23b69a102@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '9b72703a32d23b69a102@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9b72703a32d23b69a102@restmail.net',
    authPW: '2ae5e23da71671f02331957206c1b472c2b73135502264b18252bf41fc7975a8',
    authPW2: 'c2cd368bbde986b0c98c5d41e4713b0b6d834ce20f1053af64ba5a43ffdce501',
    wrapKb: 'd3b6286c960f20dedf29f7b08654618d118274c4a3dfad3ac6143a9803f3983f',
    wrapKb2: '73076b2d7c874621d4115e3aa1ac693a89167ed743859035855a5f0c430e3880',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3a84b69b48f81deb3e34130af6818db59a38e6d8f902ca077faea49188047bf7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8917e38b086847e394aee266b5e57dcf',
    sessionToken: 'fd42011f4e414b7e88e7913c47ceaf06056c9f7ebdba862e18970033f7fca604',
    authAt: 1705108707
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8917e38b086847e394aee266b5e57dcf',
    code: 'e48d760ccfbb1fa4bf759a923f79cfff',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9b72703a32d23b69a102@restmail.net',
    authPW: 'c2cd368bbde986b0c98c5d41e4713b0b6d834ce20f1053af64ba5a43ffdce501',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8917e38b086847e394aee266b5e57dcf',
    sessionToken: '9f7f4a581fe3fc89236f3ec42251b7476a56a926a2989598d771e900616c85c5',
    authAt: 1705108707,
    metricsEnabled: true,
    keyFetchToken2: 'e7e0dacd2544313dbfd26d1d15e90e8646e8bbde5741a3459e97979dd38a0631',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1b15a922e30973be59b938cb527331a4b462217e5c76687de59e6b1558a9d3e9", ts="1705108708", nonce="rVG7J8", mac="LHA3QeFTDS9cXH/LP84bcw295n+TOSzT5oecuwlQOd4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9b72703a32d23b69a102@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8917e38b086847e394aee266b5e57dcf',
    code: 'e48d760ccfbb1fa4bf759a923f79cfff',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ Account verification links still work after session verification (684ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '158d0e86f638c84bf700@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '158d0e86f638c84bf700@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '158d0e86f638c84bf700@restmail.net',
    authPW: 'ff5a4a7fa7bcdf795c0b8dca97ef7a31685e3f8b1751c2771c73d307942fe232',
    authPW2: '353c82e78c4b4bdfab4bcadd325940deff910bf06669f35f999ce3a61172db93',
    wrapKb: '5a710f5a812aee0fd3a316d00e1cb012c578dfce448bee451d0133ffc517761d',
    wrapKb2: '5d3333adf89ab03ecdee7949a843244dd3c07eaf7fc5600e76ea5da10f83259b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cfc91e8b332180c69fc36718db52061633603a7e7008aef67b453c7cc57f203d',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '19186ba719b4421fb8e625b1f30b2712',
    sessionToken: '6287fea793e58cb3c7898e39edea249e128f91b7d5e64c9e20ca0369c6d19eca',
    authAt: 1705108708,
    keyFetchToken: '5f6489e8f4e1a06892f74b3026af42dc9052b321db2951260f4c71c6bc5396e4',
    keyFetchToken2: '875701b3ba9ac2a4401afff7d4f393f09db99f7044582ba574d4d20a2a6564a3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '19186ba719b4421fb8e625b1f30b2712',
    code: 'f2a74a553e0618699f21e6170b69f746',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '158d0e86f638c84bf700@restmail.net',
    authPW: '353c82e78c4b4bdfab4bcadd325940deff910bf06669f35f999ce3a61172db93',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '19186ba719b4421fb8e625b1f30b2712',
    sessionToken: 'c3bd7f7634223732a129b72b3926b6bba8efbbfb3d1e251c5cd3cc31cd6c3c92',
    authAt: 1705108708,
    metricsEnabled: true,
    keyFetchToken2: 'da19394b05ef5a71ff99c6625fea8f8ba2b3e03595cf0c69af7c8f144148b283',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
    ✔ sign-in verification email link (702ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3bab811860f7a2d60cac@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3bab811860f7a2d60cac@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3bab811860f7a2d60cac@restmail.net',
    authPW: 'ea6bb8047aea4bf520553219902f7e9a1af9d09479e6e90522820959d76aa45d',
    authPW2: '8d3b7b8f0797e610280d4a7ff0c4b5990fa4cadd5046270ec943d5aeb2f7bc49',
    wrapKb: 'f492d8d1e017d88d3bdb050fec85e9247d98e87db4977bd91510070935876a03',
    wrapKb2: '22631e614af9e6733e0ca9a4b8a68eb25b9ba95ad8d081d0bed02d82e6d8afd0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bd3adc0e7484c19f2dc20afe9b856819d936fc7e3da45e949573aa8fb310f08f',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    sessionToken: '6819632ed19be9b95a83ab69221bd6893cb450c40890a426ed9e5ca80daa29cb',
    authAt: 1705108708,
    keyFetchToken: 'e92d9aa2608de911331c963e6837c40e6a4d94f4fc4f1f56385dadb9e8befcd3',
    keyFetchToken2: '20acbd2f4e298bfc185186db87f5ffd8a086c81c498cdb9b5442556c9f038148'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    code: '57c4adad424c4b8f897920823cab970a',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3bab811860f7a2d60cac@restmail.net',
    authPW: '8d3b7b8f0797e610280d4a7ff0c4b5990fa4cadd5046270ec943d5aeb2f7bc49',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    sessionToken: '6c684d0973bfa463105bf7996d7091f63bd79eec188faf8af1437c9b5ee7e73d',
    authAt: 1705108709,
    metricsEnabled: true,
    keyFetchToken2: 'cf975798752b6b4883cdae4c4a2ab5f916ce92cdfd8e7d4e26985bdf7934f78d',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3bab811860f7a2d60cac@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bd3adc0e7484c19f2dc20afe9b856819d936fc7e3da45e949573aa8fb310f08f',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bd3adc0e7484c19f2dc20afe9b856819d936fc7e3da45e949573aa8fb310f08f',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bd3adc0e7484c19f2dc20afe9b856819d936fc7e3da45e949573aa8fb310f08f',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3bab811860f7a2d60cac@restmail.net',
    authPW: '8d3b7b8f0797e610280d4a7ff0c4b5990fa4cadd5046270ec943d5aeb2f7bc49',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    sessionToken: 'd0c5fe78e7bd6d03bd5c47a0cb31719d3aedb1a56734624ee0d96e05b00517f4',
    authAt: 1705108709,
    metricsEnabled: true,
    keyFetchToken2: '8bc4be9361536b172357c4ce0e8e8192c823b02741dc3ea324774d1f18765f17',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3bab811860f7a2d60cac@restmail.net',
    authPW: '8d3b7b8f0797e610280d4a7ff0c4b5990fa4cadd5046270ec943d5aeb2f7bc49',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    sessionToken: '696a2d6d7a58def51a71cbb1abfb0f886212a84548c3cfbf57a31d0e101dd3be',
    authAt: 1705108709,
    metricsEnabled: true,
    keyFetchToken2: 'a207868b759fe03c72a061ac411e7b7d63a19735c213c9b77e55d6375c6cfbde',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '632748eeac754093b2eedc3bb6eaeb31',
    code: '7172f0244c4dd51eeae4d6b3aa4d69d2',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1dbc27c22c68b4d4117097d34b2cde624d17d70ecc663bbcbeb8a18eb7762000", ts="1705108710", nonce="Vh_pf7", mac="PNEf29BgWz3bWnG9NdTTuQuYhu+XocTAZ1GsNaiRLh8="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3bab811860f7a2d60cac@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="508e6abbbe6fc7ad87f34a8596db1d4c2ec43fc35a280da56867f94e83459cc6", ts="1705108709", nonce="FEsxRf", mac="YK9McGWfDKHoz6ok5vkxX/9js7YFJITKvQGdWuU3TL8="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3bab811860f7a2d60cac@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
    ✔ sign-in verification from different client (1256ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'dd716194bfe77028b698@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'dd716194bfe77028b698@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'dd716194bfe77028b698@restmail.net',
    authPW: '0de55261ec1051038787e4acf2ebcee1b44e5439fbec1a3c5004823bfacdc27e',
    authPW2: '2ae34bf35fa7f015a2e8279efa4406cc82647a9659349355a05899c0952bbfb5',
    wrapKb: 'fc5db43089868e3662cc2fdcb9919f20acc025f1b4559ab8ce84419be0ecb3a8',
    wrapKb2: '5bcc19bc0eba85173507ef23ae3b18aa6897568516c456c61cf913ba3cbfc54d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:47d7d757c1cb49d390b60f784eb7058a1c585ebf07657653c1bf390ae296ad64',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6a2e349c95ea4088b46899e6f9b8a983',
    sessionToken: '3553c31ccd0ef2dd847dd5dcd652471a36747b202d8defc6380c96ed523a2cbb',
    authAt: 1705108710,
    keyFetchToken: '2d98322a7fecb1f81f5b65f6a96844ff8aa340a7ae00a8af01f4e9562d86751d',
    keyFetchToken2: 'b5f0d01a69c3356e0f9dafc46f22b5c690d83d10695267dea34381b8616f3d57'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6a2e349c95ea4088b46899e6f9b8a983',
    code: '8f9d92826291796eed5bef2bfce9caad',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ae242fc0d51f3ed7d8d0d0561c0907e092797b055d63aeafe0ede8e68dbe8c8c", ts="1705108710", nonce="GPRQ7W", mac="rdZsA075wbmGhvY88qi6tXu3ehMf2BYO8go5/uDrTWc="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dd716194bfe77028b698@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'dd716194bfe77028b698@restmail.net',
    authPW: '2ae34bf35fa7f015a2e8279efa4406cc82647a9659349355a05899c0952bbfb5',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6a2e349c95ea4088b46899e6f9b8a983',
    sessionToken: '7d284d7cb9cd47fdb8e27975d72a9a0ca3e95762dba32a436c1de8ce9d6dec93',
    authAt: 1705108710,
    metricsEnabled: true,
    keyFetchToken2: 'a0d9fdbcaea41a300a0ce6fb13875d9adee81d3f7d7dd1362b3d5577f49abd89',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1677941e54345d0b2bd7ed6f35f7a7e42327e58bdcf1d9b5f9e12e7489ed027a", ts="1705108710", nonce="0EUdTo", mac="GVhPsVjmCPkarE04cQ8+j8sd64NkExtzyMBtroUlhtg="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dd716194bfe77028b698@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1677941e54345d0b2bd7ed6f35f7a7e42327e58bdcf1d9b5f9e12e7489ed027a", ts="1705108710", nonce="5kK06-", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="0jzyM3fgg+xMTket6yDpGFGqpRlD+0Jw0WyKeXs87+w="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ certificate sign with unverified session, keys=true (723ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '09ccfd132e3279b03470@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '09ccfd132e3279b03470@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '09ccfd132e3279b03470@restmail.net',
    authPW: 'f40202ae5245261e1ff99947dd9a5eea1bc4b816cd88c535d6d78e2a51c97dec',
    authPW2: '068849488435bdefde2e35c3ac4364946a95ebb7e7fd16121c75afb07176a233',
    wrapKb: '9a8f311ce05e822d4ba3ab7677d628cfb02038ffe1349b49f2c3c008d88c1de1',
    wrapKb2: '92833ff4472416f3a9bfb85ca496f829aca2eeb402acaa9abe8a58566558f5f5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e0413642061e003f4850bf514e6e755ef00d72a86ce41c3f2b64d2c521476cc1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '462e8841b05043a4a67dbea7ab62be64',
    sessionToken: '63e531daa2e23dc95a0ad85563c3faa900ed1d023c2eb84cf2aebe461afc2143',
    authAt: 1705108710,
    keyFetchToken: '1b411179c9c604d4c4ff82c720d9c94102462b980b1bcabca6c4667f1c763824',
    keyFetchToken2: 'c0a01720605cd3c3b290e3fabb2baadbe399bae1e0d0851a250547c558793149'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '462e8841b05043a4a67dbea7ab62be64',
    code: 'b37537368cd24d5d3449f5a06b8ae078',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8baa9cfa3b513197100616e768dd96b3752bedeb24cf827fe5f4edcf886ccad4", ts="1705108711", nonce="76MYJ2", mac="Y9pq1jlqNUWy6iGi/aZtATl90DW8+K7SDEaObtwyN5I="'
  },
  json: true
}
!!! response success {
  body: {
    email: '09ccfd132e3279b03470@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '09ccfd132e3279b03470@restmail.net',
    authPW: '068849488435bdefde2e35c3ac4364946a95ebb7e7fd16121c75afb07176a233',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '462e8841b05043a4a67dbea7ab62be64',
    sessionToken: 'c967f4646b8f6d0ad441faed6c08147f30ebaef74fe45846fc633108e39e6c98',
    authAt: 1705108711,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0f91d41d7d735e744b2d0e26470c238e3338f3915be78b4ea7a39b748876d029", ts="1705108711", nonce="nTOYlB", mac="qwefRJ02yvxZBHJAzsm4W2Mp8fGWEYx5tyWuRZ7eRhI="'
  },
  json: true
}
!!! response success {
  body: {
    email: '09ccfd132e3279b03470@restmail.net',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0f91d41d7d735e744b2d0e26470c238e3338f3915be78b4ea7a39b748876d029", ts="1705108711", nonce="Pp-cxS", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="YUi8V2tDJ5Cjpm7C8C3tAPxa2aTuQXB4JAxYEEkzXcQ="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNDYyZTg4NDFiMDUwNDNhNGE2N2RiZWE3YWI2MmJlNjRAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzAxMTkxLCJleHAiOjE3MDUxOTUxMTExOTEsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzEwODQ2LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcxMSwiZnhhLXZlcmlmaWVkRW1haWwiOiIwOWNjZmQxMzJlMzI3OWIwMzQ3MEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIyZjk4N2UwNDVkNWNkMTQyYTgxODQ2ZTVjYzdiODM0YSIsImZ4YS10b2tlblZlcmlmaWVkIjpmYWxzZSwiZnhhLWFtciI6WyJwd2QiXSwiZnhhLWFhbCI6MSwiZnhhLXByb2ZpbGVDaGFuZ2VkQXQiOjE3MDUxMDg3MTA5NzIsImZ4YS1rZXlzQ2hhbmdlZEF0IjoxNzA1MTA4NzEwODQ2LCJpc3MiOiJsb2NhbGhvc3Q6OTAwMCJ9.UE7sTzI8NFo1FAw5_xLJLYgtwhPIhpaHcu3fFVZR0esi90MV-7DFXd1_YnKswUTIH6fQai-j2xcVw2_sZ8L3Ca_Jc2_eRX-R81Cl6nH2zTFQvcjlEdS_Y96KVYtcDdOgEPbcg-wRFILLbu0Oeiv75meNsYRVWJ1IE36_TsMy0JMbP2KNNgH6DxhndsuQGBb4xBK-zyZWZyaLuDO-Sb7MTAxdMHQVSjDyMr-Z_3a0smY09Eyj7pG1DAun54NcRZOeVV54ghC59OoFHZhfoCsarF6sLcyTIoLyYoRQ0N7UQIyjJgkUhJqb-O-PfLAIna074nvqSDs9NsVdXijL7GCVvw'
  }
}
    ✔ certificate sign with unverified session, keys=false (740ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '70c60855e5fa7e4b7f3d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '70c60855e5fa7e4b7f3d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '70c60855e5fa7e4b7f3d@restmail.net',
    authPW: '42bee1263aea347509f3b9e585a9f3bca58eb9c74b3383630189e53240dda149',
    authPW2: '17255e0a1159a87e88512bcd5b8bb82ae046394e4da9ec861b813bc747076f07',
    wrapKb: '3ec92a0062d11a36b6432e09b2508b1cf209d17840ecded73522f9b326791302',
    wrapKb2: 'f4f27bfe1c180cef9c5ca22fd80a02744943f290de37121f3d6a6bdf4d0d6da9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bb089fc276ae76151d870a42c9921686db619a259ddd6e7da6574e2a21c5323a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '70193a7365e144ed843bfa47d1b65a01',
    sessionToken: 'fac9c794e90a4c1aa617d3e959cd3380a5c86b975a9e13d912e9f83643ab82ad',
    authAt: 1705108711,
    keyFetchToken: 'a721e070b1a69a18c6a8fe452146fb89f44483d666c5621dd231ee915739bb6c',
    keyFetchToken2: 'fcacdf057c53b4796a2028aa9797dad91a25873c31e5bcb6e7f25cb77f819ff4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '70193a7365e144ed843bfa47d1b65a01',
    code: '54114cfe7235b61ac07e18776103652a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a2f9121f944b06e4742095a60a7893611aafd7e4c9eb99586f6fb276050ece1c", ts="1705108712", nonce="qHBWNF", mac="SBJNBx1bp9zd73EzibgEBdT1gNRSXWDzSmsyeFMQwcY="'
  },
  json: true
}
!!! response success {
  body: {
    email: '70c60855e5fa7e4b7f3d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a2f9121f944b06e4742095a60a7893611aafd7e4c9eb99586f6fb276050ece1c", ts="1705108712", nonce="_opQoh", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="eo3phN9Ht7AQ6UR7tP2LQ9QDgfpoJzDg1sNDcYbGLlY="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNzAxOTNhNzM2NWUxNDRlZDg0M2JmYTQ3ZDFiNjVhMDFAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzAxNzQ2LCJleHAiOjE3MDUxOTUxMTE3NDYsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzExNTkyLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcxMSwiZnhhLXZlcmlmaWVkRW1haWwiOiI3MGM2MDg1NWU1ZmE3ZTRiN2YzZEByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJjNWJhYTMyZGMxYmRlNGZmNWNlYzY5MDJkMmJkYWQzMSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzExNzIzLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODcxMTU5MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.XYo1qLm4ryjDxmorbkwGFtoMgnjl1z0GT2tE-3ooxzs7gfXshntV1UwEbV5tK1iS2D3G3G4frVDhEBjGJQNUIYU5rosZykijPAAX5iQgqqLUXA_oteamO-sPVt-7jUikzJulGmXcsjK17BBFd_M_OAnRPnMQ1UCh3LwD_1KNqUy4D9rePRTdxYIdlL63d5Bz-XBO7ARbMtC1p6U93K4mjn5xcRMThw2ZaG0fk9mJXscUL7Fu5ufIgX1yCOF3Wlk3b1oZ0wi4IwDplEVxIlLUY964lZtVRFepIlI6IHevtGpqvjhgH3_dTzPXE9s6aDZVftA8q1D0trS-t7XR2DyDnw'
  }
}
    ✔ certificate sign with verified session (554ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cd5cd65e85efb37917a3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cd5cd65e85efb37917a3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'cd5cd65e85efb37917a3@restmail.net',
    authPW: '541104054820b16d68b236b0c5e4f6ff6522ce56d5fd0e22a7358263a3632264',
    authPW2: 'b4e7b385e89d14f5d2e9093ac7d089cd752d1f3e67cbea644461c020df09a47b',
    wrapKb: 'a286f632a645840f80eff85a689c1dfa34969d501a7c476db774a1522ebc0787',
    wrapKb2: '442b815613ecf050630d6ebbf0e4537754d8b43ea22909fcc1fb9b9d35536af5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:54dce44193e92c0acfeeabc2a4416c5684af413124bf6e969dccdb5adbda6775',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9261fc7c9661469fae96c24b205ef3ae',
    sessionToken: '144466983d8a1ee2c87910fc9691d490ff8023b95b61a029a2ddf24a73f83dcc',
    authAt: 1705108712,
    keyFetchToken: '20164ef343faed3236d42ec47417874125aeabaea8900d95e787181ffd52078e',
    keyFetchToken2: 'd8ca4e223d9a399d3ad4b21691999fa7dc65616a354aa72ce8f187d54ed440ea'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="39dce1f1e94a873c8017009c06365e660715e062db076fb6222a1833d8ca9d7b", ts="1705108712", nonce="Mev_jW", mac="7WBX2yM0ErRpdjodpcZ1yGLTFeqIaqaAq4uTIdk2PDI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cd5cd65e85efb37917a3@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a2858e32bf551887fa643888ea9019aaeeee9127d7dea261a0d6913bc0dc64d7", ts="1705108712", nonce="JgTVMe", mac="3KCoX0b8Zf/P1pXzvTFc3YWxsJKPtOQnRT2r4iAdIMg="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9261fc7c9661469fae96c24b205ef3ae',
    code: 'c97c92cfee5438c22dedc483934e89d5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="39dce1f1e94a873c8017009c06365e660715e062db076fb6222a1833d8ca9d7b", ts="1705108712", nonce="oUdw1n", mac="eN6s5UrlcwWYhT5trejnh/nhZdqQQZ7YBiZTOgNlIO8="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cd5cd65e85efb37917a3@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a2858e32bf551887fa643888ea9019aaeeee9127d7dea261a0d6913bc0dc64d7", ts="1705108712", nonce="i2T7pJ", mac="TqR2xcKgCYDNNpMuOTGVrJNPC2YaMcHUEPjNmgPK3h4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '4f2a08dfe7c35d7235fa8e72ecebbdef9245166a4b95ad2b9fbb324e1a66601cf6f0d44990a9342c6bfdfcb2c14862a5973410ff5a4b9e0d6b0ef22ddacde5c9dc8547c43d1a354ca1b07db418bf7579d1ab58af811899ea4b159ac0d7e7a4fb'
  }
}
    ✔ account keys, return keys on verified account (494ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3380695cb677299e2abc@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3380695cb677299e2abc@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3380695cb677299e2abc@restmail.net',
    authPW: 'aaeafa255e1630b0e57c7f19e63850db6ec6c972e7e3e421ae41c9612fca3af7',
    authPW2: '7539274df96ce0021f37baac48f536b3b83ea8983c9a8e05f95bddde16ea92ae',
    wrapKb: '9db7f2167e2c0fab6b1ea6044282f946c7e90f72afefe2a89d5a5692133dc440',
    wrapKb2: '9939df515872adb208067eb47d152e772cbb70008d75e0124020bd60e114e5f7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:998a6d3bd20b1ef566b223b8662acc9d06c76d2ea3d269b1eb37933c591cddeb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '18283cd9d2b448e3a7be7e616caa422e',
    sessionToken: 'fcd9645585aecd8a5085c16074f6b0ca9114fb1fcf00c87b8f5cad45ebb1f29c',
    authAt: 1705108712,
    keyFetchToken: '129745113f7e8d6e8189c96ee9da0e1e3e8a31b2757cdde0701d366762f4e50c',
    keyFetchToken2: '78aa4ea203dfffa42d15cb0bfcf91a4af725e69b8b60825c262fda33909c056c'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '18283cd9d2b448e3a7be7e616caa422e',
    code: '707e26e869b70f53676569698cfbd4a1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3380695cb677299e2abc@restmail.net',
    authPW: '7539274df96ce0021f37baac48f536b3b83ea8983c9a8e05f95bddde16ea92ae',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '18283cd9d2b448e3a7be7e616caa422e',
    sessionToken: 'cb42f5760e35df9c83de5482a624a069a35d4a66d76307c7816ba3fc30077860',
    authAt: 1705108712,
    metricsEnabled: true,
    keyFetchToken2: 'df43714312675147bdff48e65ee81b39a4870702b65ef64135157644b31a0c2b',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a12b2d2903a12fbf0352de2438a36fd1b3c3674a53dcea3a972b3899a999312b", ts="1705108713", nonce="Fr9TMo", mac="GBRxps90IhQOidlCnbA1xUr7yQdeFqM0HAusWj6/GU4="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5f75713017d86c53cfea32e4e9cfded8070e49c9c9457ac1f7c239679930d484", ts="1705108713", nonce="s18ZTd", mac="hK+5UzAWDvsytzWJJcJoCBiyQdwnoQ7cZqKoOkUKz70="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3380695cb677299e2abc@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '18283cd9d2b448e3a7be7e616caa422e',
    code: '7c53dda0e5db67657af6e50b0a4d7bda',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5f75713017d86c53cfea32e4e9cfded8070e49c9c9457ac1f7c239679930d484", ts="1705108713", nonce="_Hn8AF", mac="h3/aZSDVA1FxGmEsskfBLGkt5Gqn0xwuGtA17HTy1fY="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3380695cb677299e2abc@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a12b2d2903a12fbf0352de2438a36fd1b3c3674a53dcea3a972b3899a999312b", ts="1705108713", nonce="XvXEz-", mac="FSBjHP0YoFOvyuDS0KI8oVicLz8kd5ZQWZfnijFRx60="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b1d2d1b6da61f54bf58db3364122370701f3e98721af9bad73617a8c56bc70bc07ac3fdbe2b7a2de63e24d313046e6c119fdbb6f6668500ea9fdab3e71aa6405d69c718c345896767fce66d9b09136e74fc297e451435f62751418882b93310e'
  }
}
    ✔ account keys, return keys on verified login (719ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '167e913e40c20e162072@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '167e913e40c20e162072@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '167e913e40c20e162072@restmail.net',
    authPW: 'df8845c027edafe7481be2ea4da88ef3f1f1a37651b39b38321ac7b263b4dc50',
    authPW2: 'afcf7d9c408e831f4596f250f5b072da7577940ab097998629cf03f1a588710b',
    wrapKb: 'd47128695b51f7708e2ec318fb009a62e6b8ca72f83da23391c5bb95b17f8568',
    wrapKb2: '4ac4f178e5ca6b7afe61bcabd8886db283bb07ee7f5aab042d863590bf8c6368',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9ba3930c74abe3db686219f4fe5698d0671387c2ad9fb2a2bc702e3e2aee4486',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4eb856b8a8364549bf77299ef9b15541',
    sessionToken: '23ea5830369eb08fe5c3e5691cfd18f2f2f68cf7a6b9e260facf6e6ec73fc0ee',
    authAt: 1705108713,
    keyFetchToken: '014af47116f4825a128ed3a50af1619031ce858ab64060987638b8f3a2e62c34',
    keyFetchToken2: 'f777edabedfa498bac061635cb5abaa465903a068e72bd01039919cd4f5bc82d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '167e913e40c20e162072@restmail.net',
    authPW: 'afcf7d9c408e831f4596f250f5b072da7577940ab097998629cf03f1a588710b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4eb856b8a8364549bf77299ef9b15541',
    sessionToken: '879ae2e5489af4e0e8876e21c88cc5ec1da3cdc08b298ec2f834d2f681eb4a9c',
    authAt: 1705108713,
    metricsEnabled: true,
    keyFetchToken2: 'db534f8de540eea30f8f6d45e0d5fe32a3c1ba39f305efc3f9c4299d5caae653',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4eb856b8a8364549bf77299ef9b15541',
    code: 'd4607da8bb4e35ec4921135c6a132a63',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f6954bf9c619c495bb9beece736e1a961b6966d53752334c340fa6103a060a2c", ts="1705108714", nonce="mFJLPn", mac="z2GuRtXS3ho48kR/wYIle+cxDyPW+j2E9xlWVT+I5s0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '167e913e40c20e162072@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f77ef7c27976b4d6b5c4a6eac833869e01c427b24fbbdcf6722afc3a639704e4", ts="1705108714", nonce="xLYNIw", mac="G1U1dnrM2G2JYSfALXgbOTw1+xCobF0GROm87UdiiXc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'a46ec4a2e8d566856418c889d52a3956685fec3d8374c3a5581d3d5fafdcf3eb9a22be6cacb07ac3e84dc4a25eb3a48eddf7519b71828d67329d438483891966167340ecf7a5ea4ba058a5a4465f4b49f6aeb4ef78738a0796b5ff025a549e0f'
  }
}
    ✔ unverified account is verified on sign-in confirmation (700ms)

  #integration - remote account status 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5570f769d2a630ed015f@restmail.net',
    authPW: 'a5361b3dc6ff91b6a63748e5870d4a4f2dcc101dd311ad94ccd8a16f99241e8d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0c32b5fcadf3476aa705b2463a14688c',
    sessionToken: '88df4fa5655851a2c2bf977e8715f7e596f4913cac74f51b14ba5373be6e68ec',
    authAt: 1705108713
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=0c32b5fcadf3476aa705b2463a14688c',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: true } }
    ✔ account status with existing account (236ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '21c4c03d8862fc77b306@restmail.net',
    authPW: 'dfb516aa8e0b3ac466a205b098b9c76cab42075f5691a262542d95736dd4ba82',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e660c985f77d41fc8656f3335aea7cce',
    sessionToken: 'a28143fef9a7e1def9a589eabb0951ba253e5a6a9054870bbefde2602b33798b',
    authAt: 1705108714
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="acd13559df8005114a77b74d35c70a26d8e74829180bbcdaa5cd81ea8e760af5", ts="1705108714", nonce="OLf_O1", mac="1l/I1YWSUIPlrJLHGBeUZvP9y2CdPvKcCjFoU8H+ll4="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US' } }
    ✔ account status includes locale when authenticated (202ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'ce6b41e178308d3ccba1@restmail.net',
    authPW: 'b06b8a61e51742501a0971f444b5976145df7ae281e4bba774d37e03ba3e0fb4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0213271ce5134816a0011492e636650a',
    sessionToken: 'b17b0ed505b50bb9cf1c48c8b010e29f088d03a91adabb7fffbb6aeaf2eb24e2',
    authAt: 1705108714
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=0213271ce5134816a0011492e636650a',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: true } }
    ✔ account status does not include locale when unauthenticated (196ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'fc0bde065c3be179d430@restmail.net',
    authPW: 'b4dc4d673682f2a9cad1905dc3973499a391854e12897718ccc817da0cacb426',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ef6b756bb3ca47bf95997b2b31027027',
    sessionToken: 'd1cc7e5b18216b73a836d74f8a6c34ee31c93b5ad6ff37250d0592381943c1b4',
    authAt: 1705108714
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {},
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: uid',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'uid'
  }
}
    ✔ account status unauthenticated with no uid returns an error (193ms)
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=0123456789ABCDEF0123456789ABCDEF',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: false } }
    ✔ account status with non-existing account
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0df677fe9f33f8ab5278@restmail.net',
    authPW: 'c19e079074c884d7bf3d29d1eeee93624324e9788e5190c040f905c23ad160c3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6a4232de5696469ea739f20e2e6ec86b',
    sessionToken: '42117bd36236bcd5b656e6974e2c8a431fb3ca06b9e3b9fb2a64049b05c26300',
    authAt: 1705108714
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: '0df677fe9f33f8ab5278@restmail.net' }
}
!!! response success { body: { exists: true } }
    ✔ account status by email with existing account (202ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ebd071c8f17110857af8@restmail.net',
    authPW: '6260c2b51de4dd800c2cf9d9bdf25d69694d7b1f9859cb81795970486c2dfbd6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4dde3fc6baef486a8c23a4dd9b21409b',
    sessionToken: 'a9eac14c4bfb54c040ef80a351f68944077153c2a66f8200b9d9a4847dee7941',
    authAt: 1705108714
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'a78469c4e81609cac162@restmail.net' }
}
!!! response success { body: { exists: false } }
    ✔ account status by email with non-existing account (194ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'beb363182c52b7af42d7@restmail.net',
    authPW: '1fa8a366f3f695d753188a1d9bd1c497f283fa535f9d58ee1d8b6e132d75d72c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e293635f8809421b9f39487d0e9f75b5',
    sessionToken: '702f352bd10df523c1aca0b9a6e978e33017bbf760d5211f43f81b7736e67a8e',
    authAt: 1705108715
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'notAnEmail' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account status by email with an invalid email (193ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd1df2988d218dd80d2c6Ӓ@ᘮrestmail.net',
    authPW: '9f55f77a7d101bf5e7aa0dc536de0c1e8828d2313cf30add1eef4f4d0e50e957',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '830dc6acc9374546894638ddf10bd1aa',
    sessionToken: 'edf30ad7ef8b92575d21e218c44ae8c37dd21fd33d63fa4107c846eadc394679',
    authAt: 1705108715
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'd1df2988d218dd80d2c6Ӓ@ᘮrestmail.net' }
}
!!! response success { body: { exists: true } }
    ✔ account status by email works with unicode email address (198ms)

  #integration - remote account status V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c2f3018e3ac004083562@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c2f3018e3ac004083562@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c2f3018e3ac004083562@restmail.net',
    authPW: '8f7e77cb350291e0b156b114b192cfc0fd00fd48f140ec96dce4d7457aae9b5b',
    authPW2: '452c501a79654ab67b03e506d68fc6ad0edd5e5f6f772a9b121a9a8e2b2b3798',
    wrapKb: '83e16d9056ea7db9fc43d11edc1ab00502d84ab1d7524dff5f7ad6f6079e1bd4',
    wrapKb2: '8e58afe08b6c69666d17e3ef818403f949eca5f73417aee8d625b70e6035b4d1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:079c73a9ca29bbd5f9f20f6c2b59e6634726010c41a73f5817d73fa86a65406f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '032940dbae0c472f8b0278ec152d5b12',
    sessionToken: 'b78a9e491cfc23d202ebeb172be5a03ff6192d911459273e6dfff93d29ae3724',
    authAt: 1705108715
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=032940dbae0c472f8b0278ec152d5b12',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: true } }
    ✔ account status with existing account (482ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ac9f579a309fd9ea4734@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ac9f579a309fd9ea4734@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'ac9f579a309fd9ea4734@restmail.net',
    authPW: '181fdcb807c65f6e843dcfe8aee6e7815fced412e7eaa5d5126a99dacabaa33e',
    authPW2: 'cbca0dda7e6ea625ad68c8a8086a3fcfe99d9446e699246900495604318f995b',
    wrapKb: 'ac2e9f9d7d66b22bec49c24a4c33c645c21d121c2c0f66b9f49468eea8827ac8',
    wrapKb2: '37bb5741fa87ad19028dae3f7916ce0e1b545d26389f594f8edf9e542ef3baa9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3595ce34b85c3b302d13f243daac336c88b912b863c4684a7f380722682f7f56',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '70c32f5567c145569058ffec25a1dc0f',
    sessionToken: '07af30171944f4ff84ea207b85775a8770b0790a8b32460abcb51bed427d2403',
    authAt: 1705108716
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="715b983b6a6fbd6a83bca561850d4174650cec0abee8bc3ef36f8afebf02544f", ts="1705108716", nonce="kk_v-T", mac="O9Wol3qPkdelIUTitvDJH+YvpfU9HmCeTFpF/rZ8bq4="'
  },
  json: true
}
!!! response success { body: { exists: true, locale: 'en-US' } }
    ✔ account status includes locale when authenticated (461ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2bfedf26e8fcc0083370@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2bfedf26e8fcc0083370@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: '2bfedf26e8fcc0083370@restmail.net',
    authPW: 'a8354ae87904ac77c030b6e13e43bca61ef3edd652c3ef1ec53bb2a813e97a5a',
    authPW2: 'ca312a70dadd530b676989ed8693ea9c04979dcfcafd96f29b7bcdc7757c5f79',
    wrapKb: '609abc132fd97324a080be05bdb8e49be237f8ca06548784fe86d52629219363',
    wrapKb2: 'b8f002124dfd0dc480faa27d6f72ca20fab489b63145c176c471f271f7896bd4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ae6b81b5106ea0b7eaa5d9d29cef1e59f11ab4eff444e94ed6bdad919c65a0a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cac650788294483485a9cbc18d45ad4d',
    sessionToken: 'dac8d465a6372741f2b53aaa726867bbcaff72e5ff4ba0648a95eadf2991d2e3',
    authAt: 1705108716
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=cac650788294483485a9cbc18d45ad4d',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: true } }
    ✔ account status does not include locale when unauthenticated (457ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f575389fcdb878e10537@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f575389fcdb878e10537@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: { 'accept-language': 'en-US' },
  json: {
    email: 'f575389fcdb878e10537@restmail.net',
    authPW: '649a7be4b111e57e642c0afae2947026c6024e6d97c21a4ab4eb2c939e642ca6',
    authPW2: '17f80a45619e7a5cac0640f8c0a072fa60ac3ccceae6b32413fb436482c71f25',
    wrapKb: 'f8e87f55aa343efe10de2675d4fbd93df35a8f793874d4441c45cbaa28db1c78',
    wrapKb2: 'f2fd88573ec250c7c72284634d5cd50a097d69df5fae4f898de1bbff05bd09e3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:11aa782a965318ccd33398d7d23fe6264524cb61ca35a16c1be63aacef813725',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9c1bbcaca63b44f6a5b6ff2a1f2630e2',
    sessionToken: 'd28f1fffe2f81f8039259238e6ab058b64a55eda5939e204d09b2ebe0aa9f6d7',
    authAt: 1705108717
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'GET',
  headers: {},
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: uid',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'uid'
  }
}
    ✔ account status unauthenticated with no uid returns an error (455ms)
!!! request {
  url: 'http://localhost:9000/v1/account/status?uid=0123456789ABCDEF0123456789ABCDEF',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success { body: { exists: false } }
    ✔ account status with non-existing account
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bfe2f742f8438ea1f343@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bfe2f742f8438ea1f343@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bfe2f742f8438ea1f343@restmail.net',
    authPW: '66369edb0bbeb81ad288464caaf200a9ce0e655c0fd9d0cbeab2b516bf9edf37',
    authPW2: 'eff17da95b0b8026b4595762ebfbed6ab03fa63f8a898fd2c1536a7693e3a958',
    wrapKb: '80667ab2dd82521a0fcaa82872cca7f91e23bdf480a92a1d7263c427ecbc8108',
    wrapKb2: '3d8bb6b275e513dd0365cb6af647c65d310a82e25aa67f538778a3a377a375f9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f1e630e1cd2f03384e5e153d27dcfedf20a2157b50f01535e7e947188169e580',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '42a629bbdb144d13948bcbf36561f697',
    sessionToken: '41663655ed68ae676fdfa31ecc5cec1bfff3a2fe26778a192c830132f5072cd7',
    authAt: 1705108717
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'bfe2f742f8438ea1f343@restmail.net' }
}
!!! response success { body: { exists: true } }
    ✔ account status by email with existing account (461ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e34235d2e32bf4397761@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e34235d2e32bf4397761@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e34235d2e32bf4397761@restmail.net',
    authPW: '455f6ffe59fe6db22b67f238b1c767a44af21099fa32b8f2adda8b1779f9748a',
    authPW2: 'c0b44ad2f26e6679c529668ae598a6d04e78ab451138ea47596e554112b1c84f',
    wrapKb: '1e8a24035a0ab575dd79e019284e6f99014dd38c9f3b2e2bddf917604f78491c',
    wrapKb2: 'e486df1e7cec4b9a2dea2efe31e18b59bd9b9da9b9e3419663465336b1051b79',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:56b71e4d1357b4df89da45de42f46fead7061d90e018dc703e88f1d282a0f7f9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '46e08843f85c400ca9ea77368808d255',
    sessionToken: '5402465f23ce03af62e06c80176d56a385407a3c06be159214db965728b1143f',
    authAt: 1705108718
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'd942714ecfa294ed9396@restmail.net' }
}
!!! response success { body: { exists: false } }
    ✔ account status by email with non-existing account (460ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '05f2c43b95ee9175f278@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '05f2c43b95ee9175f278@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '05f2c43b95ee9175f278@restmail.net',
    authPW: '71726b10a87c5d67dfb68ec61b6a6f026217ca18ae621b1361bd1876709ad7a5',
    authPW2: '8be993c8dadbc5829d7691c8940da1074df05b6b91fe385dc68ac9ebb8080d03',
    wrapKb: '88ecfa8c4776cbee08342ba70e681d0ab38814cccbe25478e26ca513a66937b4',
    wrapKb2: 'c4e6359e5c697338979c9bcd7ab1fcabb260d6275d0e9c911d09f7219169c96c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6e6324180375aa426a7db35cbe400576bd4c22630187d0da5891e411517d2c63',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b3f24379f8bf4c2e83f862fef1fd18a0',
    sessionToken: '91f4f2a7d5fb6e1d8a6ce018ed1e2bf0bdd0e3b2d37a029c0de3df6648f37b82',
    authAt: 1705108718
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'notAnEmail' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ account status by email with an invalid email (459ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cfc0f4f70f6724f03435Ӓ@ᘮrestmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cfc0f4f70f6724f03435Ӓ@ᘮrestmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cfc0f4f70f6724f03435Ӓ@ᘮrestmail.net',
    authPW: '948ca9eca88cfc6cee743b6d29ba9a920efbf163ebb44e4fa21e17d4088fd41c',
    authPW2: 'be92cfbba9a5358fa13a4e1549cbfe8b33f750e41d8bac4864735cb8791b4bcd',
    wrapKb: '7898106421b5fa3e0b5abdd7951c0c641c2f86a9df3d94b03956b2dfe6887208',
    wrapKb2: '44a063244a59120985ce74a46fa604908630bd652aa631e76ea9666c0da21b58',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3578ebe3b5d1193d3c891f9e05df0ee83b9cc592a4eaa24ba0916577108f6e2e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '297ec637bfaf4c65b477449d7968c498',
    sessionToken: 'd909c81085c5b15736619b1fbe2da8529c186480ba70aa8e6bd4c5106a8d1d70',
    authAt: 1705108719
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/status',
  method: 'POST',
  headers: {},
  json: { email: 'cfc0f4f70f6724f03435Ӓ@ᘮrestmail.net' }
}
!!! response success { body: { exists: true } }
    ✔ account status by email works with unicode email address (454ms)

  #integration - remote account unlock 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0bac74715ae51fa794a2@restmail.net',
    authPW: '182bf49b639bc15412fb6a9d655f7638e323e62e01c6d89bf48f951b4d7ce095',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4979b94cac8b432fbb0d4cf79d002d08',
    sessionToken: '80cbab53ae8ddc112cfa4776d8d4ff7cf424918b341dd539b76c5ee94ab615ed',
    authAt: 1705108719
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/lock',
  method: 'POST',
  headers: {},
  json: {
    email: '0bac74715ae51fa794a2@restmail.net',
    authPW: '182bf49b639bc15412fb6a9d655f7638e323e62e01c6d89bf48f951b4d7ce095'
  }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/lock is no longer supported (216ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7d484be01c6ade9352e6@restmail.net',
    authPW: 'be3cb0dbf6ebdaac2a140d1b92d74eb8c2e06b83b6b6e343c19b4d9efd32d83e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '41a7621227184a3e9f2af3d8ab3e3937',
    sessionToken: '5bad82b4eb3aaf3936c87f2197ad5fe505e9a9916b6330bdfcbed9dcb9ea5abd',
    authAt: 1705108719
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/unlock/resend_code',
  method: 'POST',
  headers: { 'accept-language': 'en' },
  json: {
    email: '7d484be01c6ade9352e6@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined
  }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/unlock/resend_code is no longer supported (192ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a596031848cc696d21aa@restmail.net',
    authPW: 'a7bd52553b9ffe26ff69f93d0c17a2d94b19c6030a5c32428f23b0615b0ae10f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3c69d0fd0485450e97668ebe863a3766',
    sessionToken: '235ca9c21147f51d698de08e285909d92bf07beb1906c9a15629ee5989affaee',
    authAt: 1705108719
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/unlock/verify_code',
  method: 'POST',
  headers: {},
  json: { uid: 'bigscaryuid', code: 'bigscarycode' }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/unlock/verify_code is no longer supported (187ms)

  #integration - remote account unlock V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '681e5c35f0b88f4884a4@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '681e5c35f0b88f4884a4@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '681e5c35f0b88f4884a4@restmail.net',
    authPW: 'eae4cac9a27445a4b8b9137fa1104230310237beb7c26f62727be77e7a4bec88',
    authPW2: '981b62501e940e209c6d0413a730cf7933a9d54d8bdeec0030116e0ba0372764',
    wrapKb: '1cce5cc53f5fa55a239314ee84923a74b5282352319806e7fb9e7a399a876432',
    wrapKb2: '3ce4e2fcb861993a0d7dfaf53b831048d77c873641869b0ee19eab2e18e630ae',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1b240db8bc67b797cd559918d1d7dfc436bfad9445205328729e5d4cf145d82d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c45d5b57702c45869c6618c03da54809',
    sessionToken: '63a0c5eb7f33baa3a37f5f8817638c5fefd5fecbf46e449ffce7e2eade631503',
    authAt: 1705108720
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/lock',
  method: 'POST',
  headers: {},
  json: {
    email: '681e5c35f0b88f4884a4@restmail.net',
    authPW: '981b62501e940e209c6d0413a730cf7933a9d54d8bdeec0030116e0ba0372764'
  }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/lock is no longer supported (469ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c4829e8ab80e633aaea1@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c4829e8ab80e633aaea1@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c4829e8ab80e633aaea1@restmail.net',
    authPW: '4535ebb1d0cf2a60c74d6cf79425dc95c2778d9721f6c0b653e177843ca47a5d',
    authPW2: '0b3d8d522767220a4bae56b250a3c48bd7005f1952628de44bd3a5c26f1ab786',
    wrapKb: '2a62754ddbb8657c32c177493326e6c4d39a646874b0a22fcf7aafa70833f68e',
    wrapKb2: 'eeb0203b4f5178525892550809ed0e0397609c081cbe51551c9e77a0b31c6337',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9c299e8942e4e0892f47f7d421f235d84e116a295d4bd102210ca9521f9de515',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b0958222607b44988bde54eb7accdd00',
    sessionToken: '321d5747de83d6b79634e264768a5384b914507ca6aaf9c55f4825c54e550304',
    authAt: 1705108720
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/unlock/resend_code',
  method: 'POST',
  headers: { 'accept-language': 'en' },
  json: {
    email: 'c4829e8ab80e633aaea1@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined
  }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/unlock/resend_code is no longer supported (458ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a50f2390df499768fa9b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a50f2390df499768fa9b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a50f2390df499768fa9b@restmail.net',
    authPW: 'f12028416e97e2854d82a931bbe4355e8669d7c73f6b74a2d4c76e52bcb2307f',
    authPW2: '2d8700608dbce1f91c94167e589021e964589c63fde96c2868126127a628a862',
    wrapKb: '744dd5297e9a2c62fe445c832e3d39f53bc976e59c13766d5f81a1fd9385ff5f',
    wrapKb2: '6b2782a418a5cd7b3a857721df58cc0593cc082e42975e1c7dfec351ba0c4948',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc51a58212cbade06f7c71ee2ce3b288e7b467248e4edd2407ec1b63168a1223',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ac66207875a5496995e63bef8092a58b',
    sessionToken: '1da2590866eb3fbbe403bcf7410d3487ff3d746efb87b23f8b90e3e7a3055399',
    authAt: 1705108721
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/unlock/verify_code',
  method: 'POST',
  headers: {},
  json: { uid: 'bigscaryuid', code: 'bigscarycode' }
}
!!! response err {
  statusCode: 410,
  err: {
    code: 410,
    errno: 116,
    error: 'Gone',
    message: 'This endpoint is no longer supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ /account/unlock/verify_code is no longer supported (449ms)

  #integration - attached clients listing 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '923496b7f6898adab21b@restmail.net',
    authPW: '0a606cf3e962658e9e20f824e63a35fb6a0d35f2891222ab9c2fcd1151e2edaa',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2111b32c723543dd94689c5364e82b53',
    sessionToken: '0d58fadd73b31e6c8400fb16dbc644bee40be040c3957a6e2b9fa9ecd70ce425',
    authAt: 1705108721
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2111b32c723543dd94689c5364e82b53',
    code: '053da4c37a6aa19d55fdbe2ac63af737',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446", ts="1705108721", nonce="lzRuNs", mac="Mem5Whx/B/pAQxcFM3ISEyzHopu/2SnY03BZr8Tuv/c="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108721396,
      lastAccessTime: 1705108721460,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446", ts="1705108721", nonce="8ladcs", hash="wxzKdMAcaKYdXw0QiP5d98+l64w6074wk7P0Cbj8iwo=", mac="KnTzSNO9S82b+n+NOCEiFLZikusmi6qAkwQpQwTscPA="'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: 'd6802b576856d048ef78d364485bd00f',
    createdAt: 1705108721479
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446", ts="1705108721", nonce="dgfgmx", mac="JzwYkvNNIELJuAGVqz9CfW9bIhgL2cluFVBqmA//Vx0="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: 'd6802b576856d048ef78d364485bd00f',
      sessionTokenId: '59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108721396,
      lastAccessTime: 1705108721499,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446", ts="1705108722", nonce="TnvI4O", mac="74lEtriyWnyPibNhHYgv5Rk5kh9DoC/qrBZ1j35oxK8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: 'd6802b576856d048ef78d364485bd00f',
      sessionTokenId: '59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108721396,
      lastAccessTime: 1705108721517,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: '3c49430b43dfba77',
      deviceId: null,
      sessionTokenId: null,
      refreshTokenId: 'd98ffeafe9d27a28dd549a8cf463710f296a650ee106bd4e043134c858a06904',
      isCurrentSession: false,
      deviceType: null,
      name: 'Android Components Reference Browser',
      createdTime: 1705108721000,
      lastAccessTime: 1705108721000,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 8e9751721914ff3703b48f395600ce49ad4f0f59593d4393d5f6e0c6ae8f5fe6'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '6db46e63938494a0f0e211a2c134aa6b',
    createdAt: 1705108721538,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446", ts="1705108722", nonce="-DwwDA", mac="sRNarRNt+ruIyBm+IRh67G+JNX8VZJrMEuY/PMjjSKI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: '6db46e63938494a0f0e211a2c134aa6b',
      sessionTokenId: null,
      refreshTokenId: 'd98ffeafe9d27a28dd549a8cf463710f296a650ee106bd4e043134c858a06904',
      isCurrentSession: false,
      deviceType: 'mobile',
      name: 'test device',
      createdTime: 1705108721000,
      lastAccessTime: 1705108721533,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: 'd6802b576856d048ef78d364485bd00f',
      sessionTokenId: '59aa0c0cbc39f2238619b8bdf50245be1f21f4057e76103373deec4b68e7c446',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108721396,
      lastAccessTime: 1705108721551,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly lists a variety of attached clients (335ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '36a9426234e3939394a3@restmail.net',
    authPW: '52dcf26f280dd4f099e2128b266f06e5b9d3c7393f3ba01a0119a8cebf18d1dd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '020b50382b8443c8b11ccf151cdd9daa',
    sessionToken: '756cefa5ed20ddd5785dd700174e2f440a6d3aecf9d456dd45439329291ad914',
    authAt: 1705108721
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '020b50382b8443c8b11ccf151cdd9daa',
    code: '7e5c9aa77e3c9dd5bb783a0e78eb0a24',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '36a9426234e3939394a3@restmail.net',
    authPW: '52dcf26f280dd4f099e2128b266f06e5b9d3c7393f3ba01a0119a8cebf18d1dd',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '020b50382b8443c8b11ccf151cdd9daa',
    sessionToken: '332eb1348fb5e1275d09d07e5a571492aeeb22ee25e3da903fd83c14cdc6e54b',
    authAt: 1705108721,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a03dda66a04226e7014a007eee6cc7022e90da4baa7424e453cbd2f0beb516aa", ts="1705108722", nonce="UTcQK0", hash="77eiwLOcWhRnXkMgfFCcpzHCbJSGGNXdwU3EBq6NHEg=", mac="6ihn2BFX3zkn1PwtjN7nPJg5h1U9H2CZ9X6Fi1ijgeg="'
  },
  json: { name: 'test', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test',
    type: 'desktop',
    id: '34cc180030f2841c2e329e07e487aea8',
    createdAt: 1705108721933,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="69d5a20d8b2a561d397fca44d6805aa5228cbcbebadb61f8e49908f50a40ba83", ts="1705108722", nonce="kjK-lm", mac="tRIGs2/yP4e4+BcG1FRzeUBrioXFo5blzP9hCyOIT+k="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: '34cc180030f2841c2e329e07e487aea8',
      sessionTokenId: 'a03dda66a04226e7014a007eee6cc7022e90da4baa7424e453cbd2f0beb516aa',
      refreshTokenId: null,
      isCurrentSession: false,
      deviceType: 'desktop',
      name: 'test',
      createdTime: 1705108721896,
      lastAccessTime: 1705108721896,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '69d5a20d8b2a561d397fca44d6805aa5228cbcbebadb61f8e49908f50a40ba83',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108721701,
      lastAccessTime: 1705108721945,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="69d5a20d8b2a561d397fca44d6805aa5228cbcbebadb61f8e49908f50a40ba83", ts="1705108722", nonce="J3qzG8", hash="0E4GogLybN6HoQOLC66GHEXIw3XHTpVyDGdSvwQhRGg=", mac="vz3SSPSiuGfdGenjdsut8qfn4pQKBENPYPiJfWuRQW8="'
  },
  json: { deviceId: '34cc180030f2841c2e329e07e487aea8' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="69d5a20d8b2a561d397fca44d6805aa5228cbcbebadb61f8e49908f50a40ba83", ts="1705108722", nonce="CURmFA", mac="mzLXfwR6fdHQDNq5/l4B3tBUujM+ID4WNlVFn6dn/wE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '69d5a20d8b2a561d397fca44d6805aa5228cbcbebadb61f8e49908f50a40ba83',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108721701,
      lastAccessTime: 1705108721974,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by device id (422ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '415de4eb8c0490a1bd6c@restmail.net',
    authPW: '8ca186d84441c505a1e37e96d1a8c72380d62b3aa55c585ea0ae6f7ccc909eae',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f88caab8b00e466fafbf02a71c816ddb',
    sessionToken: 'b59572773c93611248cccd00059c44ef74a926ef5bb2ef27956bc26c01cc7eba',
    authAt: 1705108722
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f88caab8b00e466fafbf02a71c816ddb',
    code: '8da1074222fd37f9fc6f6f09733cf8e5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '415de4eb8c0490a1bd6c@restmail.net',
    authPW: '8ca186d84441c505a1e37e96d1a8c72380d62b3aa55c585ea0ae6f7ccc909eae',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f88caab8b00e466fafbf02a71c816ddb',
    sessionToken: '2ad8c644e0b75235fdc28c09655818b9519b3caa9db17f965b86b3eb72796d70',
    authAt: 1705108722,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="81796a850499d9fe109794d6ea5fdc8e82d9b4f50a9106282c59272b4078d87f", ts="1705108722", nonce="UBUdtl", mac="9dNwtJ5iZWmehH5qIHpyGqd8O/zkoVObROgu6hbpffk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '81796a850499d9fe109794d6ea5fdc8e82d9b4f50a9106282c59272b4078d87f',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108722140,
      lastAccessTime: 1705108722377,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '9a65888adb8afbdcd9b7ce86243e0fb6995f6c49ad89258efa2b8b55b217be4d',
      refreshTokenId: null,
      isCurrentSession: false,
      deviceType: null,
      name: '',
      createdTime: 1705108722340,
      lastAccessTime: 1705108722340,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="81796a850499d9fe109794d6ea5fdc8e82d9b4f50a9106282c59272b4078d87f", ts="1705108722", nonce="XcRz6N", hash="omNr8SZq+2H16Fm2nreV2X44dtWzBKmOTsLp0bbC5JU=", mac="t5H2DTXIHJntDT+O9YcyXVHd7a0qKqh2vq/qA9mNsQg="'
  },
  json: {
    sessionTokenId: '9a65888adb8afbdcd9b7ce86243e0fb6995f6c49ad89258efa2b8b55b217be4d'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="81796a850499d9fe109794d6ea5fdc8e82d9b4f50a9106282c59272b4078d87f", ts="1705108722", nonce="FwzUco", mac="F5VBrpo8IQGzowSRbVuHsgenlSn5qhYZbp0vDx0Uwcc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '81796a850499d9fe109794d6ea5fdc8e82d9b4f50a9106282c59272b4078d87f',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108722140,
      lastAccessTime: 1705108722406,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by sessionTokenId (433ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6ce601407fd7e67706b8@restmail.net',
    authPW: 'cebf0d78aae6bcfe7b3d0cb3538d8618eeadabfa4468267aaf63f0e9341f4c94',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '360084616d5147f18f8cfe2534e2bb20',
    sessionToken: 'd6b7b8dcf6e7995094c1f793f59de318b2cf02a38f513a63b16af80fa5c5c702',
    authAt: 1705108722
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '360084616d5147f18f8cfe2534e2bb20',
    code: '3cf5b2a3c0bc589b757df7342d2071f2',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dc509c2f3a67f231c8883fcb78ab90abd70c2df9a184351fb1ba69fff5f821d2", ts="1705108723", nonce="oOCP_b", mac="f3FbC6Aj/SeU5oeUTwPQ4LqmLDEZ1MgUBtim3E+89mQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: null,
      sessionTokenId: null,
      refreshTokenId: '1879ef94784259bc4e81ee65ecef902ae91351e5f2a2a3e8cb4181752ac9bbff',
      isCurrentSession: false,
      deviceType: null,
      name: 'Android Components Reference Browser',
      createdTime: 1705108722000,
      lastAccessTime: 1705108722000,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: 'dc509c2f3a67f231c8883fcb78ab90abd70c2df9a184351fb1ba69fff5f821d2',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108722567,
      lastAccessTime: 1705108722636,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dc509c2f3a67f231c8883fcb78ab90abd70c2df9a184351fb1ba69fff5f821d2", ts="1705108723", nonce="M9AbXN", hash="eZzzj6Zx0gl74lvtbGkENJV+pRJTl7kJdRGloF7qTW4=", mac="xMxNqE79IIFia59O0D/TSwtdEsZTay9mcvc7Uwof0KY="'
  },
  json: {
    refreshTokenId: '1879ef94784259bc4e81ee65ecef902ae91351e5f2a2a3e8cb4181752ac9bbff',
    clientId: '3c49430b43dfba77'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dc509c2f3a67f231c8883fcb78ab90abd70c2df9a184351fb1ba69fff5f821d2", ts="1705108723", nonce="ESqsZB", mac="bXPDi6tiMLbg6IImRbRZXD61uLBw+aCbR+ylcokPJxM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: 'dc509c2f3a67f231c8883fcb78ab90abd70c2df9a184351fb1ba69fff5f821d2',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108722567,
      lastAccessTime: 1705108722672,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by refreshTokenId (285ms)

  #integration - attached clients listing V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '62581e8329e3cb19b737@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '62581e8329e3cb19b737@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '62581e8329e3cb19b737@restmail.net',
    authPW: '65304522ae922a4075025e9526eac64e1247423b1fea444cbde3000477bf6c1e',
    authPW2: '2ab6a2fd3b86822735bf3490354a777343750f236c14b7d0be2a7883e6b17295',
    wrapKb: 'efe8014a3046e921a03b1631079c555804175a4c1c9c64abe96de4eb917f6ae0',
    wrapKb2: '11707b787543b72b40fa9fb39f41fd2896a29f7fb7be47b092fa8160d0c86b09',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6cdedb715ccf6b276db98006765152df0068365766e2b8480eea1936d1bfe321',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '18e3747fcd5b43a1989c9d14cff654f5',
    sessionToken: '861c669ab5fe34815de04ad9b19405e94d0a47038d4d581fca40bc231339b086',
    authAt: 1705108723
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '18e3747fcd5b43a1989c9d14cff654f5',
    code: 'c23a92b7d8b247be2c228b8aa3810502',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957", ts="1705108723", nonce="uloY_w", mac="yzl5IWNU8dBNVlWRvFTIIInDM2BAcmLBVA4QTSXhVNQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: 'cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108723187,
      lastAccessTime: 1705108723259,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957", ts="1705108723", nonce="8KSoDO", hash="wxzKdMAcaKYdXw0QiP5d98+l64w6074wk7P0Cbj8iwo=", mac="qrVoi2iuko5tl2+DlzU+KjxjwvL49DiH2+Ugn/vnmFE="'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: '75310bc72e9cda6d73f66a588924f2d4',
    createdAt: 1705108723276
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957", ts="1705108723", nonce="v27EuX", mac="esHxYD1b6tPOglBu/vkS02YANdGq3E+AThMWA2VOLZw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: '75310bc72e9cda6d73f66a588924f2d4',
      sessionTokenId: 'cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108723187,
      lastAccessTime: 1705108723294,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957", ts="1705108723", nonce="Nx9GH7", mac="GaCb4OdLhHPK3vHnbEIQ4zSwxRzw3o64Jf5y1yv/ZxE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: '75310bc72e9cda6d73f66a588924f2d4',
      sessionTokenId: 'cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108723187,
      lastAccessTime: 1705108723312,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: '3c49430b43dfba77',
      deviceId: null,
      sessionTokenId: null,
      refreshTokenId: '054948e51a333577bd6b71ea8bd76be276d36103de7b31473f0eac1b3c70ce43',
      isCurrentSession: false,
      deviceType: null,
      name: 'Android Components Reference Browser',
      createdTime: 1705108723000,
      lastAccessTime: 1705108723000,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer b86532acb312a9a71efe88abc88ed20742d8146d87d1df4f4dab911ee24a9196'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '51ee49095fed774a71506c6dca68dd7c',
    createdAt: 1705108723330,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957", ts="1705108723", nonce="lHVjaD", mac="kN3fM3lQ6wYrAKghQ7dP5KPSKJiwHEa7cm46PPtLObs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: '51ee49095fed774a71506c6dca68dd7c',
      sessionTokenId: null,
      refreshTokenId: '054948e51a333577bd6b71ea8bd76be276d36103de7b31473f0eac1b3c70ce43',
      isCurrentSession: false,
      deviceType: 'mobile',
      name: 'test device',
      createdTime: 1705108723000,
      lastAccessTime: 1705108723325,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: '75310bc72e9cda6d73f66a588924f2d4',
      sessionTokenId: 'cac706b8b373e4d79d3495bc36ef58a96ceb56e09edd54dddbb05b9889fb9957',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: 'mobile',
      name: 'test device 🍓🔥在𝌆',
      createdTime: 1705108723187,
      lastAccessTime: 1705108723343,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly lists a variety of attached clients (598ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e717fad1770fa7a93714@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e717fad1770fa7a93714@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e717fad1770fa7a93714@restmail.net',
    authPW: 'ac4b9efc6f4338c2d39df6f1a1f4651082493b27aa187a8e207e52e6de2ee5df',
    authPW2: '66592a11b1d821e3dbc1db18d62011241d33b4286daf7df6377b6de8f089b983',
    wrapKb: '34fdbccb8372612b3077a702cca75f95f4a624c3f26789a248c9231666708f62',
    wrapKb2: 'cedf0e0ceabc807a294a6b0d502472190f957ecadd029ed3f77b7605098d4bf7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b98f3f72bd4e4b8a2e38e707e22cf48d010c23d2310bb8857a56aff850a37c15',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '970828a001f645a0aebc454f5856dfea',
    sessionToken: '11a3386eb8d1b919c82e6d78b3d6db66c37cf54cd8bef8519cd5e98782928ad0',
    authAt: 1705108723
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '970828a001f645a0aebc454f5856dfea',
    code: '672f8ffc450a2a0a32cccded51e76c47',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e717fad1770fa7a93714@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b98f3f72bd4e4b8a2e38e707e22cf48d010c23d2310bb8857a56aff850a37c15',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b98f3f72bd4e4b8a2e38e707e22cf48d010c23d2310bb8857a56aff850a37c15',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b98f3f72bd4e4b8a2e38e707e22cf48d010c23d2310bb8857a56aff850a37c15',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e717fad1770fa7a93714@restmail.net',
    authPW: '66592a11b1d821e3dbc1db18d62011241d33b4286daf7df6377b6de8f089b983',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '970828a001f645a0aebc454f5856dfea',
    sessionToken: 'cd7eff4c723dd6509c59a963584fe9b303a340ded0e7f37be866c386a925905c',
    authAt: 1705108724,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="08b12f11ffe01f70feec3ccad5337364ebe50690a6d2f9b7be8fcc976dc66914", ts="1705108724", nonce="NPZZeK", hash="77eiwLOcWhRnXkMgfFCcpzHCbJSGGNXdwU3EBq6NHEg=", mac="/+UwUm5MmijZbZ3mEhSpM2NynQxDVODuUE6c3BT2SNY="'
  },
  json: { name: 'test', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test',
    type: 'desktop',
    id: '7b57cca5e8ca78a0b6180b02b70be752',
    createdAt: 1705108724204,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="743c35f45a4995746c626f2dc439b4c44d2f811aa767a0e8731b5c537132e5f7", ts="1705108725", nonce="oa0Ji1", mac="z12VtupoSGsITydGKuGLnPRxm90Mz1CnXkMvUZyMUyQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: '7b57cca5e8ca78a0b6180b02b70be752',
      sessionTokenId: '08b12f11ffe01f70feec3ccad5337364ebe50690a6d2f9b7be8fcc976dc66914',
      refreshTokenId: null,
      isCurrentSession: false,
      deviceType: 'desktop',
      name: 'test',
      createdTime: 1705108724151,
      lastAccessTime: 1705108724151,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '743c35f45a4995746c626f2dc439b4c44d2f811aa767a0e8731b5c537132e5f7',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108723793,
      lastAccessTime: 1705108724216,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="743c35f45a4995746c626f2dc439b4c44d2f811aa767a0e8731b5c537132e5f7", ts="1705108724", nonce="35C_ze", hash="Z6VQ9ynEkf6+efroJPbJp224d26qoVyBo4gde9htBII=", mac="vjgn2xHu91lD9BUI2w9h0olOpxLqGBIUJZwTuz1pnQE="'
  },
  json: { deviceId: '7b57cca5e8ca78a0b6180b02b70be752' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="743c35f45a4995746c626f2dc439b4c44d2f811aa767a0e8731b5c537132e5f7", ts="1705108724", nonce="OTM2du", mac="s6mZkvMyCkSlaXEXpjqxJfgQIuDLRp1G+i7LQ+WG+Gk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '743c35f45a4995746c626f2dc439b4c44d2f811aa767a0e8731b5c537132e5f7',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108723793,
      lastAccessTime: 1705108724248,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by device id (903ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'beb48ede4c175ed9e8c8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'beb48ede4c175ed9e8c8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'beb48ede4c175ed9e8c8@restmail.net',
    authPW: '3175e51f64ffae0d2cda26ee7ef8b6e22d55e7a4ccc3263d23315d6b55c6f901',
    authPW2: '75309f71a491941f89d729b00b48d7d4524c2f5706a81ec1865629d1b0588287',
    wrapKb: '3eab214570ebfda69483260050f7cd0139a26cdeab7b73011ea17e2da41721f5',
    wrapKb2: 'eaa1c9170f38749eb2655d61b3c99f8b7a923a3fe5132479fbefb8a903d5f919',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:eadce078eb181b0994308c875542bedf273c70b51d8b4e22212128f1d4de0856',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8cc13ebc00bf4e2ca722a411189a93a0',
    sessionToken: 'ec3794e2bffa773ca22c05cdee79df191c26ea39515a4dd00020e62d77ae7de4',
    authAt: 1705108724
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8cc13ebc00bf4e2ca722a411189a93a0',
    code: '013e803e482fc41e7639a36e9ee54a88',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'beb48ede4c175ed9e8c8@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:eadce078eb181b0994308c875542bedf273c70b51d8b4e22212128f1d4de0856',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:eadce078eb181b0994308c875542bedf273c70b51d8b4e22212128f1d4de0856',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:eadce078eb181b0994308c875542bedf273c70b51d8b4e22212128f1d4de0856',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'beb48ede4c175ed9e8c8@restmail.net',
    authPW: '75309f71a491941f89d729b00b48d7d4524c2f5706a81ec1865629d1b0588287',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8cc13ebc00bf4e2ca722a411189a93a0',
    sessionToken: '3e10d408c0c9e25be593bb7088ea3de42aa4481970bf423525a224e6cf309988',
    authAt: 1705108725,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="62dbdbf9defdad005514354ef5259d5cb935d558eaad3bde99fdadbe6c14b16f", ts="1705108725", nonce="-j6XDM", mac="0RRqyAX0FSErQDicNUcc/JHQQZ8loePOhx3+ZI5GDdQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '62dbdbf9defdad005514354ef5259d5cb935d558eaad3bde99fdadbe6c14b16f',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108724685,
      lastAccessTime: 1705108725098,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '82bef59983a81c7791b268c81b9c6405cee55479688da011534795e28385e892',
      refreshTokenId: null,
      isCurrentSession: false,
      deviceType: null,
      name: '',
      createdTime: 1705108725053,
      lastAccessTime: 1705108725053,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="62dbdbf9defdad005514354ef5259d5cb935d558eaad3bde99fdadbe6c14b16f", ts="1705108725", nonce="2Lo6cN", hash="UKQiSOj62tXerRmU8cG7Rf0DcrINQ49u6t1apKPvbos=", mac="6ajkBb0EGwqVdrWRxMAMAW0pm1JpT5IJSKh2vaoKT9w="'
  },
  json: {
    sessionTokenId: '82bef59983a81c7791b268c81b9c6405cee55479688da011534795e28385e892'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="62dbdbf9defdad005514354ef5259d5cb935d558eaad3bde99fdadbe6c14b16f", ts="1705108725", nonce="e9P4ud", mac="y6joOF7urwURA6MLwRjv1OKrnRF4cbHUV5K+dEj4Bjg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '62dbdbf9defdad005514354ef5259d5cb935d558eaad3bde99fdadbe6c14b16f',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108724685,
      lastAccessTime: 1705108725126,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by sessionTokenId (878ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a3ae5baef0b9f25270b8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a3ae5baef0b9f25270b8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3ae5baef0b9f25270b8@restmail.net',
    authPW: '3b2236c6f4b14562d9d18e83218f43b9b7c703a9789e17d9b8a64f9cfa67fbf7',
    authPW2: 'aa519ffce24076898e3a472dbaaeac9671c9bfdce9d30e6d3aedde78fc53c2e3',
    wrapKb: '8e9403decf46df96c3f220b398451c3b5b6a39de361eb2911ef8898de4c3ef17',
    wrapKb2: '5d53b3c933a42d8747db5bbc2d18ed2cf94ab7079faada6b868676b67f6bf3ef',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:270215a952c21fa8cdb30c2a36e4a12da71dbd81fefc5b7cc7c08a471e3e99ed',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9acb8b70e916476390c6c112563269b2',
    sessionToken: 'f1447c6320dc7db54d8216e1f5e810f4408153ebad7f03bfb461e814b03a97c9',
    authAt: 1705108725
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9acb8b70e916476390c6c112563269b2',
    code: 'e526352c99c6970bcfa505c62b27c714',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="be4c185e3019a7712562af3aa23492a92bd65b6210606840de6bc3b54fbc1661", ts="1705108726", nonce="RMJ3hO", mac="qirgo2wXQmAHKh3hvjwzg3buAw9JpQNExmVXJVagAbg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: null,
      sessionTokenId: null,
      refreshTokenId: '290a640d7ce11baa1f7561aa7c54834d2bd65e65dfcff24e65236d8600974dd3',
      isCurrentSession: false,
      deviceType: null,
      name: 'Android Components Reference Browser',
      createdTime: 1705108725000,
      lastAccessTime: 1705108725000,
      scope: [Array],
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: 'be4c185e3019a7712562af3aa23492a92bd65b6210606840de6bc3b54fbc1661',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108725563,
      lastAccessTime: 1705108725635,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_client/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="be4c185e3019a7712562af3aa23492a92bd65b6210606840de6bc3b54fbc1661", ts="1705108726", nonce="-tUzMG", hash="CyOsVF+c9+QgFkVDParFhd8uuIJQvdxEE6Zi4XFy1Io=", mac="HG/jAQMUZEs4wgwYTyRL9XzRQrHVzYGnl1jRimAImo4="'
  },
  json: {
    refreshTokenId: '290a640d7ce11baa1f7561aa7c54834d2bd65e65dfcff24e65236d8600974dd3',
    clientId: '3c49430b43dfba77'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="be4c185e3019a7712562af3aa23492a92bd65b6210606840de6bc3b54fbc1661", ts="1705108726", nonce="wGwuXs", mac="azZSGTtBSP/KegPA9aQS3VdYm+d1c8rgR2faashbMao="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: 'be4c185e3019a7712562af3aa23492a92bd65b6210606840de6bc3b54fbc1661',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108725563,
      lastAccessTime: 1705108725659,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ correctly deletes by refreshTokenId (534ms)

  #integration - remote base path 
!!! request {
  url: 'http://localhost:9000/auth/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.7367057847262597@example.com',
    authPW: 'fec91c5dc64779edde01e4447758c8ebd413ce60661af8b151d61a5642697971',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a971009d850b4f9388cfd86c5da98bbf',
    sessionToken: '02d0dd29c0bf372c47d8568f3bee1fe98149f07c5290248f9f63ead9c36152b6',
    authAt: 1705108725
  }
}
    ✔ alternate base path (202ms)
    ✔ .well-known did not move
    ✔ "/" returns valid version information
    ✔ "/__version__" returns valid version information

  #integration - remote base path V2
!!! request {
  url: 'http://localhost:9000/auth/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0.5938045142742596@example.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0.5938045142742596@example.com'
  }
}
!!! request {
  url: 'http://localhost:9000/auth/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.5938045142742596@example.com',
    authPW: '76f317a678c251222c37e2aca9dee9cb5804ef48b01210ba1e58a715e19b508f',
    authPW2: '7e8c4a22ad39be5ef1ad039047549324566b007f031703230c8f4e34423af17a',
    wrapKb: '1251cd445a29973768a546863e9183b7ea3605809ea510f10d4958f819afc33c',
    wrapKb2: 'cb3d62eebf6d7845cac533b9d3da2433fb8eea7b7c8ea51cdd91a5ed8b36483b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:64d503c58057e7bbcc8023b4bda7a32f4925c2497bb92c8aa74b3f8ee4830449',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8228301dabee4ddc987c9a29a1f6d8a2',
    sessionToken: '8f346ddf1b4081f3b20d050d1447b147f6f836b037a10f7e0064999b51fa3fde',
    authAt: 1705108726
  }
}
    ✔ alternate base path (485ms)
    ✔ .well-known did not move
    ✔ "/" returns valid version information
    ✔ "/__version__" returns valid version information

  #integration - remote certificate sign 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '830e51599505bdd10f7f@restmail.net',
    authPW: 'dd92dede98fa01b0450dcba4b7a6ebe3137524627630bd4bd8778b02ec26ca22',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6edcbe324d4f490db66dc0034ea21bec',
    sessionToken: '4c6e042c7b9f477e92b0cf9832424ee389de0948548bb52abd35511f22623e8d',
    authAt: 1705108726,
    keyFetchToken: 'b5a29701f93c1334ca9ef805f4acb69313c0e336473e465e7d24c0c288eed159'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6edcbe324d4f490db66dc0034ea21bec',
    code: 'fae7356f9b4e96d21523fa3285414990',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c9dfa2f177fa757e1c82a023a1c667d679ee0addcee53fa27a0c2b3ce0e2a8d8", ts="1705108727", nonce="8_tv6Y", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="XMjs2tj2mwsl6135sI+OfL1I5bWs0HaLFxOJK291LhU="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNmVkY2JlMzI0ZDRmNDkwZGI2NmRjMDAzNGVhMjFiZWNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzE2ODA0LCJleHAiOjE3MDUxOTUxMjY4MDQsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzI2NjkzLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcyNiwiZnhhLXZlcmlmaWVkRW1haWwiOiI4MzBlNTE1OTk1MDViZGQxMGY3ZkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI3NzZlYWJkODY1OGY5YmU0ZWYxZjBhMjYzMjZkYjIzMCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzI2Nzg1LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODcyNjY5MywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.mb92cHM0FD3coT6cMJZ05NGO6dRvu0V9ocXJwKw8S43tqEEy5u3GDThVg4vOFrtfodQekhiYksbYlq4GXd8s64dLwo50-CG1UEyDD6qh6rg2I25ve3Oo526SUWOOiAXuAiiSeQ2evx0qhdWKi_l8txtKoJQ3zDp5FQ9SjNCitW0f1UE8OH44N23Z6PvfQgY3BJsYqOicpjxqHFusasO4OYIH-H5UseZHqSoFX-OOjwS_fbH1hzmnF7XHboudnBb9BMGyDh5vASnqHhDSMx9LlKBhlOmy5NgFlIzuoVpwLnLtQ21oEoVuLnfu-U3M0hh6VspVSRL9-m88kYuGLK_BSA'
  }
}
    ✔ certificate sign (258ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3495e25a999e17ca92a@restmail.net',
    authPW: 'd8581478cea3ab135e4c14744c3ddf4e00ae909d1f748650ae0e533f9311f1ba',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '60913d63b2884df29faa1b2c1a53ee28',
    sessionToken: '773cd318f3194fcf5c67296c9040931d61c7eda5c0a94952695920c3cfe41886',
    authAt: 1705108726,
    keyFetchToken: '3ceaddd78a5683cec0309859d3f7c46b6c95cbeba094bd8d5c7cf1eee1bbf8fd'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '60913d63b2884df29faa1b2c1a53ee28',
    code: '220043d18bc6d5765fe6a3412e10eef0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2e5660766f593be55b84381907f7405c8fb9ef0c07166230dca471bcbf90a5bf", ts="1705108727", nonce="bxy64f", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="Uw866rgIP9dRdCdN79w9fkGtl9vVeu+dHou0BTSSDlk="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JNXWI5KJNMXSWSLWMZNG4KZSPB3VOOCF',
    recoveryCodes: [ 'swkr0bwd6d', '64h63239pb', 'hr3cp355x3' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2e5660766f593be55b84381907f7405c8fb9ef0c07166230dca471bcbf90a5bf", ts="1705108727", nonce="1qQn01", hash="LMGwBUL5wKmygHEnRUbFfHMrLTyF6H7bQu3G1mEvKD8=", mac="Qu6f+mjX3P3MemVnkt6gGuEDcVJkbemSzmi4pCHqnP0="'
  },
  json: { code: '663760', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2e5660766f593be55b84381907f7405c8fb9ef0c07166230dca471bcbf90a5bf", ts="1705108727", nonce="BluegY", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="uGG9gxmdcTyORXmIYsTTMnN2sG6u+c6HkfugG3XIu9I="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNjA5MTNkNjNiMjg4NGRmMjlmYWExYjJjMWE1M2VlMjhAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzE3Mjc5LCJleHAiOjE3MDUxOTUxMjcyNzksImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzI2OTM4LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcyNiwiZnhhLXZlcmlmaWVkRW1haWwiOiJhMzQ5NWUyNWE5OTllMTdjYTkyYUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJlYWFmMTIwMzFjZjk0MzBlNTRlNTQyNmIxZjY0YmFiNCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsIm90cCJdLCJmeGEtYWFsIjoyLCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODcyNzIyMywiZnhhLWtleXNDaGFuZ2VkQXQiOjE3MDUxMDg3MjY5MzgsImlzcyI6ImxvY2FsaG9zdDo5MDAwIn0.biO3BAtcMaYSeDcUbVSTZv4UsfJKqw218Msqc9-7oKSf2Hkyi4OFK5MpDOVbB_mnwoCgpFO91NhzVBNibvVbqihD5lqMjFiNGLvSIlntem7_49-koBZQcKF0XSY4w07JdskUHK2Xr971o-fBNtR4tf8uQn4LFzmQ4BQ-RUbydrKqcHyeAkxURm6dA1E1FIa8xvKiPGCRMe_Ke_7utPDd3fJvKLeoF7j-T4PEGZECVhZ3zWH8UwlCAn68PmRZbu2Gze7P_lCwIsBsohFiXujw2N3Sm7PtiQ0sINmm6O2VeDW3n9U0OaW0HD2onkYKzQvAWiEELup_9dh8-aBw_ymg6Q'
  }
}
    ✔ certificate sign with TOTP (474ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '59078b0f274ea0ccf16e@restmail.net',
    authPW: 'f2be33a09c920efb010c2d8abc805867ea01fb05e82b817979390375886c48d7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3e69715fc4634f85990a4d34d245d481',
    sessionToken: 'ce7711061c74cc7e5eba7a655ffa2bbb0ca1ce50158301d2b205dc5cb7617a7a',
    authAt: 1705108727
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d6188d69b9d242e26c1cc6e35a4b3e14016e9ebf634df10f949ed093c796a96b", ts="1705108727", nonce="fX9pVC", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="PZQvVZDwZNEeTA4MiJsEV/pnzoV9LW6XMeRWExfXZAo="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ certificate sign requires a verified account (184ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2e4a98776b00e34308b7@restmail.net',
    authPW: '57459ea11c875572fbd56f1d61fc8e5f94fa3e4bab4e974a15183158269d2b75',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8acb09706c884387a9683bc3f3e4ccdf',
    sessionToken: 'cf455d4c278fabd4079f91385ddd158d9bf40b4776f4281d5ea821a94f373cef',
    authAt: 1705108727
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8acb09706c884387a9683bc3f3e4ccdf',
    code: '4b2be6a52ba030fa61dfdaa9fd8caea3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="mE_Yb0", hash="SPe7j37D29Nt0/+hyyyckB93qNYI86jl6mki9WutKvg=", mac="3wq454eOvKz10EIeKI/hvn/DUqh4eEGM8uw55re+0Qg="'
  },
  json: { publicKey: 'tada', duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="usruZU", hash="lyhp9RAt6T/Duh0mgn/7+WYijF9FXHSXDsGgGnxsgk4=", mac="4TbPTbS0ybMVSy70b2ROyBbJJa9ToqlSCD1RyEzNMSM="'
  },
  json: { publicKey: {}, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: publicKey.algorithm',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'publicKey.algorithm'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="NL0lBu", hash="V3tT7krnXb4Q4OUMGkxLGcaSBQlANqYz7oOUpZHf8ho=", mac="FG/cNhDypbAbEiU+tJkHPDtnlGuzmDRsuIhfO9Ai3rI="'
  },
  json: {
    publicKey: { algorithm: 'RS', n: 'x', e: 'y' },
    duration: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: duration',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'duration'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="QFSNmE", hash="kOqVfu0mw6na7pv9Nxj4OkdTdeHZTEw89Vc3+VLWpYg=", mac="SucJM2AmYz3/f5BGWZ9MyzXWNfUyzIWzkRbU0gC7fYM="'
  },
  json: { publicKey: { algorithm: 'RS', n: 'x' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: e',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="_K9nVy", hash="RVFrSqmY4kL1NLBF60eRjoxYsTxH+TzWnTqHwQOcnbg=", mac="ob7JcauPSiqrid/pkfl4BqUShMxdMJAObRz9jUU7uTU="'
  },
  json: { publicKey: { algorithm: 'RS', e: 'x' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: n',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'n'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="v1fnZ0", hash="u8V66Hn7UM6+PAphU75IwHpAe32Saqu9PjiJCjzrtZI=", mac="zlOz68fqCVjyt3Jqntfh6sFkhC/Nyb0gbykEeSsZqJw="'
  },
  json: {
    publicKey: { algorithm: 'DS', p: 'p', q: 'q', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: y',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'y'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="0at2LV", hash="LM+xJ9vQxqVZZMyNcwsRi/eXiW/yUuOMhzI12dNLjqg=", mac="Q1IqXWhyR5VGfSYr7mR02LRKkgx/xrgMvaqa1YpsrOQ="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', q: 'q', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: p',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'p'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="meJreT", hash="8plJxQSJTzciTMyfbTqEMBfIRoRKSDySLPDPpMYgSH8=", mac="zlazBqczdZyvAz7qYJFBX+iZ7NDEcSfTHfKBy4kyY3o="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', p: 'p', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: q',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'q'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="ejFcad", hash="V9nlVjFOQEEcLQWtJC405lNqzgeR+GnsuhbnOAvnT3o=", mac="ZndEX4Blx2z9iTfhIi23S/1bafZUN0xrfops++7whDM="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', p: 'p', q: 'q' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: g',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'g'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="634ceb681b1cee32d611999edd48f45421ec8437d8e12f7dff852c5beb5383b9", ts="1705108728", nonce="Agc5ub", hash="c93tMvtisdymF/7r5tNWiw5eSPJnM/GXoIGQPzGhzmA=", mac="07nirBd4XXn3Eso6b/eHTy/5cypWUF+dyzyHpRvfnD4="'
  },
  json: { publicKey: { algorithm: 'NSA' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ /certificate/sign inputs (295ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '15a8d1d13eb7ddc95c0d@restmail.net',
    authPW: 'ffa738f42d86706ff9b112c5bd1e7d015a5f4f83d4ecdb9b114b55293c59515e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6d97583b7dad4057a0b7cdf31e1624a7',
    sessionToken: '8246f1ee5e251fac877f1b20696303489e5878387772fa1ad4446861a52cbbd6',
    authAt: 1705108727
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6d97583b7dad4057a0b7cdf31e1624a7',
    code: 'df237f45d1c82d88be330b3c6a92c39e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3bed69e9b712cc3859988e885bf4cb2f6213264f3bfbd919e0d4f66260ddbfed", ts="1705108728", nonce="hb3oAi", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="KIemGih+Ds/MJQf+xlAaA16iO2P9nUQpcpmmb2LzNfQ="'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 109,
    error: 'Unauthorized',
    message: 'Payload is invalid',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ no payload (225ms)

  #integration - remote certificate sign V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1fed5468cd279841c5b7@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1fed5468cd279841c5b7@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1fed5468cd279841c5b7@restmail.net',
    authPW: 'fd0768cbd53307ab61364c44b7817e392fb689a27b9fd99158b96cf2debdc328',
    authPW2: 'd78c0feda7919f84540aeb949ecb7efbe70dddfd07e6a888540a8fda072ac0ee',
    wrapKb: '515f42658a7849890391d872faaa816660681895d80e98717cb822d5ef73e940',
    wrapKb2: 'b08a2731a85b8c0ad727fbaeb30c69e4d0874379669af2b8cebeabd0fa674493',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a17c1216b64ee9e0325a573f4620a9e73f0e862bf5766b80bda18bb22c2e182e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7a51dfa922d34461b2439dcddf01ae52',
    sessionToken: '16925dcd5cc383a60be22dfd1d152b9225d6abd3a3a93e437360f599835a84cf',
    authAt: 1705108728,
    keyFetchToken: 'f6cb508aacc91a976558c84d8e51f187a7eb2bd9f5fd95b0f2719cc5d61d598d',
    keyFetchToken2: '19dc010f088b1d497466be1e50c69078a5065c7d97c8b6ad16d50e0cc1919364'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7a51dfa922d34461b2439dcddf01ae52',
    code: '2aae7b1fb6eb2202c02098615f91a3a1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e2579cccf3231f236c1fe40151d358c91d5c2288ef74164ddf8ead0660866268", ts="1705108729", nonce="KxVXHU", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="5oy1mshdCFtOrh2ND+1mvaWu5DnfAH9HC6iR3cXk5AA="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiN2E1MWRmYTkyMmQzNDQ2MWIyNDM5ZGNkZGYwMWFlNTJAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzE4NjIzLCJleHAiOjE3MDUxOTUxMjg2MjMsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzI4NTA3LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcyOCwiZnhhLXZlcmlmaWVkRW1haWwiOiIxZmVkNTQ2OGNkMjc5ODQxYzViN0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJiM2E3ZDNlZDJlZDc0MzA4MjQ0MTUyYmYwNGI4NGQ5YiIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzI4NjA1LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODcyODUwNywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.jZtugo14mPigdddBx9ZWEqRGMTyRPgkBI-ftVOb22SYzUbtZyr9WP9z4kRSuZPL1qVNRgjmXYqUTeXUHQ6RmU9m883wVnPEleg4bUFpqkIAyujVz9DNxgiTfsqjANVhjvMXu16rg5o8pDpD5BZsSZI9lVHA0guqAS1zCQE2As3IFshgbWSDLHgnblebB8dir-Zy0_8q6kGX_sQgrrg3e1iJhWKTm1_8Ju7P-HAiY5y9kP03LwPv2jM21ehr2_abUmBhTv04Ojoag8Adu6nOC4J5cyTxaYmP-ZFXLvM_c3cn-s4cMp1IntIOnf8mnS0fCNY7G7oxFwexJWuMrhkLGfw'
  }
}
    ✔ certificate sign (582ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a4fa580747e41e12fdf2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a4fa580747e41e12fdf2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a4fa580747e41e12fdf2@restmail.net',
    authPW: 'd1eda620c79a5bb860c6dd6fa358b18ab2c4fce1ed6493dd216732a8bfb15a1c',
    authPW2: 'cb7ce80e4e565fea7ddcff34e9debaf8abf3b0f3cdb9f8bac4643f0a8f0ca032',
    wrapKb: '50c5bb954312b66b802205bb472f80f39af349d1faa13db300cb5ec8305406f0',
    wrapKb2: '819417289c7ac844429a6b3136d0f239a3c8ec492f1c192db781c973f79105b1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:397c714d736db1c70c68d5b6c18598ee024d5a9c3bc500c18257734c0f29c0b1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '40c2b76368a04122affa9f8424446934',
    sessionToken: '7f700a52badd5bcfd851c936ad08be502544032fa331d1694e80371181af2163',
    authAt: 1705108729,
    keyFetchToken: 'ad9ae2e6712cb5206c1e160b504b5d542e114681aad6039e178491063ce044fc',
    keyFetchToken2: '3a0ce16ee7cfb73f80b462e076388709cd1879fee5af92dfbf1b517f5890fa0a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '40c2b76368a04122affa9f8424446934',
    code: '6c033649fa9b16addcd0c027775c5e5e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e89de5c7fc3825aebb9819de1f1dab3ca4e4aff422e958fcdfef78a353098410", ts="1705108729", nonce="f5JIFM", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="bZWVWbME3C0B8Z6bb0UQ5td0Dz1vlhHd48xRKCAHjkc="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JRJHK52QIVIGEUTMKF2FAS3BNBWWC33H',
    recoveryCodes: [ 'g33n7qk3sh', '9yf7fnk4my', 'qvdxq5x125' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e89de5c7fc3825aebb9819de1f1dab3ca4e4aff422e958fcdfef78a353098410", ts="1705108729", nonce="A9jx0x", hash="kNafIHUQwmTkTt1ty/YTM4xgId+b37AHiuy8JUpnai0=", mac="Qx5U6D/fxXyqA39t6ZZiR3u+4U6sbrBo4VCRk6taM9Y="'
  },
  json: { code: '123286', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e89de5c7fc3825aebb9819de1f1dab3ca4e4aff422e958fcdfef78a353098410", ts="1705108729", nonce="PrD665", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="cSOETCCz7YePjSJittFS9+9hL+nZTqujzbIIDi6Qzc8="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNDBjMmI3NjM2OGEwNDEyMmFmZmE5Zjg0MjQ0NDY5MzRAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzE5NDE4LCJleHAiOjE3MDUxOTUxMjk0MTgsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzI5MDQzLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODcyOSwiZnhhLXZlcmlmaWVkRW1haWwiOiJhNGZhNTgwNzQ3ZTQxZTEyZmRmMkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIxNjRjOTI1ZjRhNWZkYzBhZjMxNzk0N2Q1MTVmNjMxOCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsIm90cCJdLCJmeGEtYWFsIjoyLCJmeGEtcHJvZmlsZUNoYW5nZWRBdCI6MTcwNTEwODcyOTM1NSwiZnhhLWtleXNDaGFuZ2VkQXQiOjE3MDUxMDg3MjkwNDMsImlzcyI6ImxvY2FsaG9zdDo5MDAwIn0.IJ0F-zpe2JJwhqzZkj0pe2aCvN8e69z3HEsy1dMe_jpwUBwUjTQtNTnCKD9Y4YTJTKQNYwTZSikjZjp2Q8lcG91De7XbnjCfWZRGxj4-V00MfV_UUNDfjQ1196byJxlFKFbhF4mUoT8LV1wRh9EjLDyuJiq29BUNBmv_XKwjv5Aj2fpWqkZ_587BkSkMu7qoicSLDE9PdqR7a_GII9Q7Y-kDJ-TfrKU9n7R3I32xQCyxOywHWneEp1SVqmd5u7xrfCL02MPaOxidmqryDe0nyCvTaJ6yai0MbvtL8_aAFMq4fvYp0wZeNMLEuduUBKeQb1ZfVbmi5MCSCYFHro98rQ'
  }
}
    ✔ certificate sign with TOTP (794ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0958414408245516f484@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0958414408245516f484@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0958414408245516f484@restmail.net',
    authPW: '90ae22231345100c12b875ac2589146d1fd19b1c3ed76c3cd5fd3a9d793be8b4',
    authPW2: '2d5878a60a2f8ecfc33a00f6bdc61b8959e0ff544f7bf4aeb6b5eb9d6a1fed7d',
    wrapKb: 'fdac3b67860af5a4ddfebc29ceee364e713e713e2f55cbd623626b211ebf3159',
    wrapKb2: '1ad36476da2e5d7ec1ae2ac06dcc7cb743fa74adcbfabbeccadc1382607c193a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ad159d4616bb536e3366be751f0b2f7c34ff87bbf90abed08d2f731d13d46142',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2385bea30eb04a788fa30e0954db9026',
    sessionToken: '2c7b557343c9d926f12ce8c441fcea3a6493b16b5ba4f1de7273f5d84c52a734',
    authAt: 1705108729
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce1a7ca0429d6848b5c8a1b5f298c10717047b8f912d80a0f10a1012581021f", ts="1705108730", nonce="wzCa4V", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="Fgbadk74SOo+332Dk/xRCSAHRhroayiwEAFLTJoBQEg="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 104,
    error: 'Bad Request',
    message: 'Unconfirmed account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ certificate sign requires a verified account (487ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9483fc0e2e4335f89836@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '9483fc0e2e4335f89836@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9483fc0e2e4335f89836@restmail.net',
    authPW: 'c13ee1b969d0fa0915375e3e0e92f0369751f9091af0c00449b766f63f6d5ac5',
    authPW2: '3947bef16e506f1400ac6692fb9fc06806ed6e788856461e290839a9d19d26a7',
    wrapKb: '689649602367ee24d493d84d812870866aea25277f6b965add479b7fa1bd73cd',
    wrapKb2: '4e548e9a89e7bfc044a29438202c3947f437a6eed7029904a3356782723906b6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5f2a2ad3aee188230e9dfb90d8a1bbca953fc01b35490aaed1e8c0d729039dc1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2cb8cf90fe574c14b2ae118ed8ce0aa3',
    sessionToken: '4fdbed469f25adbe2b7559c4fc3584cabfe18c57f930aeb6f3bb51a804366bde',
    authAt: 1705108730
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2cb8cf90fe574c14b2ae118ed8ce0aa3',
    code: 'b971f1725916d4fbbd5fbcfa4d8b3ed7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="HU1C0L", hash="SPe7j37D29Nt0/+hyyyckB93qNYI86jl6mki9WutKvg=", mac="whk0QqExIFrSqsORwtAFkYSXcRZbKDQWrb30zhIt3Wc="'
  },
  json: { publicKey: 'tada', duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="ICQ7ZN", hash="lyhp9RAt6T/Duh0mgn/7+WYijF9FXHSXDsGgGnxsgk4=", mac="TK/RpdWcN9H09kk5TKm16dJOuPkneFNkJDIH8OwM3cU="'
  },
  json: { publicKey: {}, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: publicKey.algorithm',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'publicKey.algorithm'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="hCNSyc", hash="V3tT7krnXb4Q4OUMGkxLGcaSBQlANqYz7oOUpZHf8ho=", mac="/AzPdh5Pe9Ki8/EPFbfFcmyWlVF3ugnnrw6pHr14cUs="'
  },
  json: {
    publicKey: { algorithm: 'RS', n: 'x', e: 'y' },
    duration: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: duration',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'duration'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="y1wa3K", hash="kOqVfu0mw6na7pv9Nxj4OkdTdeHZTEw89Vc3+VLWpYg=", mac="ed4T7PgOSoz5YKjL7CIcyDveSFlaqKtKa0ZViYlYP9Y="'
  },
  json: { publicKey: { algorithm: 'RS', n: 'x' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: e',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="j_W7Gt", hash="RVFrSqmY4kL1NLBF60eRjoxYsTxH+TzWnTqHwQOcnbg=", mac="AHTVOLl8eIodpefisQXC1QpP9JkyDzpv7GqdRuhE0uQ="'
  },
  json: { publicKey: { algorithm: 'RS', e: 'x' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: n',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'n'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="SaOcqx", hash="u8V66Hn7UM6+PAphU75IwHpAe32Saqu9PjiJCjzrtZI=", mac="6B4u6EWayw7KSNJVM137cq4SU7Mk4Ru3mPE7GFPLLyE="'
  },
  json: {
    publicKey: { algorithm: 'DS', p: 'p', q: 'q', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: y',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'y'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="Bmsx-6", hash="LM+xJ9vQxqVZZMyNcwsRi/eXiW/yUuOMhzI12dNLjqg=", mac="ubSZFLoGo3VuG+dHxVC0AQ75J7IRPw29GXL7eTedvu8="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', q: 'q', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: p',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'p'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="bThMeO", hash="8plJxQSJTzciTMyfbTqEMBfIRoRKSDySLPDPpMYgSH8=", mac="egkATQowU9gkTYbTT0NmIWD3hlyuqAGeElbe/ORDwvo="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', p: 'p', g: 'g' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: q',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'q'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="cUHi7w", hash="V9nlVjFOQEEcLQWtJC405lNqzgeR+GnsuhbnOAvnT3o=", mac="GSI/Tp4rC6S+yA7SeaSPcbTsW6F2nrhmp1PB5II5L+A="'
  },
  json: {
    publicKey: { algorithm: 'DS', y: 'y', p: 'p', q: 'q' },
    duration: 1000
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 108,
    error: 'Bad Request',
    message: 'Missing parameter in request body: g',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    param: 'g'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da3f7a68f29b70aa37c640e4010aae4c9ee92bba9410d70decddd2939cb954e9", ts="1705108730", nonce="ROeG6E", hash="c93tMvtisdymF/7r5tNWiw5eSPJnM/GXoIGQPzGhzmA=", mac="FN71vSMfa3txo5djaHQ+G5a6W1nIu7BgrjB/ES0qNi4="'
  },
  json: { publicKey: { algorithm: 'NSA' }, duration: 1000 }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ /certificate/sign inputs (576ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '320678d97f933990a0bc@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '320678d97f933990a0bc@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '320678d97f933990a0bc@restmail.net',
    authPW: 'adf55b7a97d935f3a3748abc86e2f9ee8ba23cfdf75ab97fefdf35f917c3aeca',
    authPW2: 'a3e18fd9fa473c481c9112fdb6d1313065e7668efd8aa1a4447f6d410e0dfb09',
    wrapKb: 'fd3d001225a6642a96e4223a4c1988535bea3ea827cae83314d05e1f2b73b229',
    wrapKb2: 'a41379c5780473dfa1ce120c41ad62e6d84d484fa358ef5c803bc01c74cbaaff',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f255f60e910bb5dbed7a0255b0b3fdeed4cab1ce1cddeefa898a480f548b5166',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ed0d5fd5ddb24b6695eb0a4294f29b70',
    sessionToken: '27aeba2a7d72da1b9ce41ed95dcac06847acd5b2404100b2f665067f61d8af88',
    authAt: 1705108730
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ed0d5fd5ddb24b6695eb0a4294f29b70',
    code: '778e39a0f1245344023831a61fced0c6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="64770868d837b84cb5523ea71a51c991fc3209f452d0f5ff57cab55b86fb6e4f", ts="1705108731", nonce="4O_-q6", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="wXJiI7xiT7zr1nWiXpNp1ixrEQHPSifaJ7s3QX0K6RA="'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 109,
    error: 'Unauthorized',
    message: 'Payload is invalid',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ no payload (532ms)

  #integration - remote concurrent 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8d1937b2eeb2dbfd49bc@restmail.net',
    authPW: '9257257b658982ce3716403ec9b5c31e2ede6f622d8a0c16f8b5e9b26bad31e6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8d1937b2eeb2dbfd49bc@restmail.net',
    authPW: '9257257b658982ce3716403ec9b5c31e2ede6f622d8a0c16f8b5e9b26bad31e6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 101,
    error: 'Bad Request',
    message: 'Account already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8d1937b2eeb2dbfd49bc@restmail.net'
  }
}
!!! response success {
  body: {
    uid: '23b82903a22243e38054463d9af6230e',
    sessionToken: 'b35a02d72853947f94888f8a41845300141ed0dbd152829d5804c9e509cc5bf3',
    authAt: 1705108731
  }
}
    ✔ concurrent create requests (269ms)

  #integration - remote concurrent V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f3466d83909c26e7f91b@restmail.net' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f3466d83909c26e7f91b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f3466d83909c26e7f91b@restmail.net'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f3466d83909c26e7f91b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f3466d83909c26e7f91b@restmail.net',
    authPW: '7ef57571764fa88263d5efe1001bd14cf39b493dd2a694d77669abd29e21747f',
    authPW2: '6e29d9385633337cea616390724b1033343484f5ed1ecaee94efabe23057956e',
    wrapKb: 'f04bdba574fda8bfe1bab6255102b9fc9581ff71b67704ad2e843c2c09d5427b',
    wrapKb2: 'dce33af6bb799bd4aa49bd9ba2974122dac0891472fa33db6cea292d1ba325fe',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ebf0cea8bb966c15ce0d4cdbb8a78534c5ef2b2c424a329c49dbace991566b09',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f3466d83909c26e7f91b@restmail.net',
    authPW: '7ef57571764fa88263d5efe1001bd14cf39b493dd2a694d77669abd29e21747f',
    authPW2: 'c4330f0b064e10815525943457cd45453628dc2fee2304d9a02f8ffa59e793ed',
    wrapKb: 'cc07b6bd031c12b07bea5e6e8dbc532772abd59501c7b9698c25a3b994bb58e7',
    wrapKb2: '8488fef8d8468521c1dc6b11ecaa85f917becb57643b9629b57b522352c0f0c2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b0dd4caa42bdac57b76151310feb78e7f90e6cd380dafc3f9034ddd198074dae',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 101,
    error: 'Bad Request',
    message: 'Account already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f3466d83909c26e7f91b@restmail.net'
  }
}
!!! response success {
  body: {
    uid: '6b7a70a681e84c53926c92e5d522f64c',
    sessionToken: '9a3e2c06b073652ce92c6f2d2064f8100c7b2c9bb4ecfe23e21b993caeb1469a',
    authAt: 1705108731
  }
}
    ✔ concurrent create requests (530ms)

  #integration - remote db
    ✔ ping
    ✔ account creation
    ✔ session token handling (71ms)
    ✔ device registration (85ms)
    ✔ keyfetch token handling
    ✔ reset token handling (40ms)
    ✔ forgotpwd token handling
    ✔ email verification
    ✔ db.forgotPasswordVerified
    ✔ db.resetAccount
    ✔ db.securityEvents
    ✔ db.securityEventsByUid
    ✔ db.deleteSecurityEvents
    ✔ unblock code
    ✔ signinCodes
    ✔ account deletion
    ✔ should create and delete linked account
    account record
      ✔ can retrieve account from account email
      ✔ can retrieve account from secondary email
      ✔ can retrieve linked account
      ✔ does not retrieve linked account without option specified
      ✔ returns unknown account
    set primary email
      ✔ can set primary email address

  #integration - remote device 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a8a23418d09253a32a6a@restmail.net',
    authPW: '663abd5b2fdd9c8f2494cf4efb191146d9b5f70242b66f247111665c0c4b5f87',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '68ee30e1132a4e5aa8c26c5c33ee3069',
    sessionToken: '12d90db681a958c69ba8a95af933180897567c2c7ad947c01dd7f31a2f487c22',
    authAt: 1705108732
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="47aad1bcc61015b4e03b1bc151e6d5bc66f65d83f9374fe1d8c3668d9562fd18", ts="1705108733", nonce="-DUBUZ", mac="0xhr+F/hi3mOc/qYHJCnfAgnX9I0FGGabW7tSyheaYk="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="47aad1bcc61015b4e03b1bc151e6d5bc66f65d83f9374fe1d8c3668d9562fd18", ts="1705108733", nonce="MAEZCS", hash="wxzKdMAcaKYdXw0QiP5d98+l64w6074wk7P0Cbj8iwo=", mac="Zmf/sKXLzEp5YjJilD1O5DsZ+0PKvTkJa96PJzR/hww="'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: '3d1abb2c97d9b9d2648ca2a3aefbc90d',
    createdAt: 1705108732940
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="47aad1bcc61015b4e03b1bc151e6d5bc66f65d83f9374fe1d8c3668d9562fd18", ts="1705108733", nonce="6c6Tdj", mac="JMcvuawO3s5oj1DsWqcc6zy30VHmRM3forPE6BCci84="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '3d1abb2c97d9b9d2648ca2a3aefbc90d',
      isCurrentDevice: true,
      lastAccessTime: 1705108732956,
      location: {},
      name: 'test device 🍓🔥在𝌆',
      type: 'mobile',
      pushCallback: '',
      pushPublicKey: '',
      pushAuthKey: '',
      pushEndpointExpired: false,
      availableCommands: [Object],
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="47aad1bcc61015b4e03b1bc151e6d5bc66f65d83f9374fe1d8c3668d9562fd18", ts="1705108733", nonce="XLERFN", hash="7FOy0YCK5Jii4Qi3Ou4d8zZ0U7cIBOLf5W+OArlWzYg=", mac="QqO2SwL5LDC0OO9IFs3nJ0ZsrgyPRctUNNCgOlpbSeU="'
  },
  json: { id: '3d1abb2c97d9b9d2648ca2a3aefbc90d' }
}
!!! response success { body: {} }
    ✔ device registration after account creation (289ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd839608b191ea7931eb6@restmail.net',
    authPW: 'db0cddaad48bfecdacef5d5e27f586da6a8412df8049afbdd2b25ec8435775e3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '27ce44f7357c40aeaca3a1e1f666ada8',
    sessionToken: 'a1029496c7dba387b623d5377c869d5e87a3013becb7e22159da2d6f223fcc0c',
    authAt: 1705108733
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d1afadd6009b4d21d3a300a3953384313ad269d2283f82388201b17b07360bc7", ts="1705108733", nonce="c7ihRI", mac="CxYJ0EQWHJs82x8fgzH+LjEP9D8tLPcTySv4kVpPNoI="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1afadd6009b4d21d3a300a3953384313ad269d2283f82388201b17b07360bc7", ts="1705108733", nonce="QZOgdH", hash="r6VL6KQdfNJbr17H/DeddzCOch7D7EYxf9WwvdizdoE=", mac="VMgbtBH+WFvBurCqfhaKkYYwUoz6oiDMVzSW6Mrp3kk="'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '64d84fa46f4d7a5070e6d81b5de214ba',
    createdAt: 1705108733201,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d1afadd6009b4d21d3a300a3953384313ad269d2283f82388201b17b07360bc7", ts="1705108733", nonce="JdDEk3", mac="MA7OukHbrbHm/TLi/dy73ZnR5Cx9hCcm00aSVdEUX4E="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '64d84fa46f4d7a5070e6d81b5de214ba',
      isCurrentDevice: true,
      lastAccessTime: 1705108733216,
      location: {},
      name: 'test device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1afadd6009b4d21d3a300a3953384313ad269d2283f82388201b17b07360bc7", ts="1705108733", nonce="pss6VI", hash="bXrJNFGupDbZ/7I23pz2UkjngNB+tBByiKkNTVM/6rM=", mac="4PcuTDWJZ/blHbz6gP+LDf14qnL42YbAiYv5pNlqoCI="'
  },
  json: { id: '64d84fa46f4d7a5070e6d81b5de214ba' }
}
!!! response success { body: {} }
    ✔ device registration without optional parameters (261ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4d5cb2b98ad4e480557d@restmail.net',
    authPW: '446e08896f0827fb734730d4962608d3c38d2c99ef6dcf518088620e95ec53f7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '489a014cbc4d49de9475e4554b989e51',
    sessionToken: '3829ec114d19892e5fb6057aaa6a7782c317b147bec2cdbd8866f7fb91d090a1',
    authAt: 1705108733
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="23b9196c4d9745eefc3787089295535af790b2d2792d77aa9fb373321d9edc13", ts="1705108733", nonce="0TroNi", hash="FxQ3RxQcFHaRkYsA3XQatPjGuxPjo1GtdBiW/UB0FNg=", mac="Ty6Y0dAyQZ2LfdMpQ2r5VyGDPNdTp1uhBFC0Wz+CeQk="'
  },
  json: { name: 'Firefox 在 β test�', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'Firefox 在 β test�',
    type: 'desktop',
    id: 'fb3a1141c380fe7e966fa270003f6c42',
    createdAt: 1705108733442,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="23b9196c4d9745eefc3787089295535af790b2d2792d77aa9fb373321d9edc13", ts="1705108733", nonce="Gc-fF5", mac="vG4/fsK5Iw0OC9MmAnGNh/BH2Hsa3LqajkIRYmVU9j8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'fb3a1141c380fe7e966fa270003f6c42',
      isCurrentDevice: true,
      lastAccessTime: 1705108733457,
      location: {},
      name: 'Firefox 在 β test�',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ device registration with unicode characters in the name (227ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c8d54762ff0c94fa7ee8@restmail.net',
    authPW: '12a03f5017de3511984bb92a244bb2b5ba4c13ffc8edb924fb6fcca0137c4f42',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a7e9ae2f388240f090d51520530bb438',
    sessionToken: '1bff36afb8a3738f31bf6b8a2c94b03350ca78fd5c56e4e76e9d1a949f3a80c5',
    authAt: 1705108733
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2f67df8a264f4d5fff11af45560e7e3dbee9db193726aa4c95c9e3afd16edb2d", ts="1705108734", nonce="0BFdrA", hash="ZPtQWgx70aZ+yDFnBvdqQYyBuyy5242Md7z1GY5eviI=", mac="7rUrZmnU6xsBclksdAFcKhyPrmIfPJgFk62AglHvgt8="'
  },
  json: { type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    type: 'mobile',
    name: '',
    id: '8250549083555ccd22a44595207a2145',
    createdAt: 1705108733664,
    availableCommands: {}
  }
}
    ✔ device registration without required name parameter (208ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f4564f0522c45c25838b@restmail.net',
    authPW: 'cc4d452ec542c3481fd9cc3a96fef492385c950f421a9961255024ad0d6e505d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '977d3bfd72ed43ffb8b339d9d42e9693',
    sessionToken: '7640519ba744aef8106ff45d41be861b6f72bab1f1c4cfd5eff8396cb921ef49',
    authAt: 1705108733
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ba4a861d18239f554aa50e2dd49058107141b2efb0ed7b08159c632fe9d9a07a", ts="1705108734", nonce="8u49sP", hash="ArFnR4haj6CJJ0RxA6bTP607eJAKprz8+vi61OlPDVQ=", mac="A6wWp2laOCIQSxrBOBG6h4dDw28dD4lj0f6CjAfYOAM="'
  },
  json: { name: 'test device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    id: '06118b1ec47d0c07c110fb4def5a2f56',
    createdAt: 1705108733881,
    type: 'desktop',
    availableCommands: {}
  }
}
    ✔ device registration without required type parameter (219ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e221146f9e11a7b3b779@restmail.net',
    authPW: '2a0ce95d5f6d32de6ba37c465ce4f1c9b1ede161e0ba134232cbe405a8404a15',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1d3a947707804d6eb72ffa6122b0adfc',
    sessionToken: '5f671d0cd98e83027bedcdd19ed43244b80323b9971210272a36eb10f5749b88',
    authAt: 1705108734
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="10fab3db8d142f75c32405fe7a2265c6d009862bacdaffa2bc5fc527bb712759", ts="1705108734", nonce="TXxLQd", hash="hNZLqWCjPJK2oTHExLxX6SgNQDBV30oPGDmaBtQwgIY=", mac="ZPxsir3eLHEE+8VTudCzbahPFZxVk8qPv/m0NpLtwhg="'
  },
  json: {
    id: '8701c3694cca5c2b415da76c37076a5a',
    name: 'test device',
    type: 'desktop',
    availableCommands: {},
    pushCallback: 'https://updates.push.services.mozilla.com.different-push-server.technology',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: '6uaaDmAJRjZiv5ik02EiuA'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with bad callbackUrl (210ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7c58184da765c2263f06@restmail.net',
    authPW: '9b92825ad9dfa19efb49e94fa52ff1c8a6d5b89ff9f66bd8bed522c1e8c14332',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '780686b8486a49b0ba6cc788012596d3',
    sessionToken: '11b691a0bbb5d6c80e782f70e129af88cdfe692ac2a41305bda457036590dae1',
    authAt: 1705108734
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7e76be4a08e01cc0144da1713b8a868d5a8fdde590826bd3ef925715dc0a5945", ts="1705108734", nonce="3adMr3", hash="my0ePtyMGWsLP4qNu5KzwP92x28U4tcV3fc7zEukFB0=", mac="ZpScOGP6C/17aM2CujNwdJ1ehTU+lr+pk1/ZwlimUt8="'
  },
  json: {
    id: '0c3efa97acd9a7681572b0bc56223763',
    name: 'test device',
    type: 'desktop',
    availableCommands: {},
    pushCallback: 'https://updates.push.services.mozilla.com/invalid/č/char',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: '-_VnlCb4Tdk_9H3V2jqCLA'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with non-normalized callbackUrl (227ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd1fe2286a710df47ab0e@restmail.net',
    authPW: '026b3b067bddd0865f45e66e8b7dedfc136866af35a453d9ca3374b2fa1010c8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '814122d926964f88bdf5518ae207ebac',
    sessionToken: 'f811480ed4668b2f1ca279a0010e1d7558c162af9976664130bf7f6742625bf5',
    authAt: 1705108734
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e4b7d26f886fdc1d1a0d8270afecfd3bc1cd07044d44ce082fc6be83fa3a9215", ts="1705108735", nonce="_RlzbJ", mac="csYQVQ/rDn1RoMP8MUAhMwYz73i6j9GDxaZ1BIYIxbU="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e4b7d26f886fdc1d1a0d8270afecfd3bc1cd07044d44ce082fc6be83fa3a9215", ts="1705108735", nonce="7y86wq", hash="QNGKtqcQlcgBINiGFCzWnNF0BbRgjYM397VNUneDx+E=", mac="oK8crCpHm5Gi1G9Hvl81PT1zrvXo1jTa0aUWcPPSBTg="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    availableCommands: {},
    pushCallback: 'https://updates-autopush.stage.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'v7lmuPAoxzOGrjrX3ETaTQ'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates-autopush.stage.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'v7lmuPAoxzOGrjrX3ETaTQ',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    availableCommands: {},
    id: '287fde90200e349d3223afe1952dada0',
    createdAt: 1705108734545
  }
}
    ✔ update device works with stage servers (226ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '699bf9c0f060805971a5@restmail.net',
    authPW: '948440351b9160fc19afd9c7e513257a1dde7929450f08c17dd5fa46fd6318ee',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0a14b4606ad047d78e4d0e82776c00b5',
    sessionToken: '6c90bc8d63b9598b9c41324536c42c40ad1a34dc24f1ebc8c4264843826badf4',
    authAt: 1705108734
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f79c9e705fd6ec41d007c3c52fcba1b43b165c04197eeed184cae7488919cb83", ts="1705108735", nonce="j72-DT", mac="GAaf1BCb7DBHw1XQlI7WpG0dYSC0a3YEPoQDCvomKw0="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f79c9e705fd6ec41d007c3c52fcba1b43b165c04197eeed184cae7488919cb83", ts="1705108735", nonce="7MRsTr", hash="uDs/XiBvhiw1VBtpOh1JPNa1eWvCgglSQbtOE3v60Wc=", mac="6ncD29adW4TX8Dg5tLUSXv7do0F+G9E0cKy6458/0JI="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates-autopush.dev.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: '-A9wX2IZkTL2BPSMMxVGbw'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates-autopush.dev.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: '-A9wX2IZkTL2BPSMMxVGbw',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '77c847c3d4433e83e054f49b7997922a',
    createdAt: 1705108734768,
    availableCommands: {}
  }
}
    ✔ update device works with dev servers (219ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '904677d5c853f03e58a6@restmail.net',
    authPW: 'e735bdf3324d28e749a0c9e6ce38332979b6b4e98a77465f3be9f5becef38e95',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ef99ea6b97fe4ec48ba657b518b799e8',
    sessionToken: '18b2e64784068f39d2f6fdad55f63262fe23435fc472c7a69932ff04a407e702',
    authAt: 1705108734
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3a7c4c29158165e5bde6cebc275f2493b59a03d67b2794a98074c643c35dea80", ts="1705108735", nonce="pyAWso", mac="q/O2aLtoICgGSHbP1LgL/9EIUf/tRnluUbs8bsN4QXw="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3a7c4c29158165e5bde6cebc275f2493b59a03d67b2794a98074c643c35dea80", ts="1705108735", nonce="oxmbrN", hash="yUgKM3qes+/3GofgKs49AfrHcerF5zIoHfR+UjzYWBQ=", mac="sKALiuAxsDcyBhv4PHIxK0DVq1S5Dx/iTm4Z+poULqg="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:443/wpush/v1/gAAAAABbkq0Eafe6IANS4OV3pmoQ5Z8AhqFSGKtozz5FIvu0CfrTGmcv07CYziPaysTv_9dgisB0yr3UjEIlGEyoprRFX1WU5VA4nG-9tofPdA3FYREPf6xh3JL1qBhTa9mEFS2dSn--',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'qKrhWseg2rJPimij5XDxjA'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:443/wpush/v1/gAAAAABbkq0Eafe6IANS4OV3pmoQ5Z8AhqFSGKtozz5FIvu0CfrTGmcv07CYziPaysTv_9dgisB0yr3UjEIlGEyoprRFX1WU5VA4nG-9tofPdA3FYREPf6xh3JL1qBhTa9mEFS2dSn--',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'qKrhWseg2rJPimij5XDxjA',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '529b749555be59fd009c551b9c9a017f',
    createdAt: 1705108734985,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that :443 as a port (218ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '084cf6dada6f6c6ce1ad@restmail.net',
    authPW: '2ab2ab17b7a205b5403ebbd1187d4847569ad9ffd2f0933d73b91a0ffc6eee1e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '604ab27a0bbe42298681c890a0a129a7',
    sessionToken: '3ccc9157f72589bf09dc7936c55fb411ce82e7fe527b4bbdeb2ebac96d12d126',
    authAt: 1705108735
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="05db0c10450709ff3cfd708d860d68aa26a6453401d789bdb14f9e3d80bf2ff2", ts="1705108735", nonce="KCQyEZ", mac="Ubo6P3POGE8BwQCQIzdSe04wUQb1gSCuWetqevr5/JI="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="05db0c10450709ff3cfd708d860d68aa26a6453401d789bdb14f9e3d80bf2ff2", ts="1705108735", nonce="4SPYYd", hash="XJY9RJFkg+n6N9ufEjl8quhkeztI4bC65eoDlk8CF6Y=", mac="0F3Hz1sz8zHBSOA6OMlCDWiWGiEbqfMPj1iTP/tFsW8="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:4430',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'mEwHP3pJR8voLI8D5d30SQ'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:4430',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'mEwHP3pJR8voLI8D5d30SQ',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '3049c5576070ce68ae133ef0997a1703',
    createdAt: 1705108735203,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that :4430 as a port (219ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a15ac289ef78f3720166@restmail.net',
    authPW: '167bc6b1f4d0845f1efbcd7b58f4d38e57953b806d8ada0988f8bbc0f5d7c172',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f5cae1981699427b9f3c8891622ae0cd',
    sessionToken: '4d970cc3938c30cd784c2f509e8726269857bdf7a72e53fd14bc9f9b563090e0',
    authAt: 1705108735
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="beef7eba544575f5c82bd9a47928b68a7d620db34b7c422e7586e04e3e8259bb", ts="1705108735", nonce="xdxLdx", mac="sQRyq7Q+IhMbpYUxgCwsNVJa+wdjHBUHfD4h6sWVarQ="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="beef7eba544575f5c82bd9a47928b68a7d620db34b7c422e7586e04e3e8259bb", ts="1705108735", nonce="XMDDVd", hash="gzskeBuTupsr8kXPegva7/LFx41L4wBed3J/k7+2bRA=", mac="pztaoke/M0qsqEIU8DXtEArLS++xKIxxQPvHijIinio="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:10332',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'sHmzIi-lHzxf7VkhFKD0og'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:10332',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'sHmzIi-lHzxf7VkhFKD0og',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: 'b00fe92c0a201f53567b66c1ad4d502d',
    createdAt: 1705108735423,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that a custom port (218ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0f8ab3c3d3efd5ba58bc@restmail.net',
    authPW: 'ed8e8ee4f50b29aa11fcc31ac6561c9e4c53a174b55f22b9aca4eddafae46277',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '06dc9df05f854b26ae62db872e79eb4b',
    sessionToken: '98fa85c02a14eb7d6870cae19f3f1d7ebdad78524a20e228812ed45b624cacf1',
    authAt: 1705108735
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6cf801cf872f6db818b02ad64f2562e679f4edeb4eb12db928722f9da7976115", ts="1705108736", nonce="UUAbwg", hash="Sd/FTX+SW1tt51OAwiCGugt8D0/S0FRjS9DF+Uv7q40=", mac="t2AS0YRN5A5e5zte0EHK+kgv2bEmXAjMMpJslzmE0Gs="'
  },
  json: {
    id: 'e90539883385d7e9f65f3ff21f337591',
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://evil.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'w0NQtf6i6jY9h9648pRVaA'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with bad dev callbackUrl (209ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fb092cb1f291154f5cc7@restmail.net',
    authPW: '77a2cc286cf759317241000bb7e7fda54ddd3fc8532b79dbd531a3468e2020ee',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2eb01ab8a7494916b1c0408fa0c3027e',
    sessionToken: 'cf954ffa46ecf772cab0bcfdd7cec7ef23ab2ab43f6f8d9168cf82aec07d8d01',
    authAt: 1705108735
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="01bd29337b5bcba21832e5718d0b65bcb5e08ca2c9968d811bd0eefe9dde521e", ts="1705108736", nonce="fOnbSe", hash="vL70FKAavoL7f2avbeBZgRKNIGK59Mgfn8HeVEwv8hs=", mac="28uYA2iLWAupAwb644oqxt9pLoldGiNDztcUxnXSu9k="'
  },
  json: { name: 'a very capable device', type: 'desktop', capabilities: [] }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'a very capable device',
    type: 'desktop',
    id: 'b6a91d25aaf1188c743814728c5b1d18',
    createdAt: 1705108735840,
    availableCommands: {}
  }
}
    ✔ device registration ignores deprecated "capabilities" field (208ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3bdfd34390687a0366c@restmail.net',
    authPW: 'd932c51835bf468c04d1819a5d31a0cfbd970eafd33be60ab1c96d261a466a22',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9d100093dd484bcb9686878a0fdd2471',
    sessionToken: 'bd5ffd32c3b514163d7cae698d382e4df3e427ce36f9aaa0cabcac95d80505f2',
    authAt: 1705108735
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9d100093dd484bcb9686878a0fdd2471',
    code: '8237a9c8bd87b37ddda134c92098d0c9',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3bdfd34390687a0366c@restmail.net',
    authPW: 'd932c51835bf468c04d1819a5d31a0cfbd970eafd33be60ab1c96d261a466a22',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9d100093dd484bcb9686878a0fdd2471',
    sessionToken: '93769525cad35e70c60acdcd01be3840b21bbd4fc23b1d3cd02b2ee2fbaf8548',
    authAt: 1705108736,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="66b976ab898b2a42949da84ce9f160f042ce1a00d154cafc81868b26c17d12a3", ts="1705108736", nonce="iXQZ26", hash="XaZfhofC+yN+7jz5XiOPZ87mGKF8wbBGR3pj1sdmlMA=", mac="8kcx9pK1e9nujH8s+ulhBolGYXsRk+wSsbpmENImM0o="'
  },
  json: { name: 'first device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'first device',
    type: 'mobile',
    id: '1d30775123ce82eadd58cadccb61a3ec',
    createdAt: 1705108736265,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="05ffd639a20376d47613b5ab334f08db1cbfad791105a5a9d46b2db4dff270be", ts="1705108736", nonce="KB8Tdr", mac="QsvK2MG8nLjMuueAgn2t6Gy9I3iPfF4qH7McMsTwUeU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '1d30775123ce82eadd58cadccb61a3ec',
      isCurrentDevice: false,
      lastAccessTime: 1705108736214,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="05ffd639a20376d47613b5ab334f08db1cbfad791105a5a9d46b2db4dff270be", ts="1705108736", nonce="nG-0sW", hash="wBqB55pfMdCq/zOFQzKDwuzxB7Mgim89Lpd+kzRXRKY=", mac="Z4IdbnEnnR3gn4ryz8Wqc/eVUWv9JY1Gb2OAZKXb4ww="'
  },
  json: { name: 'second device', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'second device',
    type: 'desktop',
    id: '5d9014ffcd6f10488fbcd9a8352535a6',
    createdAt: 1705108736288,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="05ffd639a20376d47613b5ab334f08db1cbfad791105a5a9d46b2db4dff270be", ts="1705108736", nonce="vYi2ZF", mac="+ByfzWTH4lu6x/ykTZnfLQrPNZGbATZzZ/2mlVhHv6U="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '1d30775123ce82eadd58cadccb61a3ec',
      isCurrentDevice: false,
      lastAccessTime: 1705108736214,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      id: '5d9014ffcd6f10488fbcd9a8352535a6',
      isCurrentDevice: true,
      lastAccessTime: 1705108736300,
      location: {},
      name: 'second device',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="05ffd639a20376d47613b5ab334f08db1cbfad791105a5a9d46b2db4dff270be", ts="1705108736", nonce="m7uCyH", hash="MLUgeDJqt6SDSWV0fr+LzFzSZao5NpjgNd+wed90EkQ=", mac="XdFCFfBNocRfD8LLl4FKSMtKB3IHavcxl93E4Dzzx+g="'
  },
  json: { id: '1d30775123ce82eadd58cadccb61a3ec' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="05ffd639a20376d47613b5ab334f08db1cbfad791105a5a9d46b2db4dff270be", ts="1705108736", nonce="DGLVWd", hash="esrjw03dHPY9gEkwBtJNJW6rFHLfhO7FnimMYY3wfGw=", mac="Bt2f3NcO/r6KF+ttL20BBxnFIU2BKRPQXQr9ARL2+dQ="'
  },
  json: { id: '5d9014ffcd6f10488fbcd9a8352535a6' }
}
!!! response success { body: {} }
!!! response success { body: {} }
    ✔ device registration from a different session (471ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '13a94138527053f8fe83@restmail.net',
    authPW: 'f1d2d58957706f9f3ab69957fbb2de40d1c157a92654405c13ddd02806cef531',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5c961a5502ee47c09f375ccd9f1db280',
    sessionToken: '4c52ebe2bcf86b393232795e72ac518ba4c1cc7162f89d2f3b8a18aa5341221d',
    authAt: 1705108736
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bbd29ce3df41edbb158429a5114b5077e52be883a04b93949a01ceeb4b491c28", ts="1705108737", nonce="X5KPjL", hash="hRuKiNS0SZ+7AUskzdduXem6y51eGxuJ32fQrXGd8b4=", mac="tHedbCkBbrRNQCWRMLvgL5RQn+m4SSf7SINe07WsXjE="'
  },
  json: {
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'A8DTHe0wjJb7ThzZmPplYA'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'A8DTHe0wjJb7ThzZmPplYA',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'desktop',
    id: 'c0fc67e34a51eb934d2d7f0bc5787f30',
    createdAt: 1705108736520,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bbd29ce3df41edbb158429a5114b5077e52be883a04b93949a01ceeb4b491c28", ts="1705108737", nonce="5GrDPL", mac="4mUnM7/B1I8L/AsJ4vDy8PNXwjlONJPh+wOQQpjIVFA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'c0fc67e34a51eb934d2d7f0bc5787f30',
      isCurrentDevice: true,
      lastAccessTime: 1705108736534,
      location: {},
      name: 'test device',
      type: 'desktop',
      pushCallback: 'https://updates.push.services.mozilla.com/qux',
      pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
      pushAuthKey: 'A8DTHe0wjJb7ThzZmPplYA',
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bbd29ce3df41edbb158429a5114b5077e52be883a04b93949a01ceeb4b491c28", ts="1705108737", nonce="kIhJ5M", hash="haCDGTLTKrSCU6kX6HDDpJGcNByX7euw7mHLbEKt0So=", mac="pM5vq/bF0sRsPUIPse5v3OQwxL6+2I5vhoos5YCWYDc="'
  },
  json: {
    id: 'c0fc67e34a51eb934d2d7f0bc5787f30',
    pushCallback: 'https://updates.push.services.mozilla.com/foo'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ ensures all device push fields appear together (225ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5f9e1b46ddbdbf50c182@restmail.net',
    authPW: '8a37cf4fc0a0694fca5c944fab8565de64791c10d282c046943c6f64969a88c4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0c641c37d94e4a48b58fc0d409442717',
    sessionToken: '4fc455667abe0fe140ec8cc507b830b7936c1816b34123a620ae0f094136d9e4',
    authAt: 1705108736
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0c641c37d94e4a48b58fc0d409442717',
    code: '64b155adba746d01c25ead3d92229923',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b5389a8db78be8ab42857d0b6f669ca997aeef8216fc4956069db59c2f6d59bf", ts="1705108737", nonce="JFx3hH", hash="ptGwJhVVAGSqlETHu3gstLgLSgfkIQYBKVazfrKZyGo=", mac="H6tmhtikGC1IcGU7LuGKMIGPw3ovqJESPCXckUTaK/M="'
  },
  json: {
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA',
    pushAuthKey: 'XXhmkCPnZflEFEmlyZGPrA'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: 'invalid pushPublicKey'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b5389a8db78be8ab42857d0b6f669ca997aeef8216fc4956069db59c2f6d59bf", ts="1705108737", nonce="XP2G3W", hash="JAXdCKsdbuISg9Ni8m2KGTRfMuiX9HniedWY/4/uRFk=", mac="Zz/7cnt7SZm1GfT7BPkgJka5PIBUGys09k3s2VQvc2A="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 300000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMGM2NDFjMzdkOTRlNGE0OGI1OGZjMGQ0MDk0NDI3MTdAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzI2Nzc3LCJleHAiOjE3MDUxMDkwMzY3NzcsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzM2Njc5LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODczNiwiZnhhLXZlcmlmaWVkRW1haWwiOiI1ZjllMWI0NmRkYmRiZjUwYzE4MkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIwMTgyZTcyMTEzZWU4YWQwOTkzYzNmZDBiMDJiZmM1NyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzM2NzU0LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODczNjY3OSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.b9uwuyAAbfBqN-pGnpmiu4O4orHzzuVE4iLh-_CDIrP6WKNKZxpKH5Bzr1Fw9_VW9eCo8rHiJyYaDs7qNff0ac6DBjBtB_8oh9kZ4zG6szu8jXevnKZx_NDB-C3L02UMAzkJNC65aB3cwzG-aOvx4dnuhzsZdE0xELDF56xq_EPO_w_LB7SA5grEkZniCy64uku54jCkHaLzvKW9xpTsIgN4YoyRypM0Lp5OHOoVHpjD2g3VWsohnpFgKdvH5OuinIKRofRh7rQHcy7ItzQWjOoFcqbjFVFb0QpkcrmF9-a4TKFWEKR-glvsRC8e7yrxg32MqegWJBuJbehNTPsoPA'
  }
}
    ✔ invalid public keys are cleanly rejected (234ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb770ece7792951ef06e@restmail.net',
    authPW: 'deacdd9507c733fd4c07cc3cb7b239180be08635d3be0124fded7c6ca093bafb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '93cdc693306345e8a2a10412341ad898',
    sessionToken: 'e20bedd4293fb090f935bd7b85c625a742b80fc3df8a5bd13ae15c8ce4f0d542',
    authAt: 1705108736
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '93cdc693306345e8a2a10412341ad898',
    code: '0d5b644125171f47d1f2d8d0a40fd2ce',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign?service=sync',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0195ef8f5d6748d85e032b125dee12726163239683cf9d8a08d63ff4cbc0071a", ts="1705108737", nonce="KplfOk", hash="JAXdCKsdbuISg9Ni8m2KGTRfMuiX9HniedWY/4/uRFk=", mac="eZIg8K+5vVfZC3/aTGMerzHBYPC666i/BGI22fZRLic="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 300000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiOTNjZGM2OTMzMDYzNDVlOGEyYTEwNDEyMzQxYWQ4OThAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzI2OTk0LCJleHAiOjE3MDUxMDkwMzY5OTQsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzM2OTEwLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODczNiwiZnhhLXZlcmlmaWVkRW1haWwiOiJiYjc3MGVjZTc3OTI5NTFlZjA2ZUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJjYTc3NjZiMGYyYjY2ODVjMWRlN2Y0OTk0YzUzMzBjZiIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzM2OTgwLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODczNjkxMCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.oWRIe_S6ldQUHORlHy03ritzKGB08kNYUaUGxsnE9LhuEsbxtzyB7iBkdk-rCKb1f2FrxooamBE0aimE8hyPnQYFaS4RNSXe3UY1z84fy-8UHqReh6TvKc_cLDZEr2DehzKKhhrFq4sJhBmChSRGedfIXcSCQop2L2p2LHmaiHn3P4mmu-0ovT4w413cZxjT3xPmR6lBdqE4Pkw64Xf-Yyd1o2U-HdrvYpEE7CXFP0mQWlZJhfmyZn8L3tDQkpPDmRTQn0UsX1Y43inhC-jUU6NSOfJ9AQVCMN5a6d4usylfnZD9WScVeo08kFBK4JzyCqO3IMxSSqcp_5iZZKl2kQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0195ef8f5d6748d85e032b125dee12726163239683cf9d8a08d63ff4cbc0071a", ts="1705108737", nonce="8cZDE6", mac="ypJR1zUU6MsWr9axvhGT0pUK7KIHHAqIWR8ukKWRNUs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'ca7766b0f2b6685c1de7f4994c5330cf',
      isCurrentDevice: true,
      lastAccessTime: 1705108737000,
      location: {},
      name: '',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0195ef8f5d6748d85e032b125dee12726163239683cf9d8a08d63ff4cbc0071a", ts="1705108737", nonce="QEaalD", hash="gmKiCvOHTRrBTIDmnmmjpcPrEk9iuMb4S4+2AN/byZU=", mac="IIqXDgI1cVJkL/rm2OQaCX+B3Id5u3HWS1AhX/j7UvY="'
  },
  json: { name: 'test device', id: 'ca7766b0f2b6685c1de7f4994c5330cf' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    id: 'ca7766b0f2b6685c1de7f4994c5330cf',
    type: 'desktop',
    availableCommands: {}
  }
}
    ✔ device updates can correctly handle upgrades from placeholder record (235ms)

  #integration - remote device V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1ae58a505acccc316f91@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1ae58a505acccc316f91@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1ae58a505acccc316f91@restmail.net',
    authPW: '1cec5665281c4735afb190cecfce6b01651f6dc154be6955b047b27baa2dd5c0',
    authPW2: 'bb009b871ba5fd977d170ff62d94912044194b3be52a177fc886a38610664558',
    wrapKb: '92e0e0dc42d4e3392e404ab526dfa9855c03972cd95751f6e3bb28236bdb6399',
    wrapKb2: '5f0d058eb0bd066eb33c4963d55d152c25c395a31d481288792690418709c72d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:448402e938fd0828bacdbc24fd2b535d58e44d6ba5862b99c22623688850bc38',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6f36f2606a824897962acfb42de64d0e',
    sessionToken: 'a1e87e26ed25589e6e20268a5f007319e0e0dc2f929991af5827a77f510204d7',
    authAt: 1705108737
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="46c0940547748ce3546486f45d395d14854c1925e1ae939687f4714d557670ba", ts="1705108738", nonce="uPptpc", mac="dd6D8TA5H9BxasRISfmiEr8mWO6YQgsPBPdD67U4Sqw="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="46c0940547748ce3546486f45d395d14854c1925e1ae939687f4714d557670ba", ts="1705108738", nonce="xb1pFq", hash="wxzKdMAcaKYdXw0QiP5d98+l64w6074wk7P0Cbj8iwo=", mac="bLThIN0w6+xQZFUELO4wU4mS7IoqCbnBqYbGn9SG42w="'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: '7f66dd6c82474d8ff8700021bcf51d7c',
    createdAt: 1705108737550
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="46c0940547748ce3546486f45d395d14854c1925e1ae939687f4714d557670ba", ts="1705108738", nonce="aPn-q9", mac="OnFjHHdvwfoYAbX0akcyruE9zCtSvfRBfAxePUCc4iA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '7f66dd6c82474d8ff8700021bcf51d7c',
      isCurrentDevice: true,
      lastAccessTime: 1705108737567,
      location: {},
      name: 'test device 🍓🔥在𝌆',
      type: 'mobile',
      pushCallback: '',
      pushPublicKey: '',
      pushAuthKey: '',
      pushEndpointExpired: false,
      availableCommands: [Object],
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="46c0940547748ce3546486f45d395d14854c1925e1ae939687f4714d557670ba", ts="1705108738", nonce="5O41Vp", hash="l8Lv07cBcyKn7uKIFZ1kx4/QFhsRixMH4gfP913bL2Q=", mac="X7VZq6rGn0kS+Atu7SmTNU9icA6kZoLocD76/NMSyO0="'
  },
  json: { id: '7f66dd6c82474d8ff8700021bcf51d7c' }
}
!!! response success { body: {} }
    ✔ device registration after account creation (514ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e6f92e519c16740c9d49@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e6f92e519c16740c9d49@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e6f92e519c16740c9d49@restmail.net',
    authPW: '2cc9bc1e0e0131d0ed72774d20ee20e36d7acb835c9f11e1f442ccc7b3434ed4',
    authPW2: '66652f5d5fa112e0450f53c75b7a3bed0660e7741cc284ecf33f7d010d8030cf',
    wrapKb: '1b456a561a0586f2babe0c19e58d8477c6fbda9cf04d054d37b43d40e3e77c06',
    wrapKb2: 'be00fc533892b87039563b1dee1f4d98b73f603808e69212bec9bb88ded38981',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8a05995821d8bb3f5316bb480a738a71166bbd64c7a08fb3b7b715b115507485',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b1063e834a514db38f8b98334f72733c',
    sessionToken: '19652fd3e18312c87c03b8a5c2cdc039aee7d98b44534b3c3c3389c2fb63982b',
    authAt: 1705108737
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="984877fe54b56523768234783985971e6d1e667b2baee39120d750baa6a03f58", ts="1705108738", nonce="aIYgSD", mac="2wiAy+FNLUyTIQo/Yk8oDj3/vIYUMDS67vHB6AkVvLg="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="984877fe54b56523768234783985971e6d1e667b2baee39120d750baa6a03f58", ts="1705108738", nonce="oVFI9x", hash="r6VL6KQdfNJbr17H/DeddzCOch7D7EYxf9WwvdizdoE=", mac="jemQdF8ipHuXQmML5mAoyq6yDixuEJ+wczL94DjNnZo="'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '9d8bf7b4bb812c5e68684665f229cc7f',
    createdAt: 1705108738047,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="984877fe54b56523768234783985971e6d1e667b2baee39120d750baa6a03f58", ts="1705108738", nonce="8gPVgr", mac="r6xWzM0ii1QbgAxqOQZJt/cVv9a8NLTNWEl9aSdxalQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '9d8bf7b4bb812c5e68684665f229cc7f',
      isCurrentDevice: true,
      lastAccessTime: 1705108738059,
      location: {},
      name: 'test device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="984877fe54b56523768234783985971e6d1e667b2baee39120d750baa6a03f58", ts="1705108738", nonce="krufRR", hash="1C48kbHbw3aPvQzXwiY1ABeSbS0UprmyQWtlLMbJ2lw=", mac="tfpv0H8EGc1ZiUFtC5ECrTCj7VxVshK+k6gudisJ9s0="'
  },
  json: { id: '9d8bf7b4bb812c5e68684665f229cc7f' }
}
!!! response success { body: {} }
    ✔ device registration without optional parameters (493ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '076575b99f10c72e6984@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '076575b99f10c72e6984@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '076575b99f10c72e6984@restmail.net',
    authPW: 'c49a0ceb80e071470577310d9f620a3a45589b9270ffa04ae1444d59931e9974',
    authPW2: '5223f825cd9a226d42634109e4b4c6762e97a0880c6785d83b5b8f886f8137f4',
    wrapKb: '3b9502c2016814716db76a6bfc760b9870e12cd7de4a50e5272f392e0b17a175',
    wrapKb2: 'a2912c38728ee0fc439e9f9d310218e16ab922c2afa36f2446bab22405a16c54',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:43212571a6ad1ed8403fc3abcc4fa5fd615705d813c3616f180831edc906f04f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f42fb3bf0acf4156885f387ff1b5fb8a',
    sessionToken: 'ce729e677da6c4ac3e695cf11379ff54e2ee6caa9a7ef30970f09f34a3ed419b',
    authAt: 1705108738
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bc8c10cd1669195dd58d0367d24417090353c8cfe69208e7260209322f59c964", ts="1705108739", nonce="vrAVQq", hash="FxQ3RxQcFHaRkYsA3XQatPjGuxPjo1GtdBiW/UB0FNg=", mac="lg1gJ00g5GxHGGNRwiaGfb9sGKPEd9W4YFGmzGID7nw="'
  },
  json: { name: 'Firefox 在 β test�', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'Firefox 在 β test�',
    type: 'desktop',
    id: 'bf09b9449d8729bb477eb91e8dec149d',
    createdAt: 1705108738544,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bc8c10cd1669195dd58d0367d24417090353c8cfe69208e7260209322f59c964", ts="1705108739", nonce="fUn-X4", mac="sarSQTk5bRjcnJq1pciY0KviwETg5DLchOALqB+mXOA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'bf09b9449d8729bb477eb91e8dec149d',
      isCurrentDevice: true,
      lastAccessTime: 1705108738555,
      location: {},
      name: 'Firefox 在 β test�',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ device registration with unicode characters in the name (480ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8c09e7a477506e39f950@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8c09e7a477506e39f950@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8c09e7a477506e39f950@restmail.net',
    authPW: '572e30ede8706cf17b0370aa4c9ce1ac87c5dd2ef1a43c1377570bdf5b895169',
    authPW2: 'f1005ecae12c0c0dc3e06d6b82315d2415009e72daa36a98f1807bb838c40b25',
    wrapKb: 'b2bbae479c3b3e8f8f03e9b3822ff0e8e551728d2067ea1fcd1dc6a2fc3a5246',
    wrapKb2: '67d101fd680bf309631dbd5f7324849a662a9bf86a8b4095ebaff91d6cd57c11',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b484aad0c2af8853ede3b644931c4493fa7fdea934932c58287af8acb7f2151e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6580eca8b3824edbb184c6a7b35f64fb',
    sessionToken: '2fbd26bc8b2ef74b9226667ff1f5cdaff1c753f21a6414427e273c0a1042dff2',
    authAt: 1705108738
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0283c5cfea9e0c91547cec88c307baf25efb70ffcca7bb5ce32eb98014b91ce9", ts="1705108739", nonce="ynAEAp", hash="ZPtQWgx70aZ+yDFnBvdqQYyBuyy5242Md7z1GY5eviI=", mac="uYXICoT9I4Z+d4A1GtLE1XIyFg2fcv0msrBW+hMAGMY="'
  },
  json: { type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    type: 'mobile',
    name: '',
    id: '172af914f866f6f5cf40d4c12f7a977c',
    createdAt: 1705108739019,
    availableCommands: {}
  }
}
    ✔ device registration without required name parameter (471ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '32fac04ab2288f1d2427@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '32fac04ab2288f1d2427@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '32fac04ab2288f1d2427@restmail.net',
    authPW: '9c04bc186d40c379e6ae3eb8a1a2ca823f746478409fc8fc5398b4175b8b7f3c',
    authPW2: '3610334323dcc163e114f87ef1be947e527acdadc655598ca4af5ee336c96a23',
    wrapKb: '07b06a6fec67dd3bfae855f5e1292b64dd6b03c7e1b5471841e5e5c67c1a84e5',
    wrapKb2: '2205e31585cfe83819a02b4edd35a08302f90435ba5a6f1d599038b8cb5d1920',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f7b4fca7f7b12adaf413586a9f4e165ebc3b94d3556445431ecf0f07df85dfff',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '57438e33eddb450ea979d9f569582f26',
    sessionToken: 'cd641012e103b35cff513fdd48cfbf29f3fc23432324da05886964d5a53f6e16',
    authAt: 1705108739
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="398c6a9f24475bbddfc998d3609f5194884e07241884ba5f62fabc67c67eb73c", ts="1705108739", nonce="peZZkH", hash="ArFnR4haj6CJJ0RxA6bTP607eJAKprz8+vi61OlPDVQ=", mac="MZJth37c4x5869SMt95yPVRkoUDDO1zCBYEv4uzIvkg="'
  },
  json: { name: 'test device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    id: '5bbfe599a8be10cc7f197422ddfcf909',
    createdAt: 1705108739500,
    type: 'desktop',
    availableCommands: {}
  }
}
    ✔ device registration without required type parameter (480ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '914dc4a3b0cecc0ad136@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '914dc4a3b0cecc0ad136@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '914dc4a3b0cecc0ad136@restmail.net',
    authPW: 'c260f4f3669d02e6430c8ac681252044885475246e26997f658e4e5bc3b95cc3',
    authPW2: '302ff8cf3aafd93797d76dff4cfe89bc261eab55ed99028f6fe4d164b39585fa',
    wrapKb: '88e6c58d6d7b3e54638156442665cf9c4ff2c83e9e6848f57d1494c8334602c4',
    wrapKb2: 'a0938ae54db03b82bc0123b0ff77fb71600c88ec98e76d32155fa89f9054647d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8c57b17ab497ff509e0e85e1cd241469980369015081a125d921c6c6b7a3ea18',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3105a769887c4d28a4342d602405bb15',
    sessionToken: '223d710961a553f418d0dd2ecc3fd73f55aeedd4811a073f41bde47df307bfff',
    authAt: 1705108739
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0451c8c16a207281c65da77f5d2c83a7d13550af86755c6ef7bd35faa01851fb", ts="1705108740", nonce="TUtN0_", hash="kYjuUmjeRXd/Kf1aiEtmPq2RfcGcop8gIK0fIujDBus=", mac="6NguwJTWKI/aIa4WgooOsZPFHVXwn4DshXOEv97s6k0="'
  },
  json: {
    id: 'ad6280f907065bd0997c1a0608bbbab6',
    name: 'test device',
    type: 'desktop',
    availableCommands: {},
    pushCallback: 'https://updates.push.services.mozilla.com.different-push-server.technology',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'c-h3A49DikRRv8RG6oh3Xw'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with bad callbackUrl (475ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '499dcfae9aec0f79b0b5@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '499dcfae9aec0f79b0b5@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '499dcfae9aec0f79b0b5@restmail.net',
    authPW: '8695cbf4163b4f1693631d4a1d5e33fd9aea6d5a6fa6dc2f44d84a34a2b9673f',
    authPW2: '727d5cd6876107ce895397a427c72cc231aac30633b58faaf2b9c835b6213c22',
    wrapKb: 'bce2e141b90c6b73ec840497e3684a6345fcb7dc26934a945dbdd89e234dc3d8',
    wrapKb2: '6970310e604df786b643be217545cdd9919182ed573db951b1d56a5f742fd44d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5aadc50c2abcc8f3e5aec05b9aa7a6fda46cfb3c0311d9f602432d8ed79df2f8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '980a007d5abc4e51a61d32d3d9326763',
    sessionToken: '2fd7fad1ceba61192de590e8aad7ff5a6d0f28a8a197b8fd1913172b0d6a0928',
    authAt: 1705108740
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bc9d0fe26a992f0a1965f4deabfad4dbea7eaa2c6bb1d9050d0510ba25fae4d9", ts="1705108740", nonce="uw4QY0", hash="305sVtMRZ7q1y2lWOPjuRGa/EJEKCWFvLp9M18j3Ik0=", mac="6GVyN0fXSBpFa/PB3/wHpNLMHP6VES5iKgZJe3S1QU8="'
  },
  json: {
    id: '654ac54a2cf6133106f6c9da2b0f60d7',
    name: 'test device',
    type: 'desktop',
    availableCommands: {},
    pushCallback: 'https://updates.push.services.mozilla.com/invalid/č/char',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'V6nVXb0QJn7lorA1PBGGsg'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with non-normalized callbackUrl (468ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '90952777fa5281db658f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '90952777fa5281db658f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '90952777fa5281db658f@restmail.net',
    authPW: 'c2dbddddf8f8099793f340f1f5686fc802f28a1ff1277c126f7ad1d321d837ad',
    authPW2: 'e8c93a423d96d56b334fe3dab9fb31f7643ff79706902624fce8948e8331d728',
    wrapKb: '5d4477db6b81daaa440f3ee66a05c344c1e58fe892b15a6d64545bcfeb4c667a',
    wrapKb2: '15185913b120f7abc0ed7a62ddfb521c9d159a3e3d4fa23fb429035f60cfb757',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f6461d46066987d9f88e258cf8b3bc179f157972755d2164e33fd87732f1430a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '231e257817e4415cae7483b32583b6de',
    sessionToken: '7a9f8c653529328f8e20780919636ea0618a79529667f4fb5800d6a512478b35',
    authAt: 1705108740
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ea58bb2705314c9c1f64fd6e74fc4ead9212ec4908df63323bb10d6577906db3", ts="1705108741", nonce="ya6JYx", mac="0At47l5g9N5EKU++mvpDs7Ea/Uwhn9llhB8qtBaRDis="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ea58bb2705314c9c1f64fd6e74fc4ead9212ec4908df63323bb10d6577906db3", ts="1705108741", nonce="JA48U6", hash="u5ZtreVTVnax43XlddjAPOAM+uxM4reeTm3WrLldZ7o=", mac="98W4GV4KgL8RvyxKA+QZsF4aZUwIraS41cKsQlC46YI="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    availableCommands: {},
    pushCallback: 'https://updates-autopush.stage.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'NpISezNh28Nxr4-3mBph_w'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates-autopush.stage.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'NpISezNh28Nxr4-3mBph_w',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    availableCommands: {},
    id: 'db330dea650c7a7504070b0c1003d60a',
    createdAt: 1705108740931
  }
}
    ✔ update device works with stage servers (485ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '879ef15a1a168aa7f569@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '879ef15a1a168aa7f569@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '879ef15a1a168aa7f569@restmail.net',
    authPW: '29eb3dd7e57d3fcbb2b2f495ac1155ebeb56d728713af0bd09c8207e3396e984',
    authPW2: '5586aab05d47d0cc1434854a8129c0503190b5cf4e7992bf68577367efdc295a',
    wrapKb: '1597e0ecd51142363b4f4cea5de43ee3a9cdd58a0d8097f9c26ffe7ab1c54e97',
    wrapKb2: '7da7df377607e8c087b8b9cb1b363733b03c4977a25b4f150b37688c3e4c28e0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cdd303dfd20f83f2439ef3f823c88c4c8ac49b4bc3f68ab3292d5f7e00bcf27c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c9e523d270a549579abd58f56677d36a',
    sessionToken: 'f59e376bffa6b82ee2b8214c3c739a6672ac5d293b74e24e20a354ca024f691b',
    authAt: 1705108741
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c037781e1725b6c1509bab259d52f54bd572bda45faa269bd66c610908842159", ts="1705108741", nonce="P6MITh", mac="mlI2Fj72Gu3AQ2jJwCWGQBRSV8PLABKoipV1vgFiz7Y="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c037781e1725b6c1509bab259d52f54bd572bda45faa269bd66c610908842159", ts="1705108741", nonce="PS88Pw", hash="Y0dQL8aW2DzWQqvaQ1iJZmGv704I0p/wiFx1pCJhUOw=", mac="K9WFjOgL1t0PGxffGwhV9YzkQQrsJBD5qtWwQTZ3RuU="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates-autopush.dev.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'bJJTcI2jS8d23yPILItTbw'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates-autopush.dev.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'bJJTcI2jS8d23yPILItTbw',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '92560755033d559b3983df29e4fec31e',
    createdAt: 1705108741402,
    availableCommands: {}
  }
}
    ✔ update device works with dev servers (470ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd5bf390bbe5ffe64ea29@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd5bf390bbe5ffe64ea29@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd5bf390bbe5ffe64ea29@restmail.net',
    authPW: 'dbee57504fccf88ab39b7be97a4cd8fb92f65299009fffd059ed2f1ae0e6c0d2',
    authPW2: 'df35bc75a825f27e6c61cc1157ae84c78c2d70c3b214ca59fae9b322ec38c879',
    wrapKb: '343465d97ec48908cfec19e917d57d33c309fa105fb315c59485547ebca8c5a2',
    wrapKb2: '4f9790dd7bd2ba6db507311e459446fc7d7e57d2b1c79d68b4747804df84101a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c9cf664e4d9d57beaf5b9e3bf1569275bec5c11571a6053bf2c47abe84de7568',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c7eea33a21ac41cea0b02662033de7eb',
    sessionToken: 'bc3ce5a671e52de75f975343de538530da3b907107c47d040de8dc9149f263fa',
    authAt: 1705108741
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="544932200cd565420574e1cab812c24c4586fc013cf1aa5b7742f40a4b4576d9", ts="1705108742", nonce="bOIDAX", mac="jRBR2F66yYSm0F1b3OLj+69pj49p94KSeOOQ6TCZoUg="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="544932200cd565420574e1cab812c24c4586fc013cf1aa5b7742f40a4b4576d9", ts="1705108742", nonce="UDZIB8", hash="M7yZMdUQcGb89OpewsNIMmYtlgv4/3yjXhVYQJhf8vs=", mac="Uf1kqk1MVJEmwoggHDtmRrOgoKoXdgCKsM3J2aEhQ0o="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:443/wpush/v1/gAAAAABbkq0Eafe6IANS4OV3pmoQ5Z8AhqFSGKtozz5FIvu0CfrTGmcv07CYziPaysTv_9dgisB0yr3UjEIlGEyoprRFX1WU5VA4nG-9tofPdA3FYREPf6xh3JL1qBhTa9mEFS2dSn--',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'RVd3jPYZgBfqZBGiDiv0dA'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:443/wpush/v1/gAAAAABbkq0Eafe6IANS4OV3pmoQ5Z8AhqFSGKtozz5FIvu0CfrTGmcv07CYziPaysTv_9dgisB0yr3UjEIlGEyoprRFX1WU5VA4nG-9tofPdA3FYREPf6xh3JL1qBhTa9mEFS2dSn--',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'RVd3jPYZgBfqZBGiDiv0dA',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: 'fbded6b78660e8edf1ef903720b9d6f0',
    createdAt: 1705108741883,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that :443 as a port (481ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '94a951042a6c797a06ca@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '94a951042a6c797a06ca@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '94a951042a6c797a06ca@restmail.net',
    authPW: '9825c95d05e3edcfb4b41eda4cc9419abdb6d0d8d3edca3f2489329acd7b86e3',
    authPW2: '87966caeada489259caaf19f089899e800a7fe0423674e6f9c6d2797d6087b3e',
    wrapKb: '90b54104182f3a9c401c1b472bc923a7cec0b71502a0e1c4e37a03045f9529d6',
    wrapKb2: '6e970643f9b458d8c3e05f45b05e8f56200b36bbdb01128c517089def81bcb60',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:525fa527137a3ab038a49d33628676e647913271fb12328d9e3709310abf4cc3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '84f91990003a4c7090b7de2691385378',
    sessionToken: '2f0ec622079a100e4b7da2a2996dd132926de442fe2b40b9df0846b477d4d095',
    authAt: 1705108742
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="876a2d65d4bf09a5c7c4790d378280958e99d3b4864a06e3b2f7f3992e4b1485", ts="1705108742", nonce="YI25Su", mac="zlBtyqZ5p8IttOouEhbmzxD1jgmQcAf7JsSvTiBkpgs="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="876a2d65d4bf09a5c7c4790d378280958e99d3b4864a06e3b2f7f3992e4b1485", ts="1705108742", nonce="w5LvH4", hash="9WTYSURHBo79hYcLlUi4EKCXtCYT5fcXsLNX60trWXc=", mac="4fRgxsQZA2jVhIlgYM7orFw73UhOR2B3sWpR/C8DtQw="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:4430',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'epsFNEoYShYOZehufA6Mvw'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:4430',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'epsFNEoYShYOZehufA6Mvw',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: 'dbc6a1d4a468be477d404c855d097700',
    createdAt: 1705108742338,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that :4430 as a port (454ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '59914420be24bb57091d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '59914420be24bb57091d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '59914420be24bb57091d@restmail.net',
    authPW: '2964e29e1969b2bf193b73829fdf07b9ffb83345b4228b507b0103df8c72a2dc',
    authPW2: 'bd92c91efaa0717899c24930ec9211fe443594d0e7969f0c896d1297ded202be',
    wrapKb: '267d3d71b66121c200f3dd546bd4007e1995ca43557e576629566a72642a4d79',
    wrapKb2: '675827fe7f6b16f742516a01a530d1febffc3e085a4ad4263e9e3b8b307e921c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ecb95cd806be5e48290859c4e905def616687f24fabd973390aafadfb26783b7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '08cc4dd4698d4e82b03fc63407dd0fc4',
    sessionToken: '7a70a84eabd3b5b1b0b60ed07a6fb8e3ad26af8e90052ea7951902aae9e2c6db',
    authAt: 1705108742
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="be0bf5b41b4ee487d5d7f83625b86f713b0373ec7306082ea375e0d0f772bbde", ts="1705108743", nonce="jQJfRT", mac="E3jNr3avtKLerDW9UiR2zUCLihkJCYx+yoqjIyt1V64="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="be0bf5b41b4ee487d5d7f83625b86f713b0373ec7306082ea375e0d0f772bbde", ts="1705108743", nonce="D_ov0R", hash="JxoBz1MkHAMOYcz03S0kkTP3PpOuS3Gpiiu8j/q7v/M=", mac="KOay4hINlTZiqtd13MInZqTYOYSoOSKm8iOJfpMHd2k="'
  },
  json: {
    name: 'test device',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com:10332',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'psnoh32ApYIeBg6qABGLJA'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com:10332',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'psnoh32ApYIeBg6qABGLJA',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '2b53b2979311131cbdd316343ff05828',
    createdAt: 1705108742807,
    availableCommands: {}
  }
}
    ✔ update device works with callback urls that a custom port (470ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ae9f2bed6b8e98597e92@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ae9f2bed6b8e98597e92@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ae9f2bed6b8e98597e92@restmail.net',
    authPW: 'e21793899b56f64a6857e30b30102bc26b7a425c4d30a583d6485936cef71364',
    authPW2: '441807bfdf887bc629abba5ce3529a7f94c924f1901b0eb5675475f81731338c',
    wrapKb: 'fd43853a4207cc41d163668f5e0401c4c06bcd7ab68cba76113f06cabebb1a91',
    wrapKb2: '9015c1397ea3aa1f669677939e1be636377a42139003d4630a7df20b33c1bf4b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5cb648b1129524404c1678f742ef5269cedb6e45dae8b0a457cd0d2be5664d19',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '96bb5c56ed0346438c64179d72aa2608',
    sessionToken: 'ac1db86fee30ffd29608ccff94a4f0bf6f1382bf5473d49f4eb24f545efb1e7e',
    authAt: 1705108743
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="262dc0d60dd430b03d830e608aa7b492ab9119759978b83977208c981e807e0e", ts="1705108743", nonce="3hbGSX", hash="ci9j0/9HVvywlEk0azvbOnktfyhoxwpMWY1z5V4hgvA=", mac="SI7SinEkoqy0vG99Myak5pr67DSRLQlNPsD8vdSri0M="'
  },
  json: {
    id: 'c628eb61ba0166866f58098b2ba5d7b9',
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://evil.mozaws.net',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: '4pDkJrNoLCejgHb0aVpXMA'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ update device fails with bad dev callbackUrl (467ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5ce30b6da77ce53f91f8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5ce30b6da77ce53f91f8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ce30b6da77ce53f91f8@restmail.net',
    authPW: '1b4bcfd4db7d66a8b1ffc7f58ca43d70012d71d5ac05b8002ac6a1e79679e4e2',
    authPW2: 'dde7b5d5a7df15106f7860b4cee9193fffc777c45f3c239b8fffca51489e676e',
    wrapKb: 'b7aeb31f5d6e8fce8c764e928ef33ee2642b910652be86ead9f71306bab37a3c',
    wrapKb2: '7728d655832a4db7c327ea0c3eb027a4610d2b3261f7cfc042daa7854a8f0003',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:45e92d5ce25f76728ff60d672ccd58cab76e6719c032abb938fbd5e0a95374a0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'afc363327a4f4c8589089dd5fe5fb223',
    sessionToken: 'bc6f0a3c7e4167c7bf2a379db5a27a27dc472f26b11cce7dba021df1efbf5352',
    authAt: 1705108743
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9c81b1dd930038ba3ecab8098b1ac3ee2936c09921c35649b24878fd7efed1dc", ts="1705108744", nonce="gGySpp", hash="vL70FKAavoL7f2avbeBZgRKNIGK59Mgfn8HeVEwv8hs=", mac="uKVEWkvLsnoi8zrqDOy7nNmBWq1mPaDL8Ve8boyxOvA="'
  },
  json: { name: 'a very capable device', type: 'desktop', capabilities: [] }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'a very capable device',
    type: 'desktop',
    id: '7f8053056d06a2f126f0cc53318bf749',
    createdAt: 1705108743737,
    availableCommands: {}
  }
}
    ✔ device registration ignores deprecated "capabilities" field (462ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5587f8ea7b864c57fdae@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5587f8ea7b864c57fdae@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5587f8ea7b864c57fdae@restmail.net',
    authPW: 'a77185c64c21e75d3fdbfdfe18d8ba15c0249e0096c62489351ea9e6d2a3737a',
    authPW2: '610726b68e291ed1e90aea2829136097fdd8afce4db59cf15b3a3e07602dafe2',
    wrapKb: '43ed382678c6590f7a2ceac0e77cd9a11eee5be182ec428b6d7d9b1c1e3d5653',
    wrapKb2: '0a7912367c7ec66ea9d9ab59939fd92803544f26a6649dd1c35939a9952a4d58',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a1c84decd4b3cf75f10fe7f84fc7e3cec8fc0dcc100d1ee4c4b1967bd847ae51',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b522667d6e9c415d9c96484d69fb9b02',
    sessionToken: 'e732c088c7c3de9113de3b2b9fa7c2cde9fe6ed07af804f0306d4bec1e4a6a6e',
    authAt: 1705108744
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b522667d6e9c415d9c96484d69fb9b02',
    code: 'a6471f3b61740dadfaa35d51943bc7c2',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5587f8ea7b864c57fdae@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a1c84decd4b3cf75f10fe7f84fc7e3cec8fc0dcc100d1ee4c4b1967bd847ae51',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a1c84decd4b3cf75f10fe7f84fc7e3cec8fc0dcc100d1ee4c4b1967bd847ae51',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a1c84decd4b3cf75f10fe7f84fc7e3cec8fc0dcc100d1ee4c4b1967bd847ae51',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '5587f8ea7b864c57fdae@restmail.net',
    authPW: '610726b68e291ed1e90aea2829136097fdd8afce4db59cf15b3a3e07602dafe2',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b522667d6e9c415d9c96484d69fb9b02',
    sessionToken: 'ad595700869b2d31bf8e7e2ff6bd9bd44081e6e9e2831dae2d02e450f0e0e9cb',
    authAt: 1705108744,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bdd1c3e9b54080f347f5332375d2b75429ed797407132e55ad8a867cf282fedb", ts="1705108745", nonce="jYPWHz", hash="XaZfhofC+yN+7jz5XiOPZ87mGKF8wbBGR3pj1sdmlMA=", mac="VS2pwtlb3NWZb0mhnXqwwWolqpOvcCwRONIbxU9RYs4="'
  },
  json: { name: 'first device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'first device',
    type: 'mobile',
    id: 'e2e9f20e81a272ab96f253e9fe743cd7',
    createdAt: 1705108744596,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="69b88edff8f3480a76cd711c65531e47877a93ba2cd63724e1b5062cfa7493f5", ts="1705108744", nonce="h3Xtp8", mac="fKYafbqtY0nPLgsGVuLf3gJIW/xLZ7KdtrMXD2i1zBk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'e2e9f20e81a272ab96f253e9fe743cd7',
      isCurrentDevice: false,
      lastAccessTime: 1705108744542,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="69b88edff8f3480a76cd711c65531e47877a93ba2cd63724e1b5062cfa7493f5", ts="1705108745", nonce="tqCfaE", hash="wBqB55pfMdCq/zOFQzKDwuzxB7Mgim89Lpd+kzRXRKY=", mac="eEjF1i5mXOcGCUiDZLNa2Sk+MRAIexFJngHYZJXVMMg="'
  },
  json: { name: 'second device', type: 'desktop' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'second device',
    type: 'desktop',
    id: '3468a9f0023c0baadd1984c0e165e8d0',
    createdAt: 1705108744617,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="69b88edff8f3480a76cd711c65531e47877a93ba2cd63724e1b5062cfa7493f5", ts="1705108745", nonce="uAJyOR", mac="o3qXO1dpdqj6AJ7D4qGCxsW+Zll6ofsfr6SF/E6RiuU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '3468a9f0023c0baadd1984c0e165e8d0',
      isCurrentDevice: true,
      lastAccessTime: 1705108744628,
      location: {},
      name: 'second device',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      id: 'e2e9f20e81a272ab96f253e9fe743cd7',
      isCurrentDevice: false,
      lastAccessTime: 1705108744542,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="69b88edff8f3480a76cd711c65531e47877a93ba2cd63724e1b5062cfa7493f5", ts="1705108745", nonce="zvhpTA", hash="8hfSMrXNZDAd8Payx5KzrxNsq2LxUlKG6vo6QzVGrbs=", mac="m/K1u7EYRttS7N4SPCeueiB++CuNXaKRoquBiuaN+vQ="'
  },
  json: { id: 'e2e9f20e81a272ab96f253e9fe743cd7' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="69b88edff8f3480a76cd711c65531e47877a93ba2cd63724e1b5062cfa7493f5", ts="1705108745", nonce="wz_OXB", hash="Hs4XwUGyxtvREspUq0oCK+MpFeestY0rG9VFyJUALK0=", mac="OK6DLtndpptQPZXXGPH/nIGKOx3hnciSfmDabVTIwGo="'
  },
  json: { id: '3468a9f0023c0baadd1984c0e165e8d0' }
}
!!! response success { body: {} }
!!! response success { body: {} }
    ✔ device registration from a different session (905ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '85fbae12ad745ce15e19@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '85fbae12ad745ce15e19@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '85fbae12ad745ce15e19@restmail.net',
    authPW: 'c38d9f11ecf7acb890663bfc1eb5b6705ca954723f586dfe5b321dab03dbbd23',
    authPW2: '4fc0dcb55b46b989b9ce2e570af2495e1455dfc7bc68000d5c965026b3d401e7',
    wrapKb: 'd76f45b579ab22f18c26b8a047a04e00ed352bc8e18337feca097c1d7410e711',
    wrapKb2: 'ed3396ab852d7af598a08f049e0ffa2d6b9dc5ddaa024a3417a4331fe8fe81e9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a3df19ceae09ecdc2a383162ef1c61b0220fe30821d6347706021dfe7130621e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'dbf7f9ef81fc42f1b5c96dd191558bd4',
    sessionToken: 'bc11d5fb8c0df2f748f2690bd97fbd88695a96b772fbf1f5ca3962a06fbedfd7',
    authAt: 1705108745
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d9dc2d6e6d93d9a43c0f62e087dd4051ba76854242adabd0e42bcff0cebc7aa0", ts="1705108745", nonce="pHx15L", hash="onmiKTgooLKB66x/j1Qf2evZpO1PnxIEsMCMFLjRPeI=", mac="Hf4SaUgFpQ++om+NhyYitgBNoCQ1/ddeG/KJ1Id5IrY="'
  },
  json: {
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'NeHj_ZuuAEYCIycD7qU3uQ'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'NeHj_ZuuAEYCIycD7qU3uQ',
    pushEndpointExpired: false,
    name: 'test device',
    type: 'desktop',
    id: 'dd8aae4588b95c2c89740ef26c125093',
    createdAt: 1705108745113,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d9dc2d6e6d93d9a43c0f62e087dd4051ba76854242adabd0e42bcff0cebc7aa0", ts="1705108745", nonce="u0UJu1", mac="zG/n0PLC67GPz/tZieBoTQ/9YFuM9tIzkzd8QfePcTI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'dd8aae4588b95c2c89740ef26c125093',
      isCurrentDevice: true,
      lastAccessTime: 1705108745124,
      location: {},
      name: 'test device',
      type: 'desktop',
      pushCallback: 'https://updates.push.services.mozilla.com/qux',
      pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
      pushAuthKey: 'NeHj_ZuuAEYCIycD7qU3uQ',
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d9dc2d6e6d93d9a43c0f62e087dd4051ba76854242adabd0e42bcff0cebc7aa0", ts="1705108745", nonce="mwyJOI", hash="p3DG6F1FkgI0NNyKDdVCedkN9y1HZF74x2VVWr7bG3I=", mac="4ZKrsfW37WF6cvDk1H9jCfojT+6vme7GjQYOlx4JQrw="'
  },
  json: {
    id: 'dd8aae4588b95c2c89740ef26c125093',
    pushCallback: 'https://updates.push.services.mozilla.com/foo'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ ensures all device push fields appear together (485ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '051c4283bebf1ae13907@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '051c4283bebf1ae13907@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '051c4283bebf1ae13907@restmail.net',
    authPW: '375bbd097eb6aa07854ce1269dc1c55e4757795c2bef2584ba6f4f59ebb6afab',
    authPW2: 'fdd98978e481159befa8f9de56051ff201ee4c48b16ae6d8d2e70e81d878f94f',
    wrapKb: '22143a5f198fd3e89aeeb65595e6ed023ec57e1e0541913346fda96e11843d74',
    wrapKb2: 'bcc5a7d06e443e3c02fc7d3c851aef9278d827332769b5f99ff066c632dc7aa8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bf5f593d648c2f130f83503937999d9248cc4bdb0e25ef21037be25687f4b996',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bc6374c483164aa9b1f2e9abbb507a1c',
    sessionToken: '161afe1a690cba2dbed3e78ac64ca615b698cf663fc7d39565d38ec7d825ce54',
    authAt: 1705108745
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bc6374c483164aa9b1f2e9abbb507a1c',
    code: 'aa454e8e77edbc2b12f35721d56b143d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="10c33aef587148363213e792a53f53b485d06848f8086721ed471dde9516fb9a", ts="1705108746", nonce="7FgVts", hash="i2ybgSJeVpiZxRSWUVu+8K0jqH7vdHz+t02JMQ/X1y8=", mac="Cgiwcmgi2R51MrZ68XR7gYymN/Yb6H+kAsFPj3YGQvM="'
  },
  json: {
    name: 'test device',
    type: 'desktop',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA',
    pushAuthKey: 'F_0M1sNIExPh7YKl9T4khw'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: 'invalid pushPublicKey'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="10c33aef587148363213e792a53f53b485d06848f8086721ed471dde9516fb9a", ts="1705108746", nonce="mYQe36", hash="JAXdCKsdbuISg9Ni8m2KGTRfMuiX9HniedWY/4/uRFk=", mac="MfF2t+BZpEg0n0480yS50KbtXxU3tl3zFxbwXc9Phws="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 300000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiYmM2Mzc0YzQ4MzE2NGFhOWIxZjJlOWFiYmI1MDdhMWNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzM1NjIyLCJleHAiOjE3MDUxMDkwNDU2MjIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzQ1NTI5LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc0NSwiZnhhLXZlcmlmaWVkRW1haWwiOiIwNTFjNDI4M2JlYmYxYWUxMzkwN0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJlMmY0MTJiMTRjNWQxZWZiOTQ1YTY0OTk2M2I5MTc5ZiIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzQ1NjAzLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc0NTUyOSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.bOPuGA7gEDe7h6AK2Hafr96_9PAbH_a2WvqjEGRkCQIcnmL25VBFYqRHM9dzM0bDWo9SLi5DzEdE1phX1daAYArKhodACJY1KJuoqEwZgS5e0O1i6GHgdfxoYeNVbzkqJit1nyTBaZhCOTyU-pCBZb76OzD7AVzGZuds-69ma_pHi0NziBs3xHJvy3dAIgjOH06IF2vXScQlCZ23pSBScCjVppDZZSBZoUGkycFY9G5_FlUffgwx372zPjqhw2Jp7qzhKcvPSEpktEMgUd5JPt_cFNAfnqB-RS2B2ffjhbsZTye_dIYf7RUQ05cnoU22IO8juVWGq0UN5jrQpkxLOA'
  }
}
    ✔ invalid public keys are cleanly rejected (490ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e3329ccaaf84619ad2f3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e3329ccaaf84619ad2f3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e3329ccaaf84619ad2f3@restmail.net',
    authPW: '7ac74a62c05d32f50e25758a963603a6bad7a575faa93029c3c59ddf48b47f2e',
    authPW2: 'bad940536328208691cea36df7df64898f5f97fc36a7d6978bc9f32f0a31b6e1',
    wrapKb: '7086fd39b953558f2cf3d3f9a976d69c7f6141400a6d53023e53f8471b26f2a5',
    wrapKb2: '7535b73e90607002c259706b71f07a11c293e23d2fec43e96f100789e81481fa',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c87039530bd37dec829b414c49238c146b727885abeefcae5050ad7c6a6f024f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2ea503c05c834aa0aa05a18bd06a5ae9',
    sessionToken: '964636d3dfc305e2480fe718b7cb966cfafadf7cb1a2afa6b78ec47b2e42fdc2',
    authAt: 1705108746
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2ea503c05c834aa0aa05a18bd06a5ae9',
    code: 'bd51d16f71eea6b41539ee96f4d0786f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign?service=sync',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c592742511b008c899f1659b98418adc5247afd129aa777f624fe73a7463e501", ts="1705108746", nonce="JAsuUa", hash="JAXdCKsdbuISg9Ni8m2KGTRfMuiX9HniedWY/4/uRFk=", mac="dU8dw+NMNPOSB9nFTa53WvwuFHcqGCwcdrWat8WtWVo="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 300000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMmVhNTAzYzA1YzgzNGFhMGFhMDVhMThiZDA2YTVhZTlAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzM2MTEyLCJleHAiOjE3MDUxMDkwNDYxMTIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzQ2MDE4LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc0NiwiZnhhLXZlcmlmaWVkRW1haWwiOiJlMzMyOWNjYWFmODQ2MTlhZDJmM0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJmZWEyNzA2NjI5YmJkZGE2OTE1MzFjMTYwMmViMjQyMSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzQ2MDk3LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc0NjAxOCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.kN4mmUf2PDvy3xP-utg1cMdIN6NECyrdJcB0WwPXtxl73y0blFXcAe72z8Pa4Mruaf0KmGOLSzmVXlY4dxe-JONzKo-X5tIiMVK2cjnt8TeEUM208_u9j-a7UX1t-TizcKGeP_geH0196xN3LWuFE8qxma9aIZuKmQ7s_RMtTFUnlAVMiRQ2t_A1_mc5b-3XqPFiGdu-A_m4jaUovZaGwd1LyZtxx_uFJTU35VrLk8S-c5AjPAz8FZU9ChRoX559gyE-LRisbGd4fhtLAzvXGOx8rhu2w-DKJV-2G4e770jIAxRXLAaJopL2mggN5oeaHdy8cDNuIophPe3_6kaaEQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c592742511b008c899f1659b98418adc5247afd129aa777f624fe73a7463e501", ts="1705108746", nonce="gsSrv0", mac="lftCdKI1QTJ69i9ZczRrz6s/QcSGNSWbH7pQ62C3cBM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'fea2706629bbdda691531c1602eb2421',
      isCurrentDevice: true,
      lastAccessTime: 1705108746119,
      location: {},
      name: '',
      type: 'desktop',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c592742511b008c899f1659b98418adc5247afd129aa777f624fe73a7463e501", ts="1705108746", nonce="ziKe1e", hash="hJvOLqAF34BeqfFxe8EpNBE/jg/ErFSAtrdWgxnuo7o=", mac="iozqE6U2nKyqnvYhMtq38T0tBeN9P9sk6Xkrxfd2pTc="'
  },
  json: { name: 'test device', id: 'fea2706629bbdda691531c1602eb2421' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    id: 'fea2706629bbdda691531c1602eb2421',
    type: 'desktop',
    availableCommands: {}
  }
}
    ✔ device updates can correctly handle upgrades from placeholder record (510ms)

  #integration - remote device with refresh tokens 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea0c325be32522bd1b57@restmail.net',
    authPW: 'acdd71ab2a46280a406e09d7d6a59286f1b7e9491b053664d92bbf41816531ed',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd5007e88cd6f4618b3ef0badbdc4e2df',
    sessionToken: '7a671e1f916b9cadccbc0cb13e2bda6e81a9e49d3228ec86208368689bd1e0c2',
    authAt: 1705108746
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ device registration with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8518f9931d8884f3b655@restmail.net',
    authPW: '896ce6a4c32bfa61e28ceb1ea88b1bbdde6559b113a420bc974d7556c9c6aea7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0154a0aebe214abfbb6d985bc1da74c3',
    sessionToken: 'f784984244ad4a089fa6fb0c8d77c4a626e9d05f9b29d8c2f3ea1599e83b7599',
    authAt: 1705108746
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '55cfa9b5541f10231fe3@restmail.net',
    authPW: '33f77ef04be05db34fc0dda761893c5750b58bf7f0edcbfe058aec422a692065',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f73b3b4bb5764b1483d822b94464bd18',
    sessionToken: '74a430f1b716956d899379003bbceecec0c8ebf05aacf0458058f88afc054450',
    authAt: 1705108746
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { id: '1' }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ destroyDeviceWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2ed2cc6bc0b551cc1da8@restmail.net',
    authPW: '1b5237474d5b2a9b1e194bd66a7bc3e8416152b74858662b079387dc8b257f57',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b6db865277b14a958e962434c599de05',
    sessionToken: '1a91d1ece2edfb30ea05f5fc9091012094a71876ed81ef47c9fdbf1b3c76c351',
    authAt: 1705108746
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/commands?index=0&limit=50',
  method: 'GET',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ deviceCommandsWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ff6e875aba6221608fe2@restmail.net',
    authPW: '6e02120385ccf01ab3090de50e91d5177e55fd4c0474d5b29dd34de772e37e29',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9469ee9669b74f2486511cb9d9cdf56d',
    sessionToken: '94186f0f20a557a04df99b398a537fd901351f88f89ddc2f5dab2d7375177e1f',
    authAt: 1705108747
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices/invoke_command',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { command: 'command', payload: {}, target: 'target', ttl: 5 }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesInvokeCommandWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8b31bf2704bd374cbdf7@restmail.net',
    authPW: 'da05762d65a630d1502790aceb42c79640fcfccc8ca6e7f1c8ab5d9d522330ed',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0857b5309f55449cb5e5cf849715e58f',
    sessionToken: 'f10c9727c1ca8ad4551071c0336d25f0cea0695ed071c7902ede81e120e145fc',
    authAt: 1705108747
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices/notify',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { to: '123' }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesNotifyWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9cb0eeb18365fd582ea9@restmail.net',
    authPW: '8d8cfbda20f3f8ca62fd5195a219c9c0faa258c858a4ccfcac9dfea609d32238',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '51b9585eb50f49d6baa381674de3260b',
    sessionToken: '6c26a33f5f60e3423ef3131df07f03d40991d29ae28a555b3ec92f38086b0297',
    authAt: 1705108747
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 7706004044f5ba3ab9b9d1a4c176aaecc28e01158cb3234861de12d4a7e97228'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 7706004044f5ba3ab9b9d1a4c176aaecc28e01158cb3234861de12d4a7e97228'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: '0c5ecdfdfc5de06d7bf84fea371025ba',
    createdAt: 1705108747597
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 7706004044f5ba3ab9b9d1a4c176aaecc28e01158cb3234861de12d4a7e97228'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '0c5ecdfdfc5de06d7bf84fea371025ba',
      isCurrentDevice: true,
      lastAccessTime: 1705108747614,
      location: {},
      name: 'test device 🍓🔥在𝌆',
      type: 'mobile',
      pushCallback: '',
      pushPublicKey: '',
      pushAuthKey: '',
      pushEndpointExpired: false,
      availableCommands: [Object],
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 7706004044f5ba3ab9b9d1a4c176aaecc28e01158cb3234861de12d4a7e97228'
  },
  json: { id: '0c5ecdfdfc5de06d7bf84fea371025ba' }
}
!!! response success { body: {} }
    ✔ device registration after account creation (72ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ed9c98d0cda671600dac@restmail.net',
    authPW: '862ccc478eb4c8d24d3c81067dcb5aef7d7cd24035723e650ca7e036a2495666',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '77f353e98b44494bbf8434d44ac26b15',
    sessionToken: '1af3f6dda08c5414034a1767545dbf3d0869852c3f8050a4e5df3d864c6d938e',
    authAt: 1705108747
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 204ba9b06a98ffe2eda60f11608535b961d2a37e47a5926be13eb6649f55b7fd'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 204ba9b06a98ffe2eda60f11608535b961d2a37e47a5926be13eb6649f55b7fd'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: 'c7d506968686cd2a67028c032815792c',
    createdAt: 1705108747846,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 204ba9b06a98ffe2eda60f11608535b961d2a37e47a5926be13eb6649f55b7fd'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'c7d506968686cd2a67028c032815792c',
      isCurrentDevice: true,
      lastAccessTime: 1705108747858,
      location: {},
      name: 'test device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 204ba9b06a98ffe2eda60f11608535b961d2a37e47a5926be13eb6649f55b7fd'
  },
  json: { id: 'c7d506968686cd2a67028c032815792c' }
}
!!! response success { body: {} }
    ✔ device registration without optional parameters (68ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '731665aee2930389d260@restmail.net',
    authPW: '5548d6986020b293c4bbca8d0d230669809fd834937959f846e4c310c8e8ad60',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5fa2bf1f15684ec9bc6d033fec30663e',
    sessionToken: 'dee4f48676948d0a7b85d9e9ba214d3c9906a169e0d04b48e588c9a8ed0d2df6',
    authAt: 1705108748
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 493d66f5ed434b5dffc9587dcd54b647b0d2da1c601f3b869c4c052a3d958e5a'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 493d66f5ed434b5dffc9587dcd54b647b0d2da1c601f3b869c4c052a3d958e5a'
  },
  json: {}
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'Android Components Reference Browser',
    id: 'be0d5a81a2aac80a278e9e41412a4ff4',
    createdAt: 1705108748102,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer fea20ac40a00de1b938bf1788631cde3189bfb8db73d184beb2a53ba7349d44e'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'be0d5a81a2aac80a278e9e41412a4ff4',
      isCurrentDevice: false,
      lastAccessTime: 1705108748097,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ device registration using oauth client name (47ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cbd7e39fdcf65957dfb0@restmail.net',
    authPW: 'a80a1cf7038e33b29b5627f74f01ab90c1cdfbac11f048420a9604ed24e2b61b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '57447338e22846129b5e054c3010bf73',
    sessionToken: '6e4ba679e739ae67fc23142d29e62bb53bb2086350f739315584dcbfdb9fe94b',
    authAt: 1705108748
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer a351ffb02b463d62b11f82d55766e42b6605d9e91c1ae2f11c2df6d259a21ded'
  },
  json: { type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    type: 'mobile',
    name: 'Android Components Reference Browser',
    id: '3f47bd5974030e33af0ff77cff3174dc',
    createdAt: 1705108748325,
    availableCommands: {}
  }
}
    ✔ device registration without required name parameter
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ef5e9704dc1c3b3668ad@restmail.net',
    authPW: '562b6a63a0e45eca898ac60fcc9f5726d577a263198862b4d1273c655c1fb03e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7699fbd1b6484a24a6ae50732e9741ca',
    sessionToken: 'f027a339782b93995f6ebd35dadebb7bb7884624a681d1a5772d079e04a13efb',
    authAt: 1705108748
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 22de0534e4c668d64435d874693c30c97842bf61ae550be44ea998be34564b18'
  },
  json: { name: 'first device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'first device',
    id: '3f0e7edca111a1be3141d0c7a79e3180',
    createdAt: 1705108748532,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer ee15e90c5176572e18bf4fbdfcd0fa7289c5b0d68781f445a7a14b0eaaa55465'
  },
  json: { name: 'second device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'second device',
    id: '029597dae8939b60354325e093e8bea3',
    createdAt: 1705108748548,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 22de0534e4c668d64435d874693c30c97842bf61ae550be44ea998be34564b18'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '029597dae8939b60354325e093e8bea3',
      isCurrentDevice: false,
      lastAccessTime: 1705108748544,
      location: {},
      name: 'second device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      id: '3f0e7edca111a1be3141d0c7a79e3180',
      isCurrentDevice: true,
      lastAccessTime: 1705108748558,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ sets isCurrentDevice correctly (48ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f62cb3d47b1e4ea61d4d@restmail.net',
    authPW: 'fab69da194c426382e79bc9fa2599306548c248d8dc5ab36abc3e6751f5faa27',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5e8e777e2fbc4e7eb1762c438106e3cf',
    sessionToken: 'f7c982fffd52a38e89521bea349a5052ef1bf2ab4fa3dc092e03db84ec5faafc',
    authAt: 1705108748
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 9e1eff5ad727524a7b18e00b47a4cc5fc64ceb3e4e96e8564441549107531ebc'
  },
  json: { type: 'mobile' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 166,
    error: 'Bad Request',
    message: 'Not a public client',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ does not allow non-public clients
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4f5975193a87d1837688@restmail.net',
    authPW: '54f578b16d114cfabe03b1a878c058222d64d8f31c8e4aa28549b827d508c701',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '058ba0627d2440e6bdc3605b52cddaf2',
    sessionToken: 'a96e913b32c52edfed3e0536bcc961ca5f82b3e3146328dac201f4ca8d57decd',
    authAt: 1705108748
  }
}
    ✔ throws conflicting device errors

  #integration - remote device with refresh tokens V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '46cf30ba9c5277f0ef74@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '46cf30ba9c5277f0ef74@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '46cf30ba9c5277f0ef74@restmail.net',
    authPW: 'e1f80a8ee651856218546668d17b992cffb4b7804f3bc8dc4fb039d1f2b794fe',
    authPW2: '16da214dd29f3b55eac0993e2dbeaa40c7f7eeefcaa5839e89459e4c14a45daf',
    wrapKb: 'faa74e369f20c6fc1702535f78d21966b62175d76b8abfeb887bf1a01c87da55',
    wrapKb2: '42a210a37651a0c514f5c3200110f8e74318a1fc07f7c9b4edafce28934d4c40',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4b815fae4a52463eb27f44262e8bd60f106c4c8216d83b585b2105fa9aac5b31',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cdd1b5be48c2479a83a991b3d327108e',
    sessionToken: '90a97db7f8661858eb360b49e163336fb94de5aa650a629547e934d01756ea29',
    authAt: 1705108749
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ device registration with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5c91e5f6f087b99de97f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5c91e5f6f087b99de97f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5c91e5f6f087b99de97f@restmail.net',
    authPW: '8960bd6e984710ad4d3c87c0755de8ad6042e2b5004bfde0744b7f35c248c772',
    authPW2: '057e4347eb276e114ea54a3266fc46ae41f489386f141dd276b6f8f70f47687f',
    wrapKb: '8fb47b918c24115fdf5b5a6752dcdc52281d45319ad558df8aa8aedcc2db0dad',
    wrapKb2: '48b7da55ad653fe0acf882f193f3eddc032dc60d8d00f0eadfb9621b116c0a8e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:99ef92e705fbe6db457b68ffe1066e26921198ca36e6aed0a2f7ebf92c19033d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '941ee4fbbc7b40ab9ea4ead3ea705532',
    sessionToken: 'ab66dfa85c377c1c9b1258cdb801d757bea504156ddcc05e04c49eb91f29a745',
    authAt: 1705108749
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7691e84296573cf130e4@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7691e84296573cf130e4@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7691e84296573cf130e4@restmail.net',
    authPW: '64a476562d9a4534a427ee0fab926fb225a00208462a68bec631ef1bb5e3bd3f',
    authPW2: 'a623bb746cbf2f51e731a7f53119545d4f5f03ba20cb304ecc93d7c85703e489',
    wrapKb: 'de1ce635eec32eb9b905f84a5240ba08073a2658843d9365da20b7b09dd87500',
    wrapKb2: '5dfa757a270a346d1eaae4ad4fa6028f3a92379db91520e1756cd3afe4d7fa3d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b49bf7b5547120251e07401b2591b2834694a78c2003efceeee3eb18222757c0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a986c1e55a7342ed8dadb3ec377cefc3',
    sessionToken: '12ec246ae3e18f19e989071748ab5e4ad0869bd116242e59a16c92c104e8d47b',
    authAt: 1705108750
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { id: '1' }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ destroyDeviceWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd9b7429705c64d7d8545@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd9b7429705c64d7d8545@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd9b7429705c64d7d8545@restmail.net',
    authPW: 'fa505b45aa13eaf84e8c91eae817d51aba2ee93e85a2b38d445c5b06cb8b982c',
    authPW2: 'ac08c8d0eea75e3129bfb28c8a8fbec767b2ca957f319f1448425092c8f11187',
    wrapKb: '3745eed301f9cb137bcdf7327e138013a68ed11952e4e6445f8131db72f73850',
    wrapKb2: 'a5f154044d4388517026fb9edead3d301b2c02195f0f8c7c64c45ebdd0bd97d0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:06080e793eb871caa7b56fd12af13263d06418581b1b58adb3eea82f984c60c6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '14b71b2f03944f478da5722afd685a1e',
    sessionToken: 'e25d58c369f0648dda5774394f622067c678ad4a02a829ea4b81c33b430c1a02',
    authAt: 1705108750
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/commands?index=0&limit=50',
  method: 'GET',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ deviceCommandsWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ee66e2101e9c291dd212@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ee66e2101e9c291dd212@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ee66e2101e9c291dd212@restmail.net',
    authPW: '180f47ac6ad70fedae000ae444f635dbd0b10da26fa346add1dc63b88d084a7f',
    authPW2: '524a54cfd25880e0e8d54cfba7e7a4d1e3d8300bbabf3c2abf936584dbd60ec3',
    wrapKb: '640f23fc3e38f90a013cd0f4f76ab9cf8286583b7285e2f425f572160a04a1aa',
    wrapKb2: 'f07545a50c54d56db6b7396d56e6224fc658a6d43aeb63245da6356959f04160',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0abd939a61d613739a3fc67df5790ea71ee1a355cbdf987d78be8521333641d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '77d16696c61844a884e98bcf9835c30f',
    sessionToken: '9f381bfb6a03da6b2f04a1ca31a289e59a02e90793dcbd0cb0306a22e3ff6081',
    authAt: 1705108751
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices/invoke_command',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { command: 'command', payload: {}, target: 'target', ttl: 5 }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesInvokeCommandWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '12e708e6d11cc25e4d8e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '12e708e6d11cc25e4d8e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '12e708e6d11cc25e4d8e@restmail.net',
    authPW: 'e56a4ac5ef1da85c76b0f57c4f7368474e2b6f775dedb52e736205713e5a5d34',
    authPW2: '257e7d1aa235e328dc942970cee97cbbeb122704d1fcffd3ec4c7458bb9abefb',
    wrapKb: '4d6222d5490546ad3be959a2c80e77a8ce9f4c911203e128f87e7b307ddd2a50',
    wrapKb2: 'c5258d87ff6b3e167c6cd8efdd74a6ba1df40f821669736bc92f2e0bdd0a74f2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:37a5321e2dded24c4a47bb4913c8b444cae1e11f58495e10528cebec922649cb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7660e9cf0f324ae89a3e49003b7ff95b',
    sessionToken: 'c3e95f2e6c2864a482303afee33a5947e98886a8b47df5e87e318e44b25bd301',
    authAt: 1705108751
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices/notify',
  method: 'POST',
  headers: {
    Authorization: 'Bearer B53DF2CE2BDB91820CB0A5D68201EF87D8D8A0DFC11829FB074B6426F537EE78'
  },
  json: { to: '123' }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ devicesNotifyWithRefreshToken fails with unknown refresh token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8278cad86e33e0ee0aef@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8278cad86e33e0ee0aef@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8278cad86e33e0ee0aef@restmail.net',
    authPW: '2d86fbde95137f729c11102be423425eb25878cb838e8dd913e4603fad1f3399',
    authPW2: '1b3540a5f46a18696dfeef105d8a5acda8e2b4cb2c1660f8a01456e6e5a8b842',
    wrapKb: '0786a2c1e2680e5a8166a1e7ede02f5cdc09df03d74967ca0763c506bd6f036a',
    wrapKb2: '783d82212985c3625b78da33da703b07a2d4bddf68c3bb0252512efdbf77748d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:256084ed6d3d546c39799ebdd6c68101e82d3ba6f4f092359d58d883d9224c4e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '838f44e3959d4818b13ae2d4a238a402',
    sessionToken: '1e180daea4fa715f3b86b97b7038a1feb3de8d6495a78c0e5966985e222b7c6a',
    authAt: 1705108752
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer f5ca771a6423812c111479637f1aa904c91e676e733fb4a3c7b0dd3a95b3d4ea'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer f5ca771a6423812c111479637f1aa904c91e676e733fb4a3c7b0dd3a95b3d4ea'
  },
  json: {
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: ''
  }
}
!!! response success {
  body: {
    pushCallback: '',
    pushPublicKey: '',
    pushAuthKey: '',
    pushEndpointExpired: false,
    name: 'test device 🍓🔥在𝌆',
    type: 'mobile',
    availableCommands: { foo: 'bar' },
    id: '54f8e4884af0479d2b22da243f0ec7d4',
    createdAt: 1705108752257
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer f5ca771a6423812c111479637f1aa904c91e676e733fb4a3c7b0dd3a95b3d4ea'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '54f8e4884af0479d2b22da243f0ec7d4',
      isCurrentDevice: true,
      lastAccessTime: 1705108752272,
      location: {},
      name: 'test device 🍓🔥在𝌆',
      type: 'mobile',
      pushCallback: '',
      pushPublicKey: '',
      pushAuthKey: '',
      pushEndpointExpired: false,
      availableCommands: [Object],
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer f5ca771a6423812c111479637f1aa904c91e676e733fb4a3c7b0dd3a95b3d4ea'
  },
  json: { id: '54f8e4884af0479d2b22da243f0ec7d4' }
}
!!! response success { body: {} }
    ✔ device registration after account creation (68ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '254a6128de38ef5b48e0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '254a6128de38ef5b48e0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '254a6128de38ef5b48e0@restmail.net',
    authPW: 'b55cccda3061f56bc50a825216a055458b454e1643808ea9b1dc43335e63e8e4',
    authPW2: 'eb1eb2652bb57a02c8834f667a3cc244a076ea0d8136466d240e62b9e243ee46',
    wrapKb: '4a43f3d9d057a07d744b4c4246a21a0eadec2f9f8a6184527a071fab933f1c74',
    wrapKb2: 'bb561fe8b5f2f2ed845e50eb6272a74464c9ffcca19fd62e251f5eefdeef0800',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9175c902d44428085e629b34f7f76d31589fbac31891718178aed724b551fb5d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '86e4ef5883a446d0b4afcaaec2077601',
    sessionToken: 'd1f3762ce40670ad941569f32e1e2fec364133b2a94da69c79f07629391174b5',
    authAt: 1705108752
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer ccdae0da2de3eaaaec234bf5a0e760e8c6d66666bb962588d721bc215358fe0d'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer ccdae0da2de3eaaaec234bf5a0e760e8c6d66666bb962588d721bc215358fe0d'
  },
  json: { name: 'test device', type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'test device',
    type: 'mobile',
    id: '9e6bee1d5cccb0cd1676d70c833f1f2e',
    createdAt: 1705108752776,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer ccdae0da2de3eaaaec234bf5a0e760e8c6d66666bb962588d721bc215358fe0d'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '9e6bee1d5cccb0cd1676d70c833f1f2e',
      isCurrentDevice: true,
      lastAccessTime: 1705108752787,
      location: {},
      name: 'test device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/device/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Bearer ccdae0da2de3eaaaec234bf5a0e760e8c6d66666bb962588d721bc215358fe0d'
  },
  json: { id: '9e6bee1d5cccb0cd1676d70c833f1f2e' }
}
!!! response success { body: {} }
    ✔ device registration without optional parameters (67ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '34063210f48677925dc1@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '34063210f48677925dc1@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '34063210f48677925dc1@restmail.net',
    authPW: '1f6297a35bbcaf01105fda784dd8f680bc13a3798af76be089169e7c407d72f4',
    authPW2: '00c00f5f5b4ba8d9b971874239cc4eccc80a071581e3bc734d6e817ba346e26c',
    wrapKb: '2ba0e15ae4a9abd06fad09ba9702d1076fd055d26bcdb9a4beb40573b4d72439',
    wrapKb2: '5d9e5c936becf7dc8b97e0e0648e99c073c36c472d43f914e4f09832b1a528f2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:99f980df646fdc5f4baf5700bdc1c9bbb4452b2911539ab69d1ece4686976289',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f47d233de9d74df89d419c07cde358ae',
    sessionToken: '73fa2361191c0c4095473eb67f17ea05eaaa379ded4f793cbc29b591d56289b5',
    authAt: 1705108753
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 1835ae3f8ec17ee21938a389dbd72ce1851668afade10ff5db7f7dc07b8c8500'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 1835ae3f8ec17ee21938a389dbd72ce1851668afade10ff5db7f7dc07b8c8500'
  },
  json: {}
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'Android Components Reference Browser',
    id: 'c95f06803a0700cda1dd9398443d1e71',
    createdAt: 1705108753295,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer a45f0d3d6f7debf15c7d8d9a153704b5437409fd5153c391fc8d5e620062b84c'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'c95f06803a0700cda1dd9398443d1e71',
      isCurrentDevice: false,
      lastAccessTime: 1705108753291,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ device registration using oauth client name (45ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c02607f52edd8c7787b4@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c02607f52edd8c7787b4@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c02607f52edd8c7787b4@restmail.net',
    authPW: 'd9dca339dbdc713c1c820624169024f710e3f14b1ef563502a76ca254c8de3d0',
    authPW2: '49d41b0df3b05a596ea4b4ef26d38df6c19c93735a35511b43f411d4d97c361d',
    wrapKb: 'aa34dc821cc6e5ca48dc6028768b3447641d01518fb5f385f57169859120ba35',
    wrapKb2: 'e948ea6bde82d6ac32e89e8089a5148fbb44ff2e5f91be90b6eb5b2722fdb3a3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d20d3aa2080e8af5c4ae6b908e57efc501a24a2f8f5685d8e0e208f13c5bb0d8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eaa5370963934ce2a6f740d9e30b1d48',
    sessionToken: '1802ff324a26f3bbe8bc751a857d725548eff468fd61a908d702a77fd6e25833',
    authAt: 1705108753
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 0353adb02f435d37e05cc5e52d3311b2b08012059be75b5e93cf484290ec00f0'
  },
  json: { type: 'mobile' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    type: 'mobile',
    name: 'Android Components Reference Browser',
    id: '488b42365d76754fba33175a2ccd74a9',
    createdAt: 1705108753776,
    availableCommands: {}
  }
}
    ✔ device registration without required name parameter
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8f0506d40411ea16571a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8f0506d40411ea16571a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8f0506d40411ea16571a@restmail.net',
    authPW: '4ca445355dee43b78412319d10f353a7b3d921968b7f2d1373905d0f7f6fcfa0',
    authPW2: '4fca463431923b5d1144ea074c26e69f4571fcd2e99eac4d27104ef7e763c52b',
    wrapKb: '4818afec7daf5e2ed4596eec3408c5976805967922b99058735efbd91f108dd9',
    wrapKb2: '92a9117a8ea9d72955470bcfece349941cb524c15d50014cbec564a4ce282826',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3c30a3fceb85ea152427e6760392f1e0f675d13e5a3f173c4d586e7a4b64c27e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a7e17917ce0c4f4ab98946ed8faf0a6e',
    sessionToken: 'ea8b9b407eaeb6be125f0df9ffa72ef8e54a9ba72ddefd953a712e7ef4b95526',
    authAt: 1705108754
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer e5a6233839198cfc94070c6937f8ff37328c99db4ca19e87656aee0f93348556'
  },
  json: { name: 'first device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'first device',
    id: '5f7ed4f074f5dec289d85962f330cb4a',
    createdAt: 1705108754255,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer e524167177d444c4b945f77d1e5eb52473ebd40e2fcfc7bd27d186a0eb0a7005'
  },
  json: { name: 'second device' }
}
!!! response success {
  body: {
    pushEndpointExpired: false,
    name: 'second device',
    id: '59265b1006bbe2cd44108acc0e1ba6f8',
    createdAt: 1705108754271,
    type: 'mobile',
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer e5a6233839198cfc94070c6937f8ff37328c99db4ca19e87656aee0f93348556'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '59265b1006bbe2cd44108acc0e1ba6f8',
      isCurrentDevice: false,
      lastAccessTime: 1705108754267,
      location: {},
      name: 'second device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      id: '5f7ed4f074f5dec289d85962f330cb4a',
      isCurrentDevice: true,
      lastAccessTime: 1705108754282,
      location: {},
      name: 'first device',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ sets isCurrentDevice correctly (50ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7b680794783921a9886d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7b680794783921a9886d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7b680794783921a9886d@restmail.net',
    authPW: 'b814d858ee7931f61d75e701d8149e7784e592a174f161c84b0dd0c13ab8aa32',
    authPW2: '21e274fcea23170b4060b4f869e34917a532e6563d6d73a83588f791acc67b2d',
    wrapKb: 'c388856bfa82d5256258e801727e6d4ae526d47e4058e5f6c532699ad0809a60',
    wrapKb2: '3e7b314d018cd4eca6a61770c3335c14eebfbca151dc82ead197b1c03aa84f92',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:426efc16d87636d6f3ce51f9c9f7edb44f44878d1ee756fcfb1c1576019aaa4c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '23498e8050c94debbab52856858e2b98',
    sessionToken: '6e4ef02b5dabfd2ad94f21e77bd7f15ff183d5bc552838182909a6c1405e8106',
    authAt: 1705108754
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Bearer 93a92bc5c94be212c26aa8b82f07bd7449701ea8c53fa8966d90a2a083466a90'
  },
  json: { type: 'mobile' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 166,
    error: 'Bad Request',
    message: 'Not a public client',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ does not allow non-public clients
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9e614cb2939869986cb0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '9e614cb2939869986cb0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9e614cb2939869986cb0@restmail.net',
    authPW: 'fe6e4ac56125145261316e25c3a6baf9208808308d4afc1dd491aa546393445d',
    authPW2: '7e0aaf83020e3ee6696f0e585b6fd7ef2bbd593482a8b5a2c63fdd1d7cd845fd',
    wrapKb: '113cb85eade8765510614788e4fc218c9933ec649cb2170e26f11e8b4f3bdd4c',
    wrapKb2: 'b19d2033353c4368905f08a07fffad5578da6d22c87f5b47438700291570d250',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dcc38c12c393b5cca72d2ee3a331b134378b18fb57f772eb95825e502f2bae01',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '83c6ce2281eb4bf7b7136cb3f338a475',
    sessionToken: '29f300c348d1024d78a759494f9cb3857446e4bc5f89475370477fe21f449552',
    authAt: 1705108755
  }
}
    ✔ throws conflicting device errors

  #integration - remote email validity 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'notAnEmailAddress',
    authPW: 'b23d8ba05e94744e7c048703d6051b8f6f9314339e06dedca483f9766b2e2efa',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@hello world.com',
    authPW: 'b6fb87c15f769d0034f260d3a79f6bc14216458cd1e5ee54e9a14c858f2ed4b2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '\n@example.com',
    authPW: '9197ead8b93b20d3f8f5fe512d5cc88d29b2a892e90913078733f5bdbd6b3f2f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@hello+world.com',
    authPW: '314ba51d7d070d4bae4c7fcf9bb74299b24957686768bf4da4568d1a5e784774',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example',
    authPW: 'ad6d19e5ba1917c61802ef79da64264487afbdc9cc320dc3dd9dc090de000259',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@.example',
    authPW: '344683ee3bdbb165c7faf09fecf6053aada8feececd22e10c3d0b48cc25d3911',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example.com-',
    authPW: 'a883fa2bccd01b322e8ead531fdce47b4ff2bf1c63dd07b9922dd2d0887e9f78',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example..com',
    authPW: '5ec802c3d21bc705e0439f8d4bc2a7b20c1f93e272c0611919c9e4ecb7cec60f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example-.com',
    authPW: '09216b2ffcc242ee1eab51880637b722235543f09ca1735a8248e58d4b50719b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example.-com',
    authPW: '1e92533eebef275f366806378cd20f7fa6fa33f1032de5d5d30f22ca9db41695',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '💩@unicodepooforyou.com',
    authPW: 'beaacce0e4d18670f497f3ceec740e73a557a527931b949fd77dc38783d69840',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ /account/create with a variety of malformed email addresses (44ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a+b+c@example.com',
    authPW: '269182395f8962b9a759ecaa28c514d95fda440f1263f4644944c6568e251a16',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '#!?-@t-e-s-assert.c-o-m',
    authPW: '0f7cfced52fc888092dfe50c811cd6b028a571636114da7333ec2621d2c9f1db',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'tim@tim-example.net',
    authPW: '94a8892de2c7e15d900173187154a8d99fefffa312d75052ee399f2a6a58b8b4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'Ӓ@example.com',
    authPW: '7beadbd67df714ffd6d8dfccaa12581c20ff9ca7731d3c5a2cd5c2f446a0a2f7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'test@ᘮ.com',
    authPW: '17d4852faad2624771bbb85bcf3314beab8313dc1ceae8759dc219d5fae2ae80',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9c0e5b68fb184f9fbe3176b177f7cef1',
    sessionToken: '6b2821c4292e47888f0d5ddb3bb1d4920c217e198ec043befbc2d8da3534b4b7',
    authAt: 1705108755
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7e36b0103b238359e68b23ba4016c378e2438dccdf0ece8faf0d1966b15829fe", ts="1705108756", nonce="hpRh2P", hash="5AqsomlTta6EECpKqg8m3Fr8IsXVOcGMk5Tz0r1pm28=", mac="6IPgAfSnkcIufbxfumZkCqp+9vo0K1cut1KmfLF8Keg="'
  },
  json: {
    email: 'a+b+c@example.com',
    authPW: '269182395f8962b9a759ecaa28c514d95fda440f1263f4644944c6568e251a16'
  }
}
!!! response success {
  body: {
    uid: 'a612457e0ef94aa8b3c6ad93186748b2',
    sessionToken: '7d5cda4294247ccc3296bbe2abde1000a82d5d5a402e905e777657a003c4477a',
    authAt: 1705108755
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7fbf763e8e7789596737b0dc1a4fdd81e3573df8538aed14f2343f2791ac6c95", ts="1705108756", nonce="uWEfIy", hash="BKRIZBDEUmRWPnCOH8oEECHGmrjZh3pav/gt9FKW+aQ=", mac="Y3FcMANoOBE3xa63orSE3ZKJ6vBtx4+poJ1ZXIHxjIA="'
  },
  json: {
    email: 'Ӓ@example.com',
    authPW: '7beadbd67df714ffd6d8dfccaa12581c20ff9ca7731d3c5a2cd5c2f446a0a2f7'
  }
}
!!! response success {
  body: {
    uid: 'dc12da96343f40f7adace90a425a1a53',
    sessionToken: '8277dd21ce8cf0e29173c867395325cc6fe3a97120209334f231f295c97cf779',
    authAt: 1705108755
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="165b5027941f59821f5a939577862bf986bc66148db8415f3008d24ccdd0dfe2", ts="1705108756", nonce="0zWTGQ", hash="QOGrk4W66bQS/4M0R+Cm3AEY/ZTG2R6e31etMPXwi2k=", mac="AwF7qliNHJtjV5gFLKKWBePHDnGTVj/kqWJ+MFENPS4="'
  },
  json: {
    email: '#!?-@t-e-s-assert.c-o-m',
    authPW: '0f7cfced52fc888092dfe50c811cd6b028a571636114da7333ec2621d2c9f1db'
  }
}
!!! response success {
  body: {
    uid: '674f32ad25984957a27819b5f765593c',
    sessionToken: 'a0f366a9e71b6b61e09ccbc56226e8a03bbe94a4c1b88a3e115b338c540b1d53',
    authAt: 1705108755
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="16ec3dc109333fec7430cdf4837f1a5b149fe4bde59d31f3f527d4b92f7876fd", ts="1705108756", nonce="z4XeaG", hash="PouSCaUtuY5H0oBii6C2D9NMTbmBqvjIwCPzE0op5Yc=", mac="8eY+iYS13IPZAHubsohs4xJUqj7pkGd23GQTiWbQnZU="'
  },
  json: {
    email: 'tim@tim-example.net',
    authPW: '94a8892de2c7e15d900173187154a8d99fefffa312d75052ee399f2a6a58b8b4'
  }
}
!!! response success {
  body: {
    uid: '8a20e3719b074efcaefd32ae1f81ea51',
    sessionToken: 'ee81ce64092152ccda03474e9a455e0b24588c6e2957228afd3d49723dfae9f5',
    authAt: 1705108755
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="645477f9eb6ace83cb049bbf085e87277f944546b4464294dcb428b3e9b5d36e", ts="1705108756", nonce="CuauPE", hash="GjHrTKQDM1lT30xRqCgTkRl5LSUPGvWczkqXB2u/RhU=", mac="+5gFvlKp2cyI8CpZRqsJpeyMDF/aqXCamHdkK22UfcU="'
  },
  json: {
    email: 'test@ᘮ.com',
    authPW: '17d4852faad2624771bbb85bcf3314beab8313dc1ceae8759dc219d5fae2ae80'
  }
}
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
    ✔ /account/create with a variety of unusual but valid email addresses (681ms)

  #integration - remote email validity V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'notAnEmailAddress' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '\n@example.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@hello world.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@hello+world.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@.example' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@example' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@example.com-' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@example..com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@example-.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'me@example.-com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '💩@unicodepooforyou.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '\n@example.com',
    authPW: '9197ead8b93b20d3f8f5fe512d5cc88d29b2a892e90913078733f5bdbd6b3f2f',
    authPW2: 'f0ee23a5a8a6bf56e83bf1ae3960d6c23d92e87521ba93e1ba2d5804416af577',
    wrapKb: '7a48edb86be10b0c73a15ded0c012413874e20dbd7d79e140b3afc61cdae7c25',
    wrapKb2: '24f1579e5d4edbe8c854ed0c874e1c96f1b126867609182eb4e60429e08e7f8a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cfb47390f2706e165bac7d781fa4e4c29a49d1b56523e3ca462ce3d12485816',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'notAnEmailAddress',
    authPW: 'b23d8ba05e94744e7c048703d6051b8f6f9314339e06dedca483f9766b2e2efa',
    authPW2: '2bff3af81c355c2dba6f6182c67dee5abd32f8ac8e8fa30a01821fc0aea06ddd',
    wrapKb: 'ec0e1cca7b72628b07b1718bee0ff3427a376345f68edf4418afad493437f115',
    wrapKb2: '35e3de3486173b44cbff3ddd6ee6a4e75871f79327b38507431dc52a6ae4c299',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:86072670c1236037f77f065e89a513238ff850b0fb784951530abdfd4e8d86dd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@hello world.com',
    authPW: 'b6fb87c15f769d0034f260d3a79f6bc14216458cd1e5ee54e9a14c858f2ed4b2',
    authPW2: '319ce43200488ab32412f6714b237334bd79f4b8f5a7bc74fb9c0f7aa08bb03c',
    wrapKb: 'e668283ed1c8422188fc0d261542593bdfca545fb3b3fd703ba21a4b73560ffe',
    wrapKb2: 'b38d2710282d7a387f64ffb5281ddbd97bdaf04bbfe880648000e8fd22addd67',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:16dcaf50726723ec25ec81b560d8d0f4d3964eeda30a397122fd578d12636e83',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@hello+world.com',
    authPW: '314ba51d7d070d4bae4c7fcf9bb74299b24957686768bf4da4568d1a5e784774',
    authPW2: 'c26dc06f39e35c83c87691269be8db9f9aff1be454cb3243cb0ea1d9847d5a6c',
    wrapKb: '2ee8d4622602b9bf4b3f7f7b53832a584df8b98134513c4868b998a6dd56c243',
    wrapKb2: 'bc4f134c6da97e2b788e27eeb4c9ab5f237121a4118967f4988a60746971b4b9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:012ec1b2601ab9094a14362fb7fb0f6f3bd2e7595a228cb3b2d66b72e106d1f4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@.example',
    authPW: '344683ee3bdbb165c7faf09fecf6053aada8feececd22e10c3d0b48cc25d3911',
    authPW2: 'aff33735a779f2c78f878a02c1226f4433b635557da2e40b4bbe16010d09fb9f',
    wrapKb: 'b2d381da6610b3c41dc1b3342afc14fb76828a6132d7edcc84c4c4c36b78a623',
    wrapKb2: 'd639fd4927e69ee94b64c5dcd97d221e842b3a12c57a5a1e3c4652fb25b9c0d5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b13fc982f1ff5a327cbc634567725266d3aaf12a8192ef029c649d1c346530c8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example.com-',
    authPW: 'a883fa2bccd01b322e8ead531fdce47b4ff2bf1c63dd07b9922dd2d0887e9f78',
    authPW2: '96e552b1c2fd7d4412cd22e17fcf9bdc3d23c2354e1c6f3862cbd1d354be377f',
    wrapKb: '1b185d90f3e4dcd3db60d81a3be701c86e17de396528ae4e51ebc2d7ad57129b',
    wrapKb2: '6380389a449cdd5393434ea44790235e10e010ef9add0d5ffb0d6c89cd99855e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0b64fac4f38080c9df44d78e61f6bdc92e52d909fb433ce6b9472b198939356a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example',
    authPW: 'ad6d19e5ba1917c61802ef79da64264487afbdc9cc320dc3dd9dc090de000259',
    authPW2: '846db1a3e18a06dc31985ac4ed7df163b34cee04fb007f1d487a9b55eac25c13',
    wrapKb: '79b13838648684d7bb3c0d1c3d66d022c6a1a6af3e8f77719be529f880ef5e77',
    wrapKb2: 'c427ff2406799568f36996a48d6d1d326057f52641c5ece9d7b8a1ababc05634',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:69bc4affa11e49a6033e45fe8feb6c7815119eadfe05e0cd3e2b2469a1a3d9ab',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example..com',
    authPW: '5ec802c3d21bc705e0439f8d4bc2a7b20c1f93e272c0611919c9e4ecb7cec60f',
    authPW2: '6d06f248bbc7499c7a2bd182c88ece26d31d18909f2cb918494cae427ba1c6b1',
    wrapKb: '276ad0367113ee32ad291feadfceb2b791c8dfa422b7942b27b39573e8d739c3',
    wrapKb2: 'da1b99455ba3c6f463b2f112266d0495be22f8be7f8725d15564a8f09648c001',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b7a994474347d955e5e3706cdc466dd5adb48ae7552ca00d879b7136cb39f1f5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example-.com',
    authPW: '09216b2ffcc242ee1eab51880637b722235543f09ca1735a8248e58d4b50719b',
    authPW2: 'e8fdea07ccbef7934556b5e6ce61612f2b1f3f295b5640c0641429e1f1bd7d55',
    wrapKb: '7f64a7d869073d402ce5cd2d5a7ca274c3c1ea5df15de03dd45b72023f5e8bf7',
    wrapKb2: '0c4de5c0b242d5ea2324d2e866c5b95139bd082b3e72a471ce3c008aadb41311',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fbd1b623efb1c37aed956e7db315cb78b34a242e4e8f80ed062ebbc39043f053',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '💩@unicodepooforyou.com',
    authPW: 'beaacce0e4d18670f497f3ceec740e73a557a527931b949fd77dc38783d69840',
    authPW2: '07f56d6312f6fa6833183c76aa7d5b3c32ff3e9ca5d9f2afd1f9f2786ec7843d',
    wrapKb: 'db84e47c67a777ab9b3e55a13e2433ffbdde45b489a7f67b651c2b351f74b594',
    wrapKb2: '73f7d73819fba3d34f1072c649785ea6ce77bc2cd47ca051f9f0e40eb68e7e56',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:663e4b09982d81040e74c429a37810a19eab844f892fde448db2e1192752287e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'me@example.-com',
    authPW: '1e92533eebef275f366806378cd20f7fa6fa33f1032de5d5d30f22ca9db41695',
    authPW2: 'c0dee6b032ac6aa45fd00ab7b5e42fc33ebdcf3bdbddc9e4fc2f455d7d977cbe',
    wrapKb: 'de1243ee6b8353f9d78d72a0ecb6d529f9012f6a4061c37f8d228c0806400189',
    wrapKb2: '04047c6a7901fb1d9ec695ee17fc98aeb46e2c466413cd8302dea9b91d913179',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:23414022edd8e94a386f90fbba7213cd8ff62dd622d019310394e3fd88b12622',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ /account/create with a variety of malformed email addresses (443ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'tim@tim-example.net' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a+b+c@example.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '#!?-@t-e-s-assert.c-o-m' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'Ӓ@example.com' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'test@ᘮ.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '#!?-@t-e-s-assert.c-o-m'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a+b+c@example.com'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'tim@tim-example.net'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'Ӓ@example.com'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'test@ᘮ.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '#!?-@t-e-s-assert.c-o-m',
    authPW: '0f7cfced52fc888092dfe50c811cd6b028a571636114da7333ec2621d2c9f1db',
    authPW2: '3ebf01b30a2bbc1d3d429fa64e2ce5244d0ad76073763b4b4675c7d95830395b',
    wrapKb: '1ad4f292d22a6a3c225a52895baa839b02965d12b20e9c34f38428d20c5e6ca1',
    wrapKb2: '16244837f9d75d72e3e892a781cea0c4fbe2a26024f63e215319f0ee64b1242a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3bc161b73a6840b26f91b057269191ca9d64f51f17a911f2e509b195a387b116',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'tim@tim-example.net',
    authPW: '94a8892de2c7e15d900173187154a8d99fefffa312d75052ee399f2a6a58b8b4',
    authPW2: '8fbb558dd498837f83a4f938e75fb28ab99a2704333553074adad2db00a8e08f',
    wrapKb: '9bd46c819048e1ae7348f05507ef37aaac138c827f941fe9e00282aa1531ef7a',
    wrapKb2: '28ba27903f630c709f35afa76d24130405dd68112bec058859484b61b9a888e2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5bdbdc5693583e0fd8c03401a1d7e89ae0eda7b70bec3a0540946b77fb76f7c1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a+b+c@example.com',
    authPW: '269182395f8962b9a759ecaa28c514d95fda440f1263f4644944c6568e251a16',
    authPW2: '78c98d3d5449e5c693d9f6803dfd93c4650034c413066466814f75640c15743b',
    wrapKb: 'f924e750e60e5538af0a8fc878b96c1719a74a7a67c6f1d24071180d2fe86aa4',
    wrapKb2: 'eb2c8fe4dd641c76e9905992b8a3145f7f5ca9b9b9a37017859024e8936588af',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b67e3ca7bcd37ee63ab27aefc55f6c6b98875a826a3a2c2cb0983e64c3b72866',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'Ӓ@example.com',
    authPW: '7beadbd67df714ffd6d8dfccaa12581c20ff9ca7731d3c5a2cd5c2f446a0a2f7',
    authPW2: 'd3f208f73cf5d0ee5cafd73925f88b307ef78a7c52ba7a5defea23de76e009c7',
    wrapKb: 'ddc1e8ada51f6263c7994ca50b583fc568a096d873bdfed2a5f071967ab7cd0d',
    wrapKb2: '056958aadb12fffc41e3e670a5a13f7da43c90d37674ef0baea2c662604b0f64',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:68f2b8d035dd452e7cf0ec0a5ee41b9aa7e316dea9158e25d7c584430197bd5e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'test@ᘮ.com',
    authPW: '17d4852faad2624771bbb85bcf3314beab8313dc1ceae8759dc219d5fae2ae80',
    authPW2: '0ff55eb80fd6ceebb7b7a8dbb26d2fb17a9d389e48a8b3de08f865dfbb29ffb7',
    wrapKb: '484e27f89027ab4fc56f8af8407639f2363592c252ee19f092d03103bd0d7e7d',
    wrapKb2: 'facef57705ded747616201bbcaa4d598af5e2245506c9e52aa8e96a216954e3d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b620f0fd8ab0e323d7e8048d3244b7d323a2f9c1635af7aabddd14aa56f9f346',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3f48eb949e704b6abc3e4041f685a8bb',
    sessionToken: '510db0dbebb36866fd4f8e6ae9c75ae7c110271cd304dfc121ed4bfb0f09d05c',
    authAt: 1705108757
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="95c3a222571a791db2051f9c047a43216c048dd962baed7a41884e6353ab5aa5", ts="1705108757", nonce="V7WSnX", hash="fcu/BXNlDJ7JANb4wM6s8vKowP5xuFTgvNXWtt7iNG0=", mac="4UVyzD30kkTmR66ZHQtfgVuKWvfJglQCUnjanLdGpcg="'
  },
  json: {
    email: 'a+b+c@example.com',
    authPW: '78c98d3d5449e5c693d9f6803dfd93c4650034c413066466814f75640c15743b'
  }
}
!!! response success {
  body: {
    uid: '7d76021f8795461d8d22af030769fc70',
    sessionToken: '22434fd95433fa7dc0acc5233fed6ad042c0e52ea71c4f8840f4c225cd6ec186',
    authAt: 1705108757
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="677bb2cabf729ccd747117ae7162adfbb2f2d84a0ff768a1ecab835c04623a1c", ts="1705108757", nonce="cPHd0M", hash="bKMNSHlwaZrKc3SfWjSxH1HPKQ5CSfc8R2O22hhNKhQ=", mac="etlCO0s6a5TT269gj5Jlm7j8xEGML4XOnRQPpBpdx80="'
  },
  json: {
    email: '#!?-@t-e-s-assert.c-o-m',
    authPW: '3ebf01b30a2bbc1d3d429fa64e2ce5244d0ad76073763b4b4675c7d95830395b'
  }
}
!!! response success {
  body: {
    uid: '933db46a5c8746678022b4a7cf7beaaf',
    sessionToken: 'e27234110792611cb0f36911424bea521bb440784998280b355acb77d8af5286',
    authAt: 1705108757
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b922d7f67deffe29df98a6a2c75c9424a564a1e8569d4435a5f361ada5887114", ts="1705108757", nonce="5Ps6ZL", hash="fAElie50hk3u7alf7/yzIZJFPKIvtjJXhBmPbkTJkpQ=", mac="s3tSIuYFxvpmilkeSIeEi0fkipWvXdFwwchJduwumHM="'
  },
  json: {
    email: 'tim@tim-example.net',
    authPW: '8fbb558dd498837f83a4f938e75fb28ab99a2704333553074adad2db00a8e08f'
  }
}
!!! response success {
  body: {
    uid: '84b5f9b72a6b4b5db77535939b227050',
    sessionToken: 'e2fb2f7e2aa4f84c32f7107cd459972652f1f6ddd72cc08602ed0fea114b96ca',
    authAt: 1705108757
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="35671488a294e6ed508e9fa8efebe7ee3b3452da945b8b8b2e0f3fdb79539fab", ts="1705108757", nonce="-7JjCy", hash="EOMz5A8W8nXWnddi5dgH6dw1nuRyIzpzDah5CI/corE=", mac="xSGDYZBEGAil/g8JiG4kAdhi37ajuewYG13QMyb1T+A="'
  },
  json: {
    email: 'Ӓ@example.com',
    authPW: 'd3f208f73cf5d0ee5cafd73925f88b307ef78a7c52ba7a5defea23de76e009c7'
  }
}
!!! response success {
  body: {
    uid: 'cfae6d6db4484653bf52b8c148f2d334',
    sessionToken: 'e41bf68dedb65539f720b6ce5def1bfd3e016af25777ccd53a4dfbf9cd7e6b3b',
    authAt: 1705108757
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e2da2fe0964b853bc5b2d951c3da85ac7435704f8b91df5abfa29d93713e4a5f", ts="1705108757", nonce="d6HL1D", hash="5wdLhgqIpdrhTFiJEYbAbLe+CBL9oMkf3XeEFB5BJDs=", mac="PTM7fpOIpuTarXlvp8z5qiXi0mynSudVUvAlW2tnQF4="'
  },
  json: {
    email: 'test@ᘮ.com',
    authPW: '0ff55eb80fd6ceebb7b7a8dbb26d2fb17a9d389e48a8b3de08f865dfbb29ffb7'
  }
}
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
!!! response success { body: {} }
    ✔ /account/create with a variety of unusual but valid email addresses (928ms)

  #integration - remote flow 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '14d9dc0e10af67e8440f@restmail.net',
    authPW: '92ac2a2f60829ce11d7325eb15b4dd1d1ca11fca7b928a95889f86812ddf17ce',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7c7d0181988d466c929e6888c3088535',
    sessionToken: '6049a52ee5af5976da2bf48da80e4c6c4305369dc8cfb03e7d693d624dc70765',
    authAt: 1705108757,
    keyFetchToken: 'f7c41accc864834ce57cc050e86f54b77f28e6aa379451a7989388f5fde6f63a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7c7d0181988d466c929e6888c3088535',
    code: '35b6a8cc5b7268b147fc545162cdd1d4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="423e7a948ca23272642d37be9c13879187aa48ef1ae5a0bcb5ddc5726fe7118e", ts="1705108758", nonce="32fPQU", mac="VMiHMTRQnnWjlaC+KtaPcKxTpVh+8HwRrwUbauKF+C0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '0163ff055ddaef2b343c98c30652cba3489398ba9703aa9214ee0e5e0277823292d7dc9f8d4a8550ea5fb48225e33a40a407d01d0bac530608565fe5a234c307f2dbceb04ef0dd2cab75502f8219954c3ed0d5c1adc7d92872e297cafc7e9bd2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a1da03d6654fa5db0b119f576487ed34bfb6c6f7cb1872d78cf9c193dd068dd0", ts="1705108758", nonce="xRAXGa", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="u3VZ2foqRcgy3ec7YSr36skHu2xt66Z31KocgunWcWc="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiN2M3ZDAxODE5ODhkNDY2YzkyOWU2ODg4YzMwODg1MzVAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzQ3OTQ1LCJleHAiOjE3MDUxOTUxNTc5NDUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzU3NzkxLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc1NywiZnhhLXZlcmlmaWVkRW1haWwiOiIxNGQ5ZGMwZTEwYWY2N2U4NDQwZkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIwMzMwNGE4MzhhZWU5ODIyNDc1YmQxMjBmYjlmODcyZCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzU3OTA2LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc1Nzc5MSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.J3XJPo1SYGvozf6N63beGpCpV4s8lRdKGtH4eYfaplC-fi4fwzQ3UjfIQfxTsUPgaCvsvmK9eWckPB-oUBxqKKKNsJsYo-MYxXdpmGRGuErviVhnU4QL8arFDyjEwj1jB3RDTmQDfl2X5jHOCeW2V_1P7FUxtEi4S2gsnbw1xC9Sx2oqvWaRpgIiF8wWrJSv_4ZKWHHfW0Bn3BlwInuAfVKwcgy-26YZMJaNWvqi7Jo466o4PinceiKW7aTpp1Ty0n_kmfjF3lNpu_UMcXkhhuq2h87pf7MfAmn7VrWGJp0YIwbDNx7XaCNGY3JuaMoDzrt5YF5FNapG3uF62xn2Xw'
  }
}
    ✔ Create account flow (312ms)
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '14d9dc0e10af67e8440f@restmail.net',
    authPW: '92ac2a2f60829ce11d7325eb15b4dd1d1ca11fca7b928a95889f86812ddf17ce',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7c7d0181988d466c929e6888c3088535',
    sessionToken: 'daf1f9fd8f7aa977c5467dbb99f2dcb9cc4ad8b87209c5c006ca5f1406ed104a',
    authAt: 1705108758,
    metricsEnabled: true,
    keyFetchToken: '515448708f2e027f6a6fe49ebcb7051284a2a0789179e7a8a15baf535f235c8a',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="15863380424b85349c59db3a4c4d716c3ab9291e074c562c746e2819f60ee080", ts="1705108758", nonce="IYWui8", mac="f7y35U1DL3XujONMnI0K8waB8lMdum4FBibXlfCgze0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b4fa265d7f134c3a9ac5d7bf294160b043ad84d0a20de410f1b0f72a82cd10b5544d252100f055b93f95836fe5c91ab6435f13ac0fc37525e2c98ff220ff44ed12527bfa8365c293e677987b8747741c3c08206a9101369cba5ad91f46a03790'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9363865452367cf405a8da875fc57af184b49cd162b3483f13c1ca7c52cde435", ts="1705108758", nonce="b5CWAE", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="rr+Tncxqh4kKQovuhThZV7OynoarBIWKS81i15Skazc="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiN2M3ZDAxODE5ODhkNDY2YzkyOWU2ODg4YzMwODg1MzVAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzQ4MTcyLCJleHAiOjE3MDUxOTUxNTgxNzIsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzU3NzkxLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc1OCwiZnhhLXZlcmlmaWVkRW1haWwiOiIxNGQ5ZGMwZTEwYWY2N2U4NDQwZkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIxN2MyNWUzNDY0NTJhOGRhY2U2ZDMyNDg0YjdjOWVkNyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzU3OTA2LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc1Nzc5MSwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.GhmkgMKYAHGwcmE_4qwhNJtecGrj3BWS3Evb9tmkSWO0AqW0ztEH9laMg9NXzM1iNvfIXS1untKv-go3LKBbOjXWToQBO9FFe-Z2Q4NA4I1NSJdiWgjHt5WDr-CyocCKCGfVdJdo3SNgS5_zbmQ5mgU7JVQuCsznRdhOEryF2QrU9xZmWK3hWwHk2USHesJ4fDsn2-0T5VIoKs5eJBYt-QXD-spyPvfGyGiYWD7YImWBEj7iD6A8r9obFy56HSKamGfEVfaEsmHAj-kn4Sdc8WH1ptankIE_QEM2HVOZESY6h45KfwItMS7VjNJjgH5z3-fhju-E4TFlYVIDhFdjkg'
  }
}
    ✔ Login flow (226ms)

  #integration - remote flow V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cf002d3e5f1cec383855@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cf002d3e5f1cec383855@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf002d3e5f1cec383855@restmail.net',
    authPW: '29f562b574f3a5744c7513d6baf90fc0fd6502ea73e88d3e4ddd8a8ba8eb12cd',
    authPW2: '022881fd97fb866f25c20a1811b45c61e7543b2cec1a373e7117fed5a6ae5e56',
    wrapKb: 'f7e65e6ce13c673cb05f4d219d6ba193fa8d2e1b88c58283668f7e0b0d3aebc7',
    wrapKb2: '1550156c815c015e6237cdc0458a66a6b7a5e04d95fd10cfb184db6a63300c80',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a220b2e059e5f2fc2a67d86568b965ce4b0427c1be826ad87ea20340a33e71b7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd8a382b3ffa04363ad0c7f4af6b72a93',
    sessionToken: '39831224e74cc20701fa07444b390c18482ef7057ff253aac6feb65f640818e3',
    authAt: 1705108758,
    keyFetchToken: '5578ef9e53499a07e3096e387181fd7d2c0dd2143132293aa4b84e49ca44a201',
    keyFetchToken2: '3ab4daae516493ea9a5e35df0787e2908e6bb49076c79a56079e8d58e6582e85'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd8a382b3ffa04363ad0c7f4af6b72a93',
    code: '71bc2e4f91ffcf33d07525e2b0622a1c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7b11601aa851426047d0152cbe2fbb234df373d190ba76d666031a028a399062", ts="1705108759", nonce="TpUFPK", mac="tZpVmWroo2RzwA9ejcAusdkBBds+XNocvPdNlB5b7Fc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'dcb3caaf42e8c1f672c1d4b20bdd87dd31a70a3fb3027fa4b231678893cf0de36f281fb55a32634932a35918bc3d25ffaa02cb24193993830b3a453494a6d8dbbb7058ab01e34bed13c1f6bb75efa49fc92406aef8d1ef06eaf29e129f9874af'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2d3b1a08b4776132e1c59e44bfb34d07f01945f930a519d543874d6f05dfb816", ts="1705108759", nonce="_oycGi", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="Fpb/YpInPXYlcfHv//HO8uV3357pDlcfzw1Vc3j6i9Y="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZDhhMzgyYjNmZmEwNDM2M2FkMGM3ZjRhZjZiNzJhOTNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzQ4ODA1LCJleHAiOjE3MDUxOTUxNTg4MDUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzU4NjUyLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc1OCwiZnhhLXZlcmlmaWVkRW1haWwiOiJjZjAwMmQzZTVmMWNlYzM4Mzg1NUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIzN2FhNjgwOWRiODM4MzBiYzQ2M2NjNWFlZTYyZTAyOCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzU4NzU4LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc1ODY1MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.OybM_Qmv52qxHEFoOG3P6YvzfAoG6zVWsxoror5DGfs9hPE9mZFP60AIB37xCW7KbXJEyhAY6O0hr4yxFBFQO8kd82YgYMZjiUrg39og4fykCziKbTF0KhEApOSEToTb0itkn0VlIq9fWv6nCvhjeqix8ssaJgSeU07sTIHKqOVw1lrrYDlypRYpzl7GMgPnBPJiS8XpqjZilCvd6IZTUL1XZE_JepasvT0oqNgPhzYD444LqIZtg3mo7HjwtCZ9hBKFA9z9D0zGuc7Dr3uEVcicXrx0c3EAmhG4siP5KYr9tpN1tjTWmrET0TH2p5nbDzQPZIsL0H75351vYVMWQw'
  }
}
    ✔ Create account flow (577ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cf002d3e5f1cec383855@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a220b2e059e5f2fc2a67d86568b965ce4b0427c1be826ad87ea20340a33e71b7',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a220b2e059e5f2fc2a67d86568b965ce4b0427c1be826ad87ea20340a33e71b7',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a220b2e059e5f2fc2a67d86568b965ce4b0427c1be826ad87ea20340a33e71b7',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf002d3e5f1cec383855@restmail.net',
    authPW: '022881fd97fb866f25c20a1811b45c61e7543b2cec1a373e7117fed5a6ae5e56',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd8a382b3ffa04363ad0c7f4af6b72a93',
    sessionToken: 'ba2e5660dd28f5d4328c76fdd706a2baa74ce0aa396e2a0cac25d61e272d06a8',
    authAt: 1705108759,
    metricsEnabled: true,
    keyFetchToken2: 'f5a62047f902a2be2959c5ddd32a02ed86c6ef761467c327e691c8167e87be02',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b72ceaaa8d1a91d603346260c94fc785349e8982384063fd332aaeea8287475b", ts="1705108759", nonce="OPUS2M", mac="fZMjxgh2ZYdb4bXfXOWEc1Gtu6NaYIq0Y0uX8L7gCmw="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'e955523c02dcdfbf253b4265048d8c3affe88e504f754c6ff103228ec152cf09392aeed3bdb593aee6e68a60a95eaa6a191c74f2e0449ea7425fc9be7c049b685f9832b26fbbb6d489a699bdf93815b1159a62b5c31ea09e304f7d4f3e5a0dc3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a9c3bcfd13aa1349e6160598971876554a33d3d8980ed7008803faaa6b6f686e", ts="1705108759", nonce="ACNApr", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="LwgkceqO6vqqV09FkoJFNAe9Yr0ASBAowXkc5q5Dw2g="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiZDhhMzgyYjNmZmEwNDM2M2FkMGM3ZjRhZjZiNzJhOTNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzQ5MTc1LCJleHAiOjE3MDUxOTUxNTkxNzUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4NzU4NjUyLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc1OSwiZnhhLXZlcmlmaWVkRW1haWwiOiJjZjAwMmQzZTVmMWNlYzM4Mzg1NUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIyMGUzNTMzMzdmZjlmZjc0ZGI5NzMwNGFjYzMwMGE2ZSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzU4NzU4LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc1ODY1MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.n7xTzJvXtWWpWrdKBGNt6NqVnSBCCqGI1qAHxn6Oac9dVlCyTztP2w-J1GwlBIAvYWitHmfVki0FHSkqdVd1I4Z8FMcJ8YuKHGyZfYaWbV9KsewKWJyJNVHDsjQdJBeXjR8jxMtBOybf1bVulHp39aOvdmtC1aCT7mKvL1HBsOPcr6lCQDHoFUOIcXKAn9Wj869EVCWZG0KCH1D3AnTTqOTf7Kf_kPP7k7175BL3VY10GwSf59EZ_DQtoPbl8ujTYot8wJhd7OPfqPCak0TrwKGoaYv8EmQdxHf80THPZ6fIVOfADZW-NIyetHZ887rbZePSxeDfX7uTKKNt4f2jFw'
  }
}
    ✔ Login flow (371ms)

  #integration - remote misc 
    ✔ unsupported api version
    ✔ /__heartbeat__ returns a 200 OK
    ✔ /__lbheartbeat__ returns a 200 OK
    ✔ / returns version, git hash and source repo
    ✔ /__version__ returns version, git hash and source repo
    ✔ returns no Access-Control-Allow-Origin with no Origin set
    ✔ returns correct Access-Control-Allow-Origin with whitelisted Origin
    ✔ returns no Access-Control-Allow-Origin with not whitelisted Origin
    ✔ /verify_email redirects
    ✔ /complete_reset_password redirects
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f795f6fcf44c7ca0f467@restmail.net',
    authPW: '9f2ccac0aa4a6f5f972c5d8b880118b756893a3ba8a120c6526832654ada009f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6de8b4f124cf49bcad02eefda2119575',
    sessionToken: '620bf562c3b6e112ad7f564a3f708ee5767dce3367430966051f910a967c2215',
    authAt: 1705108759
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6de8b4f124cf49bcad02eefda2119575',
    code: '34338187f2413e01741d8045b6a889e8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f795f6fcf44c7ca0f467@restmail.net',
    authPW: '9f2ccac0aa4a6f5f972c5d8b880118b756893a3ba8a120c6526832654ada009f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6de8b4f124cf49bcad02eefda2119575',
    sessionToken: 'ed0a35fceda96fc0dba6b8da7488327b0820090624047f17198817d89e6f75e6',
    authAt: 1705108759,
    metricsEnabled: true,
    keyFetchToken: '8dbceacccccb833eaf47f1bae527b183e3a0d543587c88e6d0c6bac5bc972ef2',
    verified: true
  }
}
    ✔ timestamp header (448ms)
    ✔ Strict-Transport-Security header
!!! request {
  url: 'http://localhost:9000/v1/get_random_bytes',
  method: 'POST',
  headers: {},
  json: {
    big: '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'... 6384 more characters
  }
}
!!! response err {
  statusCode: 413,
  err: {
    code: 413,
    errno: 113,
    error: 'Request Entity Too Large',
    message: 'Request body too large',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ oversized payload
!!! request {
  url: 'http://localhost:9000/v1/get_random_bytes',
  method: 'POST',
  headers: {},
  json: true
}
!!! response success {
  body: {
    data: '06b87b791cb9c0d97b6bcdf18a094f257ed3afb0f5eaff9269d6ca4b7323df70'
  }
}
    ✔ random bytes
!!! request {
  url: 'http://localhost:9000/.well-known/browserid',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success {
  body: {
    'public-key': {
      kid: '2023-08-17-cdcda93ba703fa1eb268d59fca757591',
      'fxa-createdAt': 1692295200,
      algorithm: 'RS',
      n: '24402106835914588272172438660953064761631464285807547766135727454026592713456788944047682835197409965456368254362566696343199026750152562895855655674844782849511233850426234918478872525525771227543068341414023801974962331147421679273924458198798688306853916496927103667575709685335666773530065093508494483979247024831179570653693996964985536596434262893936059506886894551865685141916843850154501205172680262451870697425424419260607234110402000514255022067836771466383784585839921589259182647751265164798261967218874616055533979127023131238953839428143864985728089562477283812871359915746474430260361922800874163392913',
      e: '65537'
    },
    authentication: '/.well-known/browserid/nonexistent.html',
    provisioning: '/.well-known/browserid/nonexistent.html',
    keys: [ [Object] ]
  }
}
    ✔ fetch /.well-known/browserid support document
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '77853c047059566fd7e3@restmail.net',
    authPW: '071ff4fafd3289424d1ea6436f8e4b3ad3d0e34b9ab58e3c91ee8818633fcbd5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '91f7fa24b17f4531bb8ce48381df21e6',
    sessionToken: 'e7d8f473d6b3d23299e7868624ba4d6d3830aa615fb7bf675b7ff4a782f51afb',
    authAt: 1705108759
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '91f7fa24b17f4531bb8ce48381df21e6',
    code: '2faaef774d66561db427707928d70e14',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ fail on hawk payload mismatch (230ms)

  #integration - remote misc V2
    ✔ unsupported api version
    ✔ /__heartbeat__ returns a 200 OK
    ✔ /__lbheartbeat__ returns a 200 OK
    ✔ / returns version, git hash and source repo
    ✔ /__version__ returns version, git hash and source repo
    ✔ returns no Access-Control-Allow-Origin with no Origin set
    ✔ returns correct Access-Control-Allow-Origin with whitelisted Origin
    ✔ returns no Access-Control-Allow-Origin with not whitelisted Origin
    ✔ /verify_email redirects
    ✔ /complete_reset_password redirects
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3ed2a63facbd1816b6f3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3ed2a63facbd1816b6f3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3ed2a63facbd1816b6f3@restmail.net',
    authPW: 'ad4b8521194de361aa6161ff71eb377484c9111752ba226da9479d6ceba07f18',
    authPW2: 'df8f3884f5bc6b2c014e497a913eb30912c8914a337128f41ccc60ceaacfcecd',
    wrapKb: '9da65f372c7c9a4bef373423415c426554a4df3d236431b674fc4fec3423241a',
    wrapKb2: '7fca8b242fdb339c0f3a9107742aea84715b13e4c0bed1fa490108eabb882379',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:223e2ccb6315bda13ebaddc91a8c170fc3049373bef1c8d9b7cba4d4a5920280',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'be1e64b86ebd484eb04ce91c0cc692fa',
    sessionToken: '3bf8e3b68fa6fdffc60057dcff2a038898f917ee540f24c77106284a1af94e35',
    authAt: 1705108760
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'be1e64b86ebd484eb04ce91c0cc692fa',
    code: '2dfbcfd475333a2c0305a7fc599b34a8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3ed2a63facbd1816b6f3@restmail.net',
    authPW: 'df8f3884f5bc6b2c014e497a913eb30912c8914a337128f41ccc60ceaacfcecd',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'be1e64b86ebd484eb04ce91c0cc692fa',
    sessionToken: '5b1ec3640f8eced7e0adc79bff9f4123d9abc225d42d271ac707e334090a3256',
    authAt: 1705108760,
    metricsEnabled: true,
    keyFetchToken2: '67cd54e22ca30388d52459306e916bf26cd027e4a13429841971d6b2e759e5a7',
    verified: true
  }
}
    ✔ timestamp header (700ms)
    ✔ Strict-Transport-Security header
!!! request {
  url: 'http://localhost:9000/v1/get_random_bytes',
  method: 'POST',
  headers: {},
  json: {
    big: '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'... 6384 more characters
  }
}
!!! response err {
  statusCode: 413,
  err: {
    code: 413,
    errno: 113,
    error: 'Request Entity Too Large',
    message: 'Request body too large',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ oversized payload
!!! request {
  url: 'http://localhost:9000/v1/get_random_bytes',
  method: 'POST',
  headers: {},
  json: true
}
!!! response success {
  body: {
    data: '49b6d643c507b754224f00b88797a1198da62dfd0dee50e9f39b8a0b70d94756'
  }
}
    ✔ random bytes
!!! request {
  url: 'http://localhost:9000/.well-known/browserid',
  method: 'GET',
  headers: {},
  json: true
}
!!! response success {
  body: {
    'public-key': {
      kid: '2023-08-17-cdcda93ba703fa1eb268d59fca757591',
      'fxa-createdAt': 1692295200,
      algorithm: 'RS',
      n: '24402106835914588272172438660953064761631464285807547766135727454026592713456788944047682835197409965456368254362566696343199026750152562895855655674844782849511233850426234918478872525525771227543068341414023801974962331147421679273924458198798688306853916496927103667575709685335666773530065093508494483979247024831179570653693996964985536596434262893936059506886894551865685141916843850154501205172680262451870697425424419260607234110402000514255022067836771466383784585839921589259182647751265164798261967218874616055533979127023131238953839428143864985728089562477283812871359915746474430260361922800874163392913',
      e: '65537'
    },
    authentication: '/.well-known/browserid/nonexistent.html',
    provisioning: '/.well-known/browserid/nonexistent.html',
    keys: [ [Object] ]
  }
}
    ✔ fetch /.well-known/browserid support document
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7b81dfce33d1f6a85b96@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7b81dfce33d1f6a85b96@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7b81dfce33d1f6a85b96@restmail.net',
    authPW: '920804e05612ae35687ba25e84c818b2eec590e3fd1f3fa0bb52434c2da4aade',
    authPW2: '1948194e4dc75e8e0b4b86b5bd07ec5f90ef68e523a76731e89a34c0be759690',
    wrapKb: '6d1b8716b1985343eabcedb6748f57be006a847d39b2416bc22cfdaa76191471',
    wrapKb2: 'ff8634ec8c3d3fe62fb11f56a382b3e62274f55c49386ea2ee89a80f89acf2a6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f403b7f4c2d61e82c09a4034b54d242fabcd25da03e690171132c6046e5f3081',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2523db7b30944939beb7e7c585e1c41a',
    sessionToken: '21db41b889a3892defc4e753824fc7459f3b5f7d6def2fd96cdade52d6a6fa14',
    authAt: 1705108761
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2523db7b30944939beb7e7c585e1c41a',
    code: '56a50c12182e486e6b8b7ef835c95dfd',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
    ✔ fail on hawk payload mismatch (484ms)

  #integration - /oauth/ session token scope 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1fdae1d5265dd467080f@restmail.net',
    authPW: '0b19ba4717a39f248be8f2fd271c92c368e8c664710fc5d9537ee47b74a025bd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'aad4d60ce4264b018920fbee40bb6c11',
    sessionToken: '2065aa37731500169d84267cb2883bd70d8b0c66f633f7749e356f3cbada862e',
    authAt: 1705108761
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'aad4d60ce4264b018920fbee40bb6c11',
    code: 'f8d32146a32a8aeb1bdc9fd7f929d1e7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="05ba63c4a81b81e26f8d0dbb2b57f999b4f495ffde8701de61baf1b83b3b1f54", ts="1705108762", nonce="WvZTYJ", hash="Cz/5hHryw8lvBXELbkAhGiZ1uAEz3hkrj6ooqdDWAVM=", mac="cBh1GyWp2EY7MENc1S7kw3hWFAWAvpEIX5BMNbOSOHU="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: '24c05d36f6ec95b81c2acdbc0996047595c973e78ec623b2ad926d9b8dab88e4',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=24c05d36f6ec95b81c2acdbc0996047595c973e78ec623b2ad926d9b8dab88e4&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '24c05d36f6ec95b81c2acdbc0996047595c973e78ec623b2ad926d9b8dab88e4',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '0949a270fe597913b79c03621a99f686e0ccfe3fe030542429ba7911415ac9dd',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/tokens/session',
    expires_in: 21899,
    auth_at: 1705108761,
    session_token: '2a872d9ec10e1f32b8654257744687a0e8554e6db32a7705523190bc7ab108a9'
  }
}
    ✔ provides a session token using the session token scope
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9812a72d5194f353145c@restmail.net',
    authPW: 'f4530627dfea3a08d6d3a20fc915be4bf520a0ad15481b45d59f3289e534e3e0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd267cfb5f33d49329a33bfe109475b28',
    sessionToken: '384b9c5a2b1ec28cf098e2df527300bb135f7a610fd997b03fdd1ac51a1d1583',
    authAt: 1705108761
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd267cfb5f33d49329a33bfe109475b28',
    code: '14ae8667d05b609ab168bae54318498a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="313626bb74e51d0e74c2acf5545809e97d027d04325582abdb82dc07de332d8a", ts="1705108762", nonce="qx-Bn4", hash="5XlPyoz4Iwc6EZgsws+hdACcy7Agq5w+1oIlMPMnePw=", mac="To8kgNcE6ntcUiNUIZEjWCM02BpklkvxoooYj89j5dg="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session https://identity.mozilla.com/apps/oldsync',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: 'ce7d51c045e358d59ca73c7dc9a1b90d21beb56e0d379d0212b6fad542c7b887',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=ce7d51c045e358d59ca73c7dc9a1b90d21beb56e0d379d0212b6fad542c7b887&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'ce7d51c045e358d59ca73c7dc9a1b90d21beb56e0d379d0212b6fad542c7b887',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '49c995a0395f449e1c5ab3879f4acd2cf097a4c1710f1aad66a21b777e4ef45a',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/tokens/session https://identity.mozilla.com/apps/oldsync',
    expires_in: 21899,
    auth_at: 1705108761,
    refresh_token: '7b6242d234ee713fba620479b42af1b4be3e1bc95f31b6a4cff52dec82ad7fb3',
    session_token: '2d81c4e704db8b13056ee96ccca5f751de871ed0957e502705351530d08386ca'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="313626bb74e51d0e74c2acf5545809e97d027d04325582abdb82dc07de332d8a", ts="1705108762", nonce="dOCaTR", mac="DwA++K82Mp7OmV+xM+z0qwegTY3pTeTHIjytW2FOaaE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: 'd355c656c8313c6342289ea8fab048eb',
      sessionTokenId: 'd301dd2876d648e21e3b6af9d824ada5200e3feb6ad1f78ee5ad5b505089c07b',
      refreshTokenId: '82a551eb235fa6bda44e6e81a92994323266959cf3d7f6e23c8e58c9e3f0a443',
      isCurrentSession: false,
      deviceType: 'mobile',
      name: 'Android Components Reference Browser',
      createdTime: 1705108761000,
      lastAccessTime: 1705108761796,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '313626bb74e51d0e74c2acf5545809e97d027d04325582abdb82dc07de332d8a',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108761708,
      lastAccessTime: 1705108761816,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ works with oldsync and session token scopes (64ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '483b061edccb9e9d23da@restmail.net',
    authPW: '3c452b73b3731c4b08cf407792079a956049f45782b36713b893ec72732b0512',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9a90a0418aa54f8fb7cabecf3286b8c8',
    sessionToken: 'd5e571717732acb61d5f436123171f43cc9d663c967e4bcab19a5c4792a62b2e',
    authAt: 1705108761
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9a90a0418aa54f8fb7cabecf3286b8c8',
    code: '7104e1013a689bf301f5ffa012cce264',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="57f4d7e4229a22b6323291ad73b189d1f85c48f40633dd59b9a66a30fc97afa5", ts="1705108762", nonce="Esg0om", hash="Cz/5hHryw8lvBXELbkAhGiZ1uAEz3hkrj6ooqdDWAVM=", mac="hViL8UJYC8vbTvE/k4MaPiCukBYwlz/LHpguPagyw88="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: '18d1772924048f14b7d0a4334ebfed1c820f834e29b8300cae61ae7e6892b12c',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=18d1772924048f14b7d0a4334ebfed1c820f834e29b8300cae61ae7e6892b12c&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="57f4d7e4229a22b6323291ad73b189d1f85c48f40633dd59b9a66a30fc97afa5", ts="1705108762", nonce="eY5mUM", mac="2f2lr40DDdZZapbZ9EbQEwJDhXxqwvbmINOLmRtMtgI="'
  },
  json: true
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '18d1772924048f14b7d0a4334ebfed1c820f834e29b8300cae61ae7e6892b12c',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    errno: 172,
    error: 'Bad Request',
    message: 'Unknown authorization code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ rejects invalid sessionToken (45ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a836ba9e3fe869a37e14@restmail.net',
    authPW: 'd975d61cb085c52b71df484b0975da8e2c7ec0e71e4591cfc15221ced2d10af2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '65714d9f4254415fbe93a83201ad3802',
    sessionToken: '6606332ee419fdea6f0f6227d9bef6be283cedfdcb56c522ef2eac54f45dd12b',
    authAt: 1705108762
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '65714d9f4254415fbe93a83201ad3802',
    code: 'd96bc438403ffd053b80a17f5472a06c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c576173b5674b7e4c78f301eb10f5e41960415a53b9095708f0cf6de97d4c868", ts="1705108762", nonce="UNCeuw", hash="nQQACkfkYl7o0jbkEKAonDYJV2XhwP+qaDhOsnQxLbE=", mac="BXcns0FyeivD5bL3U4kgRrRJayLfu+5GIVBu0ETMbbg="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'profile',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: 'f857b5abd41fe374b61d829f403bcf17bb66e96b945c15b1fb972802a70570da',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=f857b5abd41fe374b61d829f403bcf17bb66e96b945c15b1fb972802a70570da&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'f857b5abd41fe374b61d829f403bcf17bb66e96b945c15b1fb972802a70570da',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: 'e300e2aea046130436c3429edd92ff9b1ec9934b30ab61da6a5a97a91a6e8c52',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899,
    auth_at: 1705108762
  }
}
    ✔ contains no token when scopes is not set

  #integration - /oauth/ session token scope V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'debf293c4eb2aeadcb60@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'debf293c4eb2aeadcb60@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'debf293c4eb2aeadcb60@restmail.net',
    authPW: '27ac8e15b558286edd366deabda6cc27a33d9e28abdba3e4485b137da996623a',
    authPW2: '054b68421306570ae7849e4b93c0a6cb001b7cf781f8e4e0e8bc05161022f884',
    wrapKb: 'fcdbe386ba3bf0f3a81b29c724c69e01402481e321ad0468ea64e9cb63076a03',
    wrapKb2: '0e036ff8a7eead63c0f22dae70e7fcebe9fa2e1a5043e08dc2a91cffe3062c72',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:237b53de7e95677527249fddcc3a98cbe0bbb5e69fad20286ee07d8dd4ce3d64',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c533e280797946e7a8b088520f7c2ab0',
    sessionToken: '8517dc61c7906ef70e709dbaf7c5d04e102710cf6497bdce2804a3b69ec77fb0',
    authAt: 1705108762
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c533e280797946e7a8b088520f7c2ab0',
    code: 'b2dd2408598cf627afe546813970f263',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ef01c4601d480509145fc544eeffc0db86a07035b74a9596e4f485705e6f1d91", ts="1705108763", nonce="rO0HLQ", hash="Cz/5hHryw8lvBXELbkAhGiZ1uAEz3hkrj6ooqdDWAVM=", mac="ZQeZQ9b25Luk66SZsk20dpn+/aWqYEUQ0/h+srr9sHs="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: 'b03d507a8a2a7d2555e63be90b7abc0d5736b9837705067f0fe0732642970838',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=b03d507a8a2a7d2555e63be90b7abc0d5736b9837705067f0fe0732642970838&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'b03d507a8a2a7d2555e63be90b7abc0d5736b9837705067f0fe0732642970838',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '68abae412d1562537f90c02ab08827df2fea5accee0197b68c527c0f097e52bc',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/tokens/session',
    expires_in: 21899,
    auth_at: 1705108762,
    session_token: '4d46367d121b12c3ead4dca056c4f7a917ab2ed78754265f428b60eb20db1940'
  }
}
    ✔ provides a session token using the session token scope
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a3f1969b0886676d3f2a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a3f1969b0886676d3f2a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3f1969b0886676d3f2a@restmail.net',
    authPW: 'e9c361940f0152e09988e37584133a1d074e48c645f8597f44048d6af4e0aedc',
    authPW2: 'b5cf2098f3a08ed6056e47c97e2734c9a58ed63b3f788e45a7112794d00bfe5f',
    wrapKb: 'cd8b92cf17ecf908e3e65d2bcd763e1682a51b5d3484b8a3d90d909b27428346',
    wrapKb2: '58536a261e62a00de3ed6f54fb08b4a7f3a62cb5b4591343c69fcbb14456b13b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c3c74ebb44dc3e73e0fe4e3c4e97f7ece38ff926fb94695b90c50a7ff5a67aa5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '703afbba936b4d6095cfa538dcde1737',
    sessionToken: 'edbb96aa40331feecac2ad24bfd14d7f5defcac90ad1ed1dbcfca57c15cb23f4',
    authAt: 1705108763
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '703afbba936b4d6095cfa538dcde1737',
    code: '71f7540ca3d8e78f1daa62106a212a90',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="53b7a25e3339e4ac505a1537cd05ba596d8fa61672616edd4b6c9618c41c1378", ts="1705108763", nonce="fSdPQP", hash="5XlPyoz4Iwc6EZgsws+hdACcy7Agq5w+1oIlMPMnePw=", mac="EV4yKKfk31uCu/aYZVkZ8kovKKlFjfExZoMLv+pPI9g="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session https://identity.mozilla.com/apps/oldsync',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '2c48094522c42f080c9f8fd404a56a783fcc384323b49c4df3b4b481482e7f87',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=2c48094522c42f080c9f8fd404a56a783fcc384323b49c4df3b4b481482e7f87&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '2c48094522c42f080c9f8fd404a56a783fcc384323b49c4df3b4b481482e7f87',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '5829e1d1f423fd746d0d5031404485e053c7f58da22ad09370e71179a0c49002',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/tokens/session https://identity.mozilla.com/apps/oldsync',
    expires_in: 21899,
    auth_at: 1705108763,
    refresh_token: '6e2aea3e70b34582319e7c3879a9cbe6806ee23c4f5eb89db8440d5279c4203e',
    session_token: '06839592943b36bc78a2cce4d999cf9bdeeccac63c66d8097baa7cb78afe0263'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/attached_clients',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="53b7a25e3339e4ac505a1537cd05ba596d8fa61672616edd4b6c9618c41c1378", ts="1705108763", nonce="1ZIddK", mac="IGgzsrNnvqMmp3TXChewf0pvcqMlqsAMBIcue4/ePWY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      clientId: '3c49430b43dfba77',
      deviceId: 'c7e985ba81eddc4c64e405a6f47a5d99',
      sessionTokenId: '244124cc694d6f24facaa0ce6038f97a04d8a82213b4a1585acd7a85bfd03234',
      refreshTokenId: 'be574b757a656d582df355a5e5ef1134e9a3a3581cb7946a4d2fe358ab4ad1e2',
      isCurrentSession: false,
      deviceType: 'mobile',
      name: 'Android Components Reference Browser',
      createdTime: 1705108763000,
      lastAccessTime: 1705108763418,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    },
    {
      clientId: null,
      deviceId: null,
      sessionTokenId: '53b7a25e3339e4ac505a1537cd05ba596d8fa61672616edd4b6c9618c41c1378',
      refreshTokenId: null,
      isCurrentSession: true,
      deviceType: null,
      name: '',
      createdTime: 1705108763328,
      lastAccessTime: 1705108763437,
      scope: null,
      location: {},
      userAgent: '',
      os: null,
      createdTimeFormatted: 'a few seconds ago',
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ works with oldsync and session token scopes (63ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd048a6f2bbeb747b0f94@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd048a6f2bbeb747b0f94@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd048a6f2bbeb747b0f94@restmail.net',
    authPW: 'a157f9512ee6cafd0f5100b38fd9cfe6db4fe60a3c280967350864d664d04a19',
    authPW2: 'c7bbe093ef10e3426bcfeb6c95c2131e547c54febc7d0964c80bfc0c92fb3f6f',
    wrapKb: '1f25ea986d922672841b9105f116ce44e48c12ed12fa984ead31b94b38747292',
    wrapKb2: '855267913110e37d1063fed9a03754d7241446f0a83c7619a55cc0a47bcbbf44',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b6350c9e0f0b75f8a47231a4495dbaee814069cbfa030c4657ec163f95831e42',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'da41793a81d94e7695bb75388ce498fb',
    sessionToken: '6f3a771c707ad0dac9bc382ee2cbeede6fb6576c7defff71a1035fc445810659',
    authAt: 1705108763
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'da41793a81d94e7695bb75388ce498fb',
    code: 'dd41417ca64a9739163b3a69be8b6edf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="445243579d43b623d4170fe21f6cb7c38ae14c117ea4630712fc6b3d834d5241", ts="1705108764", nonce="7Pfawf", hash="Cz/5hHryw8lvBXELbkAhGiZ1uAEz3hkrj6ooqdDWAVM=", mac="pjVDqDHvn/RvVlVXZntyRaPdSu6ZLEdYy6G7PoYZHxA="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/tokens/session',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: '4eeb2f6d233f0ec17365d63c4811b5524c8cbefee7dbd38235f79b3f5b7c231c',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=4eeb2f6d233f0ec17365d63c4811b5524c8cbefee7dbd38235f79b3f5b7c231c&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="445243579d43b623d4170fe21f6cb7c38ae14c117ea4630712fc6b3d834d5241", ts="1705108764", nonce="vgRXZi", mac="HwToLxUDiXcOEIEMm2/9+gpfNH6Lqx5M+qTh3nWjFU4="'
  },
  json: true
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '4eeb2f6d233f0ec17365d63c4811b5524c8cbefee7dbd38235f79b3f5b7c231c',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    errno: 172,
    error: 'Bad Request',
    message: 'Unknown authorization code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ rejects invalid sessionToken
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a986cbb90de62e2e34dc@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a986cbb90de62e2e34dc@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a986cbb90de62e2e34dc@restmail.net',
    authPW: 'ebbaac66e312081c1c4ec9d33f7a4465f702b6f0bcf5faca931c15ff661a9555',
    authPW2: '78041c62a0d937cc0fa99a522626572b452b5bedede0c5e6dbdcef28028f3ac2',
    wrapKb: 'a4528878bb06a0779bcffb334173e48bacf4fc4b80fce0a8a6cb42f7339cc381',
    wrapKb2: '903dcf53f178bebc3be666c5c722f06afbd95be9b77441e0f073ec80076f4cd9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:98744d08aff3224fb012f1bc541742b39da156172c33a9eba8de2f9c3fffdbfb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4689c9e86fa4491fa502d79a37dfbbf1',
    sessionToken: 'f51da286092eba4ee4e5e9d1b18700c01bf28d84826c170794aafb3a463235ae',
    authAt: 1705108764
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4689c9e86fa4491fa502d79a37dfbbf1',
    code: 'bed3a9a6dd18623f7481376f7e4f988a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fa3c6de6e855f6e2dadcab26dddfbdca2cbbb445f75aa28314bc75be5e0fe105", ts="1705108764", nonce="vt-ebX", hash="nQQACkfkYl7o0jbkEKAonDYJV2XhwP+qaDhOsnQxLbE=", mac="8OxFAU7aFGtFajyIKhHIVkGgmcg3fjwhAJ6NhiZE9T4="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'profile',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: '11c47bbb638467219133425effcf4799580886b0c171a1092ce049fff6dd530b',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=11c47bbb638467219133425effcf4799580886b0c171a1092ce049fff6dd530b&state=xyz'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '11c47bbb638467219133425effcf4799580886b0c171a1092ce049fff6dd530b',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: 'ed025d95fbf23e5d853fccf5d4ef814cc88241936acc1722c11cd45180b1b01a',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21900,
    auth_at: 1705108764
  }
}
    ✔ contains no token when scopes is not set

  #integration - /oauth/ routes 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bf703e8f05c0563818b9@restmail.net',
    authPW: 'a9c3c00420162046c5a5e5e38bc62429b89ccdcca469ccaa01efca785dcae656',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5cf1495c5e334798928bb48f0d4c8136',
    sessionToken: 'd90d05e0a41367e285bbfb8da95ab5d108e2a93ce082e1d3960356fadd049dbd',
    authAt: 1705108764
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5cf1495c5e334798928bb48f0d4c8136',
    code: 'f953c1557d89b8497897e84a70c74917',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ce26f30b7a1bcd12cf83069ca1f08801578ce99133cfe93a63ec777c250a5c68", ts="1705108765", nonce="0GjJsY", hash="A1m4v8HyYZxRg9AaYvlXJxngGAHlit8VCmH2iHGwPfY=", mac="TkYinfEasWhTvfjgAG9Mcgvip/pmnpFPG4Qyl7Tn/UA="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'abc',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: 'e0230c85b5115a06204e18b831d1b6207263b20becb052561aad4285b3240b3a',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=e0230c85b5115a06204e18b831d1b6207263b20becb052561aad4285b3240b3a&state=xyz'
  }
}
    ✔ successfully grants an authorization code
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2b9b279f4a8ee6e3a85d@restmail.net',
    authPW: 'e463342b955a6583252df1dd5f877f581ba495c30d98c18bdbfacce78cb095de',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '04b0c13659bc4b14a2ed61992e777cd9',
    sessionToken: '89952fae98eefafbede0c35b75fe9b6dc9e21abc77c8e0746fd0d35bb3942f98',
    authAt: 1705108764
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '04b0c13659bc4b14a2ed61992e777cd9',
    code: '16b43c386eea3ca308ccc012106f2217',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d9557bda9fbc3f8187c976ea908fd8615479c8e74e071e19330e4150e9598cbb", ts="1705108765", nonce="-WLbVI", hash="4+0QDKlXTINoyY7fmsdkrJRA4RCSJX4wD3/zAcBKZuc=", mac="fgttiXPV/VKnEk4cPeaJl1AgsdeYTyr6j3/IF4Tb9Wk="'
  },
  json: { client_id: '3c49430b43dfba77', state: 'xyz', assertion: 'a~b' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ rejects `assertion` parameter in /authorization request
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '047b19b2b5bc47d7fc88@restmail.net',
    authPW: '3aaefbec632826a7d97d07c0005ee878c2e15b4b73d59a07b0d9636114d0efbb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4462c3d174924cd096c5e02aa9df7add',
    sessionToken: '8f94dd1d5de62272c642031559e0c60e1fef6395f4a5514de782b545e049dfdd',
    authAt: 1705108765
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4462c3d174924cd096c5e02aa9df7add',
    code: '3ae3e96e1bd9081273d621b49a8f4216',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="383f8732c1a5e699fa562af94ccb561f593d79780389c5d4e0879b10b9c36dc6", ts="1705108765", nonce="VjuNeW", hash="RjAS/0HE+JcRfHFWy+1Wg8YTCZviqnJmk/Z05s/liG4=", mac="LcMCw/GEwo3NyT4Fso8QfojE+aVImdozP/QX0755yXk="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    resource: 'https://resource.server.com'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ rejects `resource` parameter in /authorization request
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '076143545951f87654ab@restmail.net',
    authPW: '0189b098c00285ec19e7131e8ecf3476bda64d35a3a18e4cb8b71f5d1d3ab93f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e7806bb7ecf44dd69f194a1f1490d5ec',
    sessionToken: '60fb4872998ff0eef6731301390690d6ffe164652bcc6355ed4a8c35f8c00147',
    authAt: 1705108765
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e7806bb7ecf44dd69f194a1f1490d5ec',
    code: '910e98abdf232b3edede1950688ccb1d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d1248a883fde33c68987276da4c29780f08a932f60d4d97ca4044a67b60b6f62", ts="1705108765", nonce="IOQ9OB", mac="CgNDCn4U/OSWMvVusU0bDRuJcwCBnPtujZY84CyoGaU="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1248a883fde33c68987276da4c29780f08a932f60d4d97ca4044a67b60b6f62", ts="1705108765", nonce="-mkm7K", hash="08sObW9bMW9arVITw489FXvn2EgVIXMdjy5usEr0nw4=", mac="qymK7/oxyRWOQbAdNsJox94rtJRmVaE9z4ARTntUnmE="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '3c49430b43dfba77',
    access_type: 'offline',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    access_token: 'b5afd994e5eb5ac640dfb42e92a4f5dc31cf0d116a197e16a02042c63923b70d',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync',
    expires_in: 21899,
    auth_at: 1705108765,
    refresh_token: '4782647fdc01d3fe863a1d021e18ecaa46a5aac8053acc553ed3d07be235f075'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 4782647fdc01d3fe863a1d021e18ecaa46a5aac8053acc553ed3d07be235f075'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'c7b8242b4c64b157c32ef6fa401b5c15',
      isCurrentDevice: true,
      lastAccessTime: 1705108765461,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ successfully grants tokens from sessionToken and notifies user (43ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f89fd691b44f1c71fb90@restmail.net',
    authPW: '4451353b57783060c2e34c0913dd1456b5e0b8708dd4be55d429bf43fb4616e3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '130fa93c5b6b4ceeaef9b8a0ad70dc22',
    sessionToken: '625ea694d0bcfc3f5e89ef809635ebf55791e0a47f3bfda41fa4fb7878f24578',
    authAt: 1705108765
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '130fa93c5b6b4ceeaef9b8a0ad70dc22',
    code: '294e3a7467daca44f348dbcf68d6f5d9',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9ce5790479d6fc1451e23dfc022d775984ccba35ff44497d1235de7abc4964b4", ts="1705108766", nonce="XopfrY", mac="uEPWAYGky3Jf0LmB19RDy5kAkHJEePOIHvL4Tkn7TCY="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9ce5790479d6fc1451e23dfc022d775984ccba35ff44497d1235de7abc4964b4", ts="1705108766", nonce="eXsVzr", hash="biqwmU//vlw7TOrRHOjy7WxJqarvalF1rkembCmFVv0=", mac="M+QDLZWJLM3DmUJe9mxEC1uM29eliVb0AND/V4QsO58="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: 'b6dceed378b90c2083bccffaec0bc866888ed0c46f2152d2c873db77a674b886',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=b6dceed378b90c2083bccffaec0bc866888ed0c46f2152d2c873db77a674b886&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9ce5790479d6fc1451e23dfc022d775984ccba35ff44497d1235de7abc4964b4", ts="1705108766", nonce="q27xWK", mac="Nd/LMN4Do/5HBGqCC3jFNtpJzxryqbkJltZCCfKfifg="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'b6dceed378b90c2083bccffaec0bc866888ed0c46f2152d2c873db77a674b886',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '3c42432413d13f1137e9c6d6bb42c409347206626396bdf188f82167d7ccb876',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    expires_in: 21899,
    auth_at: 1705108765,
    refresh_token: 'c61918382013c3feb0fa7ab185fe15d7cf339aa4d9c4667009b25d9462e5ec72',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiIxMzBmYTkzYzViNmI0Y2VlYWVmOWI4YTBhZDcwZGMyMiIsImF1ZCI6IjNjNDk0MzBiNDNkZmJhNzciLCJpYXQiOjE3MDUxMDg3NjUsImV4cCI6MTcwNTEwOTA2NSwiYXRfaGFzaCI6InpVMEFvTDhFVnJzNFU0a180cUtxT2ciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.DocVDXzODQqAZw45ViiS_HwKGZIAEkrO5Mmz0v5Z-YLec70FPYXa2Uu-vlfV0Lk_ESbq9RLRID4Nhk9g0fuRwHIGJADKfman5tfSD1d4f7bFN0OokK7OPRHi02CYrAg8tHhqOyKw0WZeZythQbW87evCjZwDPmxaMZLDjN3fqVjRxqgWMvvQ_WomW4a5BjG5qy0oSJDeeNdUSMe0H7YDecZ76qcLckXxh0N98Gl4B0JHQq0ahPlEUPjrdh4ZZ_HmO6FM0zsWNbmuQQR3hUbYqoBsRer0afLH6OGSNTEsf9KVjQ8WrSni0qYakkWO2P6JrU6hAIfY3NTxTUnpScAijg'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9ce5790479d6fc1451e23dfc022d775984ccba35ff44497d1235de7abc4964b4", ts="1705108766", nonce="-fA92_", mac="yy1+8SMkasNls7uw3vgPASjWUYi1gZqU6L+AIgiha2w="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '1b06a32c32d0ee624c2208d67f184e3f',
      isCurrentDevice: false,
      lastAccessTime: 1705108765000,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: 'c61918382013c3feb0fa7ab185fe15d7cf339aa4d9c4667009b25d9462e5ec72'
  }
}
!!! response success {
  body: {
    access_token: 'f8ff9360fcabbd650d9fe3777e067c75054430a0e1d55ce7f4e2bdc6b557d61d',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync',
    expires_in: 21900
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9ce5790479d6fc1451e23dfc022d775984ccba35ff44497d1235de7abc4964b4", ts="1705108766", nonce="baggCC", mac="eYubsnDYqFJnV74422cpzZKbmG14Mjaf5TsuSrxGDRs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '1b06a32c32d0ee624c2208d67f184e3f',
      isCurrentDevice: false,
      lastAccessTime: 1705108765759,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ successfully grants tokens via authentication code flow, and refresh token flow (83ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '372355eadd1d7ad25b40@restmail.net',
    authPW: 'b1f8b83eb848fe3685ed3bf39653514524847a986951dc18e67b99e829270d90',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '929435f151c94ff699f1c92ca577ae78',
    sessionToken: '0c61bc6fd6fec6aade12816153caa799eeb2fa829e063b03e97e25cd9630a0d1',
    authAt: 1705108765
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '929435f151c94ff699f1c92ca577ae78',
    code: '76f812d5e5f6667cd37ce1290c3e5422',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e06991e655d3b4aa473a4d73cd354e59122c5c94dace68ec80a4f3700b32c1b9", ts="1705108766", nonce="aucEPr", mac="tDap91H453M7wl8WTseWqna6AnpLC+ell5QporigpG4="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e06991e655d3b4aa473a4d73cd354e59122c5c94dace68ec80a4f3700b32c1b9", ts="1705108766", nonce="YaL8sX", hash="biqwmU//vlw7TOrRHOjy7WxJqarvalF1rkembCmFVv0=", mac="E5fGcwuugPOdTLYflvYM6SJU9ODC8Ly3ictaQWmM29k="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '676d20fff12044733286d465e15f2fa53e455c005864e1e4dae0e5e93402b6d3',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=676d20fff12044733286d465e15f2fa53e455c005864e1e4dae0e5e93402b6d3&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e06991e655d3b4aa473a4d73cd354e59122c5c94dace68ec80a4f3700b32c1b9", ts="1705108766", nonce="TK4Y30", mac="zooKFw0kyXBIVlxhpBWIRfEnakbzTvbh3Q9O+kw5xDY="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '676d20fff12044733286d465e15f2fa53e455c005864e1e4dae0e5e93402b6d3',
    code_verifier: 'abababababababababababababababababababababa',
    resource: 'https://resource.server.com'
  }
}
!!! response success {
  body: {
    access_token: 'c7f28498d17427986bcb3b067e5653e06f10148368c14c28e829d5cd098d96bc',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    expires_in: 21900,
    auth_at: 1705108765,
    refresh_token: 'bf4b11dfbf3a716bdf3fd274357c305f761ccabb291c1fddcaeea9572c5a6260',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI5Mjk0MzVmMTUxYzk0ZmY2OTlmMWM5MmNhNTc3YWU3OCIsImF1ZCI6WyIzYzQ5NDMwYjQzZGZiYTc3IiwiaHR0cHM6Ly9yZXNvdXJjZS5zZXJ2ZXIuY29tIl0sImlhdCI6MTcwNTEwODc2NiwiZXhwIjoxNzA1MTA5MDY2LCJhdF9oYXNoIjoiLVNVdDFKeHBVQm9JbWZNZW9vZGVzZyIsImFtciI6WyJwd2QiLCJlbWFpbCJdLCJmeGEtYWFsIjoxLCJhY3IiOiJBQUwxIiwiYXV0aF90aW1lIjoxNzA1MTA4fQ.cH-M3-mnAW5bKlsB6gZpsI_K4eAjtkbc4rYhnLNqlRTBn8vxsolJRlSQfulL1wLKo1q49hYW2vbwj_KoJ83Xgd62UPj6PdKRunNeUEkKMMMLogmeLsy4E-xuWbpxrwKVKD282sfYdnEtbHkQTf8OBOhZ5AW0-zLcVrI7GoYEyYZshv4YAyEl4NCIazFK60dBf_u5_281SNOX-yGRVXUmtTqsaIj5BEv7FVzZdWfwsfLmaK_IVY6ENXH5y1Tkba7X18DJVW42IQUBtEU2bQTAUBmCBG-3MmPp4arp9SBS-NasM2Hhv8wwxQRdj_hQklh810cz6FMk7abLaCIwvMbyUg'
  }
}
    ✔ successfully propagates `resource` and `clientId` in the ID token `aud` claim (57ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4e6abe2c0a8b8aa67c33@restmail.net',
    authPW: 'dec1bdc807379e4f763211692c5443365d677474ba17fd32fcdc3629f73ec1d8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6c3c03e39a474c1cb6b2190a04527968',
    sessionToken: '50e4771437a6f2bd6727e8e53eb788c119bd25685b4f3644d97c41d130b073ed',
    authAt: 1705108766
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6c3c03e39a474c1cb6b2190a04527968',
    code: '7843d6fad1b0a40dd3a56f2cd49d9352',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="892f7a7d79e694faaeb5e8c9076e809c5cad10cfa7c3f562bcaee6007d85975d", ts="1705108766", nonce="K5WKhc", hash="dK2Y8q4AyaiPsHikpIjQ9d55LYONatpczgbR/rrkbSU=", mac="8AbnAdMPT76StGsUociuUw0Dl/3BFGzseJaKxwqMtdc="'
  },
  json: {
    client_id: '325b4083e32fe8e7',
    state: 'abc',
    scope: 'openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '9d1d8a7503f33d1becaf19ec4983d878f2e13e2f5b0d3fd526e4866af717e2ab',
    state: 'abc',
    redirect: 'http://localhost:10139/api/oauth?code=9d1d8a7503f33d1becaf19ec4983d878f2e13e2f5b0d3fd526e4866af717e2ab&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    code: '9d1d8a7503f33d1becaf19ec4983d878f2e13e2f5b0d3fd526e4866af717e2ab',
    ppid_seed: 100
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY2NiwiaWF0IjoxNzA1MTA4NzY2LCJqdGkiOiI4YzMyZGY5ZTY5YzI2MjYxMTQwMWMwZDRjZTExOGZmMjg5YTBiNjlmMmY0ZThkZTY3MTIyYTVkM2Y0MGExNDY2Iiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiI4ODlkMjU5ZDBkNmUyZTdmZGUxMDkxODIxMzIwMDBlYiIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzY2MjM4fQ.AbJlHgdH3fNNMwX5_u8h9Q5kNywIQuGn66ESJIEwrMHeRFdpKrQfsDqxGoWsVqUrRkXtt7qRp-lRtipQ-vpHBSQLaizKaevON_xxP07hw_7ek-jsP42ch3OYKCL_a05PNWCaFqAfotT8WaqCfIedRMyLCGWDbOA-Xjv6GObdLfufsYqZfXgmm9HUrIWJGcEOTphxXQkjQadz03xMDQb0fvQkzx4Q_FVRWf1lYn5aSIKMuqSoreBQhMDOPswhKeHTULakmlesrhSpz-ii15CH5UGFOyooaNHUs4s35LEbgvVOD1SmPL9c9h8N9Bkf2x_OG4z2LrvsrzjPibnBQsRJxg',
    token_type: 'bearer',
    scope: 'openid',
    expires_in: 21899,
    auth_at: 1705108766,
    refresh_token: '98f9381a44174ff0f162e3e3a164e1b386af42cc31033e0e0462dd2a711cab7f',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI4ODlkMjU5ZDBkNmUyZTdmZGUxMDkxODIxMzIwMDBlYiIsImF1ZCI6IjMyNWI0MDgzZTMyZmU4ZTciLCJpYXQiOjE3MDUxMDg3NjYsImV4cCI6MTcwNTEwOTA2NiwiYXRfaGFzaCI6ImxmTlVyZl9VS0tqNXB4RnJzdTZKeXciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.MBKbliCSf0jToHG1hoJiD_cg6SuXsW-egGLsrYm7MaMaA1GGxy0xmCSqJaIYj5NS492Y8NCSAdN1ghM1DrkQT4XMekOKqdAJHUACZE_1HyUEVN-Gh9DXHKow7VgdNKVmXaOvbwSGrnQ999ossFdpx_FoHejsEmdxYDIMAFj2iW5Ok6SrNOCGMVH6-wUYHZRhUsUWEO58Cjtd2j3KYzOcIWJ8mq2vbWkwRN44fFk8SPs9y0J2cdItNw4fIYuGJZhQWMQk5g3X22Qscd1BJnd874FY_gj-3vmLotZbDZOh2sBgyVTKhZubk893nwkuDQXjjBlTGgbPKUhC3F_4vpuNvQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    refresh_token: '98f9381a44174ff0f162e3e3a164e1b386af42cc31033e0e0462dd2a711cab7f',
    grant_type: 'refresh_token',
    ppid_seed: 100,
    resource: 'https://resource.server1.com',
    scope: 'openid'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOlsiMzI1YjQwODNlMzJmZThlNyIsImh0dHBzOi8vcmVzb3VyY2Uuc2VydmVyMS5jb20iXSwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY2NiwiaWF0IjoxNzA1MTA4NzY2LCJqdGkiOiJjMTRlNDZkMGZlZWUzNDg2YTllNzIyNTczZTQ2YTdmM2E1Yjg5ZmU1YzRmM2ZlODQxZjhlYmM3ZjM4MjQzZjNhIiwic2NvcGUiOiIiLCJzdWIiOiI4ODlkMjU5ZDBkNmUyZTdmZGUxMDkxODIxMzIwMDBlYiIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzY2MjM4fQ.iORuyd7lAPX3xNGjRFPAlc2m2a5CB_mJ-JjJlDHRr9pLJKbrlF24aV4zmFwPG_6bOApPd5RnPy28a90gAdoJkYr_szUBOJLSXHPiE9FW54Fvw-VS-UJ2YR6zdfsFDwEKI_a3UHjbkam5B_h1q-HJFH7QnPchm9CcBM3lGQvI2dSa5XqL8G1AgjVa859wfApS13lisSkK07zgxdwU0hW1Ke-2tGXJUHG7haBqwETxWmXo_CrnSDU8_eQXlu4IdROMOz2_M1TtmJvcrMnLIrViLYjdNxEqQ0uSO0SdvuXG9Du28RC9NAnuhE0mGTLgaXCG82qdBDncHMTGVN8v-X2a9Q',
    token_type: 'bearer',
    scope: '',
    expires_in: 21899
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    refresh_token: '98f9381a44174ff0f162e3e3a164e1b386af42cc31033e0e0462dd2a711cab7f',
    grant_type: 'refresh_token',
    ppid_seed: 101,
    scope: 'openid'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY2NiwiaWF0IjoxNzA1MTA4NzY2LCJqdGkiOiI3NjYyMjRiYzdiYTEzY2YxMzZhZGYxZjJkODIyYmIxM2JkZDViMjUwMzViNjE4MjFjMmZlMDAyNTlhMWQ5YWRhIiwic2NvcGUiOiIiLCJzdWIiOiI2OTJlZGY0OGRiMjI1ZWNlMThhNDYxNTAxMTVlNjhkYSIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzY2MjM4fQ.ew_Po_3KFOioXEuFOn5fTmHWeOJYtOrEGIGeInSmZSvX4iAFmOmouLHQ9V-5BPrV_CjkA77rfKF95fAbNcDkxGYfYtUIvqAnKA8XpbbJszGHDw7S74D2GzsR-LuyMkGdfnv675fwxWhCfWqbINMSlHKRe6LTnDfAtiJj-M_PyR89r1YMkWjwQdUh059583MJagZcJA9QYRbInukTknAdriGvtmwQrl48mbyT-QdI5yzPZ8rRsh5NxGD1Dj4gRccstgS87bK8WRY3uANjL6ERgRIxxg_I35tAlvl8upDIMHafvbj31tyh0d7i_0V7iQlX2EvPzLD7sc8TQuKIga2Hzw',
    token_type: 'bearer',
    scope: '',
    expires_in: 21899
  }
}
    ✔ successfully grants JWT access tokens via authentication code flow, and refresh token flow (50ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4643361482b0234afd0c@restmail.net',
    authPW: 'dc933d6a9d31959f7ed65d9283384cbaf8cd955ad39f51fca8c18477a5799862',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '010e0087d4484b2fb518fe61b87c1938',
    sessionToken: '255a8e468699934afdf091ec3f439b912e4f4fa1769fa9642cf598e9485a44f2',
    authAt: 1705108766
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '010e0087d4484b2fb518fe61b87c1938',
    code: 'de0520270fb588ccc273f617b34bbf74',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d70c22838c3734549256f3a96970f3774ed9076553d103f5ab0c9059c989193e", ts="1705108767", nonce="warlZ1", hash="5K1DzjufmwH+LNwW45xYbkYRT7bPL7QVIeQc8e7/QYY=", mac="Y8ApzF1GXU9CbBsqVf3LXobHcnfGCMvQ+hO8ZZe28iA="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'profile openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '1d278fc1241cac5924d52f8663d04388e7edcf918c832d612a93b43f7a736a38',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=1d278fc1241cac5924d52f8663d04388e7edcf918c832d612a93b43f7a736a38&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '1d278fc1241cac5924d52f8663d04388e7edcf918c832d612a93b43f7a736a38',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: 'ae31d7b0dc805818012f125daf245fdc4c29204def39a2405ff1a3fd09cb2701',
    token_type: 'bearer',
    scope: 'profile openid',
    expires_in: 21900,
    auth_at: 1705108766,
    refresh_token: '253b44e7d65dd734c33cb51d5301f47a025d0be7255601f8242b8306218345a4',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiIwMTBlMDA4N2Q0NDg0YjJmYjUxOGZlNjFiODdjMTkzOCIsImF1ZCI6IjNjNDk0MzBiNDNkZmJhNzciLCJpYXQiOjE3MDUxMDg3NjYsImV4cCI6MTcwNTEwOTA2NiwiYXRfaGFzaCI6IlpFTGgyWHk5ZThlVkQxbE9IUVA0VUEiLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.H-OQYTGjXmvDmQAizErh-UTjMYnamZBa4Svj1KOKD7ikXv7tOtLvq-m1LgDQnZA3Of0Xmj4C9qnzgl-pHmzkN_Har2F-rx5zvIkSyxHmaDE_n40vEr2-Tr1a8X1fsj8aTDzOiWdbqaCvBAfdgk_ETgaufHBRfh82orqtg-SL4XNRxuCepKiVf7VAfn0X9i_sSxGhiatjvZ1ZqrDLKMDaymbzdqvNqJXt-XGty6ZCamdWOWx16HgEmDLSqCT-v7XMWC7ShDsOmqkZoar_49yKzuoiDISzsM5Sv03e_k_ClWtGxQrQWK5YKvS6OkupqNuywd-Y68DBNzffY11yNMz2HQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: 'ae31d7b0dc805818012f125daf245fdc4c29204def39a2405ff1a3fd09cb2701'
  }
}
!!! response success {
  body: {
    active: true,
    scope: 'profile openid',
    client_id: '3c49430b43dfba77',
    token_type: 'access_token',
    iat: 1705108766000,
    sub: '010e0087d4484b2fb518fe61b87c1938',
    jti: 'ec239ee52cd0a3d534cee848371d2126b1e52d54aa3d2bef526cdf6eda9cff73',
    exp: 1705130666533
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    token: 'ae31d7b0dc805818012f125daf245fdc4c29204def39a2405ff1a3fd09cb2701'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: 'ae31d7b0dc805818012f125daf245fdc4c29204def39a2405ff1a3fd09cb2701'
  }
}
!!! response success { body: { active: false } }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: '253b44e7d65dd734c33cb51d5301f47a025d0be7255601f8242b8306218345a4'
  }
}
!!! response success {
  body: {
    access_token: 'd4b443024d073dbc36b4500e3f803bf84cbc9877be1a1a0ecaa01c2dd9fb590d',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899
  }
}
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: '253b44e7d65dd734c33cb51d5301f47a025d0be7255601f8242b8306218345a4'
  }
}
!!! response success {
  body: {
    active: true,
    scope: 'profile openid',
    client_id: '3c49430b43dfba77',
    token_type: 'refresh_token',
    iat: 1705108766000,
    sub: '010e0087d4484b2fb518fe61b87c1938',
    jti: 'b66fa751c964e7a701599f192cfe2c03deef158edaa667de1e8974f432766c17',
    'fxa-lastUsedAt': 1705108766573
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    token: '253b44e7d65dd734c33cb51d5301f47a025d0be7255601f8242b8306218345a4'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: '253b44e7d65dd734c33cb51d5301f47a025d0be7255601f8242b8306218345a4'
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ successfully revokes access tokens, and refresh tokens (92ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c42c4b3cf138049336ed@restmail.net',
    authPW: '95b2354ce3b65b9647bc057efaf69bc4caee43f955841f4010313513425a741b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0a3b8f5ba06849408653a130273802ec',
    sessionToken: 'fa79b84da06c98d2550991beac886e7aa2fad8783ba2ba15a45c9ebd5365140c',
    authAt: 1705108766
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0a3b8f5ba06849408653a130273802ec',
    code: 'cf6e909698775c3bfb0ebe1dee61b834',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8fdaf9ff87dfd97864686e6049910d73955d9ba6b2d75361a687aa684b9b7723", ts="1705108767", nonce="C3bGnX", hash="hjsWf3PEGdxhOIIiAoNby1OCyo8V6W4wWMWzqdwNthA=", mac="w2CYndttCDBrNPx6urM9Mj7ja3MyfgP397CJOc/MNyg="'
  },
  json: { client_id: '325b4083e32fe8e7', state: 'abc', scope: 'openid' }
}
!!! response success {
  body: {
    code: '2a495e13c36556498d24ae8f4aa94058bf3dfd81638b864634589e10ba11ef2c',
    state: 'abc',
    redirect: 'http://localhost:10139/api/oauth?code=2a495e13c36556498d24ae8f4aa94058bf3dfd81638b864634589e10ba11ef2c&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    code: '2a495e13c36556498d24ae8f4aa94058bf3dfd81638b864634589e10ba11ef2c',
    ppid_seed: 100
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY2NiwiaWF0IjoxNzA1MTA4NzY2LCJqdGkiOiI2ZjM1Y2JiMzhjNzcxYWQzYmRiZGUwYzIzODNkMjY4NDUyZWJiMTkyODdmMDc4ODM5MmZhOWJiMDYzOTMwMDQ2Iiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiI4YmFkOTI5YTllMmRlNmYzYjQ0MDkzNWM5MTJjMmY1OSIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzY2NzkxfQ.LHRRExktObRq3bneJ9DBUKbJCL1C6r3roWMTF8tbjx9fE-FrmBqLYWTvlZZDK8MJiIgxbAQFbc207ggkCrragJhnW-tVdBHdY1ZjWUYhtDGGcdIQSYVe9VRoCNJvTOG1x-xykFxRwrZ04aZDxzjyzmsuLcPozk-ovqVcNsPXH_jrR8M7I5YPxhjoiezSYB5v5o0asIZLiOicQ6o8gjDefpZPLE3gq74hlKx6gY3E58go_WwpA_s9NKvO5t4il_iiNTQQXI6n-aQXfpkVgbF58ihmoALjSAtqxzjwTzOoCCXKuyDCn3gMJLWSh9cXKHukZEmCJS_FZ8foGeYSuglWmA',
    token_type: 'bearer',
    scope: 'openid',
    expires_in: 21899,
    auth_at: 1705108766,
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI4YmFkOTI5YTllMmRlNmYzYjQ0MDkzNWM5MTJjMmY1OSIsImF1ZCI6IjMyNWI0MDgzZTMyZmU4ZTciLCJpYXQiOjE3MDUxMDg3NjYsImV4cCI6MTcwNTEwOTA2NiwiYXRfaGFzaCI6Ii1FbUQ3SV9JcjNoVS1nbWswcTJtdXciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.Kv6zp-uIUJdgpeA85x9cVZTfyphSyLUvhBo04oFIZbT8HJqzq6k0A4r1N7n0ghmz-OS_l5VrZ6fMWnYHK0QK6qZZloVDw3sn_nmTEcPxD9yftUCOHFXpGV-PbbT7wQIX2J7dmJwR-5UaOqJe_KPNXbsuBEw759s7Lgy6z4Si5rAk3sGE4yFnx8-ZBydLjCltD-9K2d93HXq2wXylgcfRuGQmj9braZzHDhDAHwSJKhC1fFQrGJcoO_gXcnpbbqwgIgPZG_PGN2Hoh0c3Tq-OUwGKCVPnsj0nPXiYKFY_JMQn1K1E64zjVtg-_RRGJod1FdtkvBjnuk94B5ilT6FaLQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY2NiwiaWF0IjoxNzA1MTA4NzY2LCJqdGkiOiI2ZjM1Y2JiMzhjNzcxYWQzYmRiZGUwYzIzODNkMjY4NDUyZWJiMTkyODdmMDc4ODM5MmZhOWJiMDYzOTMwMDQ2Iiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiI4YmFkOTI5YTllMmRlNmYzYjQ0MDkzNWM5MTJjMmY1OSIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzY2NzkxfQ.LHRRExktObRq3bneJ9DBUKbJCL1C6r3roWMTF8tbjx9fE-FrmBqLYWTvlZZDK8MJiIgxbAQFbc207ggkCrragJhnW-tVdBHdY1ZjWUYhtDGGcdIQSYVe9VRoCNJvTOG1x-xykFxRwrZ04aZDxzjyzmsuLcPozk-ovqVcNsPXH_jrR8M7I5YPxhjoiezSYB5v5o0asIZLiOicQ6o8gjDefpZPLE3gq74hlKx6gY3E58go_WwpA_s9NKvO5t4il_iiNTQQXI6n-aQXfpkVgbF58ihmoALjSAtqxzjwTzOoCCXKuyDCn3gMJLWSh9cXKHukZEmCJS_FZ8foGeYSuglWmA'
  }
}
!!! response success { body: {} }
    ✔ successfully revokes JWT access tokens
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ff2c39cb5e956964141@restmail.net',
    authPW: '366bb7348e68cfd85f53a2394f9e666d3b46456ab2f1c7b1576287882679b77b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '16c9cbf7584944bdab8cef32eebb47ad',
    sessionToken: '12aae330377284d82d1c168840a526fd3b066e30e68529546cbc5914f28044e5',
    authAt: 1705108766
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '16c9cbf7584944bdab8cef32eebb47ad',
    code: 'f5c29c545e72d7944b69592734123808',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e43623d37dfb36c2ef5c96a8f40663da9e7b143aed590c70ef9a7d3de0ab06fb", ts="1705108767", nonce="C5hm6P", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="J+DE6KAzMLknmaxuI0+3z80JWeCWKdDgRIn1xPwqDSs="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108766963
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '5ff2c39cb5e956964141@restmail.net',
    oldAuthPW: '366bb7348e68cfd85f53a2394f9e666d3b46456ab2f1c7b1576287882679b77b'
  }
}
!!! response success {
  body: {
    keyFetchToken: '988e0895a0193e889f101269a0b908a9147f846a3cf9ed948073b8ba83610627',
    passwordChangeToken: '5f136c41b8b40fdcb19912d2b4221965c7f1e32800a9e9e51d128ef570fa6f05',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6906c0ae773f1187438807639ab48d3ff0d44652bf34863a08b58f135a3e3f28", ts="1705108767", nonce="B-QBWL", mac="xwVz2rNpp1iWzjQl8T5Or0N9BREx17ekDltqQxGIU/4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '3741a3b210aac9736657b7df661eb828df24d013ff9599f5838f9818e08d0cd6c9438fd4194c07efaaf078f25cde93086df1556ec1cd772cef85188e44f58d8293ef795173574951ee9cd1c3c94d9260c01038c8c185aa40d6cc7cf8038e02f8'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4029c44862ffad151f2522d9dee63a5ba50a52ff61d463d6ee286e41ecfe039", ts="1705108767", nonce="E8GOn8", hash="9akqZkc/M4JYfxS8J3Fly/wGI/TWS2eZzXwO9Z9x5b0=", mac="0j6rTBLcrnCmZ3G+wyzIB4B91F1zsX3QywiEtF/yyGs="'
  },
  json: {
    authPW: '03bebbede6709cc4dff36b3e59635322770270f823ffb3be9bd572603be115a7',
    wrapKb: 'd0521d1afe8a7f66b698c82566a6c0ef821dc0c00f2c9aa4e502916101a62f07'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ff2c39cb5e956964141@restmail.net',
    authPW: '03bebbede6709cc4dff36b3e59635322770270f823ffb3be9bd572603be115a7',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '16c9cbf7584944bdab8cef32eebb47ad',
    sessionToken: 'ff2b348cd0f9df12533addf19b84cd558a6d3fc3f4f7f26de4bc1bd549f6984f',
    authAt: 1705108767,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0f48bb8bfedc540537fbbe7bf05c4ef1f7d307f09429e50994f49480aa375afe", ts="1705108768", nonce="LNimUS", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="LCXOOVRXzH7RhwHszW2DKwn5f5nOAUBxFpH/M5ZMdHk="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108766963
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ff2c39cb5e956964141@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '2b2558762c50e92379fe9dffb7ac8c3f5810161204e515414b38feb64158b8d9',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bf2a903cf917afa9199df6743fbb52888f94889374e5cfc99d46c5659cf246a7", ts="1705108768", nonce="CnEwZp", hash="V1dUe7iAzdu14J1xGPX0AszwRy1yrtRvoTQe8s50V9E=", mac="83QNmvIAr0WUuIqKdN5leteMhX2xFSASq5lGthgiMq8="'
  },
  json: {
    code: '0590c8b0752f753007e64009d0e21a9e',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'dd4ae64dfc61a240a48b900a889f0d8ac185bfe55e3e60b8d1a2c939c8fdf0ee'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6b6668804698b344fa74e23b4d8d82e412a7ea11e6a0b0b8eb5075a14c179e2a", ts="1705108768", nonce="ARTQTg", hash="HS8FJQOt6JO4xDX1TB5cqKj6LUovjbt3tYiSnS1z+iU=", mac="aCzGIzciNravvxZZB0OzPXWeVMM73oK3LkFr98pqfGY="'
  },
  json: {
    authPW: '366bb7348e68cfd85f53a2394f9e666d3b46456ab2f1c7b1576287882679b77b',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '16c9cbf7584944bdab8cef32eebb47ad',
    sessionToken: '1366b63c28ccaf6870fab9e1fa0655e9cec49bd7ebbfe0e53c01d0856da9cbef',
    verified: true,
    authAt: 1705108767
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dc40b8f4a429382832cac76ab7cd7cf44900abae38a4030c68ac0a71f207456c", ts="1705108768", nonce="HDdG3F", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="dVaWAjNyi9f3+RLZFt8MYJNEaJLC8rqIdsZex8xJLWU="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108767919
    }
  }
}
    ✔ sees correct keyRotationTimestamp after password change and password reset (930ms)

  #integration - /oauth/ routes V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c2fc5fc657ccac42145e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c2fc5fc657ccac42145e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c2fc5fc657ccac42145e@restmail.net',
    authPW: '665726b240bbb523cab10d5c929e5aedac73f933addc9e41f3213989a327487b',
    authPW2: '354796059f7c5773e544f45fc00600e38505199b48c9da5e0d196f701db48b2f',
    wrapKb: '19007d274f9052ae9eb050a0cb0557c31fd2f09fb3d1682a28334254648e2318',
    wrapKb2: '5d844df8e3c88e690506e7e3b96c0020d9ede544e1063fe9c2c5a17a83d842fe',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:673ae318312d8f1352449ba844f6acf347dada8e4ca05641189982bd2b31a256',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ac2f6142d1b443a4ae3dc441b46b80eb',
    sessionToken: '14a3af6ea63ba8d087df96630e53762a57e7b0d5cb46888b88fd89584ef310a0',
    authAt: 1705108768
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ac2f6142d1b443a4ae3dc441b46b80eb',
    code: '05821869b18bbe624fb47de1df4296a7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8679410e841cc325a8a380b8ff98c07b766d616f209504231d8390842207787a", ts="1705108769", nonce="iF-AmR", hash="A1m4v8HyYZxRg9AaYvlXJxngGAHlit8VCmH2iHGwPfY=", mac="gfruT90rDtwtToqHF3rjcWPL7En1Jn8tP+J//Kj6eVo="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'abc',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256'
  }
}
!!! response success {
  body: {
    code: '0abde6e1e5a0b803a05da75fe01ad9c19cecdbce667c02e87e97abf088c73e87',
    state: 'xyz',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=0abde6e1e5a0b803a05da75fe01ad9c19cecdbce667c02e87e97abf088c73e87&state=xyz'
  }
}
    ✔ successfully grants an authorization code
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c3d0a8170b8c626fe969@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c3d0a8170b8c626fe969@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c3d0a8170b8c626fe969@restmail.net',
    authPW: 'e6f6e9ddec4d47e1e29d1de007fb29d715047b9dae6e68122cfe8de6a7d0b2c2',
    authPW2: '414e48bda4998be3b29351c1d0a3fa17b74e12b050149acaa9e9f50e7f2fa26a',
    wrapKb: '7f065bab20fa33a90ceb1e21dac0709a3c3740e13aeead0f35cea4ecec003ccf',
    wrapKb2: '34d442fc2b4f2be07cdf71b517076f5b7a8ac0a8d5f27ef0d4e2043fc4c5f4d9',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:651bc3ac47acab624f316e3d633d8669c243d682ddff2aad014e2f4a728ebd28',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2cc4d9af41ea43708c4a6040f9b45a9c',
    sessionToken: 'a8eaf82a3170d2279e51714b8ca9eca409bd52363cc2bfd7dfdf62b79d5b522e',
    authAt: 1705108768
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2cc4d9af41ea43708c4a6040f9b45a9c',
    code: '223ed19dfd89745630550016396f4724',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6103c7eae1909474c599b13a6beee7412969bd71232041d2ead24e31cd457dba", ts="1705108769", nonce="hrHF18", hash="4+0QDKlXTINoyY7fmsdkrJRA4RCSJX4wD3/zAcBKZuc=", mac="CGUqrw+0Ch35K9WuIlThQFTaL4MZG1zAaMCTpvydthA="'
  },
  json: { client_id: '3c49430b43dfba77', state: 'xyz', assertion: 'a~b' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ rejects `assertion` parameter in /authorization request
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b6dd55dfa87d53aa774f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b6dd55dfa87d53aa774f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b6dd55dfa87d53aa774f@restmail.net',
    authPW: 'b0b13c22bcb88846fd268de6f6c07ad37b8fac11567641b185c9e63561a04dee',
    authPW2: 'd97d0d8f44833efb2fb3f07454f1cf8f6bc23137503ecf30e43e110570906bad',
    wrapKb: '9ea210f0339ca17383a0b8ce99407d80dcdee499e1715b6af2fde0df5b618d3d',
    wrapKb2: 'a1628df04a84fb7b36e7f972e8aa9d65fa5ac70d7d25b2c2c1460e860b0f273a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ce418722a84c8089cef2bab1c99a4fb659d5c2462a0b60fa864ae510d998768c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd5f6325eae1f439c8b03467ce0d60d1d',
    sessionToken: '0ae76b7b91c593725fef4293ae1752ba24e3a618606fcd6a519ce59a9ce67c7a',
    authAt: 1705108769
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd5f6325eae1f439c8b03467ce0d60d1d',
    code: '7b58f8fe9e326286b06d03df8674a44b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="77790a0a99a8a0833d65d8c027d2e2578041bb0d0ed80a5f4f91992c75e9259f", ts="1705108770", nonce="bD8fuE", hash="RjAS/0HE+JcRfHFWy+1Wg8YTCZviqnJmk/Z05s/liG4=", mac="NBFsppL47jMzqsr264S9mQJzMtxje5RHujsaczHYas4="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'xyz',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    resource: 'https://resource.server.com'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ rejects `resource` parameter in /authorization request
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4cfe80b60e45f2f67306@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '4cfe80b60e45f2f67306@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4cfe80b60e45f2f67306@restmail.net',
    authPW: '246deb69e5b4718ec9ac49472340470c1ff512730ebde9f4cf9b8083749a4a02',
    authPW2: 'b0f8b4b7cc143fb77e25e097040163040928a40d62194cebe07ed0207239dc89',
    wrapKb: '270dda373d53d5df1a9be7a06594541258a618bf71929894651e89275373981c',
    wrapKb2: '55884f1f7fb326b65aac48148bdfdf97426e54fa7c4150aab7f6904767ea8d4b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d8c3bc4adddf929b6e97107448c10d99e1e7f904a5328fad0c7832c93d3d48b4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ef315d2f399b4137a7864676daa2329a',
    sessionToken: 'ebca78b912d5a6228bc16e30cd8b85d03308d8a6e654423720f6c00d66b85b4a',
    authAt: 1705108770
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ef315d2f399b4137a7864676daa2329a',
    code: 'c1a63b3b9fa80d4b911efc9538067b0a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9dbf014aa248088417d200b45d08e7ae397eed3eda54acd85ab8cbeb3b4e98f1", ts="1705108770", nonce="5w5Du0", mac="ZLN/L5OJ4Kz3wy+mzU9B+U5yc84vrCDbIGJoSCm41dg="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9dbf014aa248088417d200b45d08e7ae397eed3eda54acd85ab8cbeb3b4e98f1", ts="1705108770", nonce="eHG490", hash="08sObW9bMW9arVITw489FXvn2EgVIXMdjy5usEr0nw4=", mac="/O7WORaekGlElusoO/eMvJIWoNGND7jyHoNw/n0yoEE="'
  },
  json: {
    grant_type: 'fxa-credentials',
    client_id: '3c49430b43dfba77',
    access_type: 'offline',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    access_token: 'f85035233d8242d3e77d61890896581d5c223dc3e8de10057c74b077504463c9',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync',
    expires_in: 21899,
    auth_at: 1705108770,
    refresh_token: '801fb167cfef395a366a5fac3279095c96bebfff13580ff4999169f09afea5ed'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Bearer 801fb167cfef395a366a5fac3279095c96bebfff13580ff4999169f09afea5ed'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '95c3a9430b013602681c1df706c5fa15',
      isCurrentDevice: true,
      lastAccessTime: 1705108770096,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ successfully grants tokens from sessionToken and notifies user (44ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '28b57113f2ba9878c014@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '28b57113f2ba9878c014@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '28b57113f2ba9878c014@restmail.net',
    authPW: '2b3df20bbacdca268c2bcea0e02b36014953e624c0f67f998a34389216552d49',
    authPW2: 'cbf45a38c1a1354e7dc7aec745e7b7e080638ee0379e691422ad193b222ca386',
    wrapKb: '80560a6b96d1b42c95cb251d202e6b978a890f349ed42673b30f0ff0d65b2743',
    wrapKb2: '94238d30ac1b2ce9fa2de1ca2b02d778e1c4d1512e4d975eb0f9e27bb7495d05',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c58841baa38e41458a4bf45d61f7128f4cfdc6750905d74c50fabeaf00818a16',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7d0acdf8d3354730af47ca81a283bb09',
    sessionToken: '1c06cd2c77bff07be61dd38136f9410b5dbad2d926e35999ba186551046501bb',
    authAt: 1705108770
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7d0acdf8d3354730af47ca81a283bb09',
    code: '1e4423dffedaea8ba1ae26b41fd77ec5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="af5e8e697a6d21c79fca6a29678e1fcbe40f6527bf7114d4c8ffe32b95a7f448", ts="1705108771", nonce="u6WkcJ", mac="MrR7e7KazYsMqJuyLZss9TbbTmYuqzEXQ0fzPQt3sw0="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="af5e8e697a6d21c79fca6a29678e1fcbe40f6527bf7114d4c8ffe32b95a7f448", ts="1705108771", nonce="aZWwvp", hash="biqwmU//vlw7TOrRHOjy7WxJqarvalF1rkembCmFVv0=", mac="BrWa0AbRUgxuaPdpVp7mLgWlyH6oj4DRK4lFC8SfpQ0="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: 'c6e14296f0f440fb8a81ddd1db96db27a722aa20c7313277e84292ee630b01ef',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=c6e14296f0f440fb8a81ddd1db96db27a722aa20c7313277e84292ee630b01ef&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="af5e8e697a6d21c79fca6a29678e1fcbe40f6527bf7114d4c8ffe32b95a7f448", ts="1705108771", nonce="gBrc5Q", mac="pBG4fzPuLPVeWg77vh/Mqg+ateFVEPTOLSHKEKWpRJY="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'c6e14296f0f440fb8a81ddd1db96db27a722aa20c7313277e84292ee630b01ef',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '27bbff5ec030d9130e0725595b94129dbac3bf38b17bb33fc555ea319b0f7d8f',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    expires_in: 21899,
    auth_at: 1705108770,
    refresh_token: '7d988e215fb92beba20cc34edfc32254e1b15b7541c5ff26472d6bc4e1d731b9',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI3ZDBhY2RmOGQzMzU0NzMwYWY0N2NhODFhMjgzYmIwOSIsImF1ZCI6IjNjNDk0MzBiNDNkZmJhNzciLCJpYXQiOjE3MDUxMDg3NzAsImV4cCI6MTcwNTEwOTA3MCwiYXRfaGFzaCI6ImJkTUI5T1g1ZERUalRJZVh3azd6blEiLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.j90tQGnqLxFhrTIw427GnpqCKVxn-sdgE1rZdnKtB0UR3axyNmkJbiwSWpDGp4cRMGVdpTnK6bMSvtvvEfotAaUQ8C4yo2D177q6qZFlkfHKnzhtiWQtodjPp7ib6iDC8lLJJQnrsDjsgVIbE7vhG67JQAhXJE5NQOi4qa5Me9gh8HZ2jX-IhVgpQ40fkbSQloEyt4ZO-cvVUFEIkYl8mW1b1HtTjJe47YaPOIfhBZngwXJZEAnUFGfzQblhjaUbzkF8vTRHkkyv94N1L8hFZS2O8q_P7eBw4HhiM3GK8gQbv2DO0_JibJ2iJkaUKWBq1qq8xe6P77WTzy4GyfiucQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="af5e8e697a6d21c79fca6a29678e1fcbe40f6527bf7114d4c8ffe32b95a7f448", ts="1705108771", nonce="64IrP1", mac="GVyTyzXg5V2P8x3+cIuV+s8BlZuU5bFHZVI6/rlb3Zg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '5a76524dde886a122b2b3186dfcbe15d',
      isCurrentDevice: false,
      lastAccessTime: 1705108770000,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: '7d988e215fb92beba20cc34edfc32254e1b15b7541c5ff26472d6bc4e1d731b9'
  }
}
!!! response success {
  body: {
    access_token: '89e1b6c4e62f92aefd94479aa24141db4ca130ef75ba3a618737fade93e47fc9',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync',
    expires_in: 21900
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="af5e8e697a6d21c79fca6a29678e1fcbe40f6527bf7114d4c8ffe32b95a7f448", ts="1705108771", nonce="HxX0HE", mac="hgq8j1fKJgaXcyMaNd+UMcpU6FzEgJrJz3FmoqYFgNI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '5a76524dde886a122b2b3186dfcbe15d',
      isCurrentDevice: false,
      lastAccessTime: 1705108770678,
      location: {},
      name: 'Android Components Reference Browser',
      type: 'mobile',
      pushCallback: null,
      pushPublicKey: null,
      pushAuthKey: null,
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
    ✔ successfully grants tokens via authentication code flow, and refresh token flow (105ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '52cbe7acbf0cfbb49ae3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '52cbe7acbf0cfbb49ae3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '52cbe7acbf0cfbb49ae3@restmail.net',
    authPW: '3a1141b6d51d64585362e277e794e8ec7826c97a40def432406351b357fdf137',
    authPW2: 'e67c4accb3ca943fdb91176cb6f1199829eb5833f161b8de8c2f260b57dcf741',
    wrapKb: 'dac02a520db2713ac1bdb74ce9a8adeded4765925d35fd20afe1a6f5cc79a30c',
    wrapKb2: '05d7d2eb9b80c78cb0c17f9faf3aba2a34c15f8ab7fc9cd87ead86626b2beb44',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4f0a05386ddd693a47894b52bdb6076e78028e53adf28814d6dab91fa4870ef8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8a76354b95cf42409c6b5a3638944f80',
    sessionToken: 'ca8c56441b47f6d0b2783c8c3f81e08e4ea96074f786847b7622ab54b82eb6e4',
    authAt: 1705108771
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8a76354b95cf42409c6b5a3638944f80',
    code: '2aca467cc1d2efe12786b9f91c4dd646',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9f2a34c2a3f1549e6c2c226ba2c888e093867233594113ea35a49bc142a6df0d", ts="1705108771", nonce="RcKtpD", mac="FOhCmezYWtDyS1hK4+HEQG6VgaQ91IzTNRC4ug1b9po="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9f2a34c2a3f1549e6c2c226ba2c888e093867233594113ea35a49bc142a6df0d", ts="1705108771", nonce="Bja2lw", hash="biqwmU//vlw7TOrRHOjy7WxJqarvalF1rkembCmFVv0=", mac="P0W9EM+lKTM+BpTUCY94Q4TlwPFSQcJHQDtnpLgQXvs="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: 'db90665720b127cfa6930e4e92c10e68a85d772f8f0d9097020900dd52189d07',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=db90665720b127cfa6930e4e92c10e68a85d772f8f0d9097020900dd52189d07&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9f2a34c2a3f1549e6c2c226ba2c888e093867233594113ea35a49bc142a6df0d", ts="1705108771", nonce="gIuOOm", mac="QImuQm7gcWGHdrCLj07Hg1UfpmFMjV4NepQKenLimVM="'
  },
  json: true
}
!!! response success { body: [] }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: 'db90665720b127cfa6930e4e92c10e68a85d772f8f0d9097020900dd52189d07',
    code_verifier: 'abababababababababababababababababababababa',
    resource: 'https://resource.server.com'
  }
}
!!! response success {
  body: {
    access_token: 'c1018b8423a07fd95d5724dc033421fe70404e84f54b856f9c8e5dba07e069f2',
    token_type: 'bearer',
    scope: 'https://identity.mozilla.com/apps/oldsync openid',
    expires_in: 21899,
    auth_at: 1705108771,
    refresh_token: 'ec17d449f33a3a3930d3a5015763b89b96e85c917bea1db5b672ac7a86d1d5c3',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI4YTc2MzU0Yjk1Y2Y0MjQwOWM2YjVhMzYzODk0NGY4MCIsImF1ZCI6WyIzYzQ5NDMwYjQzZGZiYTc3IiwiaHR0cHM6Ly9yZXNvdXJjZS5zZXJ2ZXIuY29tIl0sImlhdCI6MTcwNTEwODc3MSwiZXhwIjoxNzA1MTA5MDcxLCJhdF9oYXNoIjoidkZVQUFpU0F1OUs2Um51R1JUcEFNdyIsImFtciI6WyJwd2QiLCJlbWFpbCJdLCJmeGEtYWFsIjoxLCJhY3IiOiJBQUwxIiwiYXV0aF90aW1lIjoxNzA1MTA4fQ.mPl3L_StC9J5w6gZQqqxYkm2WcpLtI7FXXRlQb9HDirByL-mGFmN1o8ILnXNGH_yHJzKZxrV3z49oh97mW91HI-UA5Xd_zSf3wjlrpHMI2omE1jQvrYr4c2xuF6fd32Godfs-tIgrsjl7ATy4G-LZIahPR1Y23ymOYUrwjh619H0tc3Ipvb-w1_dexNOCu0WxI4PIWAYUefo6hvHLtHOB4oJVSvYay615PUI8VZeiCF0QHX0X7dtHl7sRzr17aeBmUznZ4-vHN1cBGBRv7-HCtTvrzHAyLODefILxeYiOzXBW319FZERI6j39jZwwhUJv_AVnJLFBASn5pzg-101Gg'
  }
}
    ✔ successfully propagates `resource` and `clientId` in the ID token `aud` claim (54ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6525a22766980530345f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6525a22766980530345f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6525a22766980530345f@restmail.net',
    authPW: '4394c31d9c48dd6f2644fbaf55a145f797bb64c181d028481d2475d90a13f67b',
    authPW2: '87d01cd7f20a082516b349aec2a5e4dde4c00d03b03756a772df96406bcfc019',
    wrapKb: '5bdbc8a7ff865eb12d92070906383f6f10f82ee7b73778456a4477ce9a6320a7',
    wrapKb2: '3f71f917a7313c0f41cca1184d2e13263a144e2bc6d1642dc847a98914ffcba7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b2afa13f132922d20b82a9fd896e03f033457f9fb741dea350b536983bca3a66',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5da047f4bdbd4ab680395f1e6bbccfe8',
    sessionToken: 'e037de1e19e546e78e2e65093c2196296bd7a81394d8617501e6535572b54e14',
    authAt: 1705108771
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5da047f4bdbd4ab680395f1e6bbccfe8',
    code: 'b7a8a6309714f3249664e36e112be897',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="02cb27f29a0049baa6c8d1ad05641ea9aafc0900cb8dcc2730694ceb0a7118df", ts="1705108772", nonce="OvZna5", hash="dK2Y8q4AyaiPsHikpIjQ9d55LYONatpczgbR/rrkbSU=", mac="lxkINSWoskXXPbRTvAt5rqdAunRWyhh68S1US96rczY="'
  },
  json: {
    client_id: '325b4083e32fe8e7',
    state: 'abc',
    scope: 'openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '2aafecd1edfc65cf9e964ccc62bda566fed41e0d115395391b585157ea8d2bd3',
    state: 'abc',
    redirect: 'http://localhost:10139/api/oauth?code=2aafecd1edfc65cf9e964ccc62bda566fed41e0d115395391b585157ea8d2bd3&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    code: '2aafecd1edfc65cf9e964ccc62bda566fed41e0d115395391b585157ea8d2bd3',
    ppid_seed: 100
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY3MSwiaWF0IjoxNzA1MTA4NzcxLCJqdGkiOiI1OWYwMGM4YTQ4YjE0MzllNzk0ZTEyNjZiZGY3YTdjZmMyMTc5YzM1NTRmMjA0ZmQ2OTdkNWUyMTkwNzNjNjk1Iiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiJlNmM2MjI5ZjdkMGVmZTUxNjYyZjYyOWRiNTg4MzE0YSIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzcxNzA4fQ.l4vbjTBzOv6Ar5y-pzcybJJGNGCrOPXVVQwp5EEZc1fH4_ueNgdRl6rTD-6g6SDEXEDjofR4hXRJb171-gnNXwEBftwfN1E4LbDlf5HCduzpvWek9vFccRlLB1klDXR3AvA70HABvtyhItRG0j0QVAB-G86kR1pIQvI3QK_S9czKQocNz6_SVneF5IK0GkAo6zaAPtf1KScRn3iB6BfI_mfhAoKKBI5REMb7xIcqfabQ259EWoqSk34vb7tW_60HFBCuzOS86e_US5TrMcg0QVgBkMsU4N9gnSXHlPbcqU8UHlJKzm_AJJoW4Lv6ZRYF3J9k3p1cIIrc-v0Gn7EAPA',
    token_type: 'bearer',
    scope: 'openid',
    expires_in: 21899,
    auth_at: 1705108771,
    refresh_token: '8c0676c5547951a182a67318b7ea06ac2506448b3d9195cec344e0a09681e87a',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiJlNmM2MjI5ZjdkMGVmZTUxNjYyZjYyOWRiNTg4MzE0YSIsImF1ZCI6IjMyNWI0MDgzZTMyZmU4ZTciLCJpYXQiOjE3MDUxMDg3NzEsImV4cCI6MTcwNTEwOTA3MSwiYXRfaGFzaCI6InJJUWF4b25QVWNjZjFMWkppWnM4V2ciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.G56VyE4hfGZPFTc7eLm2PWAcs-v56toVUSsxUM7wLb5GGk4AbLInVEcFxLgpX3uEdU34sBAvqug4jPDnp3EN_IAobUhtdndmJ_ZzyHgq4bK7pI2NVDQC2Ts_2zh2OUBMyDSlpz_6Yy5VsId-lLl_U0l3puizba7pVE4Ly_buNqep5hzbsxc38yITG2W5ffQ35Fe_GjcwFBeud2oPaR4HqiH-sJJIQKdt-Ml8_nG98IvCXN5jeRFRmObQiG_ukpyYuYTxhZ7pls0ndQQ4bhOLRfQxHCx6FY72-F16W23m66y26cgbLF2lgu6wwEEFcfQaUsfFIINdQNyjqoedlxm3tw'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    refresh_token: '8c0676c5547951a182a67318b7ea06ac2506448b3d9195cec344e0a09681e87a',
    grant_type: 'refresh_token',
    ppid_seed: 100,
    resource: 'https://resource.server1.com',
    scope: 'openid'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOlsiMzI1YjQwODNlMzJmZThlNyIsImh0dHBzOi8vcmVzb3VyY2Uuc2VydmVyMS5jb20iXSwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY3MSwiaWF0IjoxNzA1MTA4NzcxLCJqdGkiOiI1NGE5NmUzOTBmYmNmYTQzZjI4N2ZmY2QzYjQwMWJlZWNmNjI2ZjcwM2FhODkwOGE0MjA3MmYwZDJjZTFiMzUwIiwic2NvcGUiOiIiLCJzdWIiOiJlNmM2MjI5ZjdkMGVmZTUxNjYyZjYyOWRiNTg4MzE0YSIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzcxNzA4fQ.FF4o3tT2WZZ1cFpfht4hgD2IaYo2zBltRuixQNemnPdJ0ZrI_jYD6dNZ-XQAv_y5HxykjxTeHRkbD1nwPUownaUp3-6l0QPvZZ1wnF-h1bt5OO-Hw8avrrMTco2UAeDidlg2lWX2LgMLBZ4wtBwEFRzS44OXKgl8tiSqhlXSwf7woRlR1US-g3e0925UcWV2cCvXeSX7952IIJJjfVz-T9WCEA5JB3KsadBTr334oveBqGY5ubTfoloqEpOzCOAvOnG1689Auxl0MS0k2BeNhCPzjXgOACB8Pf01aNQuJSh7H03r43EPFhc_tvn0hw6KDfUHybwgSJVjnKVDMBNcHA',
    token_type: 'bearer',
    scope: '',
    expires_in: 21899
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    refresh_token: '8c0676c5547951a182a67318b7ea06ac2506448b3d9195cec344e0a09681e87a',
    grant_type: 'refresh_token',
    ppid_seed: 101,
    scope: 'openid'
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY3MSwiaWF0IjoxNzA1MTA4NzcxLCJqdGkiOiJkN2Q3NDY5YmIwOGUwZGRjNDgxYmRjYmJhMGFlODI0MWViNWI1Y2ViY2Q4N2JkMjg3YmFmZjVlMzA4YjNjM2VkIiwic2NvcGUiOiIiLCJzdWIiOiIzOWM1NWUzN2IwNjVhNmY0YzZjNTMxOGViZDE0YjZkOCIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzcxNzA4fQ.I1LtOwJY-MdSrhuhuoouJS1nNniyb9dAiGfYq3zz8xD7KXdfuL5nfEHAPay_MCGxUn1rAM4cTpO9om4Gq-_iZh2KmPu8Mu01aq6KCVDos0ULi_woqTuQulvUAajDSo143ZxzUh7aUrxmr7q2OKDXPCdNBcP4EbV9dxDEnHFEcqK6E-HtrFsW5zNVQHUM6Gqli66Bv-v3Z1wD3Qh-ftJSpdvwia394HjiByyE3Jzr3-HrUFBX-Vt0vlTc-fnLcmcJYfEo0611V2fP2hPzyupzyMXc4y1uLsTg6dNjE3f791TZ1-qleFmLCwZxiFgIqeitexsJgW2VGtMe3awnGuAbjw',
    token_type: 'bearer',
    scope: '',
    expires_in: 21899
  }
}
    ✔ successfully grants JWT access tokens via authentication code flow, and refresh token flow (48ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ca3835f7caedc7beaf25@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ca3835f7caedc7beaf25@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ca3835f7caedc7beaf25@restmail.net',
    authPW: 'b7e27c5695def1bd249786d69f1341b7c2b48f78c6a606a0872fd7c30ef7b0c3',
    authPW2: '692d1a95b404a1a620e39d166f1d7dc7b509e9b1815de5cf2eb2e7539feedbdf',
    wrapKb: '2aa41fa647643f3e82b3eee0b2c93fc042c63aca6baa111041769a7aac20e435',
    wrapKb2: '1f80f438f7a2d7a69a88348fe449cb3d4c9e63e4ac7b76703ddf8d46d0fa3583',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:94a7c523b22b5dc5cd6f5e815e6be92a3208f7d77123aa0fc103357d9b772e36',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7be3d1085f834cbd97d0e47d3a9a28e3',
    sessionToken: '00c1b68906d794586b2217b02d47bfa1729c23d94ef6916cb2545de7ee44b730',
    authAt: 1705108772
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7be3d1085f834cbd97d0e47d3a9a28e3',
    code: 'bd15d873ece79fb6d22b2e39b6c92779',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a04f95729e76c2084db810bab6fc3a071ae8c8a150fc6c5055aa2c80dae2e9da", ts="1705108772", nonce="9YFLc8", hash="5K1DzjufmwH+LNwW45xYbkYRT7bPL7QVIeQc8e7/QYY=", mac="em2JqYrnoPENQ2A0c4czqk0aEtTcvgvN0it8xIeWPcs="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    state: 'abc',
    code_challenge: 'YPhkZqm08uTfwjNSiYcx80-NPT9Zn94kHboQW97KyV0',
    code_challenge_method: 'S256',
    scope: 'profile openid',
    access_type: 'offline'
  }
}
!!! response success {
  body: {
    code: '8e5931642a83108bdae2fd0c63c0eddfee26be5851455a4cab4eabc5af5e9952',
    state: 'abc',
    redirect: 'http://localhost:3030/oauth/success/3c49430b43dfba77?code=8e5931642a83108bdae2fd0c63c0eddfee26be5851455a4cab4eabc5af5e9952&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    code: '8e5931642a83108bdae2fd0c63c0eddfee26be5851455a4cab4eabc5af5e9952',
    code_verifier: 'abababababababababababababababababababababa'
  }
}
!!! response success {
  body: {
    access_token: '18c12c087c1de9e94b96645122faa962cdf52b1584dade67f0e86e67d4da85d5',
    token_type: 'bearer',
    scope: 'profile openid',
    expires_in: 21899,
    auth_at: 1705108772,
    refresh_token: 'd5e4ef61ac73ff0f4f4bb6656c25bdc7c49e2bf822cf4236c1334d7930a7b5fa',
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiI3YmUzZDEwODVmODM0Y2JkOTdkMGU0N2QzYTlhMjhlMyIsImF1ZCI6IjNjNDk0MzBiNDNkZmJhNzciLCJpYXQiOjE3MDUxMDg3NzIsImV4cCI6MTcwNTEwOTA3MiwiYXRfaGFzaCI6Im9TejF3dlNqT2RGbnNPX1luU0hwWGciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.k1vrDuYyQoJYMQeTv4JuXO0EFOGETXd6wg281RY52oABn--AJ2LEpURw_DJ868LBQNLVXiUTwE9OzUkEIyU3za15HrRDQOQJ5lIFuIoybLLBGX3Nk1fAPsAzp-jbOmxIrVpfCuyl86sw_FDILx-WfWRifzmmkGQQ5AupjGfW5DaZqV5s2N1Npre38uP_QkQvAmSCKgTXaiyDJoB2wb7MvKZb9lzsuJu5cM_M2w3sO13k82HFPbOtQ5KFKobYuHIjpsgAtrnbyFAKkCxNVE63rko7crK3UrmHhJobSHxQyDo-QZfnWEeNPBqJCYrnGaNTX7zD2U4hSnb146ppmZyGIA'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: '18c12c087c1de9e94b96645122faa962cdf52b1584dade67f0e86e67d4da85d5'
  }
}
!!! response success {
  body: {
    active: true,
    scope: 'profile openid',
    client_id: '3c49430b43dfba77',
    token_type: 'access_token',
    iat: 1705108772000,
    sub: '7be3d1085f834cbd97d0e47d3a9a28e3',
    jti: '90651c2a163f4ed4c17d96e054698dbb2617b01329d4df146fdf23a49ca27a36',
    exp: 1705130672263
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    token: '18c12c087c1de9e94b96645122faa962cdf52b1584dade67f0e86e67d4da85d5'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: '18c12c087c1de9e94b96645122faa962cdf52b1584dade67f0e86e67d4da85d5'
  }
}
!!! response success { body: { active: false } }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: 'd5e4ef61ac73ff0f4f4bb6656c25bdc7c49e2bf822cf4236c1334d7930a7b5fa'
  }
}
!!! response success {
  body: {
    access_token: 'd5d28fdca46b61ae795afc078f91bacb7593acc63df7bcce46d1719be8421043',
    token_type: 'bearer',
    scope: 'profile',
    expires_in: 21899
  }
}
!!! request {
  url: 'http://localhost:9000/v1/introspect',
  method: 'POST',
  headers: {},
  json: {
    token: 'd5e4ef61ac73ff0f4f4bb6656c25bdc7c49e2bf822cf4236c1334d7930a7b5fa'
  }
}
!!! response success {
  body: {
    active: true,
    scope: 'profile openid',
    client_id: '3c49430b43dfba77',
    token_type: 'refresh_token',
    iat: 1705108772000,
    sub: '7be3d1085f834cbd97d0e47d3a9a28e3',
    jti: 'ccb3fcf5be1729c388fe89ed6fa421ae6225e5ee82010c7bf8a492b5cfb5114c',
    'fxa-lastUsedAt': 1705108772295
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    token: 'd5e4ef61ac73ff0f4f4bb6656c25bdc7c49e2bf822cf4236c1334d7930a7b5fa'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '3c49430b43dfba77',
    grant_type: 'refresh_token',
    refresh_token: 'd5e4ef61ac73ff0f4f4bb6656c25bdc7c49e2bf822cf4236c1334d7930a7b5fa'
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'Invalid authentication token in request signature',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ successfully revokes access tokens, and refresh tokens (74ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cb994195b6c710b1b79a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cb994195b6c710b1b79a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cb994195b6c710b1b79a@restmail.net',
    authPW: 'acb857260435bdf90db2a7c07a16fe6bbd11ef1190942adc5a9a6bc8adfd14e6',
    authPW2: '3dec9c3a07d85412224271f021e2fcf310997f938041e90027490ae4eccaa21c',
    wrapKb: '5a39a60678e17bbc522ba9a4cd9479df81469752253efe0b8913475e00e21831',
    wrapKb2: 'e8103a3146cc90a8aa1a2b9fca2e9b80d072365ffad585fe6ff1391d67056819',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:25070699add8442ee7a9833d8de932535c6cfc35b80103a0d62656bb935c3ba3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0302334b483b447fb4f694e334fa8181',
    sessionToken: '9d1ab94559ddf534cfbb031500d2560861cfc93ac7d990039f0f54cd22c47666',
    authAt: 1705108772
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0302334b483b447fb4f694e334fa8181',
    code: '53bbc7f96d397979487e4645db38993b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/oauth/authorization',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7822ae58e10e4a752af7a33b5645bad4b5ddee7dcde447ad3edd25a32ab7f9c9", ts="1705108773", nonce="OLgVXr", hash="hjsWf3PEGdxhOIIiAoNby1OCyo8V6W4wWMWzqdwNthA=", mac="P+becsolma2zQrKzoz/pmwzy9k21eIXYKFnaV68l4eM="'
  },
  json: { client_id: '325b4083e32fe8e7', state: 'abc', scope: 'openid' }
}
!!! response success {
  body: {
    code: '6332f4c66ab41ac1aaf0c6ee00aff9c6b9029be8af9ff77a054ac98f7e94bc56',
    state: 'abc',
    redirect: 'http://localhost:10139/api/oauth?code=6332f4c66ab41ac1aaf0c6ee00aff9c6b9029be8af9ff77a054ac98f7e94bc56&state=abc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/token',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    code: '6332f4c66ab41ac1aaf0c6ee00aff9c6b9029be8af9ff77a054ac98f7e94bc56',
    ppid_seed: 100
  }
}
!!! response success {
  body: {
    access_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY3MiwiaWF0IjoxNzA1MTA4NzcyLCJqdGkiOiJhYTJjYzhkNzdkMzE4NDIzNmIzZDNjZjk5MjQ5MThhNzcwMWU2ZWZiNTNiYmExZjA5MGYxMTNhZmQxYTc5ZTBkIiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiIyODhhMjE1MzliOWU0MWVlZTQ3NDRjNTBlODAxMzU4MiIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzcyODA5fQ.T8bhGcObuzz0Ctvah771qbcRT-m2qxIFuSr-axSpADqLEKepUBU4-QO91-cHMMWp5Syna2cB5sd-OB2jhuGKCwXBNdV_Km9DYBevGJhjmEOnr8nhb9RLd4nmaxsAHDZ_17EQHduCrQdf7IBGudLMEnqAK-aFlJOuovr0UqPlCJv1Q3tKDgrmp_zbKrQpeiX5jDY0OrL99mkbfoYBdaAaCI4Y-jK1j0d4DIGpqAYpwa2e_AslGh2AVPYMAXHV5mDDtKZL2FyHY13p28yDLVFyaKFacz5QN_yUQo6wMpHbkgpsum5nGPuUFX5RCgz2WkfGTG1al-5UD1LXxCom0Vnu5A',
    token_type: 'bearer',
    scope: 'openid',
    expires_in: 21899,
    auth_at: 1705108772,
    id_token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJzdWIiOiIyODhhMjE1MzliOWU0MWVlZTQ3NDRjNTBlODAxMzU4MiIsImF1ZCI6IjMyNWI0MDgzZTMyZmU4ZTciLCJpYXQiOjE3MDUxMDg3NzIsImV4cCI6MTcwNTEwOTA3MiwiYXRfaGFzaCI6Im1USXZ6alpiWndqS2hvN2lLeGNCcWciLCJhbXIiOlsicHdkIiwiZW1haWwiXSwiZnhhLWFhbCI6MSwiYWNyIjoiQUFMMSIsImF1dGhfdGltZSI6MTcwNTEwOH0.kYMlzyZto4GLGvBsZNmMemRTaqLs7uCax29XFywEm0idARCL5f3GSr0mjX9P56mJbv_6H3FPqt2vjfW97rS3wKR73SGT915uhM6ngBMnkxGjYVE2zYrx3HPlLRvzkOTr2vpXrEcikwOEYJm5DTTSebbmUV6kNGtr8ZFkO6Aps1A0UaegX-rybOhe7DQC9NEpz_iguAvMz1g7-81Z2nrSoM3erO7Rru4_xbSBfbY7hJnjD0gwKMmM-N_pBibL0Gewfb24IAAiScjLSmxTszV_7HbfJouRqzfvS8FvcP-uHSU5MQG2l9fXDorp8MoVmolEDFJYYQz_WUtDd-8RLYDRUQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/oauth/destroy',
  method: 'POST',
  headers: {},
  json: {
    client_id: '325b4083e32fe8e7',
    client_secret: 'a084f4c36501ea1eb2de33258421af97b2e67ffbe107d2812f4a14f3579900ef',
    token: 'eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K0pXVCIsImtpZCI6IjIwMjMwODE3LTg0YzRhZjNjIn0.eyJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMzAiLCJhdWQiOiIzMjViNDA4M2UzMmZlOGU3IiwiY2xpZW50X2lkIjoiMzI1YjQwODNlMzJmZThlNyIsImV4cCI6MTcwNTEzMDY3MiwiaWF0IjoxNzA1MTA4NzcyLCJqdGkiOiJhYTJjYzhkNzdkMzE4NDIzNmIzZDNjZjk5MjQ5MThhNzcwMWU2ZWZiNTNiYmExZjA5MGYxMTNhZmQxYTc5ZTBkIiwic2NvcGUiOiJvcGVuaWQiLCJzdWIiOiIyODhhMjE1MzliOWU0MWVlZTQ3NDRjNTBlODAxMzU4MiIsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4NzcyODA5fQ.T8bhGcObuzz0Ctvah771qbcRT-m2qxIFuSr-axSpADqLEKepUBU4-QO91-cHMMWp5Syna2cB5sd-OB2jhuGKCwXBNdV_Km9DYBevGJhjmEOnr8nhb9RLd4nmaxsAHDZ_17EQHduCrQdf7IBGudLMEnqAK-aFlJOuovr0UqPlCJv1Q3tKDgrmp_zbKrQpeiX5jDY0OrL99mkbfoYBdaAaCI4Y-jK1j0d4DIGpqAYpwa2e_AslGh2AVPYMAXHV5mDDtKZL2FyHY13p28yDLVFyaKFacz5QN_yUQo6wMpHbkgpsum5nGPuUFX5RCgz2WkfGTG1al-5UD1LXxCom0Vnu5A'
  }
}
!!! response success { body: {} }
    ✔ successfully revokes JWT access tokens
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e0f055c09701db387f5d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e0f055c09701db387f5d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e0f055c09701db387f5d@restmail.net',
    authPW: '30a97d276f89f11d255ba71fc222bc3b041be58ccec5357fa4744c92abeab502',
    authPW2: 'b3d3b99302b04214a982d0fc6fb86afa70466b338b60b507e2af981624cce55d',
    wrapKb: '449a7d0b175c97ab2d834e088844d2bf60937675cd08af7b782b5ee602bfea64',
    wrapKb2: 'd1ea1fc2977c21540043edc9784edfe2fb4e0420b28eb144f88127706b36da15',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f1900b7d2cff42d0818bf03161e5960c',
    sessionToken: '7f665fae2137ba78ded0b97532889d9231e056c481fc3428f7a3ba11024bb716',
    authAt: 1705108773
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f1900b7d2cff42d0818bf03161e5960c',
    code: 'bd5db58803cbc45ce057d36700deb44a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db9aafb5764f27ecb470add3ad8ff63eca032bdb7e4e2d7a95c91713146a8cda", ts="1705108773", nonce="IUHQ3a", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="8DeK2FAToi9lGwQrOudYLCNBeVrvGEBhp9fR+yKQ1T4="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108773253
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'e0f055c09701db387f5d@restmail.net',
    oldAuthPW: '30a97d276f89f11d255ba71fc222bc3b041be58ccec5357fa4744c92abeab502',
    oldAuthPW2: 'b3d3b99302b04214a982d0fc6fb86afa70466b338b60b507e2af981624cce55d'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'facc71f3f642a6de1cbff15216953d17b4ca8d7a1f8cde2f422eae0d3f6688d3',
    passwordChangeToken: '8069484fe5af6dc5c048976bb5589bb4a607b273540c67307e7b4621a1d493e0',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dff0e89621bf07a010b4969e680cf1bb048a4d54f98ecb49bcdae7a5243ff8c1", ts="1705108774", nonce="t1F98y", mac="ZpxsrHgqWRm1EWJPVzqKbebsvVyGjjfQKaujMroXMls="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '32b1f5e1730ef436c8f91e928c8657aeb1732bab6513339fba23793c58a09d0390ed19fd6c01f379e5582dc60e34a62c0ac9f1cb596bd40925f9aecf9b8b843da37411012825ce24aea3d3177338be7ad8c7e2acda3bf2b109b3ed2e6b09053a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e0f055c09701db387f5d@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="96589004fb36fb46f4c743e6079c0e938dfa9908086dea04183a39d1eb85561e", ts="1705108774", nonce="SfcgK7", hash="pnHW8qah7wS+jAm2ztPgvJsXDMkcXh2GsyD0MXQMqjs=", mac="s+L45SbJ1V1TKZVGIxaEZuk+3eGWPMISuPVshT/tYEQ="'
  },
  json: {
    authPW: '7e686f2cf85a61bc034396ea195ae961b847d4a540999a2ca65fcfb87e05850e',
    authPW2: '23327c0bdef5409ecbb21ecb440db47ad985bf940158bb525b147c86116ccac4',
    wrapKb: 'afb47ca729b61818cf7fbd287054c792d8dbb6f5b844e22924796a6c5a56dded',
    wrapKb2: '9d39850719e8a7c8539651d3b9393636d8c7cbed5740be74e05ea20a15cd1ada',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e0f055c09701db387f5d@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8f4d27be53556c963989efc986f1ba202bac52525e75733656d6321a8e7caa4a',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e0f055c09701db387f5d@restmail.net',
    authPW: '23327c0bdef5409ecbb21ecb440db47ad985bf940158bb525b147c86116ccac4',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f1900b7d2cff42d0818bf03161e5960c',
    sessionToken: 'a730351946eed6dcd77bc9f65a9fb440cc5f43cec1599f2c65c8d4cacb5ff258',
    authAt: 1705108774,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="60450f09d0fc95d421cbd43e98dc5babf235dbaade9e8458d5e55b8a657d956e", ts="1705108774", nonce="pBfgQx", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="2/2DMZ2XEyI72Vl5tjBtzHmILb7AL6L/hN2NI8AEh6o="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108773253
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e0f055c09701db387f5d@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '438cc86a3138524d94c5dddfdb9bd13d530c79510b0cd6cf54ada6ca338c0ecc',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b65bc6e1951b36622e5165e436971c3e542d8cafd3c1742199e336f9ed4ec380", ts="1705108774", nonce="8AzsJo", hash="gy7Nr91ZtkW30yymp8q8GZNxhMZP4wfU5ykUBeAJ6z8=", mac="5usMOpN94oyNLF9+J7fW31CW4PRKmy+TfINnSc8j25w="'
  },
  json: {
    code: '8f9e631c60555684e007e3d6c59c26ae',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'b69ac6e635567cb391f4235c78fad7bcb5489aaee104a8e87ea497f6537b492a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="63f04dea68b0e02875210d44a16c0bbb2ab90ae18a97ca3b64ff6d6520ca8f40", ts="1705108774", nonce="BUqFcY", hash="lTChYdilbcjOMrQvXXL0dpT2KrW0yj0UHXKBMaNlo3Q=", mac="fR3pMFVcq2y0QG7ajnOF8KnhIvBR3YiPUq/FERaasBk="'
  },
  json: {
    authPW: '30a97d276f89f11d255ba71fc222bc3b041be58ccec5357fa4744c92abeab502',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'f1900b7d2cff42d0818bf03161e5960c',
    sessionToken: 'ce6c969a028eef62bc8bad26e0272b3aa3abb52e0f6d9a419e0a77c3c507d3f2',
    verified: true,
    authAt: 1705108774
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/scoped-key-data',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="67d6a49e8baa9a9e1bf47feb007e5fd30bd112dc2a2e7cfd34bcba927ae987c5", ts="1705108775", nonce="vuhymW", hash="TE96SH+KI89Gfc2l/s0+GT0ubk1cbNlSGbRvtTqjbPM=", mac="RVDy+N7m+O9FurIWLyHC+gzZbIk4Q4IfvaUzw/aqrbU="'
  },
  json: {
    client_id: '3c49430b43dfba77',
    scope: 'https://identity.mozilla.com/apps/oldsync'
  }
}
!!! response success {
  body: {
    'https://identity.mozilla.com/apps/oldsync': {
      identifier: 'https://identity.mozilla.com/apps/oldsync',
      keyRotationSecret: '0000000000000000000000000000000000000000000000000000000000000000',
      keyRotationTimestamp: 1705108774592
    }
  }
}
    ✔ sees correct keyRotationTimestamp after password change and password reset (1312ms)

  #integration - remote password change 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6f667deff32e3a11d012@restmail.net',
    authPW: 'fb9a3e3e4b8fd4c6a426e834431dace1a0de2d30074c34d5a57974c4e04426ff',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    sessionToken: '4a41d8ae3e3bbd97df361885eec2d7da57061ff0d6e22486c5804be8566f3445',
    authAt: 1705108774,
    keyFetchToken: 'e1d3ae63a956a9318bd01ba5cca761ecd2b4e060db029c34fa045cf8df4388d6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    code: 'a3ea4a2627a9063f2653da2aa07d0f8d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="30b62b03e34c60a853ad72ad431a3f5d17071445274c4e3b21ea8bcd649f1216", ts="1705108775", nonce="EHVkSr", mac="sGs8nlXo/nGdJdKjBOkRYX95o3HrM4+kSwBGKtyxElU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9a1ccff1c2fcc076812e4462c579e2f3035d9e9ea69209f06b9d436d276ca36eb74262067e8f062c1d72f05d5a9c6f7aac99f3fe7902f8d923c3c0074142844bec95a15c1a21c055e548e7d3b648bcdcb79cde3951718bb108f44e9ebac8f644'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d7a4ac00da767987bedbc4684c0f1b137db62450c6f83de586b24cb8dc09ccf5", ts="1705108775", nonce="slDPZC", mac="oFZNg21h8DYxPuNNELXaPLLU3zgXnTO5/JxN8nl9d38="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6f667deff32e3a11d012@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6f667deff32e3a11d012@restmail.net',
    authPW: 'fb9a3e3e4b8fd4c6a426e834431dace1a0de2d30074c34d5a57974c4e04426ff',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    sessionToken: '6f3d6a84e1e544a3af500b3a9feacc7bae2c094a2db5c8b5d2b8646889620070',
    authAt: 1705108775,
    metricsEnabled: true,
    keyFetchToken: 'd0839782dc77bf95b3fa93bfb0eaf7133f5e24f00f6a77155f2bdf5582990a06',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ddf474b603357dd9685eb97ee6f6f35dcdb00f5bb9ece6592dc6a29e9ef5fc85", ts="1705108775", nonce="o4t0ph", mac="zv5fkSt5epbmng8AwuR0VdUuOYLinC5wyA5upKq7SG8="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6f667deff32e3a11d012@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '6f667deff32e3a11d012@restmail.net',
    oldAuthPW: 'fb9a3e3e4b8fd4c6a426e834431dace1a0de2d30074c34d5a57974c4e04426ff'
  }
}
!!! response success {
  body: {
    keyFetchToken: '108996b873bddc0d29c4803bd59b747c5f5348842332a8487ff6cb0abd39ef5b',
    passwordChangeToken: '860504e8d1bcef57d01b6f6f2ccc9c032c520326590b5940a2083bfc698ccda0',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="05af45470f863bda15ca079b6ae5cd1f36687e5d333e5da3d75fa625886d223c", ts="1705108775", nonce="GwHOp-", mac="b8Ru6eozZ00vl3aRqAV3Tigit6PMsTNTQg8bsFLMAfI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '72b660ca06a9bf058b2aa9e55302b4181f33a4228275ec696c7ea9796ff63b82fb21f2bff3b2a91a015cc63791149277309cc927aa1946a82da68cede46741621956752b47eed2fe7b841a838fcc63da086968ef97a817d38c408092e942768d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6924529d8e6af2237401bcac3e109fead9ce705de16c80f63f48188a36d2595c", ts="1705108775", nonce="4qUlDf", hash="tV6L8pSzmrHFghLhK9XG0VluI3yUmHJ/Dvwg1LWzzWY=", mac="TRWbrJ93LK6QZzFghilsus42zgvkz6yN+rWCRLic4Jw="'
  },
  json: {
    authPW: 'dfcf8326e2bf6d40051b17edce250429836d6d8f998876c833fd085d183a8b05',
    wrapKb: '6a3fc0efc81f12d637148a43fe59302147bff8edeeebd195c85f70873a568619',
    sessionToken: 'ddf474b603357dd9685eb97ee6f6f35dcdb00f5bb9ece6592dc6a29e9ef5fc85'
  }
}
!!! response success {
  body: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    sessionToken: '13d4d83e22d69c3df5da4aa1d9ac8caaad8c806234e5470e14edd0ca334c9865',
    verified: false,
    authAt: 1705108775,
    keyFetchToken: '825740884daf994b9f19222f005b89e64da328799bee6ccf90654a1229c2dd8b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="039ff2d84a78a21c8f873b33cae1da48a8050dd2ad0a6152b3a2fffdbf639fbd", ts="1705108776", nonce="sOJRnk", mac="hMTyxN6t1FFgXDxo4bvOHzmeCtpv6qUQVE98sapLMhM="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6f667deff32e3a11d012@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6f667deff32e3a11d012@restmail.net',
    authPW: 'dfcf8326e2bf6d40051b17edce250429836d6d8f998876c833fd085d183a8b05',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    sessionToken: 'b816558c161875786210160d9fd496ff72977b49a54dca96fd80866ff99b23fe',
    authAt: 1705108775,
    metricsEnabled: true,
    keyFetchToken: '270f591f984dc26814600993ddf6af951c1ac2afc0e2acfb85c92e7edd0883e0',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '60af7b3e247348b7bf053c978cfdec02',
    code: 'bb8d2091466778f4b8dba6d92ea894f7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c5d5d4b48a4f57971158a8039336b86d57f90f065d2aaba68c2897bcc6877e5e", ts="1705108776", nonce="1Rb36M", mac="FtwpUFKv3b/DErwDjiiU08cGEanfMi3C8deZzkkhrss="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9faf30ff2b8da89671654514b528c8c53a7b0aa444bd9da1a12b399f36c7fe633d0d943f5790405621476ebb0366be026747bba36ac625c90cc4cf5b6446c31535e6e279e4527046fcc980622ba95b6a635f1de6b4770c84af31b624bd83c855'
  }
}
    ✔ password change, with unverified session (1114ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'eaed9a6ff7d43a0c9629@restmail.net',
    authPW: '5847ffc796b8227496bda68e9062138be2e8b85d1d15eefc546df04dee25ea1d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2fed4bf8d60d447f9d9ab6373790efc8',
    sessionToken: '8070e5279384b61054ab273778bf26e5b127d560114b5adedec5d22d82f7f2c9',
    authAt: 1705108775,
    keyFetchToken: 'a3f7d71622eb45d05d057854831346ed9e2d1a8944cb6ebdaef8f26dae424417'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2fed4bf8d60d447f9d9ab6373790efc8',
    code: 'cea610dafb56d2c17d97c0a59f9e7a34',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4fbd12451e3b8a6195a50db7b002f5085402cad02c718fe3e7b0e10004b57ede", ts="1705108776", nonce="-kU6tv", mac="GIwnSE/Vw4KKe/0X8rTQh1dr2p0OA7hOmuyqTNqVRkQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'eaaf172a354bbe1315e2cdca9a85d9e90bcce459a0bac28eccf4cf5f1f731126b34f4bc7a288b8f965f4f263d2b5681830f700761143d9463e20e11e075d83ad69584069034c1c7ebccd894f0d6cc60daffc56fffe376d3856fbbc7a9e5c0f96'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="252ebec7cef713a468f61388711076eac955572791d4492cf3f9fbdfaf13a1ea", ts="1705108776", nonce="6qo4_B", mac="gG5WKrAbOOJCdk9I7SBFnuUXQLvNQUtZ5mWPafc2qm8="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'eaed9a6ff7d43a0c9629@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'eaed9a6ff7d43a0c9629@restmail.net',
    oldAuthPW: '5847ffc796b8227496bda68e9062138be2e8b85d1d15eefc546df04dee25ea1d'
  }
}
!!! response success {
  body: {
    keyFetchToken: '47d9269cdb577dc348ecc7e021011010d237c5e330123c79bc4370c51a256cd4',
    passwordChangeToken: '2b2864985dd18e2f99c090b63621d1f2b3536f8335915452f5239b87e79ef88c',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8d18ae3da4c1d7b7cd5ec665b8d02473d59221affbe2ebb2c36779eb0803269d", ts="1705108776", nonce="920xmU", mac="DpNOVdGh1CsLw1eBirkqZbn4U/NQQyF7RzWOjls3kLI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '34e472102aa91587494ad5ba7fdc1b2255c4e3d18a2a5cf6c9ad31784d61039cf39a8e36ff3d5c2ba203f4fbc3c625f4a868a61f66931a0bfeff966f9ebf192d6f4493b07f140760d88174fa7f75cb6bee24306a1c263cc061c8a59ff7ee44ff'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="912793162ba439d2270a236fea954c241d21a233acd8891de7b40584c399d8f5", ts="1705108776", nonce="PgMUc8", hash="/dUkn6CAeTz0segIKI58XdfBicIBPnueo9Lmu/nvbSo=", mac="+RLdXgZzKsmQAeyQxIQUQRpGebbK2srFDgJOTMgsthY="'
  },
  json: {
    authPW: '69afe71ea229c88c3ab590b8d824a6d12ca8dbbd4661f98aa8ca60d68b2d746d',
    wrapKb: '6b1ad84b7745d44741d0c26246ac6108a1ebe2122735e808c2d65b959d7cb458',
    sessionToken: '252ebec7cef713a468f61388711076eac955572791d4492cf3f9fbdfaf13a1ea'
  }
}
!!! response success {
  body: {
    uid: '2fed4bf8d60d447f9d9ab6373790efc8',
    sessionToken: '380a9eff9ef1f178f6349af78f48fca057446fcd4234507baa5cd40defd4c0be',
    verified: true,
    authAt: 1705108776,
    keyFetchToken: 'de7e01f65a07069f13b65dfdf635346fff7fc6abb452502754843131fb6dc8d0'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5f59e93bc63e5be61c3cbe7c4c07e56745d67872adb04bf2d9f8da9f86185a96", ts="1705108777", nonce="_NK5bk", mac="Wbnd4x0enF3RsEiORd859yobhqUWn3Fj1SnAvchpTIE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'eaed9a6ff7d43a0c9629@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'eaed9a6ff7d43a0c9629@restmail.net',
    authPW: '69afe71ea229c88c3ab590b8d824a6d12ca8dbbd4661f98aa8ca60d68b2d746d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2fed4bf8d60d447f9d9ab6373790efc8',
    sessionToken: '19e6e8131e6d3944066dd152f46854b4ef375fc478c2081ad7cbd463cee30899',
    authAt: 1705108776,
    metricsEnabled: true,
    keyFetchToken: '5dc40847a6c0b944559261d7d7f8a523a23c60b5c4a2bb0191d325402ee81349',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2fed4bf8d60d447f9d9ab6373790efc8',
    code: '13d27425bd6fe8afbd5ccb41e4e1de52',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ba1ec3be3e5b1f44d5afc817ce5b15e56c6e68d510fce1a0d0bc8fb98640c977", ts="1705108777", nonce="3UfP2d", mac="Y+kvt8RAVKRhntlB0Fy75id4H+a4PJVhhx6dMFGOEGU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '30e057da932a1644692236f56bf64b9ff23c02ba1bb496dd85bfe59783d9e260d6d1021df7a901af22beec58a52dbb8643df2b2329ad4c7dae9b10f152d122e18407f9405b7374386b5cfd0dd839060789683a958b17d366a95fff9ead7db208'
  }
}
    ✔ password change, with verified session (944ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6ed16141ba722b38d49b@restmail.net',
    authPW: 'a6c1e5d27ed934084d02ac8afa4cc446358b4c2afd47b901e7d559c9c7453318',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0dfe185f25b240f9aad9ed6f8bec4068',
    sessionToken: '23f382352f1db6917771d79794d9f98953d7569181c534a9c5ef8fc8b6b0bb3f',
    authAt: 1705108776,
    keyFetchToken: '649faaf02cda2af9c91e1468a987efe2051e00238ba21ba712ccadd97639e0da'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0dfe185f25b240f9aad9ed6f8bec4068',
    code: 'cbcee88a9cabc290f19280ad1de9e039',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="64f613a8397fd190294245d4a355c63bdb104182c2055907a0ce826e9554dade", ts="1705108777", nonce="i0_pIz", mac="2kQzrWeaQA3gd+kKV9vz6N/+L0YGoUjOemFo1J5FKio="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '654a18839a6b6c5df449b21f5158e95146c662c0a1d1985cd7d5441c13ec2a61388e96581eb7add5b8c67d807ad36a874ff18b91b1f02943dda5af51b7c4590d12a96c17399a442a120f44c99d049b5e5d46e97e3f2b14c86321e4ee48a0a1c6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5c1e09307e9b834628de6d43950e46d296a5fec6c8a0f21da8e83145c6b54f95", ts="1705108777", nonce="30zbEF", mac="MpEmb76UoeI/+Nxg9ZADBFY4lo5ws3SG8FNP+YvjVik="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6ed16141ba722b38d49b@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '6ed16141ba722b38d49b@restmail.net',
    oldAuthPW: 'a6c1e5d27ed934084d02ac8afa4cc446358b4c2afd47b901e7d559c9c7453318'
  }
}
!!! response success {
  body: {
    keyFetchToken: '43129a7e3b30b2b1cd6d4a740c00c3871dff69de1c41d4c875942cc2ea522198',
    passwordChangeToken: 'ae1ebe548a4675a73154237e4008301d2791898a955fadfe9a4e669398b5c38e',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="269c5736f05180fb0877e07b4f84d0a57f024578dc4fd070cc171a218da71a77", ts="1705108777", nonce="UzzJEB", mac="JJpCriI5iHqnOrvLK02/DZBg43ULfhtXjMsiPOqvht0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'c2806eac8d7f0d3f4067e1648b0f39d02aa093a4b2b717e6b10182a7afddd8a5edc8e6799e4f19e7602f716e380eaf866904145a145cffc2537c027fe4c4a7eb92a6664987603e7638a1f2ddc381dcc24a4c493f508e95102690d04501d49269'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4cb97d35cb79ea23dadeb12361544c478d198cbb2cd3c4e4069024a3289d4918", ts="1705108777", nonce="WDGz2J", hash="q4WbAnZ/RM1PZsGlBvp9ce3tTlq0vI8T7B9dUF/E8v8=", mac="EZ6UWQnfEgRyFFItXWX5UqVTOCeqNQsCf9gRj5NmVRA="'
  },
  json: {
    authPW: 'db815ed3f56002583fa26789589af015583a213fdb3b74fcc7062f81467aee0b',
    wrapKb: 'a72b4e28891183630f266aba3b53dcd0e02462964742cc1774396cd5105839a9',
    sessionToken: '23f382352f1db6917771d79794d9f98953d7569181c534a9c5ef8fc8b6b0bb3f'
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ password change, with raw session data rather than session token id, return invalid token error (411ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8890f228a731e7c41326@restmail.net',
    authPW: 'fa8ef2cf51044d1b366c4048bcf46d244abc905472559161f12dd1ef9681b952',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '00c7c911883c4729a719a5c4614d1bf6',
    sessionToken: '4be54be4690a4b7e21a9a1bc1d062653bbc954b7be852b64bdbc9ea4a77962c1',
    authAt: 1705108777,
    keyFetchToken: 'cca747dc35ddfec0d46668c9cee72024b0e99dcc747f29b383d1a7f6200929f7'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '00c7c911883c4729a719a5c4614d1bf6',
    code: '4339059e5fb8e3def1a6ce799614ed50',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f7d7d7e094be001e0268163430d6269fd1817903ca129658423088515a6768fb", ts="1705108777", nonce="h4dMvd", mac="d1TF5wuwh7O0X/53JrvdLQvjRJFRKsReXpv/G/kZk6I="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'a3f12b820bdd6191f46fbadd97fc864d827e68be37072bbfdf097f51c71af049d163f48ac66145c2cf07adba4794e2f289942f391741efd035f203b51fbeb41e3bc3c30e984fc201ecb02f4d5eb5e7d4cf31f3d559fb5d086f257cfbc19effc4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '8890f228a731e7c41326@restmail.net',
    oldAuthPW: 'fa8ef2cf51044d1b366c4048bcf46d244abc905472559161f12dd1ef9681b952'
  }
}
!!! response success {
  body: {
    keyFetchToken: '1c7d48324f2e42320bef5f454c8a7aa3093e115eb612d3f05e495ade9802c3fc',
    passwordChangeToken: '9178a7e87916bf54bc9765c2701edc7bf7924ed4c9441a1f9a1a3afd159de565',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8e5d54b140fad61170295516b8314f922984c481556383d708a86f8a040451fe", ts="1705108778", nonce="SkVoda", mac="EFdoq34w/KD9eDxf3Y2PJ3rGHLbA3mAIN3GgzCaM22I="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9f52dc1faf0a4fbd99cc626b1634bf6405aaf876fb4eb0977aad188e95c171791d61c381d0456b153360105cc4cc59a1e1181a9f120475964a7193a61b60c68b0726989987e7d08d3d34657d0f49b1a141066b74d2f6b46d73d326e58cff6b82'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6cb835221df0b35dc7cd0096554d14f7cb965955cf8ef19883ec602ed5ac0091", ts="1705108778", nonce="Y9QY9m", hash="a8pex/alTjCkYFZFHnJpV9DkdXQMLnnojvN06BmFpqk=", mac="JFWeYNA1AMNQLL6VrpmQ5QJRebHrIz2bqML5vm0JvIY="'
  },
  json: {
    authPW: '4bc0286ac43106a1a6ab3128725cb12bf4718735d921e3827de57d74d47be23e',
    wrapKb: '32e88666860a48774d30039570a15c01b227c28d6c391bba81c53b68a4b18e9c'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8890f228a731e7c41326@restmail.net',
    authPW: '4bc0286ac43106a1a6ab3128725cb12bf4718735d921e3827de57d74d47be23e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '00c7c911883c4729a719a5c4614d1bf6',
    sessionToken: 'bb07c836df8c13e07616662a5a63576ad3da6acbc8e8f5789fa58c0500b18e07',
    authAt: 1705108777,
    metricsEnabled: true,
    keyFetchToken: '985464d0c56d7859cf25c42666d5f460dbd0616ec71d89310679d34497ab2059',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '00c7c911883c4729a719a5c4614d1bf6',
    code: '9880bf4c0c289412d0ed389b8efdc87e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fa2922188ec9487969a7efc79ae04b9658e8bf0a4033c8948f0f83d335b80cb1", ts="1705108778", nonce="FBfzPe", mac="l1WyJVYwDl9a8m4RZeZycKhlQYKx3w+5ZIGZXpsliTQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '534dceae9224455652cfae181b73062442ae37c0bee4ffc33d788780c0425c785ec8295a9c626b8457230690d1f0b472f62aa1490c886987482832e34ef1a3176d86e6b6d1bba0213bb7697916902ff35c867d6b8a5feb2283c9a1d12ca4462f'
  }
}
    ✔ password change w/o sessionToken (890ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '86e551dbd7c5d43435f5@restmail.net',
    authPW: '01fdb78d996969381fca769e2767087eed2dc4b854856444641baa278e9ac7ef',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '995a7b397c7447d18ed48fcda9984a41',
    sessionToken: 'e56326f3537449034f3d0960dcd5530531af1f55918eb188a97e49f04bd53d7e',
    authAt: 1705108778
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '995a7b397c7447d18ed48fcda9984a41',
    code: '92b97862da732c00c757031fa901c73d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a83c2b93ff36460de9aa9a3d387548c5b9a5933923d0493ae343c861d29f8b66", ts="1705108778", nonce="Im4Hir", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="yyTGtOq3PgpvR2HAkJ6SzcScN10bs2HYvSypVCOFqd8="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiOTk1YTdiMzk3Yzc0NDdkMThlZDQ4ZmNkYTk5ODRhNDFAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzY4MjkxLCJleHAiOjE3MDUxOTUxNzgyOTEsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Nzc4MTkyLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc3OCwiZnhhLXZlcmlmaWVkRW1haWwiOiI4NmU1NTFkYmQ3YzVkNDM0MzVmNUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiI2ZDlmYzAwZGI2ZTczNzg3N2Y1OWFiZjAzZWZlNDAzNCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Nzc4Mjc1LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc3ODE5MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.jAJx054BEyj3M0es-UdtBK-OwyucLBTPxOFBfVDGOtQrym9gFSe9lB_vWkUqq2fKmChZ2Idti1aYyG2hjfWULCLyQ6qFq8VGV_grcJ0qbDIP2cud6AtFANjbF88xy0Mvxa9IUMtGeqk-iNR7T0JBnY1hXCQfA_aryi16ixNk5AG0TsJ-ZUigypmUICQlPVTNqlJ4YgnBljpQS7M71gV2KUTU_77-XI_gJOOpGOZOTzy_-vp4YFH41XBphiOtVEwDpZwME0Qack1rnzWtJ9vP8N3J7J1fbjIkN8Rkc9VmdeUWkhvtZAS9z646MKy22MUaJ_PmMVlzcto-XdI9rH92bQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '86e551dbd7c5d43435f5@restmail.net',
    oldAuthPW: '01fdb78d996969381fca769e2767087eed2dc4b854856444641baa278e9ac7ef'
  }
}
!!! response success {
  body: {
    keyFetchToken: '24f5385d0e8a445a880d8648cde1003e2822c5fa81bf46f28380f22e38f173a9',
    passwordChangeToken: '97d2d34ac07e2bec9b1062de925159c0de2c1980851ee1d81a2f601467fadab6',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ed498c910e112a88378ac3b63e2e62cd096238304ce25cd0e41121f2195fd3e5", ts="1705108778", nonce="VS4i9E", mac="oQsHepOhPg3HkCIW6mUHiFnKMCdKSUvb4s2DGL76PCY="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9f883331ccd320b2fe10c93fa596b69faf3bd5a9a2f4dc570478a2f306075159e4b62b14444abbae243f452790d03d379ab6ae254a13627436208bbfd9ea38f169d94f909eb10f9208c21bbc067a4f839837818003f4bbb6a77c5ab71615bb47'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5974bdee004a2fcb36ddb4d97c8fe4833478f9c0b23c4c64e19f3e68ec189ad6", ts="1705108778", nonce="shJN-F", hash="KEDrvpLibjxzHN98VUB/0tRWOqZCUBDfW9Vq9+syOl8=", mac="1hWe0f/4jEQ5SUNtSIhCf0mLWG3bVQSq03uZICprwJs="'
  },
  json: {
    authPW: '9d5d8a0a1258771c04d7bfe0f1b03a7338bddbc976ff84fe6a188fdd3602d605',
    wrapKb: '8b827fe87872ac00173bef803fd6692a8c333a82cdde664e56bc91300629870e'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '86e551dbd7c5d43435f5@restmail.net',
    authPW: '9d5d8a0a1258771c04d7bfe0f1b03a7338bddbc976ff84fe6a188fdd3602d605',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '995a7b397c7447d18ed48fcda9984a41',
    sessionToken: 'f5639700fe217a60faf313db4277cec5be8561e9cbc43c72ab30f8138fc07d2d',
    authAt: 1705108778,
    metricsEnabled: true,
    keyFetchToken: '915299cc03faa6aa33486f52085998744f42217a3f532a1bd442fd6d8cd77b12',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '995a7b397c7447d18ed48fcda9984a41',
    code: '5932c5ab3c82ab8018a9512e2ac3aa22',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="654a3cdd02c482189fd345b4c52fbe65ce39f1179da514247e609e73b838b414", ts="1705108779", nonce="58L5Vz", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="h/RC0dfmDNyJkfFxqL66F4UBrFctIkltlDVFNv5B4u0="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiOTk1YTdiMzk3Yzc0NDdkMThlZDQ4ZmNkYTk5ODRhNDFAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4NzY4ODk3LCJleHAiOjE3MDUxOTUxNzg4OTcsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Nzc4NjExLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc3OCwiZnhhLXZlcmlmaWVkRW1haWwiOiI4NmU1NTFkYmQ3YzVkNDM0MzVmNUByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJhN2ZkMDAzNTk4M2Y4NWU5YThjN2MzZDc4ODNiOTgzZSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Nzc4NjExLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc3ODE5MiwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.YzT5287hVtwZyYJsQ5fwQ17gFL8Y-__oeDE6Sp40A2hFFvz0gRPELhjFTxPUm8yEtc4HOLJnw5kW1oAsaBoOJ7ye9aySz0pc6EyYShrNvDGupN0VQa_nNE0e8jPYDjkowLpinwZnmRdW-oKp3SKDjLSZvKS36F45PxsdcvIMrndFWuqHINh_Te71Z2-1nxSHKh7N_hq2G7L_ufrRnyQff2OIV0ZrcZyNxEmsg0Ja3pLtxIVcTMEs7GjPvAx_ywjjr7OO7fKVqYvdgQHa52kIiCVeUzpNmbP7_xqmDHnJNaBnAsJ3rP6T8BNPsTWi6Srndy_1qFLae7FTk7VUEEWwnw'
  }
}
    ✔ password change does not update keysChangedAt (841ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3af32187e2bcd1139466@restmail.net',
    authPW: '39eddfe95b49a6ea26f40503d5908e4d0ea60ae2db4631655e3d0d66cc847b13',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '119db17f5d07463894d973d06bd49540',
    sessionToken: 'c1574830ebf4e4e4c129d640fc96e88b90e3c7b3b84a3b31fcf5a66773d8cd8b',
    authAt: 1705108779,
    keyFetchToken: '6cf57a04ea622cbb7aa8e0879e2bee12fb4ad48ae65d1e028066a9267901aba8'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '119db17f5d07463894d973d06bd49540',
    code: '55fd5911cc08298850a3315fd94c370c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="be8ec9bb821f59febd4de25156daa2ff2b3a1418d66fa01f49f409ffc80d9bae", ts="1705108779", nonce="J2liBF", mac="LJ8a4EetqDf+ut0o3Lx0JJS0Ct5qrhixCOb3nCpBgDk="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'f0d3bbbfb56a730a219c8307b9a1be686a7ec3b8710b6927af0b0a1b5f2db4d4f835573219aca53db93a09d97167cdbe754bf1dad2f46ee453cb804b7539d645b43abf57055ed480e34dab0e6804b983cda4e3b0b3ca5b12710b60e6041df898'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '3af32187e2bcd1139466@restmail.net',
    oldAuthPW: '0000000000000000000000000000000000000000000000000000000000000000'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3af32187e2bcd1139466@restmail.net'
  }
}
    ✔ wrong password on change start (358ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '80028d871acc40385d6e@restmail.net',
    authPW: '5fd2ce005e977ecd4a6fec14b4267a4d3a242dee4c1f76f58ec1c43ae6fa8929',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b9abc33b25f44fb78e322ae52e2df8e9',
    sessionToken: 'c54e733235b6c4229877be61a051a1518b91f359a182ea3f1ac3f5dce547c60c',
    authAt: 1705108779,
    keyFetchToken: '86e05fbeeafd788276d3d3ac2c8a2c5943f3b20f1273b4e29dba267eb18a6ce2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b9abc33b25f44fb78e322ae52e2df8e9',
    code: '00ea68468a1f4b0d3a6fd49a89f62fbd',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ba1dc152788b35ab7611909ce770dfabcdcb8bc629bc38b3389bd7e07d75991", ts="1705108779", nonce="yp_CNn", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="MNix7eF3eew17shy94zTs/GxmtSlkpM0yXkI1bl8qgk="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAAA/0SURBVO3BQY7ESHIAQXei//9lVx8IKC5KgGBVz+wqzOwXa63162KttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6/fCSyl+qOFF5o2JSmSomlaliUvmkikllqjhROamYVKaKSWWqOFE5qThRmSomlScqJpUnKk5U/lLFGxdrrXW7WGut28Vaa91++LCKT1J5o2JSmSpOKiaVqWJSmSomlanik1ROKk5UpoqTiicqPknlpGJSeaJiUnmj4pNUPulirbVuF2utdbtYa63bD1+m8kTFEypTxaQyVUwqT1RMKlPFpDJVnKicVJxUTCqTylQxVUwqU8WkclJxovJExRMqJyonKt+k8kTFN12stdbtYq21bhdrrXX74f+5iknliYqTikllqnijYlI5qZhUTiomlaliUplUPkllqphUpooTlaniROW/2cVaa90u1lrrdrHWWrcf/sNVnFRMKlPFEyonFZPKicobKk+oPKEyVUwqJxXfpHKiMlVMFet/Xay11u1irbVuF2utdfvhyyr+kspUMVVMKlPFicpU8UTFpPJJFZPKVPGEyknFicpUMalMFZPKVDFVvKEyVUwqU8UnVfybXKy11u1irbVuF2utdfvhw1T+kspUMalMFU+oTBWTylTxRsWk8k0qU8UTKlPFX1KZKiaVqeKTVKaKE5V/s4u11rpdrLXW7WKttW72i/V/Upkq3lCZKiaVk4onVKaKJ1SmiidUTireUJkqTlROKk5Upor/JhdrrXW7WGut28Vaa93sF39I5aRiUjmpeEJlqphUpopJZao4UXmiYlJZ/6tiUnmiYlKZKiaVJyreUDmp+KaLtda6Xay11u1irbVu9ot/EZWpYlI5qZhU/kkVJypTxaQyVZyoTBVvqEwVJyqfVPGEyknFEyonFZPKExWTylQxqUwVn3Sx1lq3i7XWul2stdbNfvFBKlPFicobFU+oTBWTyknFicpUMan8pYonVJ6oOFGZKiaVqWJSmSomlZOKSWWqeELliYoTlaniCZWp4o2Ltda6Xay11u1irbVuP3xYxYnKVPGGyknFExUnKlPFGxWTylQxqZxUTCpTxaTy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',
    secret: 'KMYTMWCJKVZGKTSOIN5DGQZVPAXVQ2CI',
    recoveryCodes: [ 'yvqga4cvjz', '7jw42v13xn', '86323awcmm' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ba1dc152788b35ab7611909ce770dfabcdcb8bc629bc38b3389bd7e07d75991", ts="1705108780", nonce="mdv4qp", hash="bCOMC/7yikhwJMH2JE/hNhFsOdTiJ64O9Xg5PQ+K8es=", mac="iMEFUuoaqOA0/sM3Y0H1Nr0Sy/wgechpUpj4zMf15fU="'
  },
  json: { code: '333442', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '80028d871acc40385d6e@restmail.net',
    oldAuthPW: '5fd2ce005e977ecd4a6fec14b4267a4d3a242dee4c1f76f58ec1c43ae6fa8929'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'd5fd7a3e10ff9fff36d5d3138d8a84c7800c500edb471ec6b633b47d4c9a2845',
    passwordChangeToken: '06bd4dd76ed486dcddfea05d62706a0c1337c3bbba188e3b73d0d1dedc6ae207',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1f0d5e82758e498a3dc906891aaab7ef8d55eac170e135e83a9d1a6126ee7968", ts="1705108780", nonce="2onrw2", mac="4HSKMMH3mIK8vAntwtZKitLvicNOm7TnbPhCt0ssI4s="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'a8d4bc7e3b7f22b956f4bfbfac81696574772c58912538fafa8c2d856ad109676252afd572b91eb511f17e2313f164a1943bfeeffc5e8a4a7b66411b3ead00ed745625ca85d340547a68f7ec4fa37d91753230c2d31306c90ce3dda34d1a5118'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9ea236cb60eb7a8356ff8a7965e7347115822a183bab0db313e6c4e18c85ffc7", ts="1705108780", nonce="60rqg6", hash="q/nuBB92qX3FtS/TviMhDSF2a6pLr2IgSLAvFCHvU0w=", mac="Wg4z2SXofTxE2fUlDJmClHxn1I7MQI37UbSLGiyHy9c="'
  },
  json: {
    authPW: '506a1251514ef095cf6e05f728da3f9591ff9d9605f3b5dad8033db89fca0a09',
    wrapKb: '82f5f13b521ff70dee508c90d6f42fb8a7248a78e4876c20a73d36a438c87aa3'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ shouldn't change password on account with TOTP without passing sessionToken (630ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0052b01945d1d8255eda@restmail.net',
    authPW: 'd7b7512e6bc892e90737ae727f5cbf0a8b7868dd8148197fd86715ce481b30a9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fe6391153b1a408abecb6a7c60a967b1',
    sessionToken: 'c6149c4181a39046f15da144846a5f76763c262d241e13e3cf8071fa8adfe28f',
    authAt: 1705108780,
    keyFetchToken: '1b3727cd18fd50c5c57ee774fa7264dc49ee2351e0da238363f55acc95237d3f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fe6391153b1a408abecb6a7c60a967b1',
    code: '123f9f0395f5a306a6c46027e51b415c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="93c783e85a1a2418495c77e53e480795f93bc39837f15cfbeca9bd2a3f93ac7a", ts="1705108780", nonce="X91YHX", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="WonhLe/yHGk6k4BUmKW9WfrTre+mys9PDbYRYguutjM="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAAA/+SURBVO3BQW7EWLIgQXdC97+yjxZcxGYeQDBTVdU/zOwXa63162KttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6/fCSyl+qmFTeqJhUpooTlaliUnmi4gmVqeJE5aTiRGWqeELlpOJEZaqYVJ6omFSeqDhR+UsVb1ystdbtYq21bhdrrXX74cMqPknlpGJSmSomlZOKE5UTlaniCZWpYlKZKp6oeEJlqnij4gmVqeKJihOVk4pJ5Y2KT1L5pIu11rpdrLXW7WKttW4/fJnKExVPqEwVT6icVEwVT6hMFZPKicqJyl9SmSomlTcqnlCZKiaVqeIJlW9SeaLimy7WWut2sdZat4u11rr98B9XcaLyRMWkMlVMKlPFVHFSMal8UsWJylTxT1I5UZkqTiqeqDhR+V92sdZat4u11rpdrLXW7Yf/OJWpYqp4QuWJiknlpGJSOamYVE4qJpUnVD6pYlKZKk5UpopJZaqYVKaK9f93sdZat4u11rpdrLXW7Ycvq/imiknlpGJSOamYVD6p4kRlqphUJpWTiidUnqg4qfikikllqnhDZar4pIp/k4u11rpdrLXW7WKttW4/fJjKX1KZKiaVJyomlaliUpkqJpUTlanijYpJ5URlqjipmFROVKaKSWWqeEJlqphUpopPUpkqTlT+zS7WWut2sdZat4u11rrZL/7DVKaKE5Wp4g2VqeINlaniCZWTiidUpopJ5S9VTCpTxTepTBX/Sy7WWut2sdZat4u11rrZL/5FVE4qnlCZKiaVk4pJ5aRiUnmi4kTl36TiDZWpYlKZKk5U3qh4QmWqmFSmikllqphUpopJZap442KttW4Xa611u1hrrZv94otUpopJZao4UTmpmFSmiidU3qh4QmWqeENlqnhD5aRiUpkqJpWTiidUTiqeUJkqJpU3KiaVqWJSmSo+6WKttW4Xa611u1hrrdsPH6YyVUwqU8Wk8kTFGypTxUnFX1KZKiaVk4onVKaKk4qTiknlpOIJlaniROWkYqqYVKaKSeWkYlJ5ouKbLtZa63ax1lq3i7XWutkvvkhlqphUpoo3VJ6oeELlpGJSOak4UZkqJpWp4kTlpGJSmSreUHmjYlKZKiaVqWJSOak4UTmpmFQ+qeKTLtZa63ax1lq3i7XWuv3wYSpTxaQyVZyofJPKVDGpTBUnKicVT1ScVJyofJLKExVPVHyTylRxojJVTBWTyqQyVUwqU8UTKlPFGxdrrXW7WGut28Vaa91+eEnlRGWqOFGZKiaVqWJSeUPlCZWpYlI5UZkqTlSmijcqJpWTihOVJyomlaliUpkqnqiYVE4qJpWTiicqJpWpYlL5pou11rpdrLXW7WKttW72iw9SmSpOVKaKSWWq+CepTBVPqEwVJyp/qeIJlb9UcaLyRsWk8kkV/2YXa611u1hrrdvFWmvdfvgylaniRGWqmFSmiidUpoo3VKaKSeUJlaliUjmp+CaVk4pJZaqYVKaKSWVSmSqeqJhUJpWpYlI5qZhUnlA5qZhUpoo3LtZa63ax1lq3i7XWuv3wYRUnKlPFpDKpnKhMFZPKGypTxaTyhspUMamcVJyoPFHxv0xlqphUnqh4QmWqmCqeqPiki7XWul2stdbtYq21bvaLP6RyUvGEylTxhso/qeJEZaqYVKaKv6QyVZyonFRMKlPFEypPVEwqT1R8k8pU8cbFWmvdLtZa63ax1lq3Hz5MZap4Q+Wk4kRlqniiYlJ5o2JSOVE5UXlCZaqYVE4qJpUTlZOKSeWkYlI5qTipmFROKk5U3lCZKiaVb7pYa63bxVpr3S7WWuv2w5epTBWTyknFpHKiMlWcqDxRcaJyovJGxaQyVUwqU8Wk8oTKExWTyj+p4qTiCZWp4pNUpopvulhrrdvFWmvdLtZa62a/eEHliYpJ5ZMqJpWpYlI5qThRmSpOVE4qJpWTik9SeaLiRGWq+EsqJxVPqEwVk8oTFf8mF2utdbtYa63bxVpr3ewXf0jlpOIJlaniDZWpYlJ5ouJEZap4QmWqOFF5o+JEZap4QuWkYlKZKp5QeaJiUnmiYlI5qThRmSreuFhrrdvFWmvdLtZa6/bDSyonFU+onFRMFU+oTBVPVEwqJypTxVQxqZxUvFFxojJVTCpTxSdVTConFW9UTCrfpDJVTCqTyknFJ12stdbtYq21bhdrrXWzX3yQylTxhMpUMalMFZPKVHGiMlVMKicVk8oTFZPKVDGpnFQ8ofJJFZPKVHGiMlVMKlPFicpUMamcVEwq31TxT7pYa63bxVpr3S7WWutmv3hBZaqYVJ6omFSmijdUTiq+SeWTKiaVJyreUJkqTlSmihOVJyomlaliUnmjYlKZKiaVqWJSeaPijYu11rpdrLXW7WKttW4/fFnFpPJExYnKScVJxYnKScWJylRxojJVTCpPVJyofJPKVDGpnFRMKlPFEypTxaQyVUwqk8pU8YTKVDGpTBWTyiddrLXW7WKttW4Xa611s1+8oDJVTCp/qeJE5YmKE5U3Kt5Q+SdVTCpTxaQyVUwqT1RMKicVJyr/pIp/0sVaa90u1lrrdrHWWrcfvqziRGWqeELlROWkYlJ5o2JSmSpOVKaKk4oTlaniCZWp4gmVE5Wp4pMqJpWp4omKSWWqeEJlUnmj4o2Ltda6Xay11u1irbVuP7xUcaIyVTyhMlWcqEwVJyonKlPFVDGpPKHyhMonqUwVT6hMFScqJyrfVPFExRsqU8VJxYnKN12stdbtYq21bhdrrXX74Y+pPFHxRMWkclIxqTyhMlVMKk9UPFFxonJS8UkqU8VUMamcVEwqJxWTylRxUnGi8kTFEypTxUnFJ12stdbtYq21bhdrrXWzX3yRyl+qmFROKiaVqeIJlaniCZWp4kTlL1U8oTJVfJLKScWkMlW8ofJJFScqJxVvXKy11u1irbVuF2utdbNfvKAyVTyhMlX8JZWpYlKZKk5UTiomlaniRGWqmFSmik9SmSomlaniRGWq+CSVNyomlaniDZUnKiaVqeKNi7XWul2stdbtYq21bj+8VDGpnFQ8ofJJFScqJypTxV+qeELlpOKJiidUvkllqjipeKPiDZWTiknlL12stdbtYq21bhdrrXX74SWVqWJSmVSmipOKJ1SmiicqTlQmlSdUpooTlanipOINlaliUnmi4pNU3lA5qXhC5Z9U8UkXa611u1hrrdvFWmvd7BcvqDxRMam8UfFJKicVb6h8U8Wk8kTFEyonFU+oPFExqUwVT6icVEwqT1ScqDxR8UkXa611u1hrrdvFWmvd7BcvqEwVk8pJxaQyVUwqU8WJyhMVb6h8U8UTKt9U8YbKf0nFEyonFScqU8U3Xay11u1irbVuF2utdfvhpYpJ5Y2KSWWqmFROKiaVJ1ROKk4qJpWpYlKZKiaVqeKk4g2VN1SmiqniROWJiknljYoTlScqnqiYVKaKT7pYa63bxVpr3S7WWuv2w4dVnKg8UfFExaRyUvFExaQyVUwqb6hMFScqU8UbFScqU8VUMalMFZPKN1WcqJyoTBVPqEwVk8oTKlPFGxdrrXW7WGut28Vaa93sFy+onFRMKp9UMak8UTGpTBWTyr9ZxaQyVUwqJxWTyidVnKi8UXGi8kkVJypTxYnKVPFNF2utdbtYa63bxVpr3X54qWJSmVROKp5QOak4UZlUpopJZao4UZkqPkllqnijYlKZVKaKSeWJijcqTlROVJ6oeENlqphUpoonVKaKNy7WWut2sdZat4u11rrZL15QmSqeUJkqJpWpYlKZKiaVqWJSOamYVD6p4kRlqvgmlTcq3lCZKt5QmSpOVN6oeELlpGJSmSo+6WKttW4Xa611u1hrrdsPL1VMKlPFEypTxUnFpDJVTCpTxRsVJyonKlPFGypPVEwVJypTxRsqU8UTKlPFicpU8UTFJ1WcqEwVk8pU8cbFWmvdLtZa63ax1lq3H15SmSqeqDhRmSqeUHlCZap4QuWk4kRlqphUpoonKj5JZao4UXlCZaqYKiaVqWJSmVSeUDmpmFSmikllqpgqJpVvulhrrdvFWmvdLtZa6/bDh6mcVJyoTBWTyhsVb1S8oXJSMamcqEwVk8qJyr+JyhMqU8WkMlVMKicVk8pU8UkqT1R80sVaa90u1lrrdrHWWrcfPqziCZWpYlL5SxUnKlPFScWkMlW8UXFSMalMFZPKVDGpfFLFpPJExaQyVUwqU8Wk8oTKVHGiclLxT7pYa63bxVpr3S7WWuv2w7+MylQxqTxRMal8U8UTKicVk8qkclLxhspUcaIyVZyoPKHyRsUTKicVJxWTyonKVDGpTBWfdLHWWreLtda6Xay11u2HL1OZKqaKSWVSmSomlROVqWJSmSomlROVNyo+qeKTKp6omFSeqPgmlTcqJpWTiqniRGVSmSq+6WKttW4Xa611u1hrrZv94gWVT6o4UZkqJpWpYlKZKk5UPqniROWkYlJ5ouKTVKaKE5VvqphUpooTlScqTlSeqHhCZap442KttW4Xa611u1hrrZv94l9MZap4QmWqmFSmikllqphUTireUHmiYlL5pIoTlScqJpWpYlJ5o+JE5Z9UMak8UfHGxVpr3S7WWut2sdZaN/vFf5jKVHGiMlU8ofJGxaQyVZyoTBWTyknFEypTxaQyVUwqn1RxojJVTCpPVJyoTBVPqEwVk8oTFW9crLXW7WKttW4Xa611++Ellb9UMVVMKlPFicpJxVQxqUwVJypTxRMVk8pUMamcqEwVb6hMFZPKScWJylTxRsWkMqm8oTJVfFLFJ12stdbtYq21bhdrrXX74cMqPknlRGWqOKk4UXmi4kTlROWk4gmVJyr+L6l4o2JSOal4o+JEZap442KttW4Xa611u1hrrdsPX6byRMUTFZPKVDGpTBV/qWJSmSqeqJhUTlQ+qWJSeaLiRGWqOKn4pIonVD5J5aTiky7WWut2sdZat4u11rr98H9MxUnFpDJVnKi8ofJExVRxojJVTConKlPFVDGpTBWTyknFpPJJFVPFicpUMalMFZPKicpU8Zcu1lrrdrHWWreLtda6/fA/TmWqOFE5UZkqTipOKp5QmVSmipOKNyomlSdUTiomlaniROWk4o2KSWWqmFSmikllqphUnqh442KttW4Xa611u1hrrdsPX1bxlyomlUnlpGJSOVGZKiaVf5LKExUnKlPFpPJExTdVnKh8kspUMak8UfGXLtZa63ax1lq3i7XWuv3wYSr/JhUnKk9UfFLFpDJVTConKlPFicqkclLxTSpTxYnKVHGiMlU8oXJSMalMFZPKicpJxSddrLXW7WKttW4Xa611s1+stdavi7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u1irbVuF2utdbtYa63bxVpr3S7WWuv2/wAHC0g2jYEvtwAAAABJRU5ErkJggg==',
    secret: 'ONUWMTLIKNIDM2JQNBSDIRSRPBWXKTTN',
    recoveryCodes: [ 'k17g3s20tn', '2y1916yk2y', '0xqrgty2bs' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="93c783e85a1a2418495c77e53e480795f93bc39837f15cfbeca9bd2a3f93ac7a", ts="1705108780", nonce="NjCisP", hash="51F1o9sPwWgWY+Mxi0fYFyCpiFjIYHuGs20YWQSC1L8=", mac="ZGr1J1qaZqb9kz22/CQSDwQTtykeUsLh1LZFqj+XPG4="'
  },
  json: { code: '141932', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '0052b01945d1d8255eda@restmail.net',
    oldAuthPW: 'd7b7512e6bc892e90737ae727f5cbf0a8b7868dd8148197fd86715ce481b30a9'
  }
}
!!! response success {
  body: {
    keyFetchToken: '6269a905396166984ab0cd4900f6d38b916c14c63b43bcd6153c43df2e5f130d',
    passwordChangeToken: 'afeeb8a23959d0b79ed16ec79436b5666e99648cd9e6234944c09d7f1dcadffd',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="66b183fc615ee94b872e1e0f059564e81d3033e7d75d06d4b2bcea09f2296757", ts="1705108780", nonce="mpIJXj", mac="T2TtXdOWjY/a2Unoz/ZgKm3lisbBiPdL/tr/HsZ+KKQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '2e47e72a10e5b762bb3c1731bd02df28ccf3463346eec174d1546ae255b93f35a39faa47c19388112118629b70b479de694fb88bea0fc0609111c8c1ed2a2d459cb4d4bb9a42dd82fcc89feabea6fc18d5a47dc3a7a39c84d12597470bda30dd'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="70e0ceb5edd1dc2688980ff637bd51892c50ee487eb323fca921b19f8b3bf93a", ts="1705108780", nonce="FP-1jg", hash="2YxMi/qaSTiTenUMb8GiIwLXmixyGG2ECk262CDFSUc=", mac="LJavcdgWPgHAUpT4efzCPz3h7I2i+yufPo2Dg7RBDwY="'
  },
  json: {
    authPW: '561b39181c827ee65ecf5a965673a46a778d4464fff78de649c90ca66842a509',
    wrapKb: '33a821d885d11f106844abd9c153860f3a14a30008aeae5c0d8d90808a984647',
    sessionToken: '93c783e85a1a2418495c77e53e480795f93bc39837f15cfbeca9bd2a3f93ac7a'
  }
}
!!! response success {
  body: {
    uid: 'fe6391153b1a408abecb6a7c60a967b1',
    sessionToken: 'b773f905d5fe182d51b904bf556f1c69e2fd9a692d26efbeac0257a3c8e969b7',
    verified: true,
    authAt: 1705108780,
    keyFetchToken: '4d479b78dd3214e150ddb88ee2ff631ad8bad30b0e9b1df7580a347273eb5aa4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '0052b01945d1d8255eda@restmail.net',
    oldAuthPW: '561b39181c827ee65ecf5a965673a46a778d4464fff78de649c90ca66842a509'
  }
}
!!! response success {
  body: {
    keyFetchToken: '46ef9fc8121bfe8dd034cec69f67d2022a4d23d7f60b2521519018fa1b77c8fd',
    passwordChangeToken: '1f91b367f5afe628efebbaa58aea8eb1161589305b3d6a7b436b8fbf9a139332',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2aacf636dd806c591ea8caabe6893d6c53b71528cfcc552ccaa7ce4112435014", ts="1705108781", nonce="NKiMaR", mac="cRdnuJn3KUXcdbaoM+/NDupSb6DIhNvQXXQKxztHtN0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '560cbdbb529d5889a6a8101432173e7654a6a0e8a0e90e2a70b669254effc645a94a4215587ed9aaf33daa5ca9f5d95ece992821591bdadcfa8abea262b1b34fc5f8b88866b282b338adb59ea7212ed74e55cb507b38ef83a73a87d1bda45089'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6ab8912b2520ad09449272a0255c4ef6c294272d3f42e28e5f89de163ec4bd28", ts="1705108781", nonce="7v2jXv", hash="PUOU/SXf/3RSOKZ6N0ip1eIb7OsMXwcxpaqI+0uKTeE=", mac="zV4REtojn2gf4v+//EO/0X+FxB6EjTl6ahE5qs8dvSU="'
  },
  json: {
    authPW: '63ec5f9edd7645441b35688e676879f8bf673fdb35dafc47bcc50235ba39f324',
    wrapKb: '00d2fef75d2e727dc6e8003b97cfa6071b07f5080387130fc7f3ea6dd708f6c1',
    sessionToken: '2ff90ba3e28f288ded19fa54e05234ed228e5ee23aefb04273db46dfb5940087'
  }
}
!!! response success {
  body: {
    uid: 'fe6391153b1a408abecb6a7c60a967b1',
    sessionToken: 'e1cbce0c6cc50824e2439b71d71782fc5552b33b3553a863341d03f019bb8169',
    verified: true,
    authAt: 1705108781,
    keyFetchToken: '5bf87a4bbb37b781f6d9e8aa419cee7bdd0d6c78960175087afd57e9c5ae2884'
  }
}
    ✔ should change password on account with TOTP with verified TOTP sessionToken (1229ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '735fed5b12eb85f16f93@restmail.net',
    authPW: 'f81085080b2606730970766d0be67433c5040851a4e47242cd794a6cc734ea40',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '790d5824a2ab4d2e9bcb21687cbbd52d',
    sessionToken: 'b9ad9407851e5eafc9ce14e6fb72835707b5466fa9a63e261d6ecd1c88470b62',
    authAt: 1705108781,
    keyFetchToken: 'e7d23e445df6051e9826f98b46684c9b82ae92a4adbc51763e6f530ee41b1329'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '790d5824a2ab4d2e9bcb21687cbbd52d',
    code: '6ee76627e33c5a22d679d4dd2411907e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5f3de317e76d88192d9411ab06677628ff3d8092f0c005ebd8a73b53d1dad395", ts="1705108781", nonce="3nxTS0", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="W5l3YUKm92cryLi2iPlK0X6AZHhxFQLv0J7hljZEMc4="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAABAqSURBVO3BQQrk2rIgQXeR+9+ydw0EHaMDQpl1633CzP5grbX+uFhrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u1irbVuH15S+ZsqTlSeqJhUpoonVKaKE5Wp4kRlqvgmlaniROWJikllqphUpoonVE4qTlROKk5U/qaKNy7WWut2sdZat4u11rp9+LKKb1I5UTmpmFROKiaVX6qYVKaKE5UnKr6p4o2KSWWqmFSmikllqphUTlSmiknljYpvUvmmi7XWul2stdbtYq21bh9+TOWJiicqTlSmijcqTlTeqJhU3qiYVKaKb1KZKk5UpopJZao4qTipmFROVH5J5YmKX7pYa63bxVpr3S7WWuv24f8YlROVk4onVE5UTiqeqJhUpopJ5UTlCZWTikllqpgqJpWp4gmVk4qpYlKZKiaV/8su1lrrdrHWWreLtda6ffg/ruIJlf+SylRxUvFLKlPFpHJSMalMFU+oTBVTxaQyqUwV6/+7WGut28Vaa90u1lrr9uHHKn5J5UTlpGKqOFH5JpWpYlKZKiaVJyqeUPkllTdUTiomlZOKSWWq+KaKf8nFWmvdLtZa63ax1lq3D1+m8l+qmFSmikllqphUpopJZaqYVKaKSeWbKiaVE5Wp4ptUpopJZaqYVKaKSWWqmFSmikllqnhCZao4UfmXXay11u1irbVuF2utdfvwUsW/ROVEZaqYVJ6omFS+qeKXKt6oOKmYVE5UTlSmiknliYpJ5Zsq/pdcrLXW7WKttW4Xa611+/AfU3mjYlI5qZhU3lCZKiaVk4pJ5ZdUfkllqjipmFSmiknlb6qYVJ5QOal4QmWq+KaLtda6Xay11u1irbVu9gdfpDJVTCpTxaQyVXyTyknFpHJSMalMFX+TylRxojJVfJPKVDGpTBVPqLxR8YTKVHGi8kbF33Sx1lq3i7XWul2stdbtw0sqv6QyVZyonFQ8UXGi8ksqJxVTxb+kYlKZKt6omFSeUJkqJpUTlScqnlCZKn7pYq21bhdrrXW7WGut24cvq/imijcqJpWp4o2KSWVSmSpOVKaKSeVEZap4Q2Wq+CaVJyqeqDhReaPilyomlanimy7WWut2sdZat4u11rp9eKliUpkqpopJZaqYVJ6omFSmikllqphU3qiYVE4qvkllqniiYlJ5o2JSmSreqJhUTiomlaliUnlC5aRiUpkqpopJZap442KttW4Xa611u1hrrduHl1SmiknlpGJSmSqeUDlROVGZKk5UpopJZar4pYoTlROVqeKNipOKE5WpYlI5qZhUvknliYqTikllqpgqvulirbVuF2utdbtYa63bhy9TeULlROWJihOVqWJSOVE5UfkmlaniROWNikllqphUTlROKiaVNyqeUJkqTipOVJ5QmSqmir/pYq21bhdrrXW7WGut24e/rGJSmSpOVJ5QmSreqJhU3lA5qXiiYlI5qTipmFSmikllqjhROamYVKaKE5W/qeJEZar4l1ystdbtYq21bhdrrXX78FLFpDJVnFRMKicVb6hMFVPFExWTylQxqUwVk8qJylQxqZxUTCpTxUnFv0zlpOINlaliUpkqpooTlZOKSWWqeONirbVuF2utdbtYa63bh/+YylTxhMo3qZxUTCpvqEwVJxW/pDJVTConFScqU8WJyt+kMlWcqEwVk8pUcVJxojJVfNPFWmvdLtZa63ax1lq3Dy+pTBXfpDJVTBWTylRxojJVTCqTyt+k8kbFpHJS8UTFExVvVEwqJxUnKk9UTCrfpHJS8UsXa611u1hrrdvFWmvd7A++SOWk4kRlqphUpopJZap4QmWqOFGZKiaVqeJEZaqYVKaKSeWNijdUpopJ5aRiUjmpOFGZKk5Unqh4QuWJir/pYq21bhdrrXW7WGut24cvq5hUTlROVKaKJ1ROKqaKSWWqOFF5QuVEZao4qZhUnlB5omKq+F+iMlVMKlPFGxVPqDxR8cbFWmvdLtZa63ax1lq3Dy+pTBVPVHxTxaRyojJVTBV/U8WkMqlMFU9UnKg8oTJVvKFyUvFExaTyRMWkclIxqUwVJypTxaTySxdrrXW7WGut28Vaa93sD/5hKlPFGypPVEwqU8WJylQxqZxUTConFScqJxWTyhMVJypvVEwqT1T8ksobFScqU8U3Xay11u1irbVuF2utdfvwksovVUwqJxWTyhMVk8o3qZxUTCpvqJxUnFRMKlPFicpUMamcVLxRcaIyVUwqU8VJxaRyUjGpnFT80sVaa90u1lrrdrHWWjf7gxdUpoonVKaKSWWqmFSeqJhU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PKEyVUwqU8WJylTxhMpJxaQyVXyTyt9UcaIyVTyhclLxN12stdbtYq21bhdrrXX78JLK31TxhMpJxaQyVUwVJypPqEwVk8pUMam8oTJVnFRMKlPFicpU8U0Vk8pUMan8kspU8YbKVPFNF2utdbtYa63bxVpr3T58WcU3qTxRMam8ofKGyhsVJxUnKicVT6g8ofKGylTxX1J5ouINlanily7WWut2sdZat4u11rp9+DGVJyreUJkqTlSmikllqjhROak4UZkqJpWpYlI5UXmjYlKZVKaKJ1SmikllqjipmFROKk4qJpVJ5Y2KSeVEZap442KttW4Xa611u1hrrduH/3EVb1RMKlPFpPKGylRxojJVTConFZPKVDGpPFExqUwqT1RMKicqT1RMKk+oTBWTyhsqU8Wk8ksXa611u1hrrdvFWmvdPvwfo3JSMalMFScVb6hMKlPFv6RiUpkq3qiYVKaKJ1SmiknljYqTikllqphUpoqTil+6WGut28Vaa90u1lrr9uHHKv5LFScVJypPVJxUTCq/pHKiMlW8UXGiMqmcqDxRMalMFZPKN6lMFScVk8pJxS9drLXW7WKttW4Xa611+/BlKv+liidUTiomlROVk4o3VE4qfqliUnmiYlI5qZhUnqh4QmWqmFTeUDmpmFROVKaKNy7WWut2sdZat4u11rrZH6y11h8Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u3/AdAgUn0ooYPZAAAAAElFTkSuQmCC',
    secret: 'JVLWY4JSOU2UES3IJZSTMVD2MZ4FQSSQ',
    recoveryCodes: [ 'edy3p6sfvw', 'tyb39j3e2t', '6jwrj95hry' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5f3de317e76d88192d9411ab06677628ff3d8092f0c005ebd8a73b53d1dad395", ts="1705108782", nonce="3_dtj3", hash="1wThnzgQjFbHow/GsJNKihwDnYDZ92tB0e8Khv9Ecz8=", mac="toI8FBTQqkHHEcggzk4VSW8Rd2SpICIQLeBg3KGXhP4="'
  },
  json: { code: '224513', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '735fed5b12eb85f16f93@restmail.net',
    authPW: 'f81085080b2606730970766d0be67433c5040851a4e47242cd794a6cc734ea40',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '790d5824a2ab4d2e9bcb21687cbbd52d',
    sessionToken: 'fb4541e380c12f5765cbf395c13cf43e71b584e8b857f989bcafa0f42f73acbd',
    authAt: 1705108781,
    metricsEnabled: true,
    keyFetchToken: '6f227790acb0e9f8ac868ba4fa0381dfc7e43bf5ec576aedea652a5c590a42bd',
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '735fed5b12eb85f16f93@restmail.net',
    oldAuthPW: 'f81085080b2606730970766d0be67433c5040851a4e47242cd794a6cc734ea40'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'fa047704bc881b0383d89a61406ebfc6edcdbc77bb71dabcfd657f1bd3c835dc',
    passwordChangeToken: '133a0e269e61fe9e0b66b7df55092f29cb2929a0262a1ceacace56d51a68760a',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4e454bfa435b4fd3851507da2fafa2add41c1ef1bceff64760577ab20bcfac7c", ts="1705108782", nonce="_6-abG", mac="ug78oDaMJ8VshAEeonh33r7iw0mg41hfKuA1bp9NEqs="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '829d295c0875a5d23b2ea77b008bc732d663aa1fbfe71da89e42e36fa0ce3e69b319d709bd5e67d17825403eea89b827b1a0b7fe6da0d698c935e48d65791863448a2e48dd3b0f0dc45159072c9db1d562430e7fd600f95a172247789c048841'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3e6242d5a31b6feb21502cb4880e94c3e35a2c1e7c2d6b1917bea9ced5c8fff", ts="1705108782", nonce="dCMReK", hash="pCmB0qfPvtqbgPKacOF/fpsWzCEadoqtbFumPRaVxb4=", mac="Q32VUh6KIwN26rUgUoUJqMb92ym0qgWON8VSV5yCF3c="'
  },
  json: {
    authPW: 'cab8e31f5e3eb5699e43728d8d230c35d8158b4bf06bd3840ba7047ca941705e',
    wrapKb: 'c0336567a70f830e6c412121e909e9efbfa6f18a26663adfbf63d2ded5dc6679',
    sessionToken: '362428db7e6eb53afb1299bb3301520112f9fa242a5c8c0e19be1d197e505c4b'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ shouldn't change password on account with TOTP with unverified sessionToken (814ms)

  #integration - remote password change V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '675ea11913e188d08696@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '675ea11913e188d08696@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '675ea11913e188d08696@restmail.net',
    authPW: '606bb69e459d9af47e30cae253fdbe30c4f3c936c73584b10668c6f077f74c61',
    authPW2: '71e637a08f1890d73a349ca5536e09fc50667705567f6830fddf86e913fdc7b0',
    wrapKb: '9a71890766478f8e23f5b4e956df6e24d1c8c9f6745c804598e1cccf7aa27742',
    wrapKb2: '9f99d36b560cdd07bbd1275fa196d41c5a9c45aff5c43d249f38c71d9aa6a629',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '97a372c906444324b426fe411ba3dde9',
    sessionToken: '1177d5d613407823fb0946f8058413559c7185f7f81848014342549c3ffae1fd',
    authAt: 1705108782,
    keyFetchToken: 'b7aa2304d960c4278a0fdaf822dd11f44dfaa5070959e36ea83216175a734824',
    keyFetchToken2: '84b51a2e807409db7ec9b5a3f7b7006d420b87ce302cc818f0e24b2475fd6210'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '97a372c906444324b426fe411ba3dde9',
    code: '52044a5a426a412775a4e9ef4d2c1b3e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a5d5454806294e84a0f91c483e8ef188ccfd45afc68d434c5b26fa92aa0285e2", ts="1705108782", nonce="bQ2XEU", mac="t8qNYlu2+OkwyLokZebu9cuxdoT/3BcMb/t+3KjLO8E="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'f34f21d8a405142535b6bbf846cd50707525d357ff40bd9cc99b0a8c5668489b443ed504c83b360c0a5cb2fca9ee75807baa59382fa2d79a6595d85601b04440cefb132bdd5f16d865bc060f4237a3d581751c13964eebd9860396f0fd379828'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="aa79ca040be8a6e977728dd24ecffc8e936f242ff9b3e3412a9c2abf1f35e0f7", ts="1705108783", nonce="d3xupp", mac="iZFXijC3AV1QqyzwzWcfVLLrpiwy7m+psSqP0F9yiSg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '675ea11913e188d08696@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '675ea11913e188d08696@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '675ea11913e188d08696@restmail.net',
    authPW: '71e637a08f1890d73a349ca5536e09fc50667705567f6830fddf86e913fdc7b0',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '97a372c906444324b426fe411ba3dde9',
    sessionToken: 'e4cbc6a1e5a68bc989f62aab9748935a5a83aa94e36faa2e0bb0d30d6d4b554e',
    authAt: 1705108782,
    metricsEnabled: true,
    keyFetchToken2: 'ee60646eb53cfb049fcfaf960666d324522491d3e5a0ccb354f2e55a3699ba08',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="542a40dc1bda34ad521acc97880417078a4d96b288330f4f06de014b7171ea51", ts="1705108783", nonce="GiiQTo", mac="CUIQ31GY+9t6P0kQti+NJWHUbYyBGUmLM8yHST+CWms="'
  },
  json: true
}
!!! response success {
  body: {
    email: '675ea11913e188d08696@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '675ea11913e188d08696@restmail.net',
    oldAuthPW: '606bb69e459d9af47e30cae253fdbe30c4f3c936c73584b10668c6f077f74c61',
    oldAuthPW2: '71e637a08f1890d73a349ca5536e09fc50667705567f6830fddf86e913fdc7b0'
  }
}
!!! response success {
  body: {
    keyFetchToken: '1fdc91940c2d43bb432e1d7f375e0a811bfb4731776751b27e6146d3c8fa0169',
    passwordChangeToken: 'fe8a71022efc2b78ca5b0443c17004195c6c99c88d7b2f8997a927f45e6e620a',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8772dc0e6fb2315406ad3c0f5fcae0c76da8edbb31799e2f083a16caa11ab2ca", ts="1705108783", nonce="eFx7bm", mac="ZC1jMmVI/jq0a7Sfe6c2dGHyDYDnQiw5fpOf41wJCuQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '19800be0b3f7d1058fa485470ab8a38c64a90dc3a2c033f9341127827ed2ab8a48a022ad38f5e1c5ba7fdf26f2e7724f560e46ceef3511b7423ed5884bb015d9b0326b2d5eaf4f13eb38e65c3685e403c672a8675027d883db183d299b8b7d09'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '675ea11913e188d08696@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="40a53deb7a89328e13a2b0dbad84118d5686c033bf6da47478e86f5eb134b665", ts="1705108783", nonce="wfVP-_", hash="kr8xh4swT5jL6aRSqGFjYM9E423o7ZmOBO6tM5LpmhA=", mac="95/0aFOhirnXkNRws946FWFKaj90U2SculbenqoWEWE="'
  },
  json: {
    authPW: '3f0472f14e21dc4bed0fff9c31a756a7a8a8127dc021c63116dab4f448440a9d',
    authPW2: 'd52b1485ea9184701383dc057c285644ba2ce3087c22d9616a08e2da8fc6365b',
    wrapKb: 'e8c963dff284500e2117d3640e428f3454bee783792869350e723c4372b50431',
    wrapKb2: '6dec0cbc4e6ade9c0bb959e2de04a40adacbf341951fe6e57991e26d926c4e56',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    sessionToken: '542a40dc1bda34ad521acc97880417078a4d96b288330f4f06de014b7171ea51'
  }
}
!!! response success {
  body: {
    uid: '97a372c906444324b426fe411ba3dde9',
    sessionToken: 'a428312427a0959a137b24ad9b30a82b965f772a8d653f88e866c062abbcd134',
    verified: false,
    authAt: 1705108783,
    keyFetchToken: '4e087f77e8d88033bb74cbda54b6572ecea780813b51b5764beac8615933fe54',
    keyFetchToken2: '0d41fa3c848fbdb862bc05e6324e673ff7dafe70f3d46162e6601516a91f67d3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="492d7afc5a08d6e880268ddc381196146130c28abc131440949153f750e5bd06", ts="1705108784", nonce="qx_Vhv", mac="TE8ek2HhKgnudsoEI0taytPlL1l+sfiCZHI7wufu3Jw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '675ea11913e188d08696@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '675ea11913e188d08696@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:fc70de5981a40e5e02dae6eb14240765dc29703ac12a3440f2b6e714890405fd',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '675ea11913e188d08696@restmail.net',
    authPW: 'd52b1485ea9184701383dc057c285644ba2ce3087c22d9616a08e2da8fc6365b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '97a372c906444324b426fe411ba3dde9',
    sessionToken: '814f7c942229773f5f60c1ca5c09acf9c3898d206b7c2a917be8940c250254b6',
    authAt: 1705108783,
    metricsEnabled: true,
    keyFetchToken2: '8e5b756522a38105371392c5c0f58cc02ad07818b122f6176d7767aab583a2ac',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '97a372c906444324b426fe411ba3dde9',
    code: 'b1bf5791dbd626f078597d4fc13a4a50',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bc5496ea151e9ae3a29f1a4c4a175eced6331bac4a4282cce505aceec26a3f7c", ts="1705108784", nonce="cuskm_", mac="XAATX2RaPYs8BmQXi7xBtYQNo0AZDB57Hj0+8n4zKjs="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '35d29059b316282afb726f470d53ff2223bf10d881222f9050508008db987d85567d4e344b5823c4636acdca5fce9118b19db9333931bc3d6f096515973b47aa5edc2d910454ce8d4adcc29d834fee3c2ecc5594d2cf5b648b3cfa612295a759'
  }
}
    ✔ password change, with unverified session (1913ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd36ee8bc2337e900b164@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd36ee8bc2337e900b164@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd36ee8bc2337e900b164@restmail.net',
    authPW: '410a84737f3f3762b0747e813759f8701a3905d40cfe551b9e8422e562be526a',
    authPW2: 'bd3a3ffc6c6b79dcea51a64a8a4bd88a3dd38f34760766e0687f1b636a5c8aa9',
    wrapKb: '82c458d2d1eb199f34b49d974a328010eb59b7c3ea640413f058399329d4a578',
    wrapKb2: '6f711634b13cdb62b191c6c33e6af240f6b65eabb986a3edd50bfb7d531724b4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8650cfe7bbd942408b0cc5ba9c8d1c55',
    sessionToken: 'bb34c8ee1700ec6048677924c6e786f03c4705b654627b90e3bc05778fec1019',
    authAt: 1705108784,
    keyFetchToken: 'f36e874baf602dca9d36e01fec1f1278e8d01591ea008663aac2da4b6398c17e',
    keyFetchToken2: '7a41481ba3ecbc0aba52c2952236baba0593e42fdf211f347f221fa0b555c174'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8650cfe7bbd942408b0cc5ba9c8d1c55',
    code: 'f00ae8aa055db569640e3248d4f75ef1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3ac282f095cbb03c856de1a3a7f66d60ce2209c7a37fc98a9661a0cccb8323fc", ts="1705108784", nonce="xVYYyw", mac="Gk06DJKwEaylT3fXYYe4TuaFKTXH+kzKEcJdbVwHBns="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '76b5aab622639585ca0411b1ce3ebf9880110acf7b834f929dde42d164374ccc0c6fa5a494416f7351c1aaf978553a7ebc60d13425f8f9ee8681b37ce483a56f54642f85a6210efe168246354143e366e10e41bef82ee3fabc8f7bb95340894d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b48891dc5237dd621a2382bf374b86857b35bafba2aeea89d32dacabbb1837a6", ts="1705108784", nonce="57naBb", mac="yltWLmOYd8gbKU2HFIWw5VRPPakKOhFK7cec6L6QMuY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd36ee8bc2337e900b164@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'd36ee8bc2337e900b164@restmail.net',
    oldAuthPW: '410a84737f3f3762b0747e813759f8701a3905d40cfe551b9e8422e562be526a',
    oldAuthPW2: 'bd3a3ffc6c6b79dcea51a64a8a4bd88a3dd38f34760766e0687f1b636a5c8aa9'
  }
}
!!! response success {
  body: {
    keyFetchToken: '0a4c34b4ff6f33960c3210c7fcf6da95bfc72fd18f6f1d5f49a04e8aec0b9bd4',
    passwordChangeToken: '0d3e532e649f95457be1510c40dd22d198341c6b44c36679dfca0261851250df',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="45dad5a58f73e00be9e04088b6bb8137b242cdee2f1e265e4751844d036ffadc", ts="1705108785", nonce="7aW7ny", mac="kadz+c342MaAHCOyIAtIMxTbj16aLUQ92+7LZ49GBVY="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '04b0e9ccb7abe0dfa7a912216652e2113fa130c19a596afa82777f6ceb55d8362def813bc6c3508fac39189c7699c05146e0f3d6db8ac47ef54237be82900898f57daee4f9515de91ce54bfa79148b6eeb8426bf67de83db555a94048db4438a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd36ee8bc2337e900b164@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ecd80441cd2e95e490d860c508d6ddc0d8a12bb8fb4822c93efe2f39c76620b1", ts="1705108785", nonce="CnKpUj", hash="wCXAwxEc84S1NegKsrSicsky8BYXfYvzODUROw7zQ6k=", mac="WNK5doCNlsmD/3SsLP9FdbQMHrgwBmuvueXhNuXLTcg="'
  },
  json: {
    authPW: '07329f24f9af8fa5de7199c0b29091bcca1e3db4c37b7167a28637abe195263e',
    authPW2: 'd2aa6fd0f77d19ce6faa32ab179b74c7a9fbcd3ebca62f5a3c11668a868b6cfe',
    wrapKb: '37d14b174e477b097ca1877c7391b23a4a67bf344e8b21636ff01051b47a6c84',
    wrapKb2: 'e5b2f6d1f49a0f36da08ae196e2a546f6ba122150ba746e333814ee5bbc4c83e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    sessionToken: 'b48891dc5237dd621a2382bf374b86857b35bafba2aeea89d32dacabbb1837a6'
  }
}
!!! response success {
  body: {
    uid: '8650cfe7bbd942408b0cc5ba9c8d1c55',
    sessionToken: '05d4cb74f6fdbedf3ee4f07cd664cdccc7417e87d4ccdd7530b30688d712c44e',
    verified: true,
    authAt: 1705108785,
    keyFetchToken: '5d861eda428df035d46240dfc260f366706c07a69f6936eaa25bbeb8965dd160',
    keyFetchToken2: '3e46dcfc2dad888eb8c3a753f4efc3d793bf25187919445c2ac0c5a3c2007773'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ed865c649b2bc1206e2e56d83e991cc4441d938e46d291ac07b8531c18313cff", ts="1705108785", nonce="PSnk47", mac="C6lS7WI9xHw1WoeH8LkCr2rKHVymNspHAVqy+e960i0="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd36ee8bc2337e900b164@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd36ee8bc2337e900b164@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9cf27f69fda8882e10b95fe44caaca3eeb89efca18e0163329af2f890adca342',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd36ee8bc2337e900b164@restmail.net',
    authPW: 'd2aa6fd0f77d19ce6faa32ab179b74c7a9fbcd3ebca62f5a3c11668a868b6cfe',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8650cfe7bbd942408b0cc5ba9c8d1c55',
    sessionToken: 'cb66db42e8e43ccdf379d4544faa5ec5bda74e5445635c639ea1655c93f58954',
    authAt: 1705108785,
    metricsEnabled: true,
    keyFetchToken2: '46fd2516eb014e25ae80b12d91428f61eda51a76c1c0bd1493b470bdfb6e5012',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8650cfe7bbd942408b0cc5ba9c8d1c55',
    code: '908a72cacc20b13bd425f4ba8f8c124a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d75116efb52e394834863c43ad9a485a6a5a9e4a6f23b706aecea642145b8b06", ts="1705108785", nonce="rEJ3Jx", mac="XeWx8bLcWQPmfDlHx5e6DX7xplSBjpt1s9tljwrsad4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '962c331e1759494b4a0bb35ae0295a0bff6ec7a4e787fdce064134633cfc4696ea7332c62d05100b09421ac5d77fb2446998aba851a4ce1971010ca81d9ab51b7940f722e31ef9174a1d199788183b6c03e0bf943ca8e355505f06600eff163e'
  }
}
    ✔ password change, with verified session (1546ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4eb52c211ffb994ed417@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '4eb52c211ffb994ed417@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4eb52c211ffb994ed417@restmail.net',
    authPW: 'e5a0af8b768aa36b4c7ef1847db67deab5588f88caeaf56a440a02608c5febbc',
    authPW2: '40019fe2bb5af8386308c07142ad49b69c11469acbe2986fe4d74b932e4633a5',
    wrapKb: '1dd6fa40ba515af7339d7533765038f918cd4d47eceef6c994b4ddebedd19d32',
    wrapKb2: 'd59a2768bebd7d9130a297ab66c7e1a5b32851542c0e6d8f7b88652957dcd8cb',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:afccea634f01eceabf5085c9a06e07b593bb6d17771039fb838a2b215e1c5ce7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '74da8f541b5941bd85da6e2ed0ec6ecc',
    sessionToken: '525f349d5d62c9453226e5fd276c322b2430c00bef0f74df1dd089a0f4a7f89b',
    authAt: 1705108785,
    keyFetchToken: 'cf75c97f68b9b64cdca99d6fde291d365d31c3241d9f7cfded5dfc6023b805aa',
    keyFetchToken2: '93b42462202b60f6cf88d7a74d302d6b63c17b998be977590eaeb94269aff114'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '74da8f541b5941bd85da6e2ed0ec6ecc',
    code: '5fe9d1feea144aa8863c6509f8ca53f9',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="442198dc846fa3388062f2963ec3f83c6053d1cecdfc6587e095bacba289f57c", ts="1705108786", nonce="-crcx2", mac="pMRgC+P/Fsk5YrR4hvSejuBuwemMhLVtG43eLwD8mLw="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '49d3bc10059cddf25d8a615e045db56a2da0e45efc2f7785e4e64cdce582b511756ee4b9c3f1db77cf5134bf21e3c26f6ea01af2b9e47a08dedd1e461365904edcc7943581b1c023d3f668933f214f570126de9079ccb4b4e309b4e81c250e42'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b2727f127dfb9bbc9da80758c23b09a76b3caa4056f6e30569588bc3e411b45d", ts="1705108786", nonce="kERDLh", mac="dPQKo586TRUIsDtUS2hGigb8Bh3Py4AgrD7YcdH4LS0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4eb52c211ffb994ed417@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '4eb52c211ffb994ed417@restmail.net',
    oldAuthPW: 'e5a0af8b768aa36b4c7ef1847db67deab5588f88caeaf56a440a02608c5febbc',
    oldAuthPW2: '40019fe2bb5af8386308c07142ad49b69c11469acbe2986fe4d74b932e4633a5'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'bd216dcea3cdd3193f8df1ddd16dad785b72f812ba5b9dfdba0b374400229d89',
    passwordChangeToken: '14783cb6ec8c644dee202528fe20cac53944750ac0bd450ee7cfb74e2f973b40',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dae3c46b2766e1537edd20709d96f1d0309ab46637b7be85bd70ffc352d88090", ts="1705108786", nonce="1K49FA", mac="OSBRyMVUKlv7HaXctEXtirrBAc9MRaSNqYN58efp4Xg="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'fe188fbc0bbb298a464adebb425ddaf171f64a54ea7a89c2214df1882b76b2831b02a5357d22ac9a11cfdaaca0ddbf3df0068064e136d32b16d3e4a9f4c3947b798cd06032737222f0ef07dd5acfa7c06eac4b7dba63e5029f88b8478bc24bd1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4eb52c211ffb994ed417@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:afccea634f01eceabf5085c9a06e07b593bb6d17771039fb838a2b215e1c5ce7',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:afccea634f01eceabf5085c9a06e07b593bb6d17771039fb838a2b215e1c5ce7',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:afccea634f01eceabf5085c9a06e07b593bb6d17771039fb838a2b215e1c5ce7',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="da0e93157c7865a93e1ddd3578b9dcea4a4f969b1f1245f803300a96933b2f78", ts="1705108786", nonce="AQjf_c", hash="iMu9SvpTFvqEv7gKx/KFVOyZFMSekcMmI3Uq4ba2Ql8=", mac="8qNbm7wQKrk5+gRDzarK/pDS9yk6QFF35GQz8SwjShw="'
  },
  json: {
    authPW: '279f6a0ef765fd2dcbb3de1a1121feca6fba960cb166b42a6f6ffc5822383ffe',
    authPW2: 'b7ccbfec98b957ddbb662f9c5d999fe30c3c5583cf589a5eda259033e5a6ff32',
    wrapKb: '230634b43efefffd500097bc94c476064e4c0e27777c35f76f3e2204436fc224',
    wrapKb2: '9cad6bede9b587b5f64c06c02d366bc7fcf1b480cc3d3f312dc096ad9d217e17',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:afccea634f01eceabf5085c9a06e07b593bb6d17771039fb838a2b215e1c5ce7',
    sessionToken: '525f349d5d62c9453226e5fd276c322b2430c00bef0f74df1dd089a0f4a7f89b'
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ password change, with raw session data rather than session token id, return invalid token error (829ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c7f10c7f1a517992f04b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c7f10c7f1a517992f04b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c7f10c7f1a517992f04b@restmail.net',
    authPW: 'd2495721743781878a49284620b880592649e3ae74df47bd26de4aae116440dd',
    authPW2: '9dd67421e3ac529ef9546b0a8453cd4ad967550b215fd2126b655a502c4ae475',
    wrapKb: 'd14611514fc903a99a9ba494d5ce1a571bffe9e937f342187a3bf81b1741c97e',
    wrapKb2: '2be9417e4fc2687bb394b03f7844dbbb892de94fae7d1eb69fbb7c30238f5269',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f7a993b140d6400b8d4a86b1452dfee8',
    sessionToken: 'a1e696438c10b6a05042db45c3226d32f1d1c825526ebb24d341ffc8eb550a13',
    authAt: 1705108786,
    keyFetchToken: '394389495ff2672943ecf6d5e23c97b1f4161ae31e8ac1d8c7f0157dc37caa33',
    keyFetchToken2: '7f9b8f58ba3927c1bd34f05567cf6e5928d3b9a920caeb52f2d1e41629a9bf56'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f7a993b140d6400b8d4a86b1452dfee8',
    code: '64fb36e8efa165914d867b922936d53e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6fcd0af3250fc75814dd770d8c321b0379c7c9665b3b937d6b18a6e415f269d9", ts="1705108787", nonce="CIqxAS", mac="3ZTcOwRyRIQEwfbljz4slAv+Ugd7zd0IXa5Hp+rvgGo="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '7ea1405f8c714cb141ed377a51a9b7fcedff619f1b369d5936379155591556be22a84df6a9c8d5c4a4bcddd0d489d8647be225d32d146c1be1ac1e258df21ecad0b3dce10a205e054dfe4ce396459093cab1f6cb0513d63bd517ddf110df9db2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'c7f10c7f1a517992f04b@restmail.net',
    oldAuthPW: 'd2495721743781878a49284620b880592649e3ae74df47bd26de4aae116440dd',
    oldAuthPW2: '9dd67421e3ac529ef9546b0a8453cd4ad967550b215fd2126b655a502c4ae475'
  }
}
!!! response success {
  body: {
    keyFetchToken: '9a97b7305b8163cb9424a012e1341e4fe46dec4f4025a2d4d2a35faa9488d552',
    passwordChangeToken: '9640c4f4be1c367c2a6459dc048dc987f48bb7358d6dbbf54bd97d9e8a21fb3a',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8329df17558b13217013bc38ce6a150ed907daa984741ad1c35c42525a5495db", ts="1705108787", nonce="XRMWBQ", mac="EIGV0O6ChIYfqjRA2+OwemvUjYBXnWKU5TVRadY+t80="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '1d79e5168fca8b6b235994f0567ccc5a0fdb3359950dc6ec2f372ad53382800294d3a210b73f279322584aba83a367661a614723057f2a221d63f132a5d8018845594b5d97a15e2a055f002f1bb2fea6323c5aa4f43a6a24573824c67d9ecae1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c7f10c7f1a517992f04b@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8e8cba8ffe5a5af001e8fe8eb83283294caa3c95375f3b9f9d7570ddd9ac86ca", ts="1705108788", nonce="1nx192", hash="56Tw6kErjy+Ss9btlU5pCO62OhyfsjzSulnHFVdbIPY=", mac="zsnifbXmb5jZCLdkEaaR5blaePdLJJLd/HtOpgiCZD8="'
  },
  json: {
    authPW: 'd7e672b86ff00a097152b1a667df4248ed955a87b6b765e83f04abcd45365c58',
    authPW2: 'b2704d7f15c698d1e15ab7ec3a8cab75547267c29ebe8eb71225c58b871f7627',
    wrapKb: '16f03062931d77dace1016a63f5216b945775c8ecc51721822edadbbed2b593f',
    wrapKb2: '4f2192d12e46a22f0764dbf11fb48b4418a10097776e02e85be12ceabd691eb3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c7f10c7f1a517992f04b@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9a7bd07befd9e4d347d931c3dac7dd32b939728fe840c577be4072e2f14c7b7b',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c7f10c7f1a517992f04b@restmail.net',
    authPW: 'b2704d7f15c698d1e15ab7ec3a8cab75547267c29ebe8eb71225c58b871f7627',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f7a993b140d6400b8d4a86b1452dfee8',
    sessionToken: '8d04989d0f158f2ab813c0a07d28ad3e03ffffa37ecfa88d89c2eeca46247f52',
    authAt: 1705108787,
    metricsEnabled: true,
    keyFetchToken2: '48f84a119802e742500dfea5c6d3f15cda52f5c89889080d85bbf1983e2c3dd1',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f7a993b140d6400b8d4a86b1452dfee8',
    code: '1b4ea42490e3762d4ad04969172799cf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="527acd9bd500a5673809fe7a05dbc74cc91fd92b499374e52f3006d18eb47c44", ts="1705108788", nonce="3PXZ-e", mac="pBMoP/fRe4Epvu4YVP2PUqIjwSRp+SgWN3oSHWXKqrM="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'aa440fb830aa9b8000986fb2b709551a64622345e727c2133a73085c149b5f44a00373251b31b73760cdac0d5ac3152d0aeca16304386eac0b93dfb27c0f0dba6d320ea4d12c81bad010fc425935d60d2bf3998ac6266f2993d6ff776e6d7628'
  }
}
    ✔ password change w/o sessionToken (1578ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '42aef77154edbc05890c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '42aef77154edbc05890c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '42aef77154edbc05890c@restmail.net',
    authPW: 'aeb2524844fb2e03810ecf2f8479bd7aa66a90c8ae5b7d827c6ff340452bf656',
    authPW2: 'f36406077ce2f555827d1a762bd49e23315701a6e244894ba63a40dc0cbcfb21',
    wrapKb: '62b1ff6210dc3e58fd71f7e81676cc4c7834b71f9be745f14cd2adbfc7cef4fd',
    wrapKb2: '46aa376e64348b7904aaae09baebbc190428ae20a1dc95827630758754704654',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '124d479cd84e4f448dc1dac6942f6433',
    sessionToken: '0166b91e7a384a729cbaff943ffd31ff349d657c0157892aeefc39eee9f1cb95',
    authAt: 1705108788
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '124d479cd84e4f448dc1dac6942f6433',
    code: 'b5f79752c1f5574c30ae6883bc500e2b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3b9a0e6f34312a91cc1a8e73587845ce740f5f73e3897273a4e9b7b34a27fff9", ts="1705108788", nonce="Ji4Xsc", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="F1Z861mtL/rTIamvtGG/QoJMxwjpqNRbuhGBrzKdC2s="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMTI0ZDQ3OWNkODRlNGY0NDhkYzFkYWM2OTQyZjY0MzNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4Nzc4MzY3LCJleHAiOjE3MDUxOTUxODgzNjcsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Nzg4MjY0LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc4OCwiZnhhLXZlcmlmaWVkRW1haWwiOiI0MmFlZjc3MTU0ZWRiYzA1ODkwY0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIyNWYwZjY3NmZlY2ZlMmUzZWJkMjgwN2NkMmFmNTI1YyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Nzg4MzQ3LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc4ODI2NCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.WN2dKgUXzltxVG3woD6qoN_qoTp_nlxGCzITVel7ePjYBDTrKO4HSF3KPh_D_CsPIiKhVteMJYcPwtzDWQy6itN81U1KWsp6UyLEM8Vp9P7hSWf-Mu1DZXc962X6rOBOqrC3ljIzSt7zJwYHJhbl3v6b_4ZPotexllNRi3Rl6eoYN8lt15qER_MlVurBXkyXiSsfghYzRqKhdzGBKiE-7z1WAEk16pJ3UoR0vBlLd9cgOgoAuN47HeqKoipdzWzEOI2HeaNCy6m9l0lkgKPc7L_Ft8KTAUYIZ0urXkKq2aGlQmayBNwJO64Eod_UJQCqsfx8RPGbJKi0fxpwuarFhQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '42aef77154edbc05890c@restmail.net',
    oldAuthPW: 'aeb2524844fb2e03810ecf2f8479bd7aa66a90c8ae5b7d827c6ff340452bf656',
    oldAuthPW2: 'f36406077ce2f555827d1a762bd49e23315701a6e244894ba63a40dc0cbcfb21'
  }
}
!!! response success {
  body: {
    keyFetchToken: '743df9c5bbb18e12125b24966e0d08c47c24dcd928a535281e85ba58eb246e46',
    passwordChangeToken: 'c9a7621c5e4bd9730eecef45803d00f3dc0e2284d176b63404557720a3b97c66',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fec3447cdc1fd6b78f0616ebdf14a4fa8b246d6840e074c9881d4c013c3093ef", ts="1705108789", nonce="laPSCt", mac="AdiVRbpZvvU8HKB/E4xucUkpbCWe0TBubeQM2g46NJ8="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'a4c6efefd40054eddc3b74c6bb8f4685a17bf5476701121f45bd0a83dbe4983f391afcfa6962f0ef588fb84d91af2fbdd79b0fd14fcfcfbd349fdbb2d17c20d96dbf5cf830ce994eb5c936e0fe3cd9836b7d19689825a48d5d57037be4be3451'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '42aef77154edbc05890c@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5323a27b0bba72d842f8ea3d9f87759b41d52130c0b1cc9f9332c07e3bc1e4ec", ts="1705108789", nonce="kNeNor", hash="8L7XaG+0ftDaUoBp3VQrREyhpmCJhlaifmefo1I+xvw=", mac="kHe+2YLtwl2SrihaIc8/C8NmnQfG4kOWhB1WZDKrUK4="'
  },
  json: {
    authPW: '51db9233ef26694ab483d11150d4bcac9c2f6cd643c9087162a7b2980fa62056',
    authPW2: '356b7f57c4bda20e0fb3fd2c85e956b2387912ca35a2f57d5490bdfab064d15e',
    wrapKb: 'fc4bf727e2a9f1cadb31bd71a21b779b8ee15bfb1e5e816ff5d4e64c2650b637',
    wrapKb2: '7627aaa54028b1acfedc7a10e88b2675e1aa225d9bb306f06945791979eb21f1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '42aef77154edbc05890c@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:49658ff631650ca5b82098d6f9e7d64d903682da54007067cacb4946380aeded',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '42aef77154edbc05890c@restmail.net',
    authPW: '356b7f57c4bda20e0fb3fd2c85e956b2387912ca35a2f57d5490bdfab064d15e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '124d479cd84e4f448dc1dac6942f6433',
    sessionToken: '7397cf12c7fb8948f4297423b40f9871f278a95b5a844686567fa7355b0db434',
    authAt: 1705108789,
    metricsEnabled: true,
    keyFetchToken2: 'd5df1e10a8f2bcc5a3a6b5fec9e8af6ced792a1ca77c84d81a4964d415556059',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '124d479cd84e4f448dc1dac6942f6433',
    code: 'a88c2202923dff7a8cdc02aede5c564f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="51efd72bcdf0951abc25ead64dd0f1edb7b211e4ffd07c03094ba728303aae4d", ts="1705108789", nonce="My1xor", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="xd63HJEVePapguGS9mm8tAvA53vOSjWGk9ltXFq2O5E="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMTI0ZDQ3OWNkODRlNGY0NDhkYzFkYWM2OTQyZjY0MzNAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4Nzc5NDE0LCJleHAiOjE3MDUxOTUxODk0MTQsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4Nzg4OTgzLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODc4OSwiZnhhLXZlcmlmaWVkRW1haWwiOiI0MmFlZjc3MTU0ZWRiYzA1ODkwY0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIyNzg5YWY4MTE4ODFiN2M0NjU1YWNiODcyM2U2YzkzNCIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4Nzg4OTgzLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODc4ODI2NCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.JyZoeTsPo3wGCYxRziK_mVfKz9FkwpcP6Jkr98SegyESljfiOjOIOXm9r2ZL837JrNrxY_jdvDyZInVX2EvpakekIDgssWeSxzUIPZPRuLrC5OUZIAT5BiGxwpTQFcdhjXD25Gy-Ipnu7KJ0po6OzhdWLjQiBdi95N4kJGe-AfCMnAKumyCqsyOEgkPaJ9t9OM3d9Fax6witYfOw2CZzCcxQSQgkhHvHFdhj4juNSARGaSonshgtnOcIrexWIQUWrMEiOJ_I4gcF3e_w0Of5qI2hxwae2c9Q7v7nRgltknoL7MWf9_xqmXPCbiNbWItJ2yk6U7RjeuYWIMv7L71wyw'
  }
}
    ✔ password change does not update keysChangedAt (1555ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2945c3de50fb86cfc5c1@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2945c3de50fb86cfc5c1@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2945c3de50fb86cfc5c1@restmail.net',
    authPW: '9a59de518d558127d22881f19b7aa7f014d6d48041abbac791740ae31eaa11aa',
    authPW2: '8a83953a4a8ff7c10587901bf702e260f41834fb58105b59798b7bdc725e3ba0',
    wrapKb: '5e197299e10199bbf145a982aeb34155684fdd0b13765896c6384409ac3f8713',
    wrapKb2: 'a677b1efc47b574733ce56dcd42538cb4de33567c08f231a301eba04255f3142',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:77547fafdf57a7e42b712f0d23d6f3de07fb2576a80105fb41b69872367d5473',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f42c011a88624c31acd6aa43ee425104',
    sessionToken: 'aba68dd95521b7cd4020f8bf7d970977a8f0260c535ca0be5aea15e669f1600a',
    authAt: 1705108789,
    keyFetchToken: 'c2f76f09bfaefb9b75372a8927ef6991a7677b1a9bdb23ff61732b31790ff050',
    keyFetchToken2: 'f5e822afd8b58cc141b31cf5bbf7cccf4ca8ed5c0d0fe53a411b08bb0e249208'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f42c011a88624c31acd6aa43ee425104',
    code: 'e91eaa5f68372f244c022fb3a3b7a618',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fe17a29c2f16326105ab043fa2df3bbb6e34e5efd64f99b3bf18c08cca73ca26", ts="1705108790", nonce="YsqA8q", mac="b8zzM5hjbsCTeKgA406AD9/dpYU++XrFPXNgicXr9p4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '5c552c63b029d4bf49786ce0b70c0f24d9a3cb2fd371dfaf1723c4ffde6dcfb7ec14fc1fc4128564006bc5aa1e09eec36dc271ddb8db323ac7792aa48736253371dda95be171efd29d82c9244e86350d412bcd0cd9b4a79d6ffb2dcf97271c55'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '2945c3de50fb86cfc5c1@restmail.net',
    oldAuthPW: '0000000000000000000000000000000000000000000000000000000000000000',
    oldAuthPW2: '8a83953a4a8ff7c10587901bf702e260f41834fb58105b59798b7bdc725e3ba0'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 103,
    error: 'Bad Request',
    message: 'Incorrect password',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2945c3de50fb86cfc5c1@restmail.net'
  }
}
    ✔ wrong password on change start (638ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c5e5a72bc85612583cb0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c5e5a72bc85612583cb0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c5e5a72bc85612583cb0@restmail.net',
    authPW: '986a731a0f8eff4334a40552a9e6b1b16a962d25a922e1437a3bfc758fea5201',
    authPW2: '0751e557467381be0c2bc14bca2d65899f093ce63809e5d6e4bc2b5e130106a8',
    wrapKb: 'a5339467bc04f1573cfe4c9a6554cb98b153eae26fe6398f376c320ee39d4baa',
    wrapKb2: '98b8ee19147d89941680ded5afd560509c3e2109c2970bf7bf76cadd4d1bf7f4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9926c65a929c7f7097be7f637d2f084051a996d3f8504db8998de62a06569f26',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '79a8cd22a36b422aa56f98851324752e',
    sessionToken: '9e3317797cf58ecfaf9e71813ac4f95e07f891c7f52df82a693ef6c423532c44',
    authAt: 1705108790,
    keyFetchToken: 'baf955cfd9f6728e4bcf112292ce20775dc10ddb87f611ca8d6d1e82ddb160a3',
    keyFetchToken2: '76c2449e14bbaa86d682110430a633e8dfc462a8707fe769dd629395040cc010'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '79a8cd22a36b422aa56f98851324752e',
    code: '5092b438c477ed672df1526b0e7fedbc',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="42ce9eecb2981b2d7d8f99f62e0f9dd3ba2f12fb82430d895c22c2194459371c", ts="1705108791", nonce="vemAOX", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="UOoBIe8UgRlivWHx7h2sZJgpImvnpupbXo85dh0Inmc="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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yhMqU8U3Xay11u1irbVuF2utdfvwkspvqjipeELlpGJSmSqmit9UcaJyojJVnKicVEwqP0llqphUpopJZao4qZhUTlSmihOVqeI3Xay11u1irbVuF2utdbM/eEFlqvgmlaniDZWpYlJ5o+JEZaqYVKaKSeWNiidUpoo3VE4qJpWpYlI5qfgmlZOKJ1SmikllqvhJF2utdbtYa63bxVpr3T78MJUnKv4lFZPKEypTxaRyonJScaIyqfwklanipGJSOVGZKiaVE5WfpPKGylQxqZxUvHGx1lq3i7XWul2stdbtw3+cylTxTSpPqPykikllqjipeEJlUpkq3lCZKk5UTiomlTcqTlROKiaVqeJE5aTimy7WWut2sdZat4u11rp9+H9O5YmKE5UnKk5UfpLKScUbKt9UMalMFScVk8pUcaIyVTxRcaIyVfymi7XWul2stdbtYq21bh9+WMVPqphUpoqp4gmVNyomlaliUjlRmSomlROVqeJEZaqYVJ6omFROVKaKqeInqZyoTBWTyk9SmSreuFhrrdvFWmvdLtZa6/bhy1T+JSpTxYnKVDGpvFExqTxRMamcVJyovFHxhMoTFZPKVPGTKk5UJpWpYlKZKiaVJyq+6WKttW4Xa611u1hrrZv9wVpr/XGx1lq3i7XWul2stdbtYq21bhdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u1irbVuF2utdbtYa63bxVpr3f4HW60MzAShbXkAAAAASUVORK5CYII=',
    secret: 'GA4E6ULFNJSVSVDCKFLXIVLXORDXCMTE',
    recoveryCodes: [ '83qeeqtw1x', 'ydd1cvja2x', 'haggm095r9' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="42ce9eecb2981b2d7d8f99f62e0f9dd3ba2f12fb82430d895c22c2194459371c", ts="1705108791", nonce="Y_wHCs", hash="liUUsaA6TvIrihgKfytzCJ/fOrM3RlIUAXl2X3gxpWg=", mac="22BYsYoUC/gMmCDt7adZwT/NM6eNK8sFfUAcr84vJTc="'
  },
  json: { code: '838831', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'c5e5a72bc85612583cb0@restmail.net',
    oldAuthPW: '986a731a0f8eff4334a40552a9e6b1b16a962d25a922e1437a3bfc758fea5201',
    oldAuthPW2: '0751e557467381be0c2bc14bca2d65899f093ce63809e5d6e4bc2b5e130106a8'
  }
}
!!! response success {
  body: {
    keyFetchToken: '5b7e4bdeb3fabb3b1ceadb6464a955d094a6f279f98cceca4435ab1b71b4344d',
    passwordChangeToken: 'adfd0da2cfe9628002f2ca114f34e6dc41fcea7d75bf8ab2445781e2d6fb618e',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ba4ba43c6039d981864d576f5a3397d698f05f3aadaab6018603db603b428498", ts="1705108791", nonce="1_pX3Q", mac="ITq3U1DEPuW6WNkwtA9Vw/MJOxsABbC4WS8e5xqwngE="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'bf358b267acb6823eb7127b699570b087cdefc7aefeb5dc17c387a2a410f707df6abdfee51bc14bd3641783c34196c6edbb6651ae3555b6399f48462b37e51bf3bf048c3472737d33d0ba8573f6fda03033f4a73a4a143f6663770d3fac46fc1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c5e5a72bc85612583cb0@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9926c65a929c7f7097be7f637d2f084051a996d3f8504db8998de62a06569f26',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9926c65a929c7f7097be7f637d2f084051a996d3f8504db8998de62a06569f26',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9926c65a929c7f7097be7f637d2f084051a996d3f8504db8998de62a06569f26',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="77804a2995cc4924546feca90f406106d961db74666d2646e19bef2d97f5f641", ts="1705108792", nonce="N3jEIs", hash="6XPoTfw9R56D9a+kVsJiBNWbikDKrnI+//ofGfhB24s=", mac="YCtyFATkkMPqsm88IWZguNlWKeNsSR0SqOkAaLLgrK0="'
  },
  json: {
    authPW: 'c3f67651ce70101b43291d39b0bcc5d12977f7b231d11640e69634a18f713d04',
    authPW2: '358cb40dfbded379300a0e74e52b64c37b5e661e7837f8fc1a9dd1681e049708',
    wrapKb: 'fa97eff628d4658a5b2d203ce2cfab7f4dd14ae2af15c1a03965f147c0e809df',
    wrapKb2: 'daf6f84c262b5d99955abac7222fde1e529527f3c62c04f4cadd385fc948c8ac',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9926c65a929c7f7097be7f637d2f084051a996d3f8504db8998de62a06569f26'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ shouldn't change password on account with TOTP without passing sessionToken (1049ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8bcf298514e2e5548010@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8bcf298514e2e5548010@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8bcf298514e2e5548010@restmail.net',
    authPW: '32c15e94c38ef8f89f78ea99a0cd3804a34dfd30bf5f1f7fa17ae0330fc6abff',
    authPW2: '9137197f22144f0d7a86eeadaee18485ed1f49364e1efc43f1f1ea670c0cc2d8',
    wrapKb: '241efb845f3ab8be91611d74623ed5dc5d3d6cf59c4c3774807d6f8046d8f2f3',
    wrapKb2: 'd7a6a6d91069ba20a6dc2597f23997afedb596125e32774d4c47633f7ae3adf8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eebb81cc154f4e20b99292c89274adf0',
    sessionToken: '8200d1509e6e069f2e239311eabce429ec2cf056c9d3823a554bde96f419999a',
    authAt: 1705108791,
    keyFetchToken: 'e1994e07cd7f8ab43d6ff1d9784bbeec2f2975377d9bf15b7f39b9512f26496f',
    keyFetchToken2: 'c14179e91a604c0f0a8a22defc1b4741089ecdf0b5f64aed3e82f9497fb10011'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'eebb81cc154f4e20b99292c89274adf0',
    code: 'c93345a2220eb3956da714d44e055fb8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7c1a47c85ad494fed99fc1abd933d0d090972914fba6ea9ec2b39fbccacea816", ts="1705108792", nonce="q6J3y-", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="uP6gqMiBv+B/qsFeQc8+NDprf90WfRM6oDgRXv6xn6Q="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'INNGOTDKLAXUEUCJMVQWY3DFJE4HAL2U',
    recoveryCodes: [ 'mr533zww5j', 'x42ce2xnyd', '92n867e274' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7c1a47c85ad494fed99fc1abd933d0d090972914fba6ea9ec2b39fbccacea816", ts="1705108792", nonce="klS77u", hash="dfY0i4Z3UywZ9M0WTzQTWXkH/GE0lPczpjeFy+6KJSA=", mac="iF9snYHTRnlbGpQBepjmB5h6eD356fzRnWXIqifZThQ="'
  },
  json: { code: '595211', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '8bcf298514e2e5548010@restmail.net',
    oldAuthPW: '32c15e94c38ef8f89f78ea99a0cd3804a34dfd30bf5f1f7fa17ae0330fc6abff',
    oldAuthPW2: '9137197f22144f0d7a86eeadaee18485ed1f49364e1efc43f1f1ea670c0cc2d8'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'c3bf17791b4910b89946f2b081f116133f6cf5cf5148f75bcce06f5e8ce9555b',
    passwordChangeToken: '5a562054e66841c340dfe1aa08bba6f4a2d3062b088f9c8af91d471b5e660f0d',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c2c0f9139a7bb588b9a06ff7684cb99e756e4e9cdf55cd179ac0e7b90ddcedd5", ts="1705108792", nonce="6HiW1O", mac="3U0DwQghsEOP6o9K1zPndD+zlBZQqyUZQ8czcdC516Y="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'dedf963281022d45e8104d787d9781fa9c7034ede9ff81ece9c71b8a59969d493474db898f5b2c8109ed5336fd5fa054fc9006bcf4bb2d0c20776a451da38a88fe9f5bfb9157b0089d3eff98ac191b456316e17871bb49104b6d91888dfe3130'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8bcf298514e2e5548010@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0c64b7688ad93b86bc4bd1fc607654f154e80b567b97f2cce1d773ff3224a886", ts="1705108792", nonce="NNWKBl", hash="uIVQHOVzS2PcudpxexdQWf77cYkXbL1GkTRurfOfjok=", mac="Kt+IITnEVpR4MHq5wVzvCccxf8R5VxvBmJEo7Ufr8qk="'
  },
  json: {
    authPW: '8706d98eb2b60b1445305cab0d64be7db571e37fcf0c8757c110878ba15935cc',
    authPW2: '7b8546cdba9ba72a9b37c9a5a5f65362277d12132b35039af732f9b6c5393eb7',
    wrapKb: '17c98df603ad40ca4f5a4c75592353a9186c87cbf2b1b01d1f9de1e356319d6b',
    wrapKb2: '20d19d24182ac7917cd6274fc1030d06c9442738e9fa6eea90be173144406fdf',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    sessionToken: '7c1a47c85ad494fed99fc1abd933d0d090972914fba6ea9ec2b39fbccacea816'
  }
}
!!! response success {
  body: {
    uid: 'eebb81cc154f4e20b99292c89274adf0',
    sessionToken: '8fe6b0f8cebb1a8085989a1817e948fe89622403210ab54b434f6a27c5b256b2',
    verified: true,
    authAt: 1705108792,
    keyFetchToken: '3f7fa55241afba292b0e1f918bbe531720ae9b6dbd5adf34bd7a91b5fa7130a8',
    keyFetchToken2: 'd13f9dd85e39267d0cbccae817a440e08215d628630620540ea7247d8818507f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '8bcf298514e2e5548010@restmail.net',
    oldAuthPW: '8706d98eb2b60b1445305cab0d64be7db571e37fcf0c8757c110878ba15935cc',
    oldAuthPW2: '7b8546cdba9ba72a9b37c9a5a5f65362277d12132b35039af732f9b6c5393eb7'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'd310a903de3a496502c3a4927740134ba63e5ef70f8308fe203d1786c53f24ac',
    passwordChangeToken: 'f937a09f9567ebc18b66b4b6ec4eb67a6d86b45965e3c887b08b4ea670cfe302',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ff924e0de9cb2c2653a01056b8ec0b40eec2d84cb32a40bfad242673918abf94", ts="1705108793", nonce="0Yd5Lk", mac="2ZHfjIYHMJQvWOK/Rrjq3gwiqu04OqLfDhvSvHAJOZo="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '30d6c749a207aaf595a60828521ef9b48d3ed498cbd8fa8098229c4b1cd37adad07d93b2fe6f8c5125f911925a36d310c7dd2a030333e2487fb289007a3e06bd5ac64d408ca480422707c0cf66c4ca356fc25f6dc0a8e3ab2ed8eed22de035be'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8bcf298514e2e5548010@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dce6bf2d915e58a9b7ff2a9384d02bbea2718eb911b5a55b090815944ba960ab", ts="1705108793", nonce="WuMiy7", hash="FRE1nt90VyVChm0XnS5e4MOuV5VMLioyhZyQlpSdU8g=", mac="8euCTMVmif6x6etm4QoRTbBl7T6Q4sNqq7dfmChjC2I="'
  },
  json: {
    authPW: 'bd800a51808e0956004edbd610cd91af8a42822608bf63c1a9a426608241d6a1',
    authPW2: '3dc6cf9ada3d1063fe1f75d3e2f3cfba871887402929772228106d871655ae7a',
    wrapKb: 'c7254ddb7425f1e61a9fdd11b017c68b3b64cdff8cd9fb621219988fd12b56ad',
    wrapKb2: '9babc610f38b39897958c0a70ca473756f836706474c82395f44c88191c66e62',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a42553c40c24dab24f6d41321882a2bf68c61698cab0125198f408c3e384c009',
    sessionToken: 'd30e9ee7e82959401b17b629a8033fbbf56255dc80db7dc47107c24c7bb6b9b3'
  }
}
!!! response success {
  body: {
    uid: 'eebb81cc154f4e20b99292c89274adf0',
    sessionToken: 'ce4407a33cc4b90b343b85e9a065ba0161da533c9672218d0e175753d3a59341',
    verified: true,
    authAt: 1705108793,
    keyFetchToken: '938300ae444a7a78a6fbd5b56adff4f91d7730a28300ed4586f772f4a5f70273',
    keyFetchToken2: '612d36e7c5f0d27c7858fe1af0728db62770988eaf0b59f11c5b553b2ee84727'
  }
}
    ✔ should change password on account with TOTP with verified TOTP sessionToken (2088ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a929030663f186f62fb7@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a929030663f186f62fb7@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a929030663f186f62fb7@restmail.net',
    authPW: '851ce4f7e04e77f211bc0600eb984df56fbe09132c4256faec8268be22b99304',
    authPW2: 'ee2dd23c077f9064014e8c3cbc2124e2bb4f227583efa4abb801454e12f774d2',
    wrapKb: '1b864c0a1f1e52554a37306b3a2a255aa70cdc828af9df49dc30bd1cef3dceda',
    wrapKb2: '624612520c3d1e6b9872ea3b1328f370dfa38dbdfa27ff4a34221f6889f0f169',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0609e395e8fe49389992fbcfe247536e',
    sessionToken: 'fcd7cb18f7b016db6a6cc3c39dc52bd1ae3939a6b3d0a71c47bd181d2fdb8508',
    authAt: 1705108793,
    keyFetchToken: '6e355e2cf5b275689fe20a2304450a9214e5272b0ccd806143426feacb48f6da',
    keyFetchToken2: '1ab808cde043a04601f65c7509774980a10dc3b01e68979008358600b67f6478'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0609e395e8fe49389992fbcfe247536e',
    code: 'f2e0a501ad30e8e4763ce5af78cd6daa',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9f51177874f38e4eb75fd6829a98b043f3213cbeacc1353d87814c9621b6201f", ts="1705108794", nonce="0e1MHw", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="Fm4xn0pyyiMmEW2Z8XyDeBfPBlPPoXdgWYXrU/Mgyjg="'
  },
  json: { metricsContext: undefined }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JRUVAQSYIU4VATSZMFSW4S3BHBEW2ULN',
    recoveryCodes: [ '1cak7rwey6', 'kvf5ex2hdd', 'cpmyxx3kxp' ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9f51177874f38e4eb75fd6829a98b043f3213cbeacc1353d87814c9621b6201f", ts="1705108794", nonce="PjW6kf", hash="JH5R/sWS2QKXpGkM+zwNqRAwQ91ifcEDp92tioZVVeE=", mac="+I5LcHIADmGKm9fansQr+XIFukWg94AGAcqIpPD7590="'
  },
  json: { code: '133259', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a929030663f186f62fb7@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a929030663f186f62fb7@restmail.net',
    authPW: 'ee2dd23c077f9064014e8c3cbc2124e2bb4f227583efa4abb801454e12f774d2',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0609e395e8fe49389992fbcfe247536e',
    sessionToken: 'd6f606897a7ca9aec482176ccc873d3447c1ed8bd5f996f6b026f1f07b343326',
    authAt: 1705108794,
    metricsEnabled: true,
    keyFetchToken2: 'd3584323d0bde316562ed0e073917f259e650df272f0c6c216d4f5074bff344b',
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'a929030663f186f62fb7@restmail.net',
    oldAuthPW: '851ce4f7e04e77f211bc0600eb984df56fbe09132c4256faec8268be22b99304',
    oldAuthPW2: 'ee2dd23c077f9064014e8c3cbc2124e2bb4f227583efa4abb801454e12f774d2'
  }
}
!!! response success {
  body: {
    keyFetchToken: '354e10ef4c0ab9e4f7366e76807be10dd9a079168cc7124aeac1ee63df72c93c',
    passwordChangeToken: 'd178169d0e8fbadc1e7e6f064a83b77f3128b53b1a61efa7190622c14ed2eaea',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8e569fb35ce9c362d005fc642db99ab2b6c73d9907ee9b05781b1fda5fe7f16f", ts="1705108794", nonce="_fY-5v", mac="iindEnXDSe2msdy4liUSKFIFain0E71yudl/RoaKC4o="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'f53cd47fcce21fae889f27047aca0bb89cea66acfc5d5f2d0ddac5c34e10d66172d40201ae8e7ddc5bee73c752b863fe4af6c9c1907f1e70852471d474c683aaaf0b6928eb56cc14f1d77ab650bc7f6387305942bda30eae8d31aad113ea4f21'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a929030663f186f62fb7@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="385eeeb1e82b7e6352202f2cf287a097d5a687589d61efbbbbce9a5d6e97bfb3", ts="1705108795", nonce="DBcDW8", hash="3AXGej3uBJLzCQnl2bC8S96/nDVp4ajTiYp4sOgd5+c=", mac="ROakWE2kfEWdySSCQffr3+UiRO8G9T9wdnTyGoOY6uI="'
  },
  json: {
    authPW: 'ded7a04cd987d890ff94fe89ea32e8c8ddb72c1066360eaad4ba141680c7abec',
    authPW2: '9b195c694be87ce7ff10077f693be3d0b2c1863fd98e1915e2fe2fa38ba46541',
    wrapKb: 'aaac2f707b40893b1bcb65cec3255cf234faf46220b047341a746f958bf81fca',
    wrapKb2: '182bf13c603f738fd5ad872d80fb3166f7403a2d5596f7455441d5cbb69266a1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb8e1d1c2d07d4812c52d974ff38399bcdebc1aac40f41b1512a7ed3e265b98d',
    sessionToken: '74f83f200bfe8a077898f3d38d9ac1cb1a9173ed1aeeaca92cf2e299bd2ea2e3'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ shouldn't change password on account with TOTP with unverified sessionToken (1470ms)

  #integration - remote password forgot 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '288ad010a82a6e80ed36@restmail.net',
    authPW: 'bd3fefae006701e120c99a8914e6874add6c1f1bbd54f86351376fb51b96b329',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108794722,
      flowId: '478b272309da57cfaf639c20a8e551bca6305f630a145dd4c27a7bca50a4cfa8'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '941715a76a1a4b6a82260cb7c870f540',
    sessionToken: '62179783e2354b33cd9676ee17420406b379320011d629202042b5ea61fecd47',
    authAt: 1705108794,
    keyFetchToken: '2d3aa1b1b9e9869af13d01a3989f4fa8cd1d87cffcc985daf8bb3b7ae72a2742'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '941715a76a1a4b6a82260cb7c870f540',
    code: 'c35583d951a4d401b0a1932991f82e0d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7c736e55e59e1683fc147a23ebc70edc8282a924f625fc1ddad3f08dc58dff95", ts="1705108795", nonce="5qRWjf", mac="bIMiOhdJDize3yHr7Gl5vZtqXTVCdDjLkdbOIaCTJng="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '87f75709ebd67e34cf6a943774a00bd4b6fb4dabf0ef32a3fd995ab841fd77429e7c314f3ec60d801631766654f6e39f5f0e89f2ceef8a694bfa46cee3cdf3618da20357ea668f7ff4ed6985d57e579fd6f604ef59d69b9315eb3415ab10786e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '288ad010a82a6e80ed36@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: {
      flowBeginTime: 1705108794722,
      flowId: '478b272309da57cfaf639c20a8e551bca6305f630a145dd4c27a7bca50a4cfa8'
    }
  }
}
!!! response success {
  body: {
    passwordForgotToken: '4889ce43d7d313123caaff56cb84eef7d4622fff7e2142247aae3fd237ff6d9b',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e8b792a8d45162253a8654208add7f56785e7c9ac053315389e90b69af62bc26", ts="1705108795", nonce="nfeqOP", hash="cML566Sr248f4wv7QbWEMVtnWvEK5dh3koEzhFSSiLc=", mac="vOzvFZ5wUT9bhLSMwMD1fA05KYM7QjchE+gKQlyNE5c="'
  },
  json: {
    code: '51e6080c650be31acb18b3932999efa1',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'e8fc6eacaa7d5b20faca08af77a4d0f0d1c0f71d4d972718d73c2c4eade3429b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e1f4a06d70aa3ce56342b234962cba77a35a48e86e0c48fb9d13b540d6e59f84", ts="1705108795", nonce="I2jYos", hash="jEAAix+NXYvO2SPtE45+CEWJbAqKTWKioF0IuClDLlA=", mac="N1JbxRVdTMRDgs2Oxs8GniOxgPGNi4cocfMJgEObHLU="'
  },
  json: {
    authPW: 'c52547098ce820349fc1eb6e609ae7472e76d12616da1f046f1b08cafa3ee4ff',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '941715a76a1a4b6a82260cb7c870f540',
    sessionToken: 'ed9ddfc96beb65b5bce0414dc8bb9b411194a16205e149aabf8fabb7725250ca',
    verified: true,
    authAt: 1705108795,
    keyFetchToken: '621943edab69a5852082dea66aaea6f2a2af0fcd03d16d237f30e233c5226c80'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '288ad010a82a6e80ed36@restmail.net',
    authPW: 'c52547098ce820349fc1eb6e609ae7472e76d12616da1f046f1b08cafa3ee4ff',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '941715a76a1a4b6a82260cb7c870f540',
    sessionToken: '6ca2493dd4da100e6d26bc2bf0c8add1dd692ee8ed7467a9ecc3bcb874ccdd25',
    authAt: 1705108795,
    metricsEnabled: true,
    keyFetchToken: '8424b461dfaa60ab1901689f2af8ff334ed066523e595088ab3cda374871c460',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e5f0b7a330ff5a37e6f36e1ceb4bed3b80a9b9e85b24e23e699eb7ddcfb49017", ts="1705108795", nonce="AymYN9", mac="M52VzPhLXGHlhTkDBQKb5mzEVtQkg6AP3hMQC+m7MrQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '22ad0dcae534ab3f86a76ef233aff388ead33a1ec07999dd7a155de37a0dba6aa988d8463d53a6e203da9fa6783fd71aab6de90ca2f5ddd7313b9b39e7546b11062eae6a0f3e3aa825c385d33aae8aa058f489c077e7378a92bee8e75c0c31d1'
  }
}
    ✔ forgot password (741ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4fd3b9c137850e33bcfa@restmail.net',
    authPW: '004101b7c0f36f6a9daf058e7f8a6ae2c154a6288a3419771e8c7b9ef7f3d286',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2cf6565cde9143edab988d0de7eeee37',
    sessionToken: 'fb13ca4da5fdbfde2d3e5017173f618b7d0ff5e2dc907118828bb8c4b4edf9da',
    authAt: 1705108795
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2cf6565cde9143edab988d0de7eeee37',
    code: '46dc20d1e41f7ef84e7405f6a30362c4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '4fd3b9c137850e33bcfa@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b23e7fcf3292c68a9cce043893ae21882d7a06077ee5ab91a8b033486a2ce4cb',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/resend_code?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4ee3091a16c3a31eac16d3f508f416219212e56803c85ab6bb70015b70585c26", ts="1705108796", nonce="KaTxjd", hash="mioM8uxgqSkLOcH+X3aTzcT2LUAbh8mh8sklev1JCxc=", mac="Btz1MVn86GImAALj8zgS/PPYgf6bnjO/Ld7UgIXbpjI="'
  },
  json: {
    email: '4fd3b9c137850e33bcfa@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b23e7fcf3292c68a9cce043893ae21882d7a06077ee5ab91a8b033486a2ce4cb',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4ee3091a16c3a31eac16d3f508f416219212e56803c85ab6bb70015b70585c26", ts="1705108796", nonce="ik4cN9", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="VdrXPzxrBldM7tdW31QwGUrXys/f44I0Ess8/dEiRCA="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 2,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4ee3091a16c3a31eac16d3f508f416219212e56803c85ab6bb70015b70585c26", ts="1705108796", nonce="y6lUrX", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="T7qXOosjhHUl5kD8eU77PyH8LjlUcqSqH43nrD6OYAE="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 1,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4ee3091a16c3a31eac16d3f508f416219212e56803c85ab6bb70015b70585c26", ts="1705108796", nonce="PlIWcb", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="MLLgh6PvHAncBXW1Y+WVCygjWZCja63O6chNQuWdJ3s="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 0,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4ee3091a16c3a31eac16d3f508f416219212e56803c85ab6bb70015b70585c26", ts="1705108796", nonce="kvHAw3", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="CljIxNYDwANMeTdBhJOEE2TfdCSAZC0lcTlfKD2+bNE="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ forgot password limits verify attempts (327ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ef3ce2aba933564f1e76@restmail.net',
    authPW: 'e3417370646a8bff237f6c8212116a7a99bbbedce9ad9d7941c5a9af19b4c9b2',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f42bd082a4384b6e9d42c4a384248d4c',
    sessionToken: '884321b283c86c349a92e43c5eaa1515a684b2c7ee8570062344ebc76fbb1708',
    authAt: 1705108795
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ef3ce2aba933564f1e76@restmail.net',
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '2a37722b5115a438c2136ef0b9f9d6a731a57efa2ac8a18c764a8981900dd13a',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ recovery email link (241ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e5ffac36e39912e02fc1@restmail.net',
    authPW: '1e086625e2c76af5955a5f403781550a09c1e1268087e22fef5ce7539be601a0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cfa3bb77283d481685c9a836d53f2bf9',
    sessionToken: '704fffd36b0e283ad7f68efe91c8a89dc93e476ebcd2bb0c54e37bff43597a24',
    authAt: 1705108796
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e5ffac36e39912e02fc1@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '3914434a8351fa1db27333460a8fb8ac6bc9649abcd85e3f57b6a163aa9871e1',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cb92da329fc148aa9ea0f430fd97f210becf0192ac467c0e106c7bb4626d0877", ts="1705108796", nonce="RAIFhn", mac="z1g43PbbKn5tTe5Va+wb8/gMd/SXSyFZIg5yIhU4hbY="'
  },
  json: true
}
!!! response success { body: { tries: 3, ttl: 86400 } }
    ✔ password forgot status with valid token (267ms)
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e49c4bc176adcb626dab9fc367453e4b488442760cf0f589526cceeb39b74e11", ts="1705108796", nonce="A1TDRC", mac="u8NgqCcbcLOit4a3Dugpmi0n1VaSX+Yn2zqVDjDVh7c="'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ password forgot status with invalid token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4bcc58e7ee3a54007ea5@restmail.net',
    authPW: '70d374111c19ea9631d670fecf5e198318837517c9093df8f5b84023dd96a121',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3507a1633be64a6ca69bd7ed2acf1fd1',
    sessionToken: '315d64852953d5c32bd4b42362487ffcb28b267619e5dce5ad7b71f442e01ada',
    authAt: 1705108796
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9237ea7d99b38525df68a998e74fac829c4e0fd67f83949b4222035ae34fbaf3", ts="1705108797", nonce="V5Nm4M", mac="I2i4cu90PMyZrG0+RV4SAaWgeQ+pa4pNxUrDHl2wQJs="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4bcc58e7ee3a54007ea5@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '4bcc58e7ee3a54007ea5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b60becc11a519cd4266ada3587d5da35a9af9b1f6f18b4108532cdfe48a2d3a4',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5f45c2b7aace942057a9f6d9a71cdab0396d1287dc15316398ffcbe74222ffd6", ts="1705108797", nonce="HzXmkH", hash="onYHSYus/vN5jnAKBcXKfowu8Jq9nNRzG6fQgYS2ir8=", mac="5MWPKFrFaCjerxv4Yz2aaCVaAGcIMiHOfMUl3MDxRck="'
  },
  json: {
    code: '751be79a3460c6b1ed03d8ff45c07023',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'c1cd1d5bb051ce0768002261b969d42bdf86df4f22a1116d14bf4d5f0667d38b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9237ea7d99b38525df68a998e74fac829c4e0fd67f83949b4222035ae34fbaf3", ts="1705108797", nonce="_PhKnD", mac="aIXs5KqIcw9S5RKPFPMNAagkIP6ph0bU7pT14JpS9Bw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4bcc58e7ee3a54007ea5@restmail.net',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
    ✔ /password/forgot/verify_code should set an unverified account as verified (298ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?service=sync',
  method: 'POST',
  headers: {},
  json: {
    email: '747474fd6156f46c8a1c@restmail.net',
    authPW: '09a6683ac5bfcd054e58167def1dddc087a2446a323c46794b8715231449ffee',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cb5c5909f7c642f1befd8a0f9ab399ee',
    sessionToken: 'cf408f6edf46d00a347635936d160d8419b8f17fb492f70a61b8cdec349722eb',
    authAt: 1705108796
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?service=sync',
  method: 'POST',
  headers: {},
  json: {
    email: '747474fd6156f46c8a1c@restmail.net',
    service: undefined,
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'aa3169e6625d0d22c5be2391f6b1c86165c6cafeda6cc44900c26f5113f3fc60',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ forgot password with service query parameter (257ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '1a3f15e892f60ba9f519@restmail.net',
    authPW: 'f272cc180619180d9d7180299f8d5ae662c67489a35411b52c34a58d731c67fc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bf458973615a4292ba8637b5c6c69505',
    sessionToken: '430510440099c3ca91a953a2b71a10a475e734bf7685241aed84cd435fde4bda',
    authAt: 1705108797
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bf458973615a4292ba8637b5c6c69505',
    code: '56578c33f65308232bd572ab90393f8a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="baa3d1ea907480929dd6b04e932451f7c656fcbaa5496c08524bdeba2bac29a9", ts="1705108797", nonce="7l3SGb", hash="YhDP6C1alb6UfyGWs972hOsiAZ6TNRejdqlh3TLOJpk=", mac="cggaFYDZuXofZCTciL89xFr6vbZEQbjr0sHVPaxAUVI="'
  },
  json: {
    name: 'baz',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'tn1A0qZS52hPmZNxNd1mCA'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'tn1A0qZS52hPmZNxNd1mCA',
    pushEndpointExpired: false,
    name: 'baz',
    type: 'mobile',
    id: '76652e0237df060ac555a6ca14e73e43',
    createdAt: 1705108797091,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="baa3d1ea907480929dd6b04e932451f7c656fcbaa5496c08524bdeba2bac29a9", ts="1705108797", nonce="jGEZb_", mac="DJhyqZS/WoNjwLANUsRh1+AySa+lIri7hnvxBY/Xfso="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: '76652e0237df060ac555a6ca14e73e43',
      isCurrentDevice: true,
      lastAccessTime: 1705108797105,
      location: {},
      name: 'baz',
      type: 'mobile',
      pushCallback: 'https://updates.push.services.mozilla.com/qux',
      pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
      pushAuthKey: 'tn1A0qZS52hPmZNxNd1mCA',
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '1a3f15e892f60ba9f519@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '92efed77fb246861f4b0549dd99e11db0b7280ed2e056fbca3cb3319fa04322e',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eddbd41aa5246e9619d0b1fec7856959593689c5af5a7448906f9216dbe6bbad", ts="1705108797", nonce="YfZrlG", hash="4ejOxPv8OAxhgKBXezpfSh4ofWbJ2wUezf1QzdAiAUg=", mac="Stt/5UIODxbzG1RfShTdzMw0TO2zhpUTQavE8EllWVU="'
  },
  json: {
    code: '66f9f06be728f62f6076204db5c6df55',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'ec3aeb2fb08b7567dc89f612cd566f70cabee57baf2f042b7b2b716bbf1adacc'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3866ca6482085544486d1373dc5455f2f9eebc5a3610fc882dc3b46601a44c5f", ts="1705108797", nonce="zrzZUJ", hash="fYWNolUYoQlKLWhZ7V5em2AIWZUGD6LezuT6NBRjjVI=", mac="gomBulsap7lgKb2teiCi84DL6DEB9Cr5UTL628evcrk="'
  },
  json: {
    authPW: '199f266b0e2213c6b82ca043c1630f65f2d7bd6c5ae38445d92143de27f10d4e',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'bf458973615a4292ba8637b5c6c69505',
    sessionToken: '63fad2f229ac5d257cde7b5e6309d1c16bbb5428e122325e4dedf0e7d46c442b',
    verified: true,
    authAt: 1705108797
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '1a3f15e892f60ba9f519@restmail.net',
    authPW: '199f266b0e2213c6b82ca043c1630f65f2d7bd6c5ae38445d92143de27f10d4e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bf458973615a4292ba8637b5c6c69505',
    sessionToken: 'c2d20b79c51d3a77d100d487617ac1e916ef88ed8936021209e0f73be14edfe3',
    authAt: 1705108797,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1b183f312f31438e5bd1d54c37a643ca6b91c17bd95fe76bbaa12b0b4a88aa54", ts="1705108798", nonce="syoNj3", mac="gt+g8SxLXs0oRW/mCQx17X7KqzQ9K7PO2u+3JpHR9sk="'
  },
  json: true
}
!!! response success { body: [] }
    ✔ forgot password, then get device list (1112ms)

  #integration - remote password forgot V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ac3061fbd03247388875@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ac3061fbd03247388875@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac3061fbd03247388875@restmail.net',
    authPW: '6986b7309257af5e1d783e8315195e6384c4290640e3af9a285d2c18dc96ad87',
    authPW2: 'c8860cba70d2028bbed0acae5d6e4e0b879900ec0447befdf67566730eb2ba46',
    wrapKb: 'e0d7006b3a610fd2eb96e4be090a50902ce60141b184db2be3e90b46fd1a2d18',
    wrapKb2: '6a375ab16c1bf2117ec0ad171a86125a85df68d0e71e98a5094de0392011a6cc',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:255a872252d89d2a156fa6b669ee48c334ce1038cbdda040fe3c70fa7af1fb6e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: {
      flowBeginTime: 1705108798026,
      flowId: 'e096f50324f7dbc55e19122df6c67f65d484ea705a7fd9bbbc6da95d20e9cf90'
    },
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c95b58e456074fbca8f1f6fdc9fb77ac',
    sessionToken: 'fc83f511eb0b64e815453868253d3d787f6acfe72b11e4a0145b78acf45208a8',
    authAt: 1705108798,
    keyFetchToken: 'd128a7e7d0e08150731c43508a8a815b4f0160cb84e458ff77c61c7dc1d37505',
    keyFetchToken2: '6db39327b31cd9ced3e118e9c37c5b8ecd1388f69c2437e72f63734601ffbf80'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c95b58e456074fbca8f1f6fdc9fb77ac',
    code: '07ebad08f346de948b2b17f70cbf7915',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="fa5b2c8b17a0987963c122b82258568bd1b980e40f10ca741eed8916887d0018", ts="1705108799", nonce="a3X8Xz", mac="4Qv5Z1SMUFFWNaAeuGaK728xz66cBJQqZgg7CbtyYn8="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b7e85cb25fb4cf310c2a07cefa2332e62a464dfa66bb03e55f2e29480e93324a96ed6eb12569055a5964401d97a241ade62720b16228973d1525d4160b9c3bfe959801da675c2c387ca6835f9c655d8604bd4fa4ed5e4621bf706dd26d103f32'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac3061fbd03247388875@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: {
      flowBeginTime: 1705108798026,
      flowId: 'e096f50324f7dbc55e19122df6c67f65d484ea705a7fd9bbbc6da95d20e9cf90'
    }
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b78f6dd3d468691c174b9d562bd56e9c5e45217d72fece35c1938c6f25b6fdfa',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2dc9f79052816ec814abff86b4980e2db964c76e4bb148866b3a88c9e4c465c8", ts="1705108799", nonce="JKVtJy", hash="z6svPFkpJ/bIAkZVhLA7gBFdTHWd95zUg0zNvWTvjXs=", mac="4FQKVys98JdDmnp5Y/btb4U9IxtAqPp1KLCvuMrOkto="'
  },
  json: {
    code: 'f516f03d7ac401d2b75e9a4946b0cb53',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '4677359b9d643fccbdb15be392bbff85490b8db3ee9c393072967f4e21a6bcbf'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e5db9224a654675d910de694a6444b2a8244afe5962b0f17c272564bb45a5d1b", ts="1705108799", nonce="av7S8b", hash="LXXehyHFyb2hIIbfi7SnphoBYmZlF8naL9y14qP9KIw=", mac="+UrD0JEtDBVLmWDT2QUOdgRU25tuA/xyWfFiqfmLHgM="'
  },
  json: {
    authPW: '4c288b598778602fac5effb96b1b9bc9c954bcf3fea97eeff2c6a7bdf3bce101',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'c95b58e456074fbca8f1f6fdc9fb77ac',
    sessionToken: 'a26758c91608fde727dcb78910d4f0ef67f192bdffe37eb11696750b7166c9f6',
    verified: true,
    authAt: 1705108798,
    keyFetchToken: '7b62bd4ee494c58c95bcd6e494a9ad103c9b15dcecb19ecef4d45b0f378d71fa'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac3061fbd03247388875@restmail.net',
    authPW: '4c288b598778602fac5effb96b1b9bc9c954bcf3fea97eeff2c6a7bdf3bce101',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c95b58e456074fbca8f1f6fdc9fb77ac',
    sessionToken: '1384f8d68cd7e7448bb09c1e3f6a618d44638fb98c179c04e1ae2d5e6fce4bd9',
    authAt: 1705108798,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac3061fbd03247388875@restmail.net',
    oldAuthPW: '4c288b598778602fac5effb96b1b9bc9c954bcf3fea97eeff2c6a7bdf3bce101'
  }
}
!!! response success {
  body: {
    keyFetchToken: '9bb5c277654f353b28bf98a0074842903cf078aa121d4dcb4f2bcfd8ae7549b9',
    passwordChangeToken: 'dac8d59dff424803f996825d9e40497069e73015274286b60948ac36df7200ba',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e220ca93c559fcfa442517ac17a31b94e3bee2d715dc4000915eab56a730c385", ts="1705108799", nonce="yBF1Mr", mac="alargoNuL71VfS9P95XzpeE/+23gdXmAX0efowPhm1I="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '8f10afd1dd2be55c42067dbabfa7d5da004b56032ff2d7e3ce57506fd0a3c44dfb78aeef6f61b2bb19557b502e2c467cef8ef9116245c84d9acc88fb2e841e66c14cf1c8538bf24eea79ad2e4bf3981522354c15789e3239a2a2c459bd8e113b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ac3061fbd03247388875@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f8d2f523b8472aa3d56e4c23f5d2680f37112007996c20502b8ca3c259012ee1", ts="1705108799", nonce="mPzyK_", hash="kr91HVyemHp4dgOAlIwSbfLKl3aw28Tp+WBiJxPctsI=", mac="12QweG2G6usKE3h+PrrBsYd9ShcAsHiaJQttGVBcw8k="'
  },
  json: {
    authPW: '4c288b598778602fac5effb96b1b9bc9c954bcf3fea97eeff2c6a7bdf3bce101',
    authPW2: 'aca149de71e717dc8bec0839b30eb2d3c5f6d45bf9ad7ec3557669b6fb15e74c',
    wrapKb: 'b9a58d0c4994ddc59ec6a147eab2f9581f46bdc7459fa715221c94cd99632a93',
    wrapKb2: 'bd0ab1640c6a2a856de5f3e2bf5548b78150857ba0eb83258e413b352ca98904',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:112351e17759546dfb4e8939a1c6b8c35e66e9d650ad5d39514129057e941938'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ac3061fbd03247388875@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:112351e17759546dfb4e8939a1c6b8c35e66e9d650ad5d39514129057e941938',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:112351e17759546dfb4e8939a1c6b8c35e66e9d650ad5d39514129057e941938',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:112351e17759546dfb4e8939a1c6b8c35e66e9d650ad5d39514129057e941938',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'ac3061fbd03247388875@restmail.net',
    authPW: 'aca149de71e717dc8bec0839b30eb2d3c5f6d45bf9ad7ec3557669b6fb15e74c',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c95b58e456074fbca8f1f6fdc9fb77ac',
    sessionToken: 'a378874fb2def4071e43c9c5bf48506caee75eec03aadf65a6675ab65e9868a1',
    authAt: 1705108799,
    metricsEnabled: true,
    keyFetchToken2: '8926fb93f324d69d92256c9c510157a5e0d47a66513849b2d5ea3d9352575a4c',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e55a3cc4a3a0462ebcc63787f14ac28fd2194aa68cf9664f9ab0c30e5168bed5", ts="1705108800", nonce="nkv84D", mac="CzB9wdufm/sk7pa2XYIZ1Iw+wLk2c4WbcnKyh6EjAr4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '404a874a1595a5bbbbbe4bbbc90c4481619e509544023e9719d6638d7ed8758f1166d718c984770937cbb58b5792da913f9b76c2515dfb9f149946d17ec409dfa1046cf709c4ab7c4856d81e13b969a4d25cdd6b58ca8bb940075ae1c7f56d23'
  }
}
    ✔ forgot password (2040ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '044c1aee10f51b9da9dd@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '044c1aee10f51b9da9dd@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '044c1aee10f51b9da9dd@restmail.net',
    authPW: '48fb411ed70180604a6ca41a173700c248896defafd1345ccb0895b7999aaf55',
    authPW2: '33874e5a5972b0ac362eb01f1649a75c0552f8ee5f7e205dc7e5541d9b1dc39a',
    wrapKb: '2389e92052c0c3193e0f02ccbab93933e971fbe1c399b79ea41202ea446abd33',
    wrapKb2: 'e0ca907df4c68011e5d9ca82594a3258b34cbd74d2bcd039271b0bb9b34da3d4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1ba7eb6d65b545858575de365869a77747405b173d4560a288a83011bbfbd18e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c3999083e1044d71b67804a46ca1bf40',
    sessionToken: 'eee6f09fd67cbd02dba418dbcb3214c39dafede5b3f01983587ca09c62d4ef71',
    authAt: 1705108800
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c3999083e1044d71b67804a46ca1bf40',
    code: '65d702bcb79611f9ccc618d6bd506444',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '044c1aee10f51b9da9dd@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '9f4eee8059399f331738cb872244847e051d560c4352d2ba68b3bc50f21dc0c4',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/resend_code?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="487c07453be86fed87cee4ffeb0d1e8dbcab785a35d9736565851b8df3359428", ts="1705108801", nonce="5B9hLg", hash="6wcoIEtQcopeiAyBrT+eWk/901T8xbzgef/ol73r6cE=", mac="N6FrspXaov5zOf38SyL19HKrNzdpcL2CMRP0sKtbSIA="'
  },
  json: {
    email: '044c1aee10f51b9da9dd@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '9f4eee8059399f331738cb872244847e051d560c4352d2ba68b3bc50f21dc0c4',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="487c07453be86fed87cee4ffeb0d1e8dbcab785a35d9736565851b8df3359428", ts="1705108801", nonce="fMvIKD", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="zpPhqXLxHqSUwmU/CLfBE8wNmTSrtu7edRREu0innDY="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 2,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="487c07453be86fed87cee4ffeb0d1e8dbcab785a35d9736565851b8df3359428", ts="1705108801", nonce="UIS7rA", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="Sy42r9kKUfvDSPzO/b/bLYt0qtb11WJLq1fruI/2fEU="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 1,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="487c07453be86fed87cee4ffeb0d1e8dbcab785a35d9736565851b8df3359428", ts="1705108801", nonce="spauXl", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="aGMb5DO91QsDCpyKPqpGjshxQ51OTTLQmRiUahcN/n0="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    tries: 0,
    ttl: 86400
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="487c07453be86fed87cee4ffeb0d1e8dbcab785a35d9736565851b8df3359428", ts="1705108801", nonce="XZQqgw", hash="NK2ttf8zlYUImHWGe/5OmJ+LPLROx88jchtQ/B62z2s=", mac="V761x+IGjDUlo8Y/qKuYdoh9ApcFL7EgDejsY7mMqs4="'
  },
  json: {
    code: '00000000000000000000000000000000',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ forgot password limits verify attempts (575ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '64683054515ffd03bd3c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '64683054515ffd03bd3c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '64683054515ffd03bd3c@restmail.net',
    authPW: 'e7d86364593bb54b6674f2d5cb47027dcf65e12ee43d2cfe1d144b6bf6ad7679',
    authPW2: '23bba69fcd80e5249b1ee6c66a9e2ed4ce56785c6aed418899f209ffab69a8eb',
    wrapKb: 'ef45e53690baf921bb42d51f49329cb22f897f2cd8a258be6ceec850eee8c22d',
    wrapKb2: '203f159229be1aecba809504b7b3986c1f729f518a66312e282efb861ffb7be7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4984bff8ba2b1412d88b66425e9b4f412a16a6134810289715afe3ffe79235c3',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5c472ea39ff04b6495e8dfcfb604f551',
    sessionToken: '61f0570282083f17bb90865c1b930987cd1f7b979c7fd3be7bb8b9fa7859100b',
    authAt: 1705108801
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '64683054515ffd03bd3c@restmail.net',
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '31f2cd1d64db976cb89cf2b1fe4080d8452cff818317ea2b85ea995001b370d1',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ recovery email link (496ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '810b157da2cba2bf6dc5@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '810b157da2cba2bf6dc5@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '810b157da2cba2bf6dc5@restmail.net',
    authPW: '3639ccd957660609f3403d7b59ecadc019dc8376a4a072986fef64930133885b',
    authPW2: '16d282ab7ae44adc6ac8776b2a4c5d085ddc14cec1f81dbe1dc8436911ec755e',
    wrapKb: 'e11217fea6ab3637ed2debfa73946adbd49609dc83fe40f469e711ddab4f57ca',
    wrapKb2: 'd5e6d3093520de594a7bb1aaa45a007bd56b448ab3c847ae20bafdebe906cbb2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f2845c2d35687cea4a738936d74b6383ba7e96ce660a7f626071356cf5600ff3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '752668a928be41a79b4d05695fb2ab1a',
    sessionToken: 'be0034f1fcf2eca851212fc845627af2da9267e90e2f41caa22e8282038fb372',
    authAt: 1705108801
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '810b157da2cba2bf6dc5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '88100fe927405e5c8f95580191e2e27cdf1a22d32732b12a5f3270bd6f29fe0e',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e7d387bc44aaffe68e1e0013bba5aa4e1b8d3b6da24bd0a3a152f9a51c0a191c", ts="1705108802", nonce="VLRUY5", mac="VxaqALlQ3LJ8IWkLcTXkt0jyukYJ2vs8M1bvN5Pe4UY="'
  },
  json: true
}
!!! response success { body: { tries: 3, ttl: 86400 } }
    ✔ password forgot status with valid token (511ms)
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e49c4bc176adcb626dab9fc367453e4b488442760cf0f589526cceeb39b74e11", ts="1705108801", nonce="iqbToz", mac="ENbATLioPmla/8Va7JxihZBkIR88n/amwU7q4YtO3tU="'
  },
  json: true
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ password forgot status with invalid token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b4bd774e1d7e093ebe22@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b4bd774e1d7e093ebe22@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b4bd774e1d7e093ebe22@restmail.net',
    authPW: '2dc846e00aaf06da9ad2704b1774a4a220644507632103e83358bdf1f4817750',
    authPW2: 'e073899c88b4021c5aab02611f5e12806edfd57ab7f1dc07beca9bee8777483f',
    wrapKb: '90772152ce3d6500ec13c797d46051597251d8ea4b51792e512cb36151eb6abf',
    wrapKb2: '01926cfd59e61bbe127006cfaa713aa15d830a790ab7eb89c86cc809e201b51c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:eabbf0b691dd529c20f82d2daf035b76b93bff06d7a1cb1fa514c78f56d95e6c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'aa64a1ef90c447c9842707d32d707985',
    sessionToken: 'd567781ce56153df4a0d68a9314c82ba56ec821c95aec6a0383f11a4ef4c40e7',
    authAt: 1705108802
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8b6e53901d09b69b7c2484820bfe6b3f0352df92776d72a40f2fb6b726bca05a", ts="1705108802", nonce="n1Z9kn", mac="JQH+TvctN6OxhKj5h4bQFN+DA5jEUvgclKjxbEtQfgw="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b4bd774e1d7e093ebe22@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b4bd774e1d7e093ebe22@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'f4f73510e93e82fb332101bfda5f06f35953e47072d77001862744cf7d96122e',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b688ff5cc3d4c384f5ad248c315e5c1087040888516254b1d9d8c934316fa059", ts="1705108802", nonce="dCLTVa", hash="V4l4lV/AHCwrwksCARDw/q970tZcPEMa7sPkKSPNPe4=", mac="baw4CGtbzjI5bpHWwDgkJfpvaP7sxjuH26XOzmr4SPU="'
  },
  json: {
    code: '602b81928f64c5b6bacd9ba4041cb9e8',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'db76d23ddb60a33ad6efae9e2a8ff84a4fb3829771e6d5067479771d35f9e94d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8b6e53901d09b69b7c2484820bfe6b3f0352df92776d72a40f2fb6b726bca05a", ts="1705108802", nonce="ekhGp6", mac="qxUm2lXe3eomdnx/t9sY1ejQSom0LwBBOE7yfClB4QU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b4bd774e1d7e093ebe22@restmail.net',
    verified: true,
    sessionVerified: false,
    emailVerified: true
  }
}
    ✔ /password/forgot/verify_code should set an unverified account as verified (557ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ee77f579d55f57d8427d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ee77f579d55f57d8427d@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?service=sync',
  method: 'POST',
  headers: {},
  json: {
    email: 'ee77f579d55f57d8427d@restmail.net',
    authPW: '30dc773a44b7e15b4cf33331ed7e13721dab0356b92eda602f1ada213d135498',
    authPW2: 'b5245c7f2c6ef47c63357e609fa61c9c7e81080ab429457002fe1ef8ae41d0e2',
    wrapKb: '5fde920cbdcbc62908ad49b456c3af2e9199cb80a98d6c02d0acaa63896773d2',
    wrapKb2: 'e4bb13107bc0ef307998de7603fdf0dcb0a31bf69619a1350d75befd4aa836db',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1d5f23a1fe9328384f1c7c7b10f82f9335ad60cc430139178e7ae7ee374dc954',
    preVerified: undefined,
    service: undefined,
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '00d87257d75840eda29873a7584f1034',
    sessionToken: 'e1c1889c726913b34576a0ec07ff7d840d620b89fc91c8debe93a805066c89f3',
    authAt: 1705108802
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?service=sync',
  method: 'POST',
  headers: {},
  json: {
    email: 'ee77f579d55f57d8427d@restmail.net',
    service: undefined,
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '8b91dbefcc31cd53a7ab1b7cf329861c915ff40b84d616e7cd876796eeac13b5',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
    ✔ forgot password with service query parameter (500ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8221c1902ae2064b9e10@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8221c1902ae2064b9e10@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8221c1902ae2064b9e10@restmail.net',
    authPW: 'e80aff338dbd081f11448ef66be8ce899626f96dd1d3675a8f5a9c7f315d6d8b',
    authPW2: 'f4c94381eeab5b63e3e5f1e2051e474b512f2ac9b655e741434cac34c545d2df',
    wrapKb: '8114461466ee67978f7aa43da18506fee62f67b5d9221e7705087b3b446acb7e',
    wrapKb2: 'e73732bb6d1502d0dcb0f7b22cb0b781621c40283c0b4aea7b6027642a661a4c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6e4ed142d689c72f6ccff58a56950221f2d9c00ea54e2e8b25094ec73ce80de6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '88324f8ef95d466684fb418c3f5895ec',
    sessionToken: 'bd8e58403811002b0ee50a162cbe9b6de05aa74c146f4416944803010acc8f1a',
    authAt: 1705108803
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '88324f8ef95d466684fb418c3f5895ec',
    code: 'f8d9c7e85e6f8dc48e697d7998a897ea',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/device',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="00c5cead558ea3b2392520aba9aa9526f66f3b360988367decea22bb16683437", ts="1705108803", nonce="sPIHIx", hash="KnzkGaBf6uuN0C/lTart+CUOR0mRVy52t75RXIdQ4b0=", mac="frhp3mGkumff2k3CX1Q5bhnfhp/drpwbCeBjTiTg6mw="'
  },
  json: {
    name: 'baz',
    type: 'mobile',
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'TkfhmRn-bqqsRkM0wm2gdw'
  }
}
!!! response success {
  body: {
    pushCallback: 'https://updates.push.services.mozilla.com/qux',
    pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
    pushAuthKey: 'TkfhmRn-bqqsRkM0wm2gdw',
    pushEndpointExpired: false,
    name: 'baz',
    type: 'mobile',
    id: 'b6dbe5e244fe6d262619163e478cb90d',
    createdAt: 1705108803190,
    availableCommands: {}
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="00c5cead558ea3b2392520aba9aa9526f66f3b360988367decea22bb16683437", ts="1705108803", nonce="TE5PYs", mac="Vi361lNqFyc+lfA0LZbUM7IWnyGBTKJtuwet8SLHDhI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      id: 'b6dbe5e244fe6d262619163e478cb90d',
      isCurrentDevice: true,
      lastAccessTime: 1705108803202,
      location: {},
      name: 'baz',
      type: 'mobile',
      pushCallback: 'https://updates.push.services.mozilla.com/qux',
      pushPublicKey: 'BDLugiRzQCANNj5KI1fAqui8ELrE7qboxzfa5K_R0wnUoJ89xY1D_SOXI_QJKNmellykaW_7U2BZ7hnrPW3A3LM',
      pushAuthKey: 'TkfhmRn-bqqsRkM0wm2gdw',
      pushEndpointExpired: false,
      availableCommands: {},
      lastAccessTimeFormatted: 'a few seconds ago'
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '8221c1902ae2064b9e10@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '244bdd84960768cccbcbaddc19f0420fa75dec8806165a20108d6b04b4ff27bb',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0d763998f4e1fcaa2dc1687a59db18d7c412831c3ed771accbbce240e34e18a9", ts="1705108803", nonce="7rKH7t", hash="yb0qwJRXJ9n0cR7o23mKrlUZ8fJTzdlgzW73sPGQWCw=", mac="jFguoXIIWE2+1b37B7yjBK+e8r7VUKckTdhIulMrrqY="'
  },
  json: {
    code: '95bfdeae97afdace10312a279c25a01d',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '6a9b9d45b31f2d1d1bbc3221004a60665d3c8f0667536b254ba7241822d6bd98'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2c4bbcaf8bdf034c2837025f39a6efcc9a882f964c7009d710ea1b29aa972d44", ts="1705108803", nonce="Re14de", hash="XtMmhzcnTdcrLxmmZ1TjoMXklNj3T0F5T/x4s+Eu3zM=", mac="F4YhrLeioUarKUGgtYrFgGDEm5YM1oUVb85RbvRbUr8="'
  },
  json: {
    authPW: 'ffda8b274ffde4553cd4881f59bc2818e9bc035f223d788eb4f157ccddf36858',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '88324f8ef95d466684fb418c3f5895ec',
    sessionToken: '4d0c838df52ff2fde097c4ded429a909e86b24095975c0bf80515aa30bcaa68b',
    verified: true,
    authAt: 1705108803
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '8221c1902ae2064b9e10@restmail.net',
    authPW: 'ffda8b274ffde4553cd4881f59bc2818e9bc035f223d788eb4f157ccddf36858',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '88324f8ef95d466684fb418c3f5895ec',
    sessionToken: '3e62bc4c98451a8f3b7c9e5aa0665c47cf4b5c448d390c3a63bc8cdae0d8469e',
    authAt: 1705108803,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '8221c1902ae2064b9e10@restmail.net',
    oldAuthPW: 'ffda8b274ffde4553cd4881f59bc2818e9bc035f223d788eb4f157ccddf36858'
  }
}
!!! response success {
  body: {
    keyFetchToken: '6b2fa242393b61cf9b1637103bb3a1f3a82e8730867608b03c9c9e9c25d4e806',
    passwordChangeToken: 'e25a94f126643bf5c3fa3f5cc4157b6d67442650caa4a55f6c76e295d8a81872',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9c4dc6672841b349a1c7b30903930bfdd45004734f9677c05637e27b5c16a9d7", ts="1705108804", nonce="dcoONy", mac="/kP2kkG9IdeYPCGn15cq93bc5KelH5WcRbFSwfTc/Nk="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '1efb6fef14730e3d93850dc2d1765990175ce54f8dd9c6ab33236643900c897c71d4cf0da356618fb4eb4140a0ad4b633185182ffbdf0135f93adcb4129f484537cda07a9a17ea8dbe7919c19298cdd85e2e22d4707b2146ad1174a0dfdcb904'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8221c1902ae2064b9e10@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b2f00367c092e8e9081ab7b6011df3b331adb5de35c0bd0caafbcb1b9a510034", ts="1705108804", nonce="73TKKs", hash="ZflwgjGeybbZWtxsqR/Ybj4L5VlISO1NyxN26xIDlqQ=", mac="4+SeuSqg03Sb6ZasRVcSxq8WD/PXESbzT+wmgb5Tqv4="'
  },
  json: {
    authPW: 'ffda8b274ffde4553cd4881f59bc2818e9bc035f223d788eb4f157ccddf36858',
    authPW2: 'ca91e6919b1502fb0bc2c29f312c2200fa126124862fde00a07c6bdf2f780141',
    wrapKb: 'cca8209a35475ca31188d08bc44b929b65fdef6b5640b3bcd71e47e5f3347d28',
    wrapKb2: '1d966c390fcea46462691cef9dbf8b4b56b805ad9ebe23b221aad9cd0fc7a913',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b7101a51497ea3a884fcfef6d3d119cb8f94ac4d7c501c904655b1094f7b81e6'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8221c1902ae2064b9e10@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b7101a51497ea3a884fcfef6d3d119cb8f94ac4d7c501c904655b1094f7b81e6',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b7101a51497ea3a884fcfef6d3d119cb8f94ac4d7c501c904655b1094f7b81e6',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b7101a51497ea3a884fcfef6d3d119cb8f94ac4d7c501c904655b1094f7b81e6',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '8221c1902ae2064b9e10@restmail.net',
    authPW: 'ca91e6919b1502fb0bc2c29f312c2200fa126124862fde00a07c6bdf2f780141',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '88324f8ef95d466684fb418c3f5895ec',
    sessionToken: '5793a95f3cd5775e0147e5f44309b391e0c94ffa2994b51dca0571ebd3bdbadd',
    authAt: 1705108804,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/devices',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a72ccddd665c69271cac8b68116a308eb2c37d68cc1e824c85638d10bc268711", ts="1705108805", nonce="Qrky0A", mac="m6aByKtBxeiEQZMbvF3tlonTWFxDOnbQeTY/yPc1dLw="'
  },
  json: true
}
!!! response success { body: [] }
    ✔ forgot password, then get device list (2236ms)

  #integration - remote push db
    ✔ push db tests (100ms)

  #integration - pushbox db
    store
      ✔ returns the inserted record
    retrieve
      ✔ found no record
      ✔ fetches up to max index
      ✔ fetches up to less than max
    deleteDevice
      ✔ deletes without error
    deleteAccount
      ✔ deletes without error

  #integration - remote backup authentication codes 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '85b47fac570917c77388@restmail.net',
    authPW: '7244197b2b2126ac14b42c0fca0be67e8959255719e8c65bfc8ce99ef65a550b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'be1af961a1d84bd6b83e10ca9774eb16',
    sessionToken: '036342235ca678804973bf785dcda66e216b404662f4a81492f4ac4d92a28415',
    authAt: 1705108805
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'be1af961a1d84bd6b83e10ca9774eb16',
    code: '17385ecef9743980de100a05b833411d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="de1c660717cd8c2bfb2ffd76817ffd29c22f8b25b8b9d9003b442236a72d3347", ts="1705108805", nonce="q4_tQt", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="y9XJLV3Q3Y3cBgNl8im3eEl/YJkzb8Wnm9TmgwN1DAw="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'KVDUKTSTLB4TAUTYGFFHUYRXMI4DINKK',
    recoveryCodes: [
      'dvdnem1fkp',
      'gmdmn10244',
      't97ftzr03n',
      'mzv9c52zjm',
      '7ydvctd9zz',
      '2qwry2aghn',
      'n1680fxbsk',
      'qvgt1exrar',
      '1856c3a9nj'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="de1c660717cd8c2bfb2ffd76817ffd29c22f8b25b8b9d9003b442236a72d3347", ts="1705108806", nonce="wSgNHM", hash="8UB2bFm1GuhzXKDfxvpDTp9X29/dZIEZ3jk7U8A/P88=", mac="AK9Y26iCKYQaLW7rV8i+96Lwi3tr/5LutiWqxccvc2g="'
  },
  json: { code: '709541', service: undefined }
}
!!! response success { body: { success: true } }
    ✔ should create backup authentication codes
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c065fa9533d6d8b0eee9@restmail.net',
    authPW: '82e7072afda00f282914155391499b9735af8653344478f22a2ee3df19fe1109',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '48cefa29b54a4c89bb3b3a0ee5d45fbc',
    sessionToken: '728596f836596309b11655540348b82681fa62f7852c02bd2a7037390b718181',
    authAt: 1705108806
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '48cefa29b54a4c89bb3b3a0ee5d45fbc',
    code: '7d839bbc9f488d99c6c6cc36840a5093',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="78bb0e02734a4e948c58e231b55e73c269be2886aee91a61a73f6a52e9f86c39", ts="1705108806", nonce="gnko5b", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="+vTzQ1RsHTaIbhi8KrliC9QoN5pTAVGjeZRyohHrWuk="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JUVTI2KBKRUTQ2ZXMVCUGRJPJFIWU4SU',
    recoveryCodes: [
      '3wtf0y5y3n',
      'xpxa0k5cet',
      'n9t1q81beb',
      'qt5z3zbdf7',
      'fgnxfxdv9q',
      'bmqbz1mnct',
      'm0ga212r50',
      'njrq2dzy7a',
      'pyqx1sx9w6'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="78bb0e02734a4e948c58e231b55e73c269be2886aee91a61a73f6a52e9f86c39", ts="1705108807", nonce="Xgjb9x", hash="aC5eXKXDIDDKNS+taihT7XIKVrh9lePKxdX+x9sEJCQ=", mac="gL6kDBm6o+8UqpIsD/eTCzTO8Qk2OIJNBZ4DMkNUUG8="'
  },
  json: { code: '810438', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/recoveryCodes',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="78bb0e02734a4e948c58e231b55e73c269be2886aee91a61a73f6a52e9f86c39", ts="1705108807", nonce="IW-SBY", mac="l0ZVJer5IE+WE/WUUCEnmeDczzdVuGHYub5axdBYac8="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryCodes: [
      '8xm960cph2',
      '998vm91br7',
      'wsa9zpase1',
      '3q5ymyzd1w',
      '1wsged6cgw',
      '9ed8fsd5j3',
      '5jevvwhpvh',
      'wy015ygytf',
      '0y8zcafsae'
    ]
  }
}
    ✔ should replace backup authentication codes (494ms)
    backup authentication code verification
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '531c9518973be9574569@restmail.net',
    authPW: 'ebfb94b21bc2f6d3a1aff450289bd8ec9572d267ef50c5bae1d38f07dbfc52a6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f338e664e7064966b9387cd120b36851',
    sessionToken: '9dd6412cc082192a6cfa4cb4c9346ea73952c004077451d675798790b3d37b02',
    authAt: 1705108807
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f338e664e7064966b9387cd120b36851',
    code: 'bfe1f9b9e152e6fe17959463fc7a9ff6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b5322d0a026d7c33ec58d0470a3dbbe1d53583373d43eb0eb21ddbde940ca527", ts="1705108808", nonce="JhQ8V5", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="Gj0h0iagOZXJk1l9w+OA0fM59/90/5gY46riL+sytKs="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'PBMHCRJYHBHGO3SZMFGEEY3XGFVVEY3B',
    recoveryCodes: [
      '4m6s1j0wm0',
      'x7a5fay4f6',
      'bwp4nqwh11',
      'm5m9pkwtgw',
      'nv8z918wmm',
      'p7zysk93ps',
      '1r8yxfqrp9',
      't0cbyca4gr',
      'pj9aewts3d'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b5322d0a026d7c33ec58d0470a3dbbe1d53583373d43eb0eb21ddbde940ca527", ts="1705108808", nonce="mevicO", hash="dMC0uqZwsxbFQNpjDDTjppnJXMtzO7Z5zz9HYpss2Do=", mac="BiS9k4Wz4Vbh/R/nN7q0FWLYdRxRP5JhX+9Y8/Xbiuc="'
  },
  json: { code: '599206', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '531c9518973be9574569@restmail.net',
    authPW: 'ebfb94b21bc2f6d3a1aff450289bd8ec9572d267ef50c5bae1d38f07dbfc52a6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f338e664e7064966b9387cd120b36851',
    sessionToken: 'ef1f2627453ecd7fa8cc1f7dcae986786b07b6d4b80215fbdc01071586f5b4d1',
    authAt: 1705108808,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f24bbdedd1679ad1415de42b7b3f71bdbe2d25d33592ebd7bab7530f9f653385", ts="1705108808", nonce="Ljpnis", mac="cksjKtvAbIvjx2WeNUZATjR2W3IcrS4On4qzJvPh+3E="'
  },
  json: true
}
!!! response success {
  body: {
    email: '531c9518973be9574569@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f24bbdedd1679ad1415de42b7b3f71bdbe2d25d33592ebd7bab7530f9f653385", ts="1705108808", nonce="DVNyYD", hash="0UjsiaadA+Ti5iFML0OzjHl1La77x17kAX8HpHZfrv4=", mac="AiO3gRE3sRdOgWlMaC4EDF/WrQzXZTuBNhFyATl2uIo="'
  },
  json: { code: '1234abcd' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 156,
    error: 'Bad Request',
    message: 'Backup authentication code not found.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ should fail to consume unknown backup authentication code (1144ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '66d81d4d4119d6691bdd@restmail.net',
    authPW: 'e983b05488f3c8742f7fc14c13269f43ff0458e2983b3d4f62975181532706b6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c08b5cd7b85247a397c1a93b8ce60bd6',
    sessionToken: '0f64d1c07bce16caec1a23b44621f08309196ad3cac42e9a86e9e80c54061a30',
    authAt: 1705108809
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c08b5cd7b85247a397c1a93b8ce60bd6',
    code: '9c728a58a786b96568688b31f0ff5825',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="578ca0dcd66248bc3bcaa6eca049bfe4cd1382c49762b01f013f838dfe132b82", ts="1705108810", nonce="RRcLOM", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="OdHweN4+uyILVbrGjwY2Vtg9CnteJr/lEuNFHyTqmHg="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAABAeSURBVO3BQY7c2rIgQXci979lbw0I/BgdgGBWSfd1mNkfrLXWHxdrrXW7WGut28Vaa90u1lrrdrHWWreLtda6Xay11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7cNLKr+p4kRlqphUTiomlaliUjmpmFSmin+ZyknFpHJSMal8U8WkclJxonJScaLymyreuFhrrdvFWmvdLtZa6/bhyyq+SeVE5YmKSeUJlaliUjmpeELlmyq+SWWqeKJiUpkqJpUTlaliUjlRmSomlTcqvknlmy7WWut2sdZat4u11rp9+GEqT1Q8UXGiclIxqUwVk8rfVPGGylRxUjGpnKhMFZPKVDFVTCpTxRsVk8qJyk9SeaLiJ12stdbtYq21bhdrrXX78D9G5V+i8k0qU8UbKlPFpDJVPKEyVZyoTBWTyhsVU8WkMlVMKv/LLtZa63ax1lq3i7XWun34H1cxqUwqT1RMKk9UvKEyqUwVk8oTKt9U8U0Vk8pUMalMKlPF+j8Xa611u1hrrdvFWmvdPvywip+kcqJyUnGiMlVMFZPKicpU8UTFpDKpnFQ8ofIvq5hUpopJ5aRiUpkqvqniX3Kx1lq3i7XWul2stdbtw5ep/E0Vk8pUMalMFU+oTBWTylQxqUwVk8pUcVIxqZyoTBVPqEwVk8pUMalMFZPKVDGpTBWTylQxqUwVT6hMFScq/7KLtda6Xay11u1irbVuH16q+JeonKi8oXKi8kTFpPKbKp5QeaLipGJSOVGZKiaVJyomlW+q+C+5WGut28Vaa90u1lrr9uEvU3mjYlL5SRWTylQxqUwqU8UTKicqJyo/SWWqmFSeqJhUflPFpDJVnKicVDyhMlV808Vaa90u1lrrdrHWWjf7g79IZar4TSonFZPKVDGpTBUnKk9UfJPKVDGpTBVPqDxR8YTKGxVPqEwVJypvVPymi7XWul2stdbtYq21bh9eUjmpmFSmihOVNypOKk5UpopJ5URlqjipmFQmlaliUpkqvkllqvibKiaVJ1SmiknlROWJiidUpoqfdLHWWreLtda6Xay11u3Dl1VMKlPFicpU8YTKpDJVTCpTxRMVJyonFScVk8pPUjmpeKJiUjlReaLipOJE5YmKE5Wp4o2KSWWq+KaLtda6Xay11u1irbVu9gdfpHJSMalMFZPKScUTKv+yiknlpGJSeaLiCZU3Kt5QmSpOVE4qJpWpYlKZKiaVJyomlaniRGWqeONirbVuF2utdbtYa63bh5dUpopJZVI5UZkqTlSmikllqjhRmSpOVL5JZaqYVH6SylTxRMWJylRxojJVTCpTxVQxqXyTyhMVJxVPVHzTxVpr3S7WWut2sdZatw9fpjJVTCpTxYnKEypTxaRyUnGi8k0VJypTxRMVb6hMFZPKExWTyhMqT6icqEwVJxUnKk+oTBWTylTxky7WWut2sdZat4u11rrZH7yg8k0VT6hMFU+onFScqHxTxaQyVZyoPFHxhMpUMalMFZPKVHGiMlX8l6lMFZPKScVPulhrrdvFWmvdLtZa62Z/8EUqU8UTKk9UTCpTxYnKGxWTylRxonJS8U0qT1Q8ofJExaRyUvE3qUwVk8pU8YbKVDGpTBVvXKy11u1irbVuF2utdfvwy1ROKk5UJpU3KiaVk4qTiknlpOJEZap4QmWqmFSmihOVk4pJZaqYVP4mlZOKE5WpYlKZKk5UTlSmim+6WGut28Vaa90u1lrr9uHLKiaVqWJSOVGZKiaVqeKNiknljYpJ5Q2VqeKkYlKZKt6omFSmiknlm1SeqJgqJpWTiknlN1X8pIu11rpdrLXW7WKttW4fXlJ5QmWqmFSmijdUpopJ5aTimyomlZOKf5nKVDGpvFExqUwVJyrfpDJVnFRMKicVk8pvulhrrdvFWmvdLtZa6/bhl1VMKicqJxVPqJxUTConFScqU8VUMalMKicVT1ScqLyhclJxojKp/CSV31TxRMWkclLxxsVaa90u1lrrdrHWWrcPX1YxqUwqU8UbKk9UPFHxTSonFZPKVDGp/MsqTlSmikllqniiYlJ5o2JSmSomlaniRGWq+E0Xa611u1hrrdvFWmvdPrxUMalMFW+oTBVTxaQyVUwqT1ScqJxUTConKlPFpDJVTCpvVEwqU8WJyqTyk1SeqDhReaJiUjlROal4ouKbLtZa63ax1lq3i7XWun34YSpvVEwqU8UTFU+oTBVvVDyhMlX8pooTlaniCZVJZap4o+JEZaqYVE4qpooTlaliUjmp+EkXa611u1hrrdvFWmvd7A9eUJkqJpWpYlKZKiaVk4oTlaliUpkqTlSmikllqphUTireUHmiYlKZKiaVJyreUJkqTlROKiaVqeJfovJExRsXa611u1hrrdvFWmvdPnyZyhsqU8U3qUwVk8pU8YbKEypTxaQyVUwV36QyVZyonKhMFU+oTBVTxaTyhMpUMamcVDyhMlU8UfFNF2utdbtYa63bxVpr3ewPXlCZKiaVqWJS+aaKn6TyRMWkMlVMKlPFpHJSMal8U8Wk8i+peENlqjhR+U0VP+lirbVuF2utdbtYa63bh5cqJpWpYlI5qXhCZVKZKk5UTireUJkqJpWpYlKZKiaVJyqeUHmi4ptUTipOVJ6omFSeqHhCZao4UZkqvulirbVuF2utdbtYa63bh5dUTlSmiknlRGWqOKl4o+Kk4gmVSWWqeKPiDZWp4kRlqjhR+aaKSeWkYlJ5ouJE5URlqnij4iddrLXW7WKttW4Xa611+/BSxaTyTRVvqJxUTConFScqU8WkcqIyVUwq31TxRMWJyknFpPKEyknFpHJS8YTKExVPqEwVk8pJxRsXa611u1hrrdvFWmvdPvywiidU3lB5QmWqeEJlqnhC5ZsqJpVJ5ZtUTireqDhRmVR+UsWkMqm8UTGpTBWTyjddrLXW7WKttW4Xa611+/CSylRxovJExaQyVUwqU8WkMlVMKlPFpPKEylQxqUwVJxUnKicVJypPVJyonFQ8oTJVPKEyqUwVb1ScqDxRMalMFd90sdZat4u11rpdrLXW7cOXqUwVJxWTyqQyVTyhMlWcVJxUTCo/SeWkYqo4UZkqpopJ5URlqnhCZao4qfiXVEwqJxWTyonKb7pYa63bxVpr3S7WWuv24aWKE5U3KiaVqeKk4kTlb6p4omJSOamYKiaVNyomlZOKE5WpYlKZKk5UpopJZVKZKk5UpopJZVKZKiaVJ1Smijcu1lrrdrHWWreLtda6fXhJ5YmKSeVE5YmKSWWqeKNiUplUTlS+qeJE5aRiUpkqJpWp4gmVk4pJ5URlqnii4kTlpGJSOamYVE4qJpWfdLHWWreLtda6Xay11u3DSxUnKk9UnKicqEwVk8pUcaLyRMVvUpkqTipOKiaVqeKNihOVk4oTlROVk4qpYlKZVKaKSeWJipOKSeWbLtZa63ax1lq3i7XWun14SeWbVE4qJpWpYlKZKiaVqWKqmFTeUPmmipOKJ1SmijcqTlSmikllUvlNKk+onKi8ofKTLtZa63ax1lq3i7XWutkffJHKExVPqEwVJypTxRsqU8WJylRxojJVTConFZPKVDGpTBWTylQxqUwVP0nlpGJSeaNiUpkqJpUnKiaVk4qfdLHWWreLtda6Xay11s3+4AWVqeJE5aRiUjmpmFSmihOVb6p4Q+Wk4gmVqeKbVE4qTlSmikllqnhCZaqYVE4qvknliYrfdLHWWreLtda6Xay11u3Dl6lMFVPFpDKpTBWTyqTyhMpUcaIyVTyh8kbFGxVPqPwklanipGJSmSqeUJkqnlA5qfgvu1hrrdvFWmvdLtZa6/bhyypOVKaKE5WTikllUpkqTlSmihOVNyomlW9SOak4qXhDZap4QuUnqUwVk8oTKr9JZap442KttW4Xa611u1hrrduHH6YyVUwqJxWTyhMVJypTxYnKVHGiMlVMKicqU8UTFZPKEyonFZPKEypPVEwqU8VJxaQyqZxUnKicVDyhclLxTRdrrXW7WGut28Vaa90+vFQxqUwVk8pUMalMKr9JZap4o+KkYlKZKiaVNyqeqDhRmSomlUllqphUpoqTiknliYpJ5UTliYpJ5aTipOInXay11u1irbVuF2utdfvww1SmipOKE5VJZaqYVKaKqWJSeULlN1WcqJyoTBVPqHyTyonKScUbKlPFpDJVPKEyVUwqJxW/6WKttW4Xa611u1hrrduHl1TeUJkqJpWTikllqphUpoqpYlKZKp5QeUPlpGKqmFSmijcqTlSeqHhC5YmKNyomlScqfpLKVPHGxVpr3S7WWut2sdZatw+/TOWJiknlCZUTlaliqphUTiqmijdUTlROKiaVk4pJ5aRiqjhReULlm1SmikllqpgqTlROVKaKSWWqmFSmim+6WGut28Vaa90u1lrr9uHLKiaVqeJE5Y2KJ1QmlanipGJSOamYVKaKk4oTlW+q+EkqU8VUMalMKlPFEypPqEwVT1RMKlPF33Sx1lq3i7XWul2stdbN/uAFlW+qeEPliYpvUpkqJpWpYlJ5ouIJlTcqJpWp4gmVNyomlaliUpkq3lCZKiaVqeINlanimy7WWut2sdZat4u11rp9eKniJ6lMFScVk8pUMalMFU+onKi8UXGi8jdVvFExqUwVk8oTKr9J5UTlpOIJlanijYu11rpdrLXW7WKttW72B/9hKm9UnKicVDyhMlVMKlPFpDJVnKhMFU+onFRMKicVk8pU8YTKExWTyknFicpU8YTKScVvulhrrdvFWmvdLtZa6/bhJZXfVHFScaJyojJVPKFyUnFSMalMFd+kMlWcVEwqU8WJyk+qOFGZKiaVb1KZKt5QmSq+6WKttW4Xa611u1hrrduHL6v4JpU3VKaKSeVEZap4ouJEZaqYKiaVqeKNiidUpopJ5ZtUpoqp4kRlqphUpopJ5Y2KN1Smip90sdZat4u11rpdrLXWzf7gBZWpYlJ5omJSmSomlW+qmFSmiknlJ1U8ofKTKp5QeaNiUpkqnlA5qXhC5ZsqJpWpYlKZKt64WGut28Vaa90u1lrr9uE/rmJSeUNlqphUpoo3VE5U3qh4QmWqeKNiUjmpmFROVJ6omFSeUJkqJpU3VKaKSeUnXay11u1irbVuF2utdfvw/5mKNyomlZOKSWWq+E0qU8VU8YTKVDGpPKEyVTyhMlVMKm9UPFFxojJVnFT8pIu11rpdrLXW7WKttW4ffljFb6r4JpWpYqqYVE4qJpWp4kTliYoTlaliUpkqTlSmihOVE5UnKiaVqWJS+aaKJyomlZOKn3Sx1lq3i7XWul2stdbtw5ep/EtUpopJ5aRiUvmbKiaVqeKJipOKJyomlZOKSWWqmFSeqHhCZaqYVE4qTlROKiaVE5Wp4o2Ltda6Xay11u1irbVu9gdrrfXHxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3i7XWul2stdbtYq21bhdrrXX7f8YSFeHvV15hAAAAAElFTkSuQmCC',
    secret: 'GVMWCS3FGJFXCWDIMJFFA4SUOJZWEYJV',
    recoveryCodes: [
      '2rtyhvf6e4',
      'bmw860cssc',
      'n1v99rqrdg',
      '4evmphgb30',
      'yqrms8khc1',
      'kn1kyg0qk6',
      'qkmzmwadvs',
      'ryv4j3ww19',
      '98bkrdehe5'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="578ca0dcd66248bc3bcaa6eca049bfe4cd1382c49762b01f013f838dfe132b82", ts="1705108810", nonce="3Y4jJm", hash="XUz+E0QssCM+uNeDJ3rLbbuOHcL99mXrfOnxF7PICmY=", mac="hJ6SiHbRDRYOS7Wlr/8BoHyZ5OvNPdWNYNJR+U9ZOyY="'
  },
  json: { code: '223873', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '66d81d4d4119d6691bdd@restmail.net',
    authPW: 'e983b05488f3c8742f7fc14c13269f43ff0458e2983b3d4f62975181532706b6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c08b5cd7b85247a397c1a93b8ce60bd6',
    sessionToken: 'bcf5136c9aef00ac6b65311b279a7066ebaf8a73c22708e21ede534bdf54479e',
    authAt: 1705108810,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9c3fcc3e53c44e7420143a6773ea563db9a7cebab04f5166c81319cc55154b7b", ts="1705108810", nonce="wheWma", mac="84jEf97a/Dzr7s/av+9s8mbPYuhCewMgyQJ5m0l+Pq0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '66d81d4d4119d6691bdd@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9c3fcc3e53c44e7420143a6773ea563db9a7cebab04f5166c81319cc55154b7b", ts="1705108810", nonce="u8PneR", hash="My/VItZcHzr7c9QZIzUTlulOg6oi6U9/gxFFMf33Cew=", mac="Mg76OHg1kBW2MUJXgiB2baIStW+1SdwF61CDqwuLuSo="'
  },
  json: { code: '2rtyhvf6e4' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9c3fcc3e53c44e7420143a6773ea563db9a7cebab04f5166c81319cc55154b7b", ts="1705108811", nonce="yl-IlX", mac="K7pqfQnCEvj6KUiVEfL4ZU1t2uUmnOxTrzrv9PPFD08="'
  },
  json: true
}
!!! response success {
  body: {
    email: '66d81d4d4119d6691bdd@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
      ✔ should consume backup authentication code and verify session (962ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea5e9dc13fc73499c67e@restmail.net',
    authPW: 'b7d0bc68de7badfbfb6593f78fa36f4fe8ceb663d8e6e988df1f0df96ece6af4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '11ae115d85bd47029272ae7281876b70',
    sessionToken: '504655ca618cf28b5485846496fa41bdcd7aed824f26525fce2a9d7dbc29ea53',
    authAt: 1705108811
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '11ae115d85bd47029272ae7281876b70',
    code: '5b50ff297fcc646b1edd82008c897f0b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="58ec879a450e040f8ca0936211be1b3cf755051f3f0263fc4c96440e5c99338c", ts="1705108811", nonce="5n4haX", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="ZWcCKw/DdOocUFafeeNp34FlQfUQOEecxIcF/k/IwMg="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'IRTU4WLZNEYE6RKWG4YTAUSTI5GWML2L',
    recoveryCodes: [
      '8zbnd9y9bk',
      'hpzd98vc0r',
      '1yqe4vnsfq',
      'ewjv6ehvgb',
      '8tss4hnnd3',
      '37znthhdcw',
      'abv0dx95gb',
      '70bvg7qyr0',
      'c8t8tyth2n'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="58ec879a450e040f8ca0936211be1b3cf755051f3f0263fc4c96440e5c99338c", ts="1705108812", nonce="S2HWwS", hash="N3C86hFZw3kl7B12F++5Ackjyt00BurjO28DPDfRCXU=", mac="TqgwB/jVtSqgI4N50PEyU9z1+Um8coPFtEgE5yvQ4e8="'
  },
  json: { code: '858213', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea5e9dc13fc73499c67e@restmail.net',
    authPW: 'b7d0bc68de7badfbfb6593f78fa36f4fe8ceb663d8e6e988df1f0df96ece6af4',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '11ae115d85bd47029272ae7281876b70',
    sessionToken: '107fef55311eff555edc427d2c32fe6d761655b39cf0a503036917182766fbbe',
    authAt: 1705108812,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2604b9ab4aef278354dca9dd1520b18c51ef65c4a4e3aa6a7d72fab74d22211e", ts="1705108812", nonce="0_0bI6", mac="Yjc5c2YCuLOFFtPD1g32QgU4l3XiyZMOWPGtE90sjjo="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ea5e9dc13fc73499c67e@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2604b9ab4aef278354dca9dd1520b18c51ef65c4a4e3aa6a7d72fab74d22211e", ts="1705108812", nonce="-v018u", hash="D0ZNrIt9rPGfgjm8LWFyu+WlyBcCA970AnpkWgjU3bg=", mac="7Fy+xpTpGUlgCYoQELK+oxo4c3/4KVo1UOvoxZ+//y8="'
  },
  json: { code: '8zbnd9y9bk' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/totp/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2604b9ab4aef278354dca9dd1520b18c51ef65c4a4e3aa6a7d72fab74d22211e", ts="1705108812", nonce="JZAqdN", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="BByo6pQFC3+qRZ+jgOfYETSyfPcXp+ITpStNF9OKLLk="'
  },
  json: {}
}
!!! response success { body: {} }
      ✔ should consume backup authentication code and can remove TOTP token (251ms)
    should notify user when backup authentication codes are low
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a747f99a0b3fa26dad95@restmail.net',
    authPW: 'e56cd1e4140ed0f8a8a80230f5b2bd2cdbcd197c05df346c50d7b8e2de952143',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f08da0848cd1407091b9eb354ceafe71',
    sessionToken: 'e2bfe070e03922b18753ffa3202abe8ebb410f657b305aa9ba28f477ab870472',
    authAt: 1705108812
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f08da0848cd1407091b9eb354ceafe71',
    code: 'd383de0441aaff8843b0645a4e2eec4b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d0572d9d453cee5cbe595b3fc112f1789b3424c326540883b7242a0284cbf0c0", ts="1705108813", nonce="RVNwud", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="Nx672lUoqxFVK4A7FQp8FDfezJI2KTgUDvuFYJfHPZI="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JJAXESJUIZREQY2NG5SHU6LMGRHGM4KI',
    recoveryCodes: [
      '7zfrn9chqq',
      'nrf6cz6mnk',
      'tax124p8xs',
      '2bt2g2k0dk',
      'qwwfja7gzs',
      'na3y4pyagr',
      '09t3f6dhyz',
      'yt4p92jwj1',
      'ad5mt4x9jr'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d0572d9d453cee5cbe595b3fc112f1789b3424c326540883b7242a0284cbf0c0", ts="1705108813", nonce="1RcGet", hash="12CQKxMcokqbvVyhlC+m/TexTzQrS6+jpLhhDi+3hR0=", mac="aOXSDWmdjkRFZJfor9Zv46nKqgeycjUgWKudmDvKHAU="'
  },
  json: { code: '885700', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a747f99a0b3fa26dad95@restmail.net',
    authPW: 'e56cd1e4140ed0f8a8a80230f5b2bd2cdbcd197c05df346c50d7b8e2de952143',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f08da0848cd1407091b9eb354ceafe71',
    sessionToken: 'd590fdfdc88af2d752519374a3b1991c51541c79fa020fd333da2f5752aa2cd8',
    authAt: 1705108813,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c6b9ff362a0d76ef70bb351228d6e01672f31418b776505374ae3a5a621ede60", ts="1705108813", nonce="hBMntd", mac="UkiSz5zPpxjGXTCL/81Wnvm+2yh8OZEEKntdMCN7bQI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'a747f99a0b3fa26dad95@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c6b9ff362a0d76ef70bb351228d6e01672f31418b776505374ae3a5a621ede60", ts="1705108813", nonce="BbWPoa", hash="Ng2Xt7DhdQIvH6ooX81ZHnLyaROcUL6FwWfAtnwdiPY=", mac="XQJict+35/Y7L53X9UxRZZaP0jGnzs3efN2y7S7d2CM="'
  },
  json: { code: '7zfrn9chqq' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c6b9ff362a0d76ef70bb351228d6e01672f31418b776505374ae3a5a621ede60", ts="1705108814", nonce="SJdhe8", hash="Am4LkLozgy1ix9wAgKW6CJ6OeE5fOGp2i94GjzTw1U4=", mac="T/zxIZATHp57FzFo0e60eNMj9PFR1Vk80I2mEmBAUc8="'
  },
  json: { code: 'nrf6cz6mnk' }
}
!!! response success { body: { remaining: 7 } }
      ✔ should consume backup authentication code and verify session (1537ms)

  #integration - remote backup authentication codes V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '362606c8e9fbb1d3927b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '362606c8e9fbb1d3927b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '362606c8e9fbb1d3927b@restmail.net',
    authPW: '344a33852397670f0df042b01ebbf4e102d03a07a5b8c20d45f1550b157dbbe7',
    authPW2: '4a64033271c31890fa68ebaff246a2ba074104158a1c3705d4f8c27dea30bc57',
    wrapKb: '34f95c020a8fec936d794e86595174eec9197709d5160a18a727a4dd6c88a577',
    wrapKb2: 'f9c25306a29f5afb948a853ba12b39b6b47d1f7e553fdee05ecfe36418f16105',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:52af4d01db553df25bb5e073c4bb5ab7f1046923b29151fd597398168e352835',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '270a8c44c4314405803003b99fc0b871',
    sessionToken: 'f703a9e6ed313e6be8848928d90f34030fcfbf5f2d9ba427355a18fd2de0b7ea',
    authAt: 1705108815
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '270a8c44c4314405803003b99fc0b871',
    code: 'bfe974f4e7e331c836ba4aff44e69e37',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cb18bc3263aaf53147fb317544dbefffbc1fc67c1284b51c85f5936b5acbed12", ts="1705108815", nonce="k6aWZT", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="LRMyBOHo0KKSK8IaVa18056TMq1h2ql701OwGYaw4Mk="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'NQZUW2TKJNLGMZ3MM5WE6L3OKVAUQOJL',
    recoveryCodes: [
      '702by89wa8',
      'mc16c12hgx',
      'pfccj4myjx',
      'v85z5eve48',
      '7kxfq4vpem',
      's22qbph86r',
      't0agtb9swv',
      '8an22rzejk',
      'b5bd4xmpaz'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cb18bc3263aaf53147fb317544dbefffbc1fc67c1284b51c85f5936b5acbed12", ts="1705108816", nonce="R2dz5T", hash="qn4d7Aiz5dDNIVfO56YIYlFc6Sb90A/kfOqdULmyFws=", mac="AjcT+7j7W4GzbgEkiv7XJW4q0HLwOb5QLMZmOPzyoCQ="'
  },
  json: { code: '248519', service: undefined }
}
!!! response success { body: { success: true } }
    ✔ should create backup authentication codes
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5e21141f9d5c4f983c45@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5e21141f9d5c4f983c45@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5e21141f9d5c4f983c45@restmail.net',
    authPW: '6334c59fe8051d706a0026c74857da575c51185dc69c59ac74c494b960a184ab',
    authPW2: 'e23544d4d72121f093673728fdd1c3603bf7f1951b3f0c65b6455383a1cc4e84',
    wrapKb: 'f421d122e80e314d19502bf16faacbc7487d49b1ccf47e867ba5f6b6c538bac9',
    wrapKb2: 'f42e793bdf0aa0f10eeb7ebb79dacf81ecfd115da863815db4493b1981fa6d89',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ad06483065d7e588c5a75b59c2a4db5af84412d1de1c2c411a4dc6277fa63c70',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '69f03fc1520b47b49fa9cf84d8579430',
    sessionToken: 'c714967a17a1161ea8a9097f7f528363b4f2c350d3ed64848a78a722e7246edf',
    authAt: 1705108816
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '69f03fc1520b47b49fa9cf84d8579430',
    code: '05b291d066126eba922a4a29a8a161d0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="84ca75bebec11c8b4974154e80da7c9af6e470ee9ffdb3381a509db19bf652c5", ts="1705108816", nonce="8LW3oA", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="qhdZ+i8hMN8eVqF08qbmqNpa3v0sA7G024Oldzo9iQI="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'GZDHKULXJBWUUOLSKJKHK6JVNI2WYM3M',
    recoveryCodes: [
      'vn5x0pbpgh',
      '9fgktegvtt',
      '8hqzs7trnn',
      '20gv7ycywd',
      'mg11akxyf9',
      'e170wk17g5',
      'ab08wq8bvj',
      '4zs97gy5bb',
      'kw12k978a7'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="84ca75bebec11c8b4974154e80da7c9af6e470ee9ffdb3381a509db19bf652c5", ts="1705108817", nonce="EMcMJP", hash="kL45W72aq/DNmfzvQo7u40Kaz9y7SOvqcjQjCkzWw0k=", mac="3XO9a/dgW2GJr1RH8xd+DAk3WaxSSaa4TX7V279oA2Q="'
  },
  json: { code: '379507', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/recoveryCodes',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="84ca75bebec11c8b4974154e80da7c9af6e470ee9ffdb3381a509db19bf652c5", ts="1705108817", nonce="gm6pQ7", mac="QX2yUJRUBZ6QvLyoJQJ/bkgvc1dMmehHgrsMPDQiq9Y="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryCodes: [
      'td47wtd9r6',
      'sr8qr2ky82',
      '8fmkctrf5z',
      'gjqp74006v',
      '03sk4a0cpw',
      '3ztdrg27t5',
      'r2gtvmrs8w',
      '3tywtd17pj',
      'zh5m9mmnz0'
    ]
  }
}
    ✔ should replace backup authentication codes (473ms)
    backup authentication code verification
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9867fa65d7eec5e38f2f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '9867fa65d7eec5e38f2f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '9867fa65d7eec5e38f2f@restmail.net',
    authPW: 'ffd6a1a55e6fc28baa49327433476e06b17052df78134c1be3cf9e3d25fb0826',
    authPW2: '4a8554a75226d00e6c3be2a4194be97141ac7a0fa7f386f4bd89160357e3ddc0',
    wrapKb: '4bc4f0f5153e58ea9a75615c8a58b81f63fa32f257cd4a684ab8c567fa750d1d',
    wrapKb2: 'd602e84fcfa76ce98b07f9a9a5d1daff7ffbdcd45948b29875656053a35009e3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb3a70a4a3a6e69d046b26116589fec6268af431b2d92548457db7d9b602b00d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '863a9cf97f6142a3899c09e9da18515b',
    sessionToken: '8d283a0c76cbca27e280b8cc294a94a9a6754fc1134b64cbd867b61747adf95d',
    authAt: 1705108817
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '863a9cf97f6142a3899c09e9da18515b',
    code: '8cd2478e7ba79c3bc35c533a84cb5cd0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="972481cbf5d0f6e43362fd90c0f5432fd10fae4fd9d45a2c292566071a9cba85", ts="1705108818", nonce="EYRDrZ", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="sickXYOZJpF5Qg+UeEmJsMnYJ58PcGkcAr0yrevGc3M="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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T1I5UZkqpopPUpkqTipOKiaVqWJSmSreqHijYlJ5QmWqeKJiUpkqnqiYVKaKSeWk4pMqJpWp4o2Ltda6Xay11u1irbVuP3yZyhMVT1RMKicVk8obKlPFpPJExUnFGyrfVHFSMamcqEwVJxX/ksonqZxUfNLFWmvdLtZa63ax1lq3H/6PqZhUnqiYVKaKJypOVCaVJyqmihOVN1SmiidUTlSmiknlkypOKiaVqWJSmSomlROVqeIvXay11u1irbVuF2utdfvh/xiVE5WpYlI5UfmmihOV/xKVk4qpYlKZKiaVqeJE5aTijYpJZao4qZhUpopJ5YmKNy7WWut2sdZat4u11rr98GUVf6liUjlRmSomlaniCZWpYlKZVE4q3qiYVJ6oeELlX6o4UfkklaliUnmi4i9drLXW7WKttW4Xa611++HDVP5LKk5UPkllqphUpopJZao4UTmpmFS+SeWk4pNUpooTlaniCZWTikllqphUTlROKj7pYq21bhdrrXW7WGutm/1irbV+Xay11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdLtZa63ax1lq3/wcYld5eWGwykQAAAABJRU5ErkJggg==',
    secret: 'OJKE4N2SGN2VIWDNIZYXQ4KFJBXUU3DO',
    recoveryCodes: [
      'sbza2cx1jn',
      'xkfcdtdrzb',
      'av731j2p9y',
      '3p4gwqnctw',
      'ys3spmk6da',
      'xm5mftcqjw',
      'qfhk529bp0',
      'hq7vhkgnde',
      'hbx08ekkwh'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="972481cbf5d0f6e43362fd90c0f5432fd10fae4fd9d45a2c292566071a9cba85", ts="1705108818", nonce="SLNYeJ", hash="kPwsN/oAqqmapYKDIkC9pFBV1UYENOXVpwB5At5GCCU=", mac="nFKEMlVzaUrM1wbtoq14n8HBeyEcLo6cpZxQkz5S7VQ="'
  },
  json: { code: '858831', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9867fa65d7eec5e38f2f@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb3a70a4a3a6e69d046b26116589fec6268af431b2d92548457db7d9b602b00d',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb3a70a4a3a6e69d046b26116589fec6268af431b2d92548457db7d9b602b00d',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cb3a70a4a3a6e69d046b26116589fec6268af431b2d92548457db7d9b602b00d',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '9867fa65d7eec5e38f2f@restmail.net',
    authPW: '4a8554a75226d00e6c3be2a4194be97141ac7a0fa7f386f4bd89160357e3ddc0',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '863a9cf97f6142a3899c09e9da18515b',
    sessionToken: '6987aca33ea60bd88e6fe9feb12231aacd6ef23f503c0ee974b42ea902dcb651',
    authAt: 1705108818,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="66a15e59ab8be74e7dff4ec8dad97c8d687bfc9eca1605cda87447c4acb0f996", ts="1705108819", nonce="vjaR75", mac="o1GuSf9QNZX9QXfEYsuOniRvlHmV1uApNrcwdpOGygc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '9867fa65d7eec5e38f2f@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="66a15e59ab8be74e7dff4ec8dad97c8d687bfc9eca1605cda87447c4acb0f996", ts="1705108819", nonce="Ldf9k6", hash="0UjsiaadA+Ti5iFML0OzjHl1La77x17kAX8HpHZfrv4=", mac="0Nk23GO3DTUlS9INYw6WrU4TJuryRU0/fsvkjC1ZcC0="'
  },
  json: { code: '1234abcd' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 156,
    error: 'Bad Request',
    message: 'Backup authentication code not found.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ should fail to consume unknown backup authentication code (1163ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ec03eb770dd349c3b55a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ec03eb770dd349c3b55a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ec03eb770dd349c3b55a@restmail.net',
    authPW: '05cb26ff17e167d66dbb2bf5ee2c534764504045e4821e5cbc7448988e9d6e88',
    authPW2: 'f42957a6e473fe9eb300d8e3976c5564f15aab1d9fc8d32efeb3f77dc1a14483',
    wrapKb: '2876e249cdd9ccf4b4a99e261b40a0adb27ccf650abd01445881ca277b7ee6a7',
    wrapKb2: 'de3a40370c9d3c97e31f4ade43fa433cdee7b4b0bc6130a43a0f1da995989643',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b0b1c3fb92eff52ea21c97f58a37eb980a1c1c3f70ae8ae4e131234f6b416a64',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e3230506c7c3495bbb4b2d0a366b110c',
    sessionToken: '8130d0c03903cffec734546bdda9bd1a6f3e99533daef3bdb544583ebe53d09b',
    authAt: 1705108820
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e3230506c7c3495bbb4b2d0a366b110c',
    code: '56908645a0409277dbb16693eaaa4fe3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0da7c329936d9e0b2ca46bce61c38fbfc58e413293bfb936f6e10bcfabddb0e1", ts="1705108820", nonce="tA3gUw", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="FizWshYKLnXcnCuVbDLSIQKcKFgb4qWbFUY0r0L5K+w="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'JNHUEZ3PGBZUGZLQKU3DGS2EIVVGSSSM',
    recoveryCodes: [
      'ngyrp7t7md',
      'm5c23gw310',
      'zqz90qh1ms',
      'n1pxj0hasg',
      '77sxfsvrf8',
      'wn8dke9z7q',
      'tvx15rg9mg',
      'q249bnp42n',
      's4ygvfwzfn'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0da7c329936d9e0b2ca46bce61c38fbfc58e413293bfb936f6e10bcfabddb0e1", ts="1705108821", nonce="W5CXNo", hash="EDFLpe7+AfZ0e+lE0bIioLic2GOPnyv/EZQHqGwCzeg=", mac="7ril/rZQOgO+UeZEE2bSmjU6XH8ui3/E6L03MGYka7o="'
  },
  json: { code: '978205', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ec03eb770dd349c3b55a@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b0b1c3fb92eff52ea21c97f58a37eb980a1c1c3f70ae8ae4e131234f6b416a64',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b0b1c3fb92eff52ea21c97f58a37eb980a1c1c3f70ae8ae4e131234f6b416a64',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b0b1c3fb92eff52ea21c97f58a37eb980a1c1c3f70ae8ae4e131234f6b416a64',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ec03eb770dd349c3b55a@restmail.net',
    authPW: 'f42957a6e473fe9eb300d8e3976c5564f15aab1d9fc8d32efeb3f77dc1a14483',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e3230506c7c3495bbb4b2d0a366b110c',
    sessionToken: '722fe767aa4ef5194d65c60102f2b7039759407edc8e88c851b53a6f85fc8ead',
    authAt: 1705108821,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="178612d73bdd3fec52522c0711a6cdb0de89fb6c63cc262ce58e00b336ac36b7", ts="1705108821", nonce="KvqUH9", mac="7OdoKcaACIgMa4cXn0EoqhHAB7XmLUPDTnAHN4KnyLA="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ec03eb770dd349c3b55a@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="178612d73bdd3fec52522c0711a6cdb0de89fb6c63cc262ce58e00b336ac36b7", ts="1705108821", nonce="cFBMPu", hash="Uelx3u6EIh1oegeOZPv1AzXUCLmJ+Ndlk2nvCDzYB80=", mac="KnRMri0s7wxnTsN+rbEd6vXdq++YmULbRNjc3EuztFE="'
  },
  json: { code: 'ngyrp7t7md' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="178612d73bdd3fec52522c0711a6cdb0de89fb6c63cc262ce58e00b336ac36b7", ts="1705108822", nonce="DrJeVX", mac="h9d4iOzsZHv3enstPJjdojL+fbNAEb7ziTtLKNNCZ84="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ec03eb770dd349c3b55a@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
      ✔ should consume backup authentication code and verify session (461ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e8733a78d85fa306ca37@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e8733a78d85fa306ca37@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e8733a78d85fa306ca37@restmail.net',
    authPW: 'd671d6b441b019da52bc83435ef3610d5d423b9555f4d2c8b4d4bb3fd1909069',
    authPW2: '27cf6c09339c3f285d2115549c8b7c734734fd7f816c06f10989a62f030acd0b',
    wrapKb: '9667e1f7e2904eb29d3c380e5e3b4450677af221ff20673277fc4eb2deb61f58',
    wrapKb2: '58d81d109ae0b6e772f9a8044ce3d1b2e576e35a38321725b9e9ca065d7fbe92',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32811faff20d3e456b579625112fde71c5e8c48f99a00962a1b668b37b28e5aa',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1feff22099da43659e30dba72389d525',
    sessionToken: '23a19b21880b80e6f588f440f2df036d7ac14e3b8b357e30279b7211b331015d',
    authAt: 1705108822
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1feff22099da43659e30dba72389d525',
    code: '7ee48e6dc6cbf0b5f3ad758738366a03',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ee89ce2433fd8b1dd08a5934c914a714a8ee036302f45362b93e0ce30a3203bf", ts="1705108822", nonce="H38QPt", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="XotPeTJLwhA5JcwyBkZVhaAcsVT45vexhLWMWNHNAgw="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAAAklEQVR4AewaftIAABAXSURBVO3BQW7EWLIgQXdC97+yjxYEfqweQDBTVdUTZvaLtdb6dbHWWreLtda6Xay11u1irbVuF2utdbtYa63bxVpr3S7WWut2sdZat4u11rpdrLXW7WKttW4Xa611u1hrrdvFWmvdfnhJ5S9VnKicVHySylTxSSpTxTepPFExqZxUTCpTxaQyVZyoPFFxonJScaLylyreuFhrrdvFWmvdLtZa6/bDh1V8ksqJyknFpPJExUnFpDJVvFFxovJExUnFpHKiMlU8UTGpTBWTylQxVZyonKhMFZPKGxWfpPJJF2utdbtYa63bxVpr3X74MpUnKp6oOFGZKiaVN1TeUJkqTlSmikllqphUpopJ5YmKSWWqeKJiUjlROamYKiaVE5VvUnmi4psu1lrrdrHWWreLtda6/fA/RuWJikllUjmpmFQmlZOKE5Wp4pNU3lCZKiaVqeJEZao4UXmjYlKZKiaV/2UXa611u1hrrdvFWmvdfvgfVzGpPFExqXyTyhMqU8Wk8k0VJxUnKk+onFRMKicV6/9crLXW7WKttW4Xa611++HLKr5J5UTlpOJEZaqYVJ6oOKmYVE4qJpWTiidUpopJZap4omJSOak4UZkqJpWTikllqvikin+Ti7XWul2stdbtYq21bj98mMo/qWJSmSomlanijYpJ5URlqnhCZaqYVE5UpopPUpkqJpWpYlKZKiaVqWJSmSomlaniCZWp4kTl3+xirbVuF2utdbtYa63bDy9V/JuonKhMFZPKGyonKk9UTCqfVPGEylQxqZyonKicqEwVk8oTFZPKJ1X8l1ystdbtYq21bhdrrXX74R+m8kbFpHJSMalMFZPKExWTylQxqUwqU8UTKicq31QxqUwVk8pJxaTylyomlSdUTiqeUJkqPulirbVuF2utdbtYa62b/eIfpHJSMalMFU+oTBVPqEwVk8pUMalMFf8klaliUpkqJpWTim9SeaPiCZWp4kTljYq/dLHWWreLtda6Xay11u2Hl1ROKiaVqeJE5QmVk4oTlZOKSeUNlaliUjmpmFROKp6omFSmin9SxaTyhMpUMak8oXJS8YTKVPFNF2utdbtYa63bxVpr3ewXL6hMFU+onFRMKv+kiidUvqniROWJijdU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',
    secret: 'NR2EIN2JNJ3HMWJTJZLGMUZUMV4XCY3F',
    recoveryCodes: [
      '4vtsj4s069',
      'rp27d64se0',
      'm4wv223azq',
      'dd6rcg8vam',
      'camravq5wr',
      'aypcbgt7z2',
      'jjvh9xpebr',
      'tn805r9ycm',
      'b5zjyvssyc'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ee89ce2433fd8b1dd08a5934c914a714a8ee036302f45362b93e0ce30a3203bf", ts="1705108823", nonce="uNf2jM", hash="/0TKJgtdnQRlHgqtB0wT+jLghQToEZ3Lnp51DZQHxqw=", mac="Vi5LlW5gcXpL7aJ1jGTag9bnlCjnRPMEtPbqUt2rnhg="'
  },
  json: { code: '907443', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e8733a78d85fa306ca37@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32811faff20d3e456b579625112fde71c5e8c48f99a00962a1b668b37b28e5aa',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32811faff20d3e456b579625112fde71c5e8c48f99a00962a1b668b37b28e5aa',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32811faff20d3e456b579625112fde71c5e8c48f99a00962a1b668b37b28e5aa',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e8733a78d85fa306ca37@restmail.net',
    authPW: '27cf6c09339c3f285d2115549c8b7c734734fd7f816c06f10989a62f030acd0b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1feff22099da43659e30dba72389d525',
    sessionToken: '1852315e8449a2ea34fdc1861632cd99008af217708424e932633dd4901686f8',
    authAt: 1705108822,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0a59042472d0c9f4585a9403a5d5493126f2deaf71caebb22ccab4862c4437bd", ts="1705108823", nonce="hdLf5p", mac="Uk+GYnuUrVt2T7s4CLa5wjLAWspKmjTfu44dmWRlXKM="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e8733a78d85fa306ca37@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0a59042472d0c9f4585a9403a5d5493126f2deaf71caebb22ccab4862c4437bd", ts="1705108823", nonce="o3KtIY", hash="jSPnEveOpHiILRKzRFBCjbZPPPIQTiA2XDxMe7BA5og=", mac="zXNIK6yjXT4TbJby4ZR4lHrCo48srubCPakRYSR/Rv0="'
  },
  json: { code: '4vtsj4s069' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/totp/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="0a59042472d0c9f4585a9403a5d5493126f2deaf71caebb22ccab4862c4437bd", ts="1705108823", nonce="AT82Ho", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="Rnd36L0jFqDdysZ3m7B4GBh8oZ+wf7JpMfwkvRH6zQY="'
  },
  json: {}
}
!!! response success { body: {} }
      ✔ should consume backup authentication code and can remove TOTP token (502ms)
    should notify user when backup authentication codes are low
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '86c824dba849f981829c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '86c824dba849f981829c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '86c824dba849f981829c@restmail.net',
    authPW: '99738bc697b4263718a104b05cabb9ac28892b1b1ce2220af0491c3bf3d8e15c',
    authPW2: '8df007df86919ef00553e0129e5c82ff7c1fce4dd248ad2614913d4132f463b9',
    wrapKb: '0627069b60ecf17cf7156fed3354ece264a391bc5d8bee89fac2d16bb836ca8d',
    wrapKb2: 'c101c537a9eb76c385c4aebcd5e396e8a3365e126ad9bef3ff8200238ed90570',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4f36e4e4e8cda8a4bc6bc29d9f0b19cacbc6a282b806dab98f4b388d1ea355eb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '46d51420c03c4bf18e00c7785dbc145d',
    sessionToken: '4c2ce3ab5158edf07e9a13936692f7932b5e5a6abb8acdb90bd86cd5db077bb5',
    authAt: 1705108823
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '46d51420c03c4bf18e00c7785dbc145d',
    code: 'f5f90a38b182fd164842117f084d3636',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/totp/create',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dd28f0e582f2b0cd7593e3e4764ad6b7836fa622b383c580c87eb552502ce1be", ts="1705108824", nonce="OlthGy", hash="ionVfI7JsM2yzVSJk76Jv0uKRwlDI6KH2RPCKv9qlj0=", mac="pWIGP3st8gadcdjgJwM0oqsoDrt/pc+82m41N+HuOro="'
  },
  json: {
    metricsContext: {
      flowBeginTime: 1705108626681,
      flowId: '0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef'
    }
  }
}
!!! response success {
  body: {
    qrCodeUrl: 'data:image/png;base64,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',
    secret: 'KV5DMU2QKVQUW43ZMVZTGR3CMEZDE5CP',
    recoveryCodes: [
      'ys8hgapnxr',
      'j9nb2111qb',
      'c2qv2wjx2g',
      '584y6sab5m',
      'wtf6ck74cq',
      '7aqdjp2sc3',
      'bgb47y11rw',
      'nh60jwh4rp',
      'bhnsngqrg0'
    ]
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/totp',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dd28f0e582f2b0cd7593e3e4764ad6b7836fa622b383c580c87eb552502ce1be", ts="1705108824", nonce="jVDl6u", hash="7UC15yNDR2OU5x14bg9BgAxVyKo8Np2+CDQt18fpqPg=", mac="IPzRa48TQAL72nVU3/Gir5KG3BgOiUmTDW3Da3aZfDw="'
  },
  json: { code: '735877', service: undefined }
}
!!! response success { body: { success: true } }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '86c824dba849f981829c@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4f36e4e4e8cda8a4bc6bc29d9f0b19cacbc6a282b806dab98f4b388d1ea355eb',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4f36e4e4e8cda8a4bc6bc29d9f0b19cacbc6a282b806dab98f4b388d1ea355eb',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4f36e4e4e8cda8a4bc6bc29d9f0b19cacbc6a282b806dab98f4b388d1ea355eb',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '86c824dba849f981829c@restmail.net',
    authPW: '8df007df86919ef00553e0129e5c82ff7c1fce4dd248ad2614913d4132f463b9',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '46d51420c03c4bf18e00c7785dbc145d',
    sessionToken: 'bb26d40ea69d64d5b159dc476b82c79ef1b57931abf57dfcfe0e86431be1451c',
    authAt: 1705108824,
    metricsEnabled: true,
    verified: false,
    verificationMethod: 'totp-2fa',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="74d2f8428b121ef8e4b7a1b17cd906423b84aa5f877b26c60ea89148edbcbe3d", ts="1705108825", nonce="UjEGIs", mac="34Npj5bDJ+fGI1pyvczZ14GxzX4S3lOIF0OTHBhwuSc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '86c824dba849f981829c@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="74d2f8428b121ef8e4b7a1b17cd906423b84aa5f877b26c60ea89148edbcbe3d", ts="1705108825", nonce="xo4F0z", hash="cKPUdWE9UcRxzbxaRGGkBoiSgjMb9yZLvSmwYrqXsXk=", mac="nitIlA4Y8vk+NKU8mSenlZUX4GdeqINITTyblUByMb4="'
  },
  json: { code: 'ys8hgapnxr' }
}
!!! response success { body: { remaining: 8 } }
!!! request {
  url: 'http://localhost:9000/v1/session/verify/recoveryCode',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="74d2f8428b121ef8e4b7a1b17cd906423b84aa5f877b26c60ea89148edbcbe3d", ts="1705108826", nonce="ZvmC9H", hash="Yv5kzgRHxiRwBccfCs8bfLDLqBlJKD85wvNDbV4h/U0=", mac="Nyo1Pt4zOo4VCUITUprlKTeFvDXGLRLNa5sr1xnNbiw="'
  },
  json: { code: 'j9nb2111qb' }
}
!!! response success { body: { remaining: 7 } }
      ✔ should consume backup authentication code and verify session (1451ms)

  #integration - remote change email 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '42b98343d309e674d1c1@restmail.net',
    authPW: '871cc181aedf81db4dbcfbe2b53cd36b7e23e9f08e33f028263f270d9d049473',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8f94f9b2108e4b9fb6e9ac27d4b6d748',
    sessionToken: '0a42b542852b14df02bcfb8bf518fce823670d9f8844435f16539bcdf459fa30',
    authAt: 1705108826
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8f94f9b2108e4b9fb6e9ac27d4b6d748',
    code: '8acf9d519ba32b12a55700a59af540ee',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b650177946da8ec32de35b899a469121f86cf5e6454eab691bc4ef9d6b661a15", ts="1705108827", nonce="mxkftJ", mac="CLXi1CZo7J933G2KCze1vmVzJ91LW8YgFJzOx2FPL4I="'
  },
  json: true
}
!!! response success {
  body: {
    email: '42b98343d309e674d1c1@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b650177946da8ec32de35b899a469121f86cf5e6454eab691bc4ef9d6b661a15", ts="1705108827", nonce="P8w-tP", hash="fhCIP5s51BuGHAsySXXS7Y5jveDaIzVonWxWzbAZaUM=", mac="hSEjHjz/Ni3M78rKPd9hKY5IX0JKnsd9AnHpPR29UNs="'
  },
  json: {
    email: '90d82b24ad37374bd112@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b650177946da8ec32de35b899a469121f86cf5e6454eab691bc4ef9d6b661a15", ts="1705108827", nonce="9YOdS-", hash="b6/cXDd9AgxwK0tqDlYJbKE6i6eguc4c65bLuni7X9o=", mac="hzVzaMbSI6gm+FgSVMNmGokpQqv31diSKgxOIo8KCVk="'
  },
  json: { code: '352435', email: '90d82b24ad37374bd112@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b650177946da8ec32de35b899a469121f86cf5e6454eab691bc4ef9d6b661a15", ts="1705108827", nonce="wmsX8W", mac="NNsCLif/Vqr4wEdrhxF/zG2FuuWiSQVLJgOLvn3SKRc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '42b98343d309e674d1c1@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '90d82b24ad37374bd112@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8a67c2a91e1db77bc391@restmail.net',
    authPW: '7e71f229f46cd344da4a950a1768376b0b2aae73ebd138c58db92617a2118724',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2f99edeb8d984f218f93251360bb8fd7',
    sessionToken: '1158b2a4cbcfe612b40f342ef1fb6d0722dd92303150793df8e809f76e9b8aed',
    authAt: 1705108826
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2f99edeb8d984f218f93251360bb8fd7',
    code: '384242fe4e115b26fd4d5704620a7bdf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f0400d1f2ea03d730838@restmail.net',
    authPW: '84e800ec9e7555e23ee2be460acfc56feb46c6f2c52ef991010f540a302ce76f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8300865622f445a58a965955d85aa9c3',
    sessionToken: '4dd28eb9a9d89fe245f3704c92d155612e9d74feb7bfa5ddbfa9e88f4e109fce',
    authAt: 1705108827
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8300865622f445a58a965955d85aa9c3',
    code: '2e79c6e5c95bf1c807d7840b88ee43ea',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108828", nonce="bMM0OF", hash="6n2EIpHIzyav0lT0FA10apinP+DPU7d0abO4vI+of30=", mac="OFREfLxgPxumVFHPKwsQ4+3o5KIiaZHXB9vkwDswAfo="'
  },
  json: {
    email: '45783976ef8811e8e661@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108827", nonce="Ooe3AP", hash="8BB+Hcb8lyaOZLIDiqMlLeXChk5l127wwieYNSrvgdU=", mac="R3UuNSI8yhsmpmJFzpg33oc3qhsB8Ieo9JqNIZBzyFc="'
  },
  json: { code: '072836', email: '45783976ef8811e8e661@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108827", nonce="AxsdIm", hash="+7QNOZIF7PANseOzkSyRktbreqSyfo64X2SzhF35WWo=", mac="EzqEYHXI4EKYvizXFufqjGM9+9nD2X6GZo6DshwotY4="'
  },
  json: {
    email: '1b40fc434f1c8540788b@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108827", nonce="ALX4Wx", hash="mY76Z8vc/jS2hEf3lGONxgvwLh+r3EPUkIx7NiV2hWU=", mac="jUD5IwRCaR0EqT1t5adHWcEUp17CBjYVSBcB2Tp/9SU="'
  },
  json: { code: '157076', email: '1b40fc434f1c8540788b@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108827", nonce="2l0dU_", hash="6n2EIpHIzyav0lT0FA10apinP+DPU7d0abO4vI+of30=", mac="BjJy0OmwQxNFJHdb7RNUJgoVZlzkQhujgBwwxmhSnfA="'
  },
  json: { email: '45783976ef8811e8e661@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108827", nonce="XCkaAk", hash="MZeBgKaGQaXkRWBEIyJ9g7JwNs/kJRXICIGLNWzp6/k=", mac="K1c4gM567dxljMA/W3dvYrNV7GpaJh1bl9gO3KDYK8o="'
  },
  json: { email: '8a67c2a91e1db77bc391@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108827", nonce="a2t_t6", hash="+7QNOZIF7PANseOzkSyRktbreqSyfo64X2SzhF35WWo=", mac="M9QwAnVw5FCPCrYIrtjfMCUfWp0zrEuaA9FIKTRVHLk="'
  },
  json: { email: '1b40fc434f1c8540788b@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108827", nonce="gm6nNx", hash="pmlsI5L+NJdK+STYrLMKtEGGtDoIvaSZEBeofKv11H0=", mac="KAK3sv1ayNN/zpIWvU5YclNQDWlT9AXRp5WAmSo1GYU="'
  },
  json: { email: 'f0400d1f2ea03d730838@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108827", nonce="zNaNqx", hash="pmlsI5L+NJdK+STYrLMKtEGGtDoIvaSZEBeofKv11H0=", mac="mNwgtNKST8QQCGU8XmymUpT8M5fgag8hNEua0UH6U34="'
  },
  json: {
    email: 'f0400d1f2ea03d730838@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108828", nonce="qfw5m_", hash="gahzMrx+ch1PCoY0hjgTTgIwNBP2oVGJ9ld7HpgGM7Y=", mac="Bt1Qc1gy8467Z1ZirMdsUPHDaBd7Kw/UsBZlpq0dwFg="'
  },
  json: { code: '062634', email: 'f0400d1f2ea03d730838@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108828", nonce="u8CNQb", hash="pmlsI5L+NJdK+STYrLMKtEGGtDoIvaSZEBeofKv11H0=", mac="MTlYeQ9befETVCxRxkOnG/NUEC4FhVmTJGXgj8MoHCw="'
  },
  json: { email: 'f0400d1f2ea03d730838@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a4c388f5518540e413e40e31378cc9365a532af8e01b5c19058c67611509bebc", ts="1705108828", nonce="ciU2mo", hash="6n2EIpHIzyav0lT0FA10apinP+DPU7d0abO4vI+of30=", mac="O/7fXQuGmMS3tS4RkyMCzbeuePCS5rhaXyqdjyu4BmM="'
  },
  json: { email: '45783976ef8811e8e661@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108828", nonce="XgqcpC", hash="MZeBgKaGQaXkRWBEIyJ9g7JwNs/kJRXICIGLNWzp6/k=", mac="4lSet6e7qhxTOurSShOtecYa6Vi1ruMrX6uR5R9F25Y="'
  },
  json: {
    email: '8a67c2a91e1db77bc391@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108828", nonce="YedIuJ", hash="w0+jKD9D/QFRS7DaUL7v3tqLoESCOCGgKoEAZS/SUbg=", mac="CLPLM4V2BCbTIdr9wpCxxCGg0BDmckvvjiWiOgDls0A="'
  },
  json: { code: '398701', email: '8a67c2a91e1db77bc391@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108828", nonce="7FaXcq", hash="MZeBgKaGQaXkRWBEIyJ9g7JwNs/kJRXICIGLNWzp6/k=", mac="xlKfzuV19MW/wkSZoMROkx5lD3v4el4tz5CenhMltfw="'
  },
  json: { email: '8a67c2a91e1db77bc391@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb841eb31a76f7a50d0da3a4d7e4c2a1a3a4b5c049566a7e733ebfec348b09c4", ts="1705108828", nonce="2UUZNN", hash="+7QNOZIF7PANseOzkSyRktbreqSyfo64X2SzhF35WWo=", mac="qyHCwkGb1vA7qaj/d+EGPc8fprIKwxUECORkwfw5JHo="'
  },
  json: { email: '1b40fc434f1c8540788b@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '8a67c2a91e1db77bc391@restmail.net',
    authPW: '7e71f229f46cd344da4a950a1768376b0b2aae73ebd138c58db92617a2118724',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'f0400d1f2ea03d730838@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2f99edeb8d984f218f93251360bb8fd7',
    sessionToken: 'ebdcaddd32ff43af635387a0a6a6e843dba502d3b063f034c56a2b3e32196841',
    authAt: 1705108827,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ change primary email with multiple accounts (1279ms)
    should change primary email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6f432d0ff20f477071ee@restmail.net',
    authPW: '2a2c0ae622654d6e043314cfc211aba5fcf392d0cca7dd4e9debfd7a929094fc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '12aa9e8b38b343118aae6cbce18012ee',
    sessionToken: '92200ddad6dc29429b0ea931c488a1bb24fb50fc519cfcc79a089c6b330753b2',
    authAt: 1705108828
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '12aa9e8b38b343118aae6cbce18012ee',
    code: '12f81795c13142c44cd34d631a5eea60',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ac28b238454ee30cb69864886125f883458eb95e5c98f1eaa5408229662c3864", ts="1705108828", nonce="zSZnyw", mac="79BR2LO3rwSNHcSgtp+AqDnEHnTBJT4/2CN87A2QQ8Y="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6f432d0ff20f477071ee@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ac28b238454ee30cb69864886125f883458eb95e5c98f1eaa5408229662c3864", ts="1705108828", nonce="CfVKG3", hash="SBCXWBRSrLTV7VmqmVDDBp7O+l0qJrrn07Ne82ugGWY=", mac="Up2I0o4wXBRR087bWdSf5IQs9W6F4FeZYg0EmPkwonk="'
  },
  json: {
    email: 'fb65c17c24e08a63c0ea@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ac28b238454ee30cb69864886125f883458eb95e5c98f1eaa5408229662c3864", ts="1705108828", nonce="akPYzG", hash="Dtez5QigEdv0q0qaxOHYHu1wI48CCNr1I9yrmTv+bto=", mac="kZhl4flJJWioHow3ZQqR3ccLYrX8E1Cz/hbjQvbrDUI="'
  },
  json: { code: '195104', email: 'fb65c17c24e08a63c0ea@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ac28b238454ee30cb69864886125f883458eb95e5c98f1eaa5408229662c3864", ts="1705108828", nonce="dugTXJ", mac="/80v9YZIOrhVHce9AJol7gqVohovTvZtgkJIWL4XQSk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6f432d0ff20f477071ee@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'fb65c17c24e08a63c0ea@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3043d1e4028f8b243f1d@restmail.net',
    authPW: 'fe3b99eada5ff8e4ea3203f224c9485c2ad21852436331290c2fd23e52bc8911',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ee4905b20104447a8b96dbf03e0dc590',
    sessionToken: 'd3f5349c490c15721dce43f997da60efa4ea1f1f5279e8db4c16442283c97240',
    authAt: 1705108828
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ee4905b20104447a8b96dbf03e0dc590',
    code: '54650d8373cb3a887b576edc0db7d95c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ab1ad735667a67e3c0670039ccadbbb9bf33c32dc4066b326d1b49763036c664", ts="1705108829", nonce="l4WfGu", hash="RPrHbuEVpqMveOb9atxm27G932tuuPP/csXov+liRvk=", mac="LM7UzFZAN7qj5oqSY3L7/jMAuW7LBF08vu5N48CnvDk="'
  },
  json: {
    email: 'e79bfffa70024d4cf863@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ac28b238454ee30cb69864886125f883458eb95e5c98f1eaa5408229662c3864", ts="1705108828", nonce="MD0m7A", hash="RPrHbuEVpqMveOb9atxm27G932tuuPP/csXov+liRvk=", mac="XjsT5Wj6MaRgbq9XpELDxRbj4lYVV/yVuB40/lBviLw="'
  },
  json: { email: 'e79bfffa70024d4cf863@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 148,
    error: 'Bad Request',
    message: 'Can not change primary email to an email that does not belong to this account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to change email to an that is not owned by user (251ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ffc6f2205a43e2bbfb43@restmail.net',
    authPW: 'e9f3152658889533afe11ff4d56354b1281740c15dda46ef07f194d69ed5e547',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f7e48db449454442a388b3d2abbe1d6b',
    sessionToken: '963883f08d4e3b9bb4ec52449700dbd868dc3435935b005e6dde29c155a9ea97',
    authAt: 1705108828
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f7e48db449454442a388b3d2abbe1d6b',
    code: 'db5bc561113fc9660c30dc1b87708916',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="Ov6ZW_", mac="sNQ2YmemZLy8tjG9Ovk67cmqvISTc8e/RU51875y6oU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ffc6f2205a43e2bbfb43@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="NoOqrz", hash="MzW76pijAUHFRlutv3k0VtXqYjijMjFQ2QoXcRw2NWg=", mac="ttmPUsfUp8B2ymPZQ9ehHs2KOdugDS91ONNfT1JW0dE="'
  },
  json: {
    email: '67d5c92700cffcdcd885@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="15Z4Lw", hash="StvtZDRC/rgeERWfqG3q5QTOKHY7XJD/k9+tI9AZkbk=", mac="htDHbe7VC0+d+x54nGQ0qZoe+fv0Q/7DK0HmWrPA1gE="'
  },
  json: { code: '484502', email: '67d5c92700cffcdcd885@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="txANuY", mac="jlEdBoxrMY7mdtm4LnRCo+/nojNEYPCeVkXfDstoiP0="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'ffc6f2205a43e2bbfb43@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '67d5c92700cffcdcd885@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="mTSqQQ", hash="VhWltmdfQr/KQF4G99Di5dCzwMapiK42pAonmfezFBQ=", mac="tfWpabfUYxJ7iMFgGAb2RmSHnrIjIMMwPbbDqYzy3Is="'
  },
  json: {
    email: '3c226ac7a2ed0200ccbd@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2b5d7e21368984240920021b3e9099e98de7573a2c0b270dd067110e17a00faa", ts="1705108829", nonce="04V9-1", hash="VhWltmdfQr/KQF4G99Di5dCzwMapiK42pAonmfezFBQ=", mac="XIp9+xF2MNxdwuDEslDBTuo/YsPYQFyYygD4iFtB51M="'
  },
  json: { email: '3c226ac7a2ed0200ccbd@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 147,
    error: 'Bad Request',
    message: 'Can not change primary email to an unconfirmed email',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to change email to unverified email (44ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c40b4676ea458dbd940f@restmail.net',
    authPW: 'cf1bcd7711a49957523ea17dfab25dc693a28cd5ac5820167da2bfcf654f63cf',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5dfb4263f6b740ff880f87c17f754610',
    sessionToken: '474f35a808585cc5504637d89c566e2094a2788c9f2d1af9ed1330d7943faac4',
    authAt: 1705108829
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5dfb4263f6b740ff880f87c17f754610',
    code: '5c96474f47e0b7fe805a15c6f64770e0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="HYyOlA", mac="//OijZwIFwd1FNgRY0LjOxoyIjl559tNcuYjIP+ajIU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'c40b4676ea458dbd940f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="MsY9WQ", hash="vakApon6DRaTZ/bVwHSDZ3kMkiHC675p7I5WYHDgzmU=", mac="oGHsTAAgCo7fWBSw98PvFkxY6z0Afdu3o/DCkaE4LrY="'
  },
  json: {
    email: 'd4a97f2cf45e8a13fb0e@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="_MYWwD", hash="vITvy571Vx84FG/k9LNULEJiYlxBZ6ELbg3aQPlSbPQ=", mac="z+hupwBbbkYArHUmK3WRguxlkQC54Anfa/Ngy5C/OiY="'
  },
  json: { code: '057959', email: 'd4a97f2cf45e8a13fb0e@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="96qnrO", mac="x44foUv731+2uZze+yer20UKxqR9Wpwmf4xBTjotIKM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'c40b4676ea458dbd940f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'd4a97f2cf45e8a13fb0e@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="jYrAWf", hash="vakApon6DRaTZ/bVwHSDZ3kMkiHC675p7I5WYHDgzmU=", mac="vDHXDqyBlG99I+gqzjPfJqGjjhyxsN9AaAbbDe1l6yM="'
  },
  json: { email: 'd4a97f2cf45e8a13fb0e@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b00fc21dbd6689b9ba459ca3c4821f89cdeda88d8f05cd21a3d1939d5b265c84", ts="1705108829", nonce="odugck", mac="neUXlPy+WULYPswMEjclJkcfIGOn0ro7EKT/HiAIxzY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'd4a97f2cf45e8a13fb0e@notrestmail.com',
      isPrimary: true,
      verified: true
    },
    {
      email: 'c40b4676ea458dbd940f@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can change primary email (55ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '523f7ea9d70c34d6b331@restmail.net',
    authPW: '377f356234e13fff411095f7ef8a46956eaa70f3e55c0fcbb5a28b8efb7d2948',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5883a2217e01476eaa4fee4cc2d5e867',
    sessionToken: '0aad69dc1cb766ab85172f678e01e1db3f16f98d00fc1d38084616a62247401f',
    authAt: 1705108829
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5883a2217e01476eaa4fee4cc2d5e867',
    code: 'e4afc7be506bda6de22abcbbadf3b901',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a51eb60529a91a93cdfd27827fb02ab2ffcb7ee2d9179a636f00a877322df526", ts="1705108829", nonce="7vgmOd", mac="5cP3G4l4BHjQ9PCV4J2/kSZeesmotL3d5LmFgf8++PU="'
  },
  json: true
}
!!! response success {
  body: {
    email: '523f7ea9d70c34d6b331@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a51eb60529a91a93cdfd27827fb02ab2ffcb7ee2d9179a636f00a877322df526", ts="1705108829", nonce="dLILZ9", hash="SP5XoWTVnvgD8TU6PFPi5mnPQN5iotbLTLKau+Kw+0Q=", mac="gH4Rxh141Hy1IkxwHNQDn3mBnO24x92Q7if4BFL7Ook="'
  },
  json: {
    email: '1c14ba682a3a11450574@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a51eb60529a91a93cdfd27827fb02ab2ffcb7ee2d9179a636f00a877322df526", ts="1705108830", nonce="6pslVa", hash="2GPqddFc17nYk6V64v6o1JCBj7m2TX9Dxr3hP11rEk8=", mac="Oti9b0ssyRbhfzHTshMImUU8s6QyXxp+C7zp27/nKoI="'
  },
  json: { code: '571430', email: '1c14ba682a3a11450574@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a51eb60529a91a93cdfd27827fb02ab2ffcb7ee2d9179a636f00a877322df526", ts="1705108830", nonce="w_R_pG", mac="faquA7DdFAeZeQ6W23+TBS8odS6x6lOaeakh2UF2Hqc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '523f7ea9d70c34d6b331@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1c14ba682a3a11450574@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a51eb60529a91a93cdfd27827fb02ab2ffcb7ee2d9179a636f00a877322df526", ts="1705108830", nonce="WTN1wx", hash="SP5XoWTVnvgD8TU6PFPi5mnPQN5iotbLTLKau+Kw+0Q=", mac="/Tcrta8ivufZDYog+KlfwHFJoB9lLF9Ao8hwb23tGUo="'
  },
  json: { email: '1c14ba682a3a11450574@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '1c14ba682a3a11450574@notrestmail.com',
    authPW: 'd19f3afbe9ad386e26cee7086e608b9b80e855bafeeac435442999a6684ce46c',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 120,
    error: 'Bad Request',
    message: 'Incorrect email case',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '523f7ea9d70c34d6b331@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '523f7ea9d70c34d6b331@restmail.net',
    authPW: '377f356234e13fff411095f7ef8a46956eaa70f3e55c0fcbb5a28b8efb7d2948',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '1c14ba682a3a11450574@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5883a2217e01476eaa4fee4cc2d5e867',
    sessionToken: 'e6f7975e17d9da8b684e211cf3ae2ff57147de7f5dc63768c6756fbfc6c88a18',
    authAt: 1705108829,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can login (389ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3d3089098a5f7cab2c38@restmail.net',
    authPW: '76a361228293f67b3375021ec50391e09023f7532ccc56e072b1ebd78b444788',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3b63b7340ead43f0a2d8e8ddfc659f22',
    sessionToken: 'bac9662d3f568efddec68355bc6f7c86b854186aaeeb71db1e1a4343395156f5',
    authAt: 1705108830
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '3b63b7340ead43f0a2d8e8ddfc659f22',
    code: '39583953b317bb6909c7b21c10803c2d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4e46b2dc9f9f81cf11afa249e7ad906fa2ad6d5647f5fb8243e74dd6180df5cf", ts="1705108830", nonce="9W1RCk", mac="rt0TTH4Hkwe14YB2i6rz10UUN1pKCyQmEeUQCTosrgc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3d3089098a5f7cab2c38@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4e46b2dc9f9f81cf11afa249e7ad906fa2ad6d5647f5fb8243e74dd6180df5cf", ts="1705108830", nonce="4S8V4z", hash="r7HFFSfwUffqD9lAFTLEVtSyyam8bm8Z01plTz+SpZw=", mac="zvKT81RjLmZHzU0FWwixKwXlgAlEEmMjFyK078pL+mw="'
  },
  json: {
    email: '9e3ae340defb99c1a24f@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4e46b2dc9f9f81cf11afa249e7ad906fa2ad6d5647f5fb8243e74dd6180df5cf", ts="1705108830", nonce="5Sq_Nh", hash="jIHavbybm+nCa/ljD06CGll7jei9MUugkr/ofPTTVsw=", mac="WSXG+rOJeqUiTqf9fmPwPuWocvNccOrpD41oFqzY2kA="'
  },
  json: { code: '486990', email: '9e3ae340defb99c1a24f@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4e46b2dc9f9f81cf11afa249e7ad906fa2ad6d5647f5fb8243e74dd6180df5cf", ts="1705108830", nonce="fQuvub", mac="kR9/5ZjYf5wy10oBGAJaWGyb+XJM6KsKUUthqWHkYlU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '3d3089098a5f7cab2c38@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '9e3ae340defb99c1a24f@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4e46b2dc9f9f81cf11afa249e7ad906fa2ad6d5647f5fb8243e74dd6180df5cf", ts="1705108830", nonce="eoSgma", hash="r7HFFSfwUffqD9lAFTLEVtSyyam8bm8Z01plTz+SpZw=", mac="fjeipZP3tX0Wy5/84XnNObaEFYKz0I7sz1ixfmXEh6w="'
  },
  json: { email: '9e3ae340defb99c1a24f@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3d3089098a5f7cab2c38@restmail.net',
    authPW: '76a361228293f67b3375021ec50391e09023f7532ccc56e072b1ebd78b444788',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '9e3ae340defb99c1a24f@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3b63b7340ead43f0a2d8e8ddfc659f22',
    sessionToken: '66e996733f5ce98869464215c0b3719dae910dedddbbf1fdee21f51cb11afd59',
    authAt: 1705108830,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '3d3089098a5f7cab2c38@restmail.net',
    oldAuthPW: '76a361228293f67b3375021ec50391e09023f7532ccc56e072b1ebd78b444788'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'd447076dd2d2d4ff07987b7b7ed4431883c461d8b73886bceaded07370c6e622',
    passwordChangeToken: 'dc8cd22b000f2d5748744cfacd31fea5c5e56d4dd929c6a52b9a5037348caf23',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e4c80c84930e78fe1215575c028f47051a7561cc982557196281ce982c3064b1", ts="1705108831", nonce="AYJ6C3", mac="s5mzQ/PaxK82UBx+ZDe3W3PTVRpUEjK2vxPMkPTL/10="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '425ee7229ceefd012d803346e3d34d538f81b058ade65d679dbc18921d7c44070ebf3fbf85a05371f20212e53587ccc773a5c85ee4fb9fbf18fa416b124c060e17894597c792e4e59f954e6fd44956a45e1c304e3664597388c09535b39ba681'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6eae0128e14e4eb93dd0b5a9c34d87c5bcd204a9787da5c041a3b24a5e1c9279", ts="1705108831", nonce="JOjVdn", hash="IUFifPXihssajKvP9Bv2omrAWxR/oMT9S0zcMmTyMqk=", mac="sj6WU44LxJquLu6jQbSwiIz3z+B0u4jzeFIDVJr4hAw="'
  },
  json: {
    authPW: 'febeac4bb0b5f8c96ce294dcf7e427509461d2794b579898ba17c3ed51ddd652',
    wrapKb: 'e1720e70c3bc581c5c32bcd698258a2ab0f0a20e7530699557d03bda475b5c6d'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '3d3089098a5f7cab2c38@restmail.net',
    authPW: 'febeac4bb0b5f8c96ce294dcf7e427509461d2794b579898ba17c3ed51ddd652',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '9e3ae340defb99c1a24f@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3b63b7340ead43f0a2d8e8ddfc659f22',
    sessionToken: '16ffe6b2b7aada0476e2e6d9ebf4ed0943b36d080a65c3ec952da5ea0a0f75b7',
    authAt: 1705108831,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can change password (808ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b3d6f9a33b1a5897baf8@restmail.net',
    authPW: '537691d6ba2bed42ce426af7438cf1b0a7b0f10a37ec6d89e0bef78e397858bf',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '22ecd25fad0c4c2096da40fad5d5df48',
    sessionToken: 'be25666e2f496d6ebdfee4b0fe91e5a8e322ca3e6ee12da703428b047496d494',
    authAt: 1705108831
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '22ecd25fad0c4c2096da40fad5d5df48',
    code: '5da4d1fe02480fbc005deef3e566b913',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="36dd2669c264536e3074cc2e1557c4289db510efea6f9b8e7cb7e78f8f9b0be8", ts="1705108831", nonce="Wm0W2d", mac="syMlX9LinDZbGC2IMvv14qr9fIdTn/KvU37oN5DfEOs="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'b3d6f9a33b1a5897baf8@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="36dd2669c264536e3074cc2e1557c4289db510efea6f9b8e7cb7e78f8f9b0be8", ts="1705108831", nonce="qc0elS", hash="22J8gWAOXbWL7sy6+4PO9wsuBPWkMgcO7SCm6loDxUE=", mac="q1Mjne3WR7sHj0pNQqmvxrC1VodFUwtA6Z9jh1uRvqg="'
  },
  json: {
    email: '53b32241c692524c138e@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="36dd2669c264536e3074cc2e1557c4289db510efea6f9b8e7cb7e78f8f9b0be8", ts="1705108831", nonce="hW-rMp", hash="m9DsFudcyCsWDA/suz/k/M2QIaEvVsjH02sg8WBSnKY=", mac="LPxfozFvq2ZzXwL4bl6FEbaituvUcJELwoZQdFpLSLU="'
  },
  json: { code: '733980', email: '53b32241c692524c138e@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="36dd2669c264536e3074cc2e1557c4289db510efea6f9b8e7cb7e78f8f9b0be8", ts="1705108831", nonce="ObPsZh", mac="TQ79Y1tVIOKKpwlWnnoFHF7i+RFzLyrV3iwwteDQIRw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'b3d6f9a33b1a5897baf8@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '53b32241c692524c138e@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="36dd2669c264536e3074cc2e1557c4289db510efea6f9b8e7cb7e78f8f9b0be8", ts="1705108831", nonce="o8pPzO", hash="22J8gWAOXbWL7sy6+4PO9wsuBPWkMgcO7SCm6loDxUE=", mac="9pU0Tz6Ki6+iLkpH9JwUuBeEoZOuusQLPoBq15TAiJQ="'
  },
  json: { email: '53b32241c692524c138e@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '53b32241c692524c138e@notrestmail.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'e9c9a6c984a22c01ce10abcb986f2f8aa630c56d893f9634754ccf6cc8205d6f',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="80e4b30492f9554da3ef4f92b3ab1950dba93e4867f755e094dd088c0be54419", ts="1705108831", nonce="FkTGEc", hash="uhNi8QZId+nz/uhMVcLeOwfhHZVxJ7d2Y5qifhDbl8M=", mac="WnZFeJpwlrxA/Zy8JCPLmXTxLjIEd8oDuZ/vE1X1TGA="'
  },
  json: {
    code: '7c2f1b1ccf4c48692e60f362a2c81ebf',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '0ee7f74d61f419685669438bacd75bae45454ab256297c25c82de3fe20b6a30e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b41cc2e98efea46ec55e5009de5dbefc0c4351c1bf4260cf7e7cfaf57c0f49a3", ts="1705108831", nonce="lWiX_A", hash="IrZmOHH0pcTOtQdTYfo4buZyyN5TEBeUGeeh6XDplaA=", mac="C6cjTwygpoewLeH3EM2lKVUn75kMDNpGYSeHbmHGEAc="'
  },
  json: {
    authPW: 'e523320dd6974ab7832a92b3ba4695f2d5c91416113fbfd5b61e4d2086510673',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '22ecd25fad0c4c2096da40fad5d5df48',
    sessionToken: '1493a607ae356db6f6ed5cbef14c7bb97ceb56317e5d64b23e716ea3cf436551',
    verified: true,
    authAt: 1705108831
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b3d6f9a33b1a5897baf8@restmail.net',
    authPW: 'e523320dd6974ab7832a92b3ba4695f2d5c91416113fbfd5b61e4d2086510673',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '53b32241c692524c138e@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '22ecd25fad0c4c2096da40fad5d5df48',
    sessionToken: 'ac3e0f56f2475ae36eb7b7d37865d9db5674d16cf41888510f81026e52b57a49',
    authAt: 1705108831,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can reset password (510ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2636a9fde4d5307db9d2@restmail.net',
    authPW: 'e210c61c186736d85e3f4a10fc3bfd141330a3228dc58ab75766286afb7f1f76',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1e32a90565b24000a13b8cc46e7ec445',
    sessionToken: 'f3c46bad32404b379170f812c000863c833d7c6d3d32a5d537c9d62f426ac468',
    authAt: 1705108832
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1e32a90565b24000a13b8cc46e7ec445',
    code: '1cd8dcd2bd7e822329a47ab578b491e1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="4wQS8n", mac="cXaeMTAieg6nFJaPkwmEMLhaSUjraFayUbOfRM5l1Sk="'
  },
  json: true
}
!!! response success {
  body: {
    email: '2636a9fde4d5307db9d2@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="tjJEGC", hash="tWfmMa+jIamjLT4G0IAoNOOH9P/MsdpAJ7fqpsGhI+k=", mac="R9zgyz482BqzYFlsAmgMFdFHCe7Bg45DWbqYN8JyKj0="'
  },
  json: {
    email: '3d3ca67b5a768428f7db@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="9xwpwT", hash="YPIXKGemuUkkLuz4h/utkW8gPLv3KtBIRQ0pFE08V6A=", mac="qTXRYIp0pLRhdEnd5NX5H+wC3UGasMgrCZlC82gTuBA="'
  },
  json: { code: '225492', email: '3d3ca67b5a768428f7db@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="98SPM5", mac="qNfEVs04rQm2SomeXrJSEt819WnxYYsFlxFJRdaqEXI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2636a9fde4d5307db9d2@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '3d3ca67b5a768428f7db@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="oUciiV", hash="tWfmMa+jIamjLT4G0IAoNOOH9P/MsdpAJ7fqpsGhI+k=", mac="vmmtccY2HtgVnAEfX4ONmotI63CUR5yahxY4QrHsmvE="'
  },
  json: { email: '3d3ca67b5a768428f7db@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7f93058182ef93ff4dfaa51f90107e0259d0872b9349ee50734e8627aa52de06", ts="1705108832", nonce="yUR86a", hash="Z6A0+Zdpt7gefxflgSF5f02ufLu5NUeXGZCnJ4qcQsg=", mac="JaQCwtufZ2cqdH12jA3O9/yToG7iAMrYn/hEcLDJd+A="'
  },
  json: {
    email: '2636a9fde4d5307db9d2@restmail.net',
    authPW: 'e210c61c186736d85e3f4a10fc3bfd141330a3228dc58ab75766286afb7f1f76'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '2636a9fde4d5307db9d2@restmail.net',
    authPW: '770356d0c35a8e450313f124c4c3af04029dfb80f302e4b3c3506d23eaf5ffd9',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '3d3ca67b5a768428f7db@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3d3ca67b5a768428f7db@notrestmail.com'
  }
}
      ✔ can delete account (229ms)
    change primary email, deletes old primary
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6ff2290ceba9000f6dbb@restmail.net',
    authPW: 'e7adf9eb4d38688d59694d6462e2481028e0e3a85335f26fdb558c5a8a45a4f9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c8b0799d53164114a4c5ac15dcc27fbf',
    sessionToken: 'c29a32b7924ddaedf6c4f7ff3b1180d5afd61cf5fb8f1e2c4c95f0d96fbefdc3',
    authAt: 1705108832
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c8b0799d53164114a4c5ac15dcc27fbf',
    code: 'ec9eda82858676fabefd66095702fb83',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="yeMEqB", mac="0dIOCFI9dzspED/MX8FhEPhwrBkzeJzU0WsVGWok7+A="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6ff2290ceba9000f6dbb@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="YcLLDQ", hash="iQhMm/Zb26G4LTl/ZjpKsSu4Js4/SG4QJ9v+UIFy6ek=", mac="vQRh5ShpGaxLONuiNhkTur+N8rZVSiCqFW6Sw1M+zH4="'
  },
  json: {
    email: '0b7d03a6718a30e00f88@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="w-M4Ro", hash="VG6w6Eb8Npqzi0Yzyoh2bNsOCPHLT+vJfcLIDPWkDO0=", mac="A5F4xR9AYyhkJfGGYu4M7aIjQuq7t57cpatW0JuxV30="'
  },
  json: { code: '133704', email: '0b7d03a6718a30e00f88@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="dMMeM6", mac="ACZ8K6HQMpZAU0juAklBZyo7WHPfaX08wCqNMdLQGcw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6ff2290ceba9000f6dbb@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '0b7d03a6718a30e00f88@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="Gm1CQm", hash="iQhMm/Zb26G4LTl/ZjpKsSu4Js4/SG4QJ9v+UIFy6ek=", mac="hMD5dwmtKM6eVuAAxl7xWjM7/6kgt9KwDieFMlVo4FA="'
  },
  json: { email: '0b7d03a6718a30e00f88@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="THF4eZ", hash="XDzYOwJGs9gYekPMCLf8Dud7CF+13t5GgmI77yZFW1Q=", mac="0I9NAh5JZs2TgQTS1PYAx+4WchRvQVOZ0OD+9jyucas="'
  },
  json: { email: '6ff2290ceba9000f6dbb@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8174463dfe214503b114ac052b132b1e5183fd139b5a4e7effe81b3f43bb3de9", ts="1705108833", nonce="0DyCfu", mac="LeysmaN7NJ3iRQwJ8MlZd4ZpSr7HyZtvs1fcZXVjZvo="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0b7d03a6718a30e00f88@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '0b7d03a6718a30e00f88@notrestmail.com',
    authPW: 'e166272d1f5b6b6c015dcaa43f2d4f18861f7ee8813adc177001986822e1140b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 120,
    error: 'Bad Request',
    message: 'Incorrect email case',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6ff2290ceba9000f6dbb@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '6ff2290ceba9000f6dbb@restmail.net',
    authPW: 'e7adf9eb4d38688d59694d6462e2481028e0e3a85335f26fdb558c5a8a45a4f9',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '0b7d03a6718a30e00f88@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c8b0799d53164114a4c5ac15dcc27fbf',
    sessionToken: '9df2348e695af951a1fc0cd91da6e4b164a665d7cad8923a5346cc5c4bc10d95',
    authAt: 1705108833,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can login (322ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0011b205d3b8b711ac5e@restmail.net',
    authPW: '2dbea8b390735b78cfa11a0d696e695d7f4f13aae6d7880a371bf331f67c4bc3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '26e21c5a745c48798a0d5a9519898aaf',
    sessionToken: 'c8307838c73667bb4cbee001d247ea082970eab1aa8376d013085dd325582d61',
    authAt: 1705108833
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '26e21c5a745c48798a0d5a9519898aaf',
    code: 'da062731e2b1b72b28fa75ae8df11b6b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="26RjVY", mac="NSys5BMT8MSCi+cLYk+Su8b3etaenl58qEvzW+LRLVg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0011b205d3b8b711ac5e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="SAhKJy", hash="YwrGzY91e90MZ/UMk+nfagH8ix7s2kVnU37xIfzWyLo=", mac="9PJ68zJGklDDdz7n2U/ObdjDXEqLmL2FY2dHwdjAq8w="'
  },
  json: {
    email: '96d606a2ac4d9c32c848@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="CNRbK2", hash="g5/dOsF+m21qwxCKNppSgoK/78xZM+MRKTWh1fI1QSI=", mac="fBkkdzieX8RLGsIHRMWKNEUiaKdeskGAJZRhFOzf5x0="'
  },
  json: { code: '879944', email: '96d606a2ac4d9c32c848@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="05HWbX", mac="08vllXBrSYSdsgbc8Xh7VhNN+DPTkUGCs7u7oV9lBnk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0011b205d3b8b711ac5e@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '96d606a2ac4d9c32c848@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="UoZ5fU", hash="YwrGzY91e90MZ/UMk+nfagH8ix7s2kVnU37xIfzWyLo=", mac="JKkpmZ/IxhEKdBjGQca/onqIXNVpwXhPJvm+ogggJRs="'
  },
  json: { email: '96d606a2ac4d9c32c848@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="GFZQ_s", hash="mbsYUekg1Pk0h7epr2KEKkXheKyiu3JC75809wh8b3Y=", mac="HZ4tUTCtkesLXzEcTSuy8FhK+RIqbdHv26VleXHA2lg="'
  },
  json: { email: '0011b205d3b8b711ac5e@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bf759e32c3fe28f236b513464918491b267af828d79f7e210e148b69970bc9fc", ts="1705108833", nonce="0sDXqE", mac="XSDIjOGSZhONUoZSnCuBEJb6u7nxvGKXLgQw0Hiv6yw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '96d606a2ac4d9c32c848@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '0011b205d3b8b711ac5e@restmail.net',
    authPW: '2dbea8b390735b78cfa11a0d696e695d7f4f13aae6d7880a371bf331f67c4bc3',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '96d606a2ac4d9c32c848@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '26e21c5a745c48798a0d5a9519898aaf',
    sessionToken: 'd190fccafa4d1b9a580243a578244b64a0b726b2a97c81af4a1d36e49f1c9ad5',
    authAt: 1705108833,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '0011b205d3b8b711ac5e@restmail.net',
    oldAuthPW: '2dbea8b390735b78cfa11a0d696e695d7f4f13aae6d7880a371bf331f67c4bc3'
  }
}
!!! response success {
  body: {
    keyFetchToken: '85a268555f5e2cb30a7102e444c13a6c323f7ebbf077d51d4cce5b19f3d7d03c',
    passwordChangeToken: 'ebf442de4ec35ff06300031b2481b55d25c690d8860a6d4ead58362cfdee4a71',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d2a5205e09ad2eba1f89daf5d7bddf15b5fdda2deeb0f78593a889789eb2add7", ts="1705108834", nonce="w2iCfV", mac="WEfr6w9nTILAASXa0ABDwFnAqAch9TYIa09nZZYq7GU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'a81985c23d96404d63d1e77636f97fa8df7df7f0ab42fc216abfc1b56f5ad59d2f4d0976a099f22756a817c51fc8d6c99427e98a82078cc67f6970e73f46cbb84ae0ae5dad2a8b5064c12d05db201d62e932fd39802d4f35c6cd923325cd6048'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5cf2043d67138bfb053f8550198c24be2dba1e0f23d0274cf1769b2845181d12", ts="1705108834", nonce="hIkg6n", hash="2QxUzZPRJcNC62IFkfzWmzr+o6payOxCXgji2Zy2c58=", mac="zREG7nT6b62IY5ZH33MHMxFo7RJkI2ixwiwqsKeK5Iw="'
  },
  json: {
    authPW: '86a359748d1839f291ea3ecbe883a239ec69525b3a19a1c7dfeb01915c1c8a5a',
    wrapKb: '69718fea18373697bc383a7694a38a74c4f159c95c21ccb12a764b6519ffe7d0'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '0011b205d3b8b711ac5e@restmail.net',
    authPW: '86a359748d1839f291ea3ecbe883a239ec69525b3a19a1c7dfeb01915c1c8a5a',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '96d606a2ac4d9c32c848@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '26e21c5a745c48798a0d5a9519898aaf',
    sessionToken: 'f7385132f1087e650082e0a65771596b69837a9c367227e255939dca69542a5a',
    authAt: 1705108834,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can change password (753ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cd2e0fdc572699b375f5@restmail.net',
    authPW: 'c163034200319533c4ee262279746d91d8675d14f65d335d9b4c71c4a1411574',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '587e95782aeb4bf4b6b06f1fd82a527f',
    sessionToken: 'e8eae303d2cd10fa99509b7f161467008d6d3955fdaad35f8fb51502289bb3c1',
    authAt: 1705108834
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '587e95782aeb4bf4b6b06f1fd82a527f',
    code: '0745e4650c8a7888b234a8b339b9d752',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108834", nonce="RK6eKB", mac="PRwmTtE2MSRGtNBY12HxQOWUT+ovKQqs8cKGyu7+628="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cd2e0fdc572699b375f5@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108834", nonce="Cf50O5", hash="PBgxQsY1LAiviSQK7ogAk9CG2oFLbuZq1xjmERLVtSY=", mac="oYpiLBGIJUyQ113oNz6+OeI3xG/oWQShe8BV+Klv944="'
  },
  json: {
    email: 'afe91ce924cff124a492@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108835", nonce="ybEYZZ", hash="eFdRI5K4L/7w8FQRBboAi/C+dpLQrgDQ+DmXDpvTAvA=", mac="xDeJvifTjrIoItR9UvhNUbQsRA8oMS8RLYYRq3I6Fzk="'
  },
  json: { code: '149393', email: 'afe91ce924cff124a492@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108835", nonce="uH5ruc", mac="MGYZ5cP3+o9Z7gybBTere54h96lS8Gc1BFiyJHk/j7s="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cd2e0fdc572699b375f5@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'afe91ce924cff124a492@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108835", nonce="PxAxg9", hash="PBgxQsY1LAiviSQK7ogAk9CG2oFLbuZq1xjmERLVtSY=", mac="njBWBk/6sfSkvhtr1AO8hWTSJEjlc6Lle+i/GKg0XHA="'
  },
  json: { email: 'afe91ce924cff124a492@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108835", nonce="-LOXxE", hash="3lJGPnT1kvAu/uPjYjGL0bCsvE9vhjsu5baae94RIkY=", mac="1LFAqaP1Y+StLDoRv55O8/djCRL2hpQuQHzC/0rLafk="'
  },
  json: { email: 'cd2e0fdc572699b375f5@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33bf087c2e355e1b2e692c769b3726599deb41a59719b70d49a6acaa7575ef94", ts="1705108835", nonce="tnFN8L", mac="xodHTUH7v82/6NAw9SoBumbt2ta1xXDqLXwqX3saML0="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'afe91ce924cff124a492@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'afe91ce924cff124a492@notrestmail.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'e487212ab06390fa17069933925d058be7ed4ccf9f59c352000be0a4ea2692da',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ed37bd1cd2162435af767af2229571ea8ec1797a3b09cc7c26a7604a1506cd8", ts="1705108835", nonce="dJrV4C", hash="OLYDCpgMvZ4UuglkQhk+WQGtInfVWpLg4G0D1XqI2sc=", mac="7dlln5lpq/Zy/C+4Io6hkyg7QfFTKVbnCzoPw95tLwE="'
  },
  json: {
    code: '3e65b23c6115f94efcd65044e28e1f9c',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '3bc56e6131b51a35a58f388ad75fa49f5ae7dbbba15cc25b483c998abe5064c7'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="480ce61572359677521aec3362e56e7aa932d691a60165182ade9dd109d416fe", ts="1705108835", nonce="mXti_b", hash="cp8Jdhqz4+aM1Lur7uoFmVsv7AiWMQZIys6T+xw7LAA=", mac="vrkh1ugxJkNNYhk7oaWmVC7fG9W8wcJYgvzDtSCA+gE="'
  },
  json: {
    authPW: '44dd8ccb685fda7cad563deda1068e43ee44d42d4d9b4016e122652fdc8fac08',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '587e95782aeb4bf4b6b06f1fd82a527f',
    sessionToken: '406a87e47a6dd9c82263503f8314a78118a964ae4b5ca45ea0a3be065830250a',
    verified: true,
    authAt: 1705108835
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cd2e0fdc572699b375f5@restmail.net',
    authPW: '44dd8ccb685fda7cad563deda1068e43ee44d42d4d9b4016e122652fdc8fac08',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'afe91ce924cff124a492@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '587e95782aeb4bf4b6b06f1fd82a527f',
    sessionToken: '02c55eb0cfbbc6d1e8433562a9d570902591836bcc66df6b27785e469dedcbe2',
    authAt: 1705108835,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can reset password (475ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7da31871a2bd64d3c698@restmail.net',
    authPW: '52be9e47d780ba3eea0d40906793583d870c9bcd7238536b81aa26cc350055ed',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '25d976a88a28456f9ad671ff7e547026',
    sessionToken: '8db9d36e7006a31a62afd9e0b61b01d1f46b4cb53cad134f633b1f234c267438',
    authAt: 1705108835
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '25d976a88a28456f9ad671ff7e547026',
    code: 'effa975bcd796d5a229648ee4f06ea14',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108835", nonce="h7koF7", mac="22Nz2QTPE3EmWFbx0/Z92foaP40g2QkXQd8WqrfxPh8="'
  },
  json: true
}
!!! response success {
  body: {
    email: '7da31871a2bd64d3c698@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108835", nonce="LqLNlq", hash="PlyAtnJFTANPq96d8+pW8koS0YTKhiXnLJ2vd6Zt8ak=", mac="H0vb56+IrtzZH+hiJIo6CsM6vj8/2WZqYj6KgGWxB6Q="'
  },
  json: {
    email: 'dd40a30e7093dd061d80@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108835", nonce="xKAjAP", hash="iHjfeNSGdzf7qU6qinzdfKR8dobt4GV0Gyk9/wwRwyM=", mac="Vb9P/0B25FD7VL70yihroMNf/fSWnQ+Ern6mJ98wdL8="'
  },
  json: { code: '898407', email: 'dd40a30e7093dd061d80@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108836", nonce="UDIraK", mac="oLHx74e8r6iEli7f0p6ybYeGg7yxazTMyiPqn5U+jLs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '7da31871a2bd64d3c698@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'dd40a30e7093dd061d80@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108836", nonce="hq55lu", hash="PlyAtnJFTANPq96d8+pW8koS0YTKhiXnLJ2vd6Zt8ak=", mac="lHIecnkeSoAvVRySpqcNVNtAUkf/G4CE/6qs0S+sKyU="'
  },
  json: { email: 'dd40a30e7093dd061d80@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108836", nonce="-1QUix", hash="CFrwXsCls2yRoPkR1slqiEVIb4YpTcGvB8xx9/Bgloo=", mac="ANKj2niXPHfrAjLROTY2PmTMDxxq+K9BOp3ReUfLbQA="'
  },
  json: { email: '7da31871a2bd64d3c698@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108836", nonce="rdOCxm", mac="ubscmGCnyBAEv6PHGP6OR1U8wcTVfR8pvjlKVgfZxnI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'dd40a30e7093dd061d80@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="abae78cbf96b5212f86907dae4984d31d2cc6b857ae87daf851938214e26113e", ts="1705108836", nonce="KakZFl", hash="VzwQRIrxPveo2F9gRbHay/2VunDxicrdCuYm5FU+a9E=", mac="zHY5Scv3VdXF3GVYPoVdOdbBVpXuJuyLV+/DRAhc62M="'
  },
  json: {
    email: '7da31871a2bd64d3c698@restmail.net',
    authPW: '52be9e47d780ba3eea0d40906793583d870c9bcd7238536b81aa26cc350055ed'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '7da31871a2bd64d3c698@restmail.net',
    authPW: '36415f35850bfe39c657c42729da5341e7ed17f8669726aa69aee53583e9ced6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'dd40a30e7093dd061d80@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'dd40a30e7093dd061d80@notrestmail.com'
  }
}
      ✔ can delete account (207ms)

  #integration - remote change email V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '540af0b275333d01c785@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '540af0b275333d01c785@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '540af0b275333d01c785@restmail.net',
    authPW: '06da82dd929c5414ae3f11a3c034ae3dded1109e7d9b6b80e7643110bbbf6812',
    authPW2: 'eba69c25091403bff68ab9a80250e1a6eff8855b341cb5cab045003e1d2c8b4f',
    wrapKb: '2a5f4ba8d951ae6f44646bfc72991b7790faef31a8fe163e0d5cd002dfd9ef9f',
    wrapKb2: '3b9c0a19cebfaaf431fb92ab15e1233117f69bea4f15625638c065287d6b43ff',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ed635c796ec13c062ffe7964e7591e86daefc856896a5a87abdbd990d5133bf7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4d4eddc126de47bab930aa97669f55f5',
    sessionToken: '094c50fe5729e09f183fd05b190100cef41399edafbae11e359ffc34fcdacc18',
    authAt: 1705108836
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4d4eddc126de47bab930aa97669f55f5',
    code: '126bd09eba478f3763005f8675b60991',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="46f88441c5e6b7f6bf43a8bb156a12b755f4ba23409eab843bc7f0366164b813", ts="1705108836", nonce="GA-1Ts", mac="IAFSoild4DwY9+KL6OG9nExdEg2r9O9BMWYyBMSPgfw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '540af0b275333d01c785@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="46f88441c5e6b7f6bf43a8bb156a12b755f4ba23409eab843bc7f0366164b813", ts="1705108836", nonce="edRcRK", hash="YdLRUOke8FD3G+JIthvxzD/Z0yU5kzQ7ub2luPGZppQ=", mac="rkXdc8W1QIZKif1tgrXilLbXNrPU8pRj54jFH3YMcZM="'
  },
  json: {
    email: '01729b1cfef5d2fbde08@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="46f88441c5e6b7f6bf43a8bb156a12b755f4ba23409eab843bc7f0366164b813", ts="1705108836", nonce="pa-LCO", hash="0MoQgbtBpdvweMfWNJJzTgpsy3l3sa24eREEqvfDroo=", mac="c9GTEZVywmFtITWJK8YQjF/4OOitbkemniRoWZ7g5hs="'
  },
  json: { code: '769722', email: '01729b1cfef5d2fbde08@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="46f88441c5e6b7f6bf43a8bb156a12b755f4ba23409eab843bc7f0366164b813", ts="1705108836", nonce="yi2QL-", mac="1Lf7UM3Os/QmKncxQhnNFAbIcI8c+YSFleZRqO4Pf1E="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '540af0b275333d01c785@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '01729b1cfef5d2fbde08@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '25e0e1ec4ccd90486e11@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '25e0e1ec4ccd90486e11@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '25e0e1ec4ccd90486e11@restmail.net',
    authPW: 'b4eca71caf7bd8b7518dca75ade0dd49fea65537412a8fd2f5f3197a0e5d9d02',
    authPW2: 'aa47742d26b8e8a005cd5c4e760e75f240cee6f17f728cfe9298cb7e99a1fab6',
    wrapKb: '795622368182fa152674a6841306cc0b9358159b57430bc314a53b98ffbc5557',
    wrapKb2: 'e427be4b4d567212025e5c05a0781d5d44a8172cd94752f18f3a4328f5b9d715',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3af14f4ea200327070ec4e37e11a9acbc30b870822cd7193fcaadd039c7940f9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fec54b899d6f442f85f66bdce4b9bee2',
    sessionToken: '0b2a2a625b0b15dcd42a8622e2085cf1b83f59d461fe4608c2cdf3db52913dc1',
    authAt: 1705108836
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fec54b899d6f442f85f66bdce4b9bee2',
    code: 'b12c6c71273f06507c8c2a7221f0e509',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bb1a9e99429c4db28019@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bb1a9e99429c4db28019@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb1a9e99429c4db28019@restmail.net',
    authPW: '9a9452b0a612285425eae14a406fb893ec1f9486b1230eafb1757a752ecfae67',
    authPW2: 'e176dc07bd71cca241413121772650786b9d026766f1592c490ad8c8021d5e28',
    wrapKb: '5d8e9441cdd80f8b2fb9bb8a1bfe88b226d3c7afa03622b47e1f4d2839ac43a4',
    wrapKb2: 'd3ae322dbc823b237b6b3224570bc3647098e721e2e73e6781c050a84e116aa1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:92c558ae293037ed087da87a9e74512d486fd1379a8ab0359356122d6ea393e2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0574c1c2226942a79c2e5d69fa52ef99',
    sessionToken: '9d303f7dce6e2f808ea6bebc2652cab68f04635cae5725630711d2021a9f7ee7',
    authAt: 1705108837
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0574c1c2226942a79c2e5d69fa52ef99',
    code: '024eaa528eed42d9bc60692a55402009',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="wn4uJg", hash="vSiWYTOOMpGzwe+hdXUUkJLZQx1S4WThh3QsHZrXNg0=", mac="hFqCVSQo1xxApZcu7sBIyxSQ1JJPF/45E4Vgj4dJykU="'
  },
  json: {
    email: 'cc00ab53e66fe984d803@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="4Uh6SF", hash="zHwxuCl3ZRPPWce46v2fszZdvR2u3BGVonsi+JaIcdU=", mac="RfpZmEc2ibVb3CXZW9TdanKxHhqUuapFqo0rqdLEcPw="'
  },
  json: { code: '237004', email: 'cc00ab53e66fe984d803@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="8ZCcVa", hash="5JLzQDqNlozyMZQeD931H7hJFXTDfNkvkKt429yx2Jo=", mac="7adOBtre8wOnoXA/9ax2E+tWu6+wWYaY/gBBQdUx2uU="'
  },
  json: {
    email: '0577ba853d9076aa1202@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="AFREK2", hash="btIGNZMpRnrlvXw+tV/ueOCXiHTrv0qzjQ/7jG2VIK4=", mac="x6WP6SnP4RGGjE4kxkVsdqUE0gnuJow1OIpxlCy9xCU="'
  },
  json: { code: '559571', email: '0577ba853d9076aa1202@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="HMFfV0", hash="vSiWYTOOMpGzwe+hdXUUkJLZQx1S4WThh3QsHZrXNg0=", mac="P4+thZpDm5ANIK3MdWPkb6yV5BIlmO+2nw1tONivPpM="'
  },
  json: { email: 'cc00ab53e66fe984d803@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="-iHeSu", hash="/9F5XuVZE267WSzlxruSqwiV3z/Ff457mo5jplS6RnI=", mac="bydmEHgW8KWl45cYpz/JgJzyECXtAWD2ftasvld8m/I="'
  },
  json: { email: '25e0e1ec4ccd90486e11@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="cCT7tY", hash="5JLzQDqNlozyMZQeD931H7hJFXTDfNkvkKt429yx2Jo=", mac="5ofH7QysHMcYWLV3UmKjw9S0BloZ7NOM4rw6Y+OkZRQ="'
  },
  json: { email: '0577ba853d9076aa1202@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="OTR3Ey", hash="YnD6JW0hH7TTklwzd8J1a1SAwij2PsovFQpWuBMD/S4=", mac="lGqM4w6EAOt4Zn3Af1IsOw8pmD6EqVvkwBIuCt0RSWs="'
  },
  json: { email: 'bb1a9e99429c4db28019@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="Cg8pne", hash="YnD6JW0hH7TTklwzd8J1a1SAwij2PsovFQpWuBMD/S4=", mac="ANFLFUUbTpM73jLqAJtycsXXfNovtnVJGC4hGuBIn9U="'
  },
  json: {
    email: 'bb1a9e99429c4db28019@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="KIs1bT", hash="fm+KcqhgZwXZ5ycJIRqYoJxDBmsRUMbQIguKuEnPH7U=", mac="Ns+C/ego96+1IpqQqr2CHSuO5w7BkkkZyc/VmQtKQmg="'
  },
  json: { code: '400072', email: 'bb1a9e99429c4db28019@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="F-wG_-", hash="YnD6JW0hH7TTklwzd8J1a1SAwij2PsovFQpWuBMD/S4=", mac="/8+63zlAp30qNAejD0eH+/r2C/13F6MyinaYCbKGUqg="'
  },
  json: { email: 'bb1a9e99429c4db28019@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8ef30d5a73697bcd5befc5dcc568311e74db62e5f3dd0039b33d14e007d2cb69", ts="1705108838", nonce="7XWKPP", hash="vSiWYTOOMpGzwe+hdXUUkJLZQx1S4WThh3QsHZrXNg0=", mac="VekVzA0CoONA/cMRUik0VTX/NoYVRaGrzKplv10534I="'
  },
  json: { email: 'cc00ab53e66fe984d803@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="nyWEGY", hash="/9F5XuVZE267WSzlxruSqwiV3z/Ff457mo5jplS6RnI=", mac="Q3Wbcd495abff4C0lFJzJ7Qy5tlw6cj3GNuM4HDxDm4="'
  },
  json: {
    email: '25e0e1ec4ccd90486e11@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="zY6M6_", hash="jp46o0vDG1qKYNRsBGKgCgXm+Jl625/P79VAyV+6qFs=", mac="u3gxMr97eNReWIE32KNCjWcPdyIslK21TwaMHN1n+1I="'
  },
  json: { code: '074304', email: '25e0e1ec4ccd90486e11@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="FmmVVx", hash="/9F5XuVZE267WSzlxruSqwiV3z/Ff457mo5jplS6RnI=", mac="yUYD+zGN84HC3gVdXv7PnBYfrc25Z2kEWKhLrcdc7Xw="'
  },
  json: { email: '25e0e1ec4ccd90486e11@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2ab6795326fcb52e08e3e6b5cb91ba707890a19b314e0368d543fb140ad52440", ts="1705108838", nonce="nwuIlI", hash="5JLzQDqNlozyMZQeD931H7hJFXTDfNkvkKt429yx2Jo=", mac="vPFHV329k0wgao5wUcSTtOnVrqWvKGSNIgu/TUWL1ws="'
  },
  json: { email: '0577ba853d9076aa1202@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bb1a9e99429c4db28019@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3af14f4ea200327070ec4e37e11a9acbc30b870822cd7193fcaadd039c7940f9',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3af14f4ea200327070ec4e37e11a9acbc30b870822cd7193fcaadd039c7940f9',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3af14f4ea200327070ec4e37e11a9acbc30b870822cd7193fcaadd039c7940f9',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '25e0e1ec4ccd90486e11@restmail.net',
    authPW: 'aa47742d26b8e8a005cd5c4e760e75f240cee6f17f728cfe9298cb7e99a1fab6',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'bb1a9e99429c4db28019@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fec54b899d6f442f85f66bdce4b9bee2',
    sessionToken: 'ec5662dcb02c9492d437b062469d70f014be1b203dc599b4447beaab83ca9fe2',
    authAt: 1705108838,
    metricsEnabled: true,
    verified: true
  }
}
    ✔ change primary email with multiple accounts (1865ms)
    should change primary email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a778f6951ce646a10026@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a778f6951ce646a10026@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a778f6951ce646a10026@restmail.net',
    authPW: '955a6d2116ab5c3d1a67bfacd3735c2e3f0bcbc9c55541fb1a759cce9df01971',
    authPW2: 'a1ea5da3af6b241549aa01936df5ede0d7c7233fcbdbc5b471313f7b8f7c8964',
    wrapKb: 'a9e947ed5ea1128b0b32de03f4f3c32fb7789b0b8f8d95582a113ba38e583ca2',
    wrapKb2: '0c5cf943ab460c96620aa5e8dc9e8535c4b843aa6d85fd0780411ed5de592f7f',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cce02dd86dd73c3073bcd64b3179cd7acd98c99bdccb03c481c0c401ffbf1303',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '052adbc6f2e44aeaba7d881a96e0bc8e',
    sessionToken: '9af4eafbef233a217e6449ae0404c26872d69f684e2d26ef4d0cb95bee2fc225',
    authAt: 1705108838
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '052adbc6f2e44aeaba7d881a96e0bc8e',
    code: 'dfd9f91a73046fca180c0e9e198abea4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f0271a21e8d285e74c8cadb4d3d2cd6bbaca8447293231e7a8c9840476f60e45", ts="1705108839", nonce="792Y0A", mac="TKvqXGZN7KFWVMRfBKLTrE9ckb32AzVv3E0U7Xqlbr0="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'a778f6951ce646a10026@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f0271a21e8d285e74c8cadb4d3d2cd6bbaca8447293231e7a8c9840476f60e45", ts="1705108839", nonce="Dv7GLf", hash="0UWW7V2I+xEiUT1U3hXyQfee/Srf3fr0LBaXr4QodHg=", mac="/+uv0oZ2SRENJxsRTQk2y7iDv4krw03/o5DfU49NNf0="'
  },
  json: {
    email: 'dfd1019f235a58637920@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f0271a21e8d285e74c8cadb4d3d2cd6bbaca8447293231e7a8c9840476f60e45", ts="1705108839", nonce="yNXj9c", hash="dvHeoX6Wt6u9TpF4p6defRmpNH1tLHc6GL5RxkBmT+g=", mac="82n8L+2Gmg5I+/lJodHbr/69/zkmZhUL1rjlKGO1Ry4="'
  },
  json: { code: '715147', email: 'dfd1019f235a58637920@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f0271a21e8d285e74c8cadb4d3d2cd6bbaca8447293231e7a8c9840476f60e45", ts="1705108839", nonce="9j0qNl", mac="Kw2VDoJTHyuCGl2JWk1AEy1037PaDzOfbzCDSFYZ2es="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a778f6951ce646a10026@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'dfd1019f235a58637920@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a297f18ed7c4b27f87c2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a297f18ed7c4b27f87c2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a297f18ed7c4b27f87c2@restmail.net',
    authPW: 'bef6d8af46071da8f5cf5e4a287c5433b867eb3ec5de7fa0ecacf03c4cfff908',
    authPW2: 'b4fd91ccf79f4bf5508e00a5458826c32e015274aa1a0fd5c3f644385635ef0d',
    wrapKb: 'b2a18ccb38e653a5b5d8f55dc49d198fe96e66d947056190557d78b85a96e825',
    wrapKb2: '7d9c3e1efd5d6b4c0adc530d833566e7500d1d5df1c21184fdd3c4d9753dd14e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5e27e694f160b0759e770e4054bbc3fc1eb3464cdd152818230f9c717ba79764',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5faae9c2591649b9af38ff766138f0e0',
    sessionToken: '8be7b5c953bfd5ff8a4503f9241b71b4891e2ccb5b4dfb0fa168d68d459010c1',
    authAt: 1705108839
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5faae9c2591649b9af38ff766138f0e0',
    code: '529bd91f65e0e5b3cb45945d468eca39',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="873da003a0e4b3beae0dadb2a041c9b5892895dd04e0c483bd75be15dbf31776", ts="1705108839", nonce="6xOjx0", hash="aIl3I81ltts/P9u9/avN7HndMu9It0DbTVJCzadDwp0=", mac="YFeqDiwBIex9oxry9Zr7op+Z8M+9SBy7Plo87ZNS5xM="'
  },
  json: {
    email: 'a6a2edc8fc50a457cc7e@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f0271a21e8d285e74c8cadb4d3d2cd6bbaca8447293231e7a8c9840476f60e45", ts="1705108840", nonce="Vs7Q2L", hash="aIl3I81ltts/P9u9/avN7HndMu9It0DbTVJCzadDwp0=", mac="jrRebM/xFxNk49/Ou2d04VfMdkbngYCFr9vRJKnKPOw="'
  },
  json: { email: 'a6a2edc8fc50a457cc7e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 148,
    error: 'Bad Request',
    message: 'Can not change primary email to an email that does not belong to this account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to change email to an that is not owned by user (508ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f2c35479715b27d161d8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f2c35479715b27d161d8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f2c35479715b27d161d8@restmail.net',
    authPW: 'b9b5b409b2bc6f82b42891314a18c04de5b4efcc50999397d395c36b583a3c21',
    authPW2: 'fb13da2cbe6b4b153899bb8cd592895f385a4c53c8c1ecb37865dd2f3c58b4c7',
    wrapKb: '7f90d9e45a2ca702315cb022f31a98a1a5cd07f1de45716d832bcbd6d762251f',
    wrapKb2: '81195877b5c36f0bdcd0148bc02ece62778eac9f800bf67dc7f3fe0ed05ae11e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5b91dad99aa697744002c578f3845b6bbc1b6d9f1a41a97f2f269d16bffb8aed',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c5dbaf988ea24a41b6e8539d806a410c',
    sessionToken: '2282e3e2b3e1de7e75848f2829fd38232d16eaac76234fdd710e31e4d5e14194',
    authAt: 1705108839
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c5dbaf988ea24a41b6e8539d806a410c',
    code: 'b8ebf75058b65b32a8a0a5b96077594f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="9RSA_U", mac="slS3+ldUi6Gnc4kkwtp6IGOo1TpcBxQtRpdLdLE/NZE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'f2c35479715b27d161d8@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="5yBJBh", hash="pNkoaefSP8vinCXP2Y6bOkMz0UlvzaXhJKG9rdsHKkI=", mac="jW0uXJkmHEOYg45gkLax78WqVIV86BC9D8DDzfpWF7w="'
  },
  json: {
    email: '9a3d17975af14f06043b@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="Yu4ag2", hash="XaPZiMn7YUsxsYuujvefAT/Mca8eCNr0vmFpQGIbu6Q=", mac="ccnk+4PaqaxDesPDTVhH4cjS0wuZin3IWGb3AzZwnO0="'
  },
  json: { code: '563514', email: '9a3d17975af14f06043b@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="cqkwzE", mac="ygkaeLtpbW/oGtFSmjcRLVmAlxWTDnEY/x5FEHDFhF4="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'f2c35479715b27d161d8@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '9a3d17975af14f06043b@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="HDLvhp", hash="g+xfXxXvRjaqx/4vDzArMLbAte0x/H5lm7cLbuXuKiw=", mac="6NoQsnC2YqILjOBFg6DRNRD5zpx0/U9WYo4MqjpBigI="'
  },
  json: {
    email: '518b3bf5ed805c142203@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b3a04501157367d9513b0d6a14da5064b4398b208bbf30cb1e00cb7ba45381a3", ts="1705108840", nonce="KJhvhr", hash="g+xfXxXvRjaqx/4vDzArMLbAte0x/H5lm7cLbuXuKiw=", mac="9+JUnBz10CrLIU8OTaet+BUZii1m7B/Dva2sVaUemJI="'
  },
  json: { email: '518b3bf5ed805c142203@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 147,
    error: 'Bad Request',
    message: 'Can not change primary email to an unconfirmed email',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to change email to unverified email (41ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6a361a76d0aa8c93fdf8@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6a361a76d0aa8c93fdf8@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6a361a76d0aa8c93fdf8@restmail.net',
    authPW: '2f86e40db0efdf4e2a8b45ad5112c217d7849fd011f523ea944d05f168f36b2d',
    authPW2: '2bd0b6d5d6f50f3e11b18241246c568cf097b389b907cf59a796ac2e92b552b1',
    wrapKb: 'c5be606487caa74c6b69e05db9f4c3adddf9ddc4a70e80583a839f3927384ac3',
    wrapKb2: 'e8dc61c39191b54e1fd45866136fe423963a3a93001246240ef34c959eed2a61',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c2dc41d9f5ada72f0d24ea4fab52bfec261b9700768aec63d7a6130639cfb18b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e543032b0e384f52958ecb8e234921c1',
    sessionToken: '9a20c99c63e1f7b453ee3c16bccb6f2aafaa7da7310febe1b8008b62d58f69b3',
    authAt: 1705108840
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e543032b0e384f52958ecb8e234921c1',
    code: 'e08ba1ad45a9a4fa5525c6fa85b66b1c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108840", nonce="GvdZoW", mac="oBvi/Gcwh8JmIpnZubMl2X/rdKKpnyK5t1XjVYMo8PE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6a361a76d0aa8c93fdf8@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108840", nonce="YY0hDi", hash="hu9z1OFXJOCFAZVAZTI1XPIei7s5g4kHwLlMjrc2QnU=", mac="J9J734BrsoGakk3iBoVv9JPSh9VqPY61VJDlaC25MG0="'
  },
  json: {
    email: '39dfa4d84cc5712d9173@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108841", nonce="Jka5qD", hash="zbhiY7TAh584Kg+snjq/4LawG/Cubn4BUj7fvYdDsiE=", mac="DoZ/YdRsIW6MohRQcKZqo+dtbOiwfc84tp5Tm4Vv3PU="'
  },
  json: { code: '508775', email: '39dfa4d84cc5712d9173@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108841", nonce="3W9iSp", mac="U3ABpj4hKgWbjP2RKudwnoo1PubFWxR60m0NMUsSBNg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6a361a76d0aa8c93fdf8@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '39dfa4d84cc5712d9173@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108841", nonce="aWZwsZ", hash="hu9z1OFXJOCFAZVAZTI1XPIei7s5g4kHwLlMjrc2QnU=", mac="siV84Fr0xBmOYYTKCPdsbhk7gnrca1kPj1Ad8aKgPVo="'
  },
  json: { email: '39dfa4d84cc5712d9173@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="002e9b2eda90f40acfb06ee759900d80fcb42f6c94255f2da1da2133b9602bb3", ts="1705108841", nonce="rVAyeD", mac="WWMvRn17VJp2fvqvtXyzAtLG9RmiSX7ehcu+38PG3Cg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '39dfa4d84cc5712d9173@notrestmail.com',
      isPrimary: true,
      verified: true
    },
    {
      email: '6a361a76d0aa8c93fdf8@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can change primary email (49ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0b446a7df34deb6e5778@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0b446a7df34deb6e5778@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0b446a7df34deb6e5778@restmail.net',
    authPW: 'cf0842e98f8eebe89044532c53c11c0095a6128626f9a9bf93c53815f8e8b6fd',
    authPW2: 'f898471e8a11a88828bbe15cedddaa4c9a5c3225b002a35377f4b5606c3fa11e',
    wrapKb: '4cc8799a56b4f84639074ad739270b025a2e7e126958b1c3f57fbc877fbf5845',
    wrapKb2: 'a1e577c70a5bc41003c35d2648673d05ab02b050117c423b293aa7aedc016158',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b2973631ebcb6d4d76ccadacafe441e001974bffedbdbea1b29521186381d9af',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ea2ec7ccc0b4463381040291833b9b1a',
    sessionToken: 'c813fafb157cda0ddfa9c93f518cca3cd3e7ec74c2725e5acc97de2657cd57b6',
    authAt: 1705108841
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ea2ec7ccc0b4463381040291833b9b1a',
    code: 'fb78a1b8bd8398ebdffe458d603ddddc',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="74ec345de2fbd53f2a1fb1bc29830745fd4e70906a023f066d76a089b5af9dbc", ts="1705108841", nonce="kHcCSu", mac="xbrZb2xSCh24tVfiXHzdzY7xlmXwEY4Ieq42toJ8tQQ="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0b446a7df34deb6e5778@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="74ec345de2fbd53f2a1fb1bc29830745fd4e70906a023f066d76a089b5af9dbc", ts="1705108841", nonce="U9BwO3", hash="gChWu0tiK9aGot9iyH5OfMbHJGTQXd6FjYwdjiLFUJU=", mac="2jFPrw9T+KuK/TmWv7NV7XTVGDzF7B+THZKIVt0DjMI="'
  },
  json: {
    email: '815247bc9326ad776809@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="74ec345de2fbd53f2a1fb1bc29830745fd4e70906a023f066d76a089b5af9dbc", ts="1705108841", nonce="DPG2-a", hash="YZ/BxW6iNBKj4e8DqKE+FTvkcwRgU8EnCm5MFAPyGW8=", mac="EpaJo05XTJcH1yYudpjvrL/IeG11PabYYAR1/mk/vUE="'
  },
  json: { code: '341445', email: '815247bc9326ad776809@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="74ec345de2fbd53f2a1fb1bc29830745fd4e70906a023f066d76a089b5af9dbc", ts="1705108841", nonce="WRcgwL", mac="nig3ZgMXy2xbXpIFn6cLJLp9nuMYXNdRnBEPED4Ulog="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0b446a7df34deb6e5778@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '815247bc9326ad776809@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="74ec345de2fbd53f2a1fb1bc29830745fd4e70906a023f066d76a089b5af9dbc", ts="1705108841", nonce="Ellg-n", hash="gChWu0tiK9aGot9iyH5OfMbHJGTQXd6FjYwdjiLFUJU=", mac="JLJkoar1dw/wB+bfzDcybCUeei7kpwi9MrjVgc7Rwio="'
  },
  json: { email: '815247bc9326ad776809@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '815247bc9326ad776809@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b2973631ebcb6d4d76ccadacafe441e001974bffedbdbea1b29521186381d9af',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b2973631ebcb6d4d76ccadacafe441e001974bffedbdbea1b29521186381d9af',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b2973631ebcb6d4d76ccadacafe441e001974bffedbdbea1b29521186381d9af',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '815247bc9326ad776809@notrestmail.com',
    authPW: 'f898471e8a11a88828bbe15cedddaa4c9a5c3225b002a35377f4b5606c3fa11e',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ea2ec7ccc0b4463381040291833b9b1a',
    sessionToken: 'b77514c185ffacc61562af83738bce99d27c85778fa316f8bfd68b4331d77cd0',
    authAt: 1705108841,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can login (376ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '498a89090a7ead0fe5c3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '498a89090a7ead0fe5c3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '498a89090a7ead0fe5c3@restmail.net',
    authPW: 'e6e0a737d99992639695be3b7a9ea52a52f821b91dff5a2e3fe065d9ef72dc06',
    authPW2: '153881af118f319aa60263f8ab41de00fa9a0da11cd205e929332af48ede9030',
    wrapKb: 'a7ec791b5f2281270d95441dd0d9a6a14ccd8cc5b7640e24c83656e895d798b2',
    wrapKb2: 'f709053ef1b7c6b673122bd4bf6b2ff48f9f3dc65ba158add179424e8af74546',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '198ae62f259c427bae599405eedbd05b',
    sessionToken: 'b00befebdfebcc0746598c8d4b5ebfd889aa8150511813d7248ba6cdb709b0c6',
    authAt: 1705108841
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '198ae62f259c427bae599405eedbd05b',
    code: '46390eeae8ea6a59cebb18cd443f1e7f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="adda526d97e75db944991e8f93aa0b8cc723ae65c67b2e73e72c6b0198cb5c52", ts="1705108842", nonce="44hfQy", mac="zNaN90XuYBp/b/HKfhjLWVCP0apnDoJN1ecaZe1oPG4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '498a89090a7ead0fe5c3@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="adda526d97e75db944991e8f93aa0b8cc723ae65c67b2e73e72c6b0198cb5c52", ts="1705108842", nonce="A02Jep", hash="rNO4EHJz8ifcQ4Jf1Fm3+xObxYbeGEBAAw3UPUTPt9U=", mac="JgtprynEuNYMP+pUgvjQostuvlAB2esp07k++bCtvJc="'
  },
  json: {
    email: 'bbb50e787509409930a1@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="adda526d97e75db944991e8f93aa0b8cc723ae65c67b2e73e72c6b0198cb5c52", ts="1705108842", nonce="3pOLFA", hash="k8asmi3t3nREApegGYCONj3jXEFGAkknOwf6s99dr98=", mac="rLcPwSUkAB64Be6Sns8TUpvIC5Jkh6RlUlcXG1AQ9S8="'
  },
  json: { code: '934289', email: 'bbb50e787509409930a1@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="adda526d97e75db944991e8f93aa0b8cc723ae65c67b2e73e72c6b0198cb5c52", ts="1705108842", nonce="lH_gQd", mac="Qn+MQ68XOBmaS2mfTj/jTbR/5qqVnTaDsjLfiZyjz6o="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '498a89090a7ead0fe5c3@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'bbb50e787509409930a1@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="adda526d97e75db944991e8f93aa0b8cc723ae65c67b2e73e72c6b0198cb5c52", ts="1705108842", nonce="Qj421X", hash="rNO4EHJz8ifcQ4Jf1Fm3+xObxYbeGEBAAw3UPUTPt9U=", mac="MmFuuTboiagolcJE8Ry56pjt3lclcYg4WDAdTz+5Syw="'
  },
  json: { email: 'bbb50e787509409930a1@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bbb50e787509409930a1@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '498a89090a7ead0fe5c3@restmail.net',
    authPW: '153881af118f319aa60263f8ab41de00fa9a0da11cd205e929332af48ede9030',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'bbb50e787509409930a1@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '198ae62f259c427bae599405eedbd05b',
    sessionToken: 'ea98d5dab89cb6fb7dbb7556969b7f93589fc456a4871eac90a07805b40b2049',
    authAt: 1705108842,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '498a89090a7ead0fe5c3@restmail.net',
    oldAuthPW: 'e6e0a737d99992639695be3b7a9ea52a52f821b91dff5a2e3fe065d9ef72dc06',
    oldAuthPW2: '153881af118f319aa60263f8ab41de00fa9a0da11cd205e929332af48ede9030'
  }
}
!!! response success {
  body: {
    keyFetchToken: '22e47443377a555ed48a6dd87806500eee4cea98757b6323b809fe618d9d7d47',
    passwordChangeToken: 'cac9c96f04d279c7475fdd5385ed46a0fff3e4485166da399da5751953ab08c6',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2bbdd0e94b7f68ee8c681e35b95d1a948cab05b13c3a332e6cfabde3575c8915", ts="1705108843", nonce="qod6k1", mac="y8z8RNV0Ke6SH0muVobVZ7bvw9fVQdK9I7TRmT7bJQw="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '35ce6e510aa30969e2c73f854af4c11a7b38ccf5c3a10e184a0f83b788d9f5b6099205e5a53f32f02ed7ccdad9cbca6ee4b91c90c85d4b0e927fbb4a62bfe13b9982c191548be843329c04e4764ee5924bc4da1add6ad25ef3dc6e8ef50812b9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '498a89090a7ead0fe5c3@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5797f18be7e29edad5f67bffa21f55b7ad2dc958b4437cee1e71ca41e2e93772", ts="1705108843", nonce="XP4aJn", hash="D6xJ0kC94rp2EH2Akg8FfjdYWcJiWzcpONLo+f8YHco=", mac="U4LJ4+Udn9AgNnypuPVS7HgqSaHS1RjludbGTfBQ8xM="'
  },
  json: {
    authPW: '646a4d941e531b6cb333215cbf24b4fecb4e25b6d4af73c1d86774109c4d09c9',
    authPW2: 'e5ebdd7e8ed813b39b0a9b9f6ccec22fb63df0be33cae853089e94cf63afa2e7',
    wrapKb: '2aaa2ce24366b5dd6d20bf436302bca7414d776620220047f7f91c2de2419b08',
    wrapKb2: '479bb92d0e617b001bee9b715e8b99692a90ffb9ab0afa5f713e05ea87bcf4bb',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bbb50e787509409930a1@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:29dc2a1a7017b8ea178a0b3121a669459988fd54c3d3109681fa292cd4b4ca05',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '498a89090a7ead0fe5c3@restmail.net',
    authPW: 'e5ebdd7e8ed813b39b0a9b9f6ccec22fb63df0be33cae853089e94cf63afa2e7',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'bbb50e787509409930a1@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '198ae62f259c427bae599405eedbd05b',
    sessionToken: '6d563b665f268e3fca466db0a632176050dde5d418f4d45b76d8624d872e3405',
    authAt: 1705108843,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can change password (1447ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6b3b4d329ed79c55ae91@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6b3b4d329ed79c55ae91@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6b3b4d329ed79c55ae91@restmail.net',
    authPW: 'f13d2501066bf1e2a9dca7edddd9c98f28ead77d07409b06ae3f115ac23e12c9',
    authPW2: '9b93bc5ed4ab41ea01ced7b21498db591a1790a52244415d152e3e9fac9033be',
    wrapKb: '48800c3d1ee0d96e1850e48395753de01fb2d51842f5a21d4a38348ce18fcede',
    wrapKb2: '98cd84784b6cd3dae8aa0b961ba9054565215247bc26032e1e4499cb408df1e2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:64f636fcb474f49b12288d22811e429ed2307c2614c39becc9029aaf5fe28825',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd921e9a3430140e785bec545d2c4d24e',
    sessionToken: '083aa2de078eb238dd2f988ce63bee975cb2a5dabbd3579b43a400c0d2f8a972',
    authAt: 1705108843
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd921e9a3430140e785bec545d2c4d24e',
    code: '43c695e609ec7747e7abeade8bc9ccc7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5bc68b4f272e9551fa4ecfa6ba91a6e3afc06a7cc846c9412d8c3190e4b58a43", ts="1705108844", nonce="csAzlQ", mac="y5J/PYzXT6lv20k1EuU2a1jRf261EspEsxQCcwz4BB0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6b3b4d329ed79c55ae91@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5bc68b4f272e9551fa4ecfa6ba91a6e3afc06a7cc846c9412d8c3190e4b58a43", ts="1705108844", nonce="9vhzxF", hash="7RhpLKOx6ddRFB8XYs+lCnD/hyKSeikqlZtfn1bt2hI=", mac="gn6lH6WpK6SMlQcJH6x6UK+QP6rsQWRF4O85aDAL8z0="'
  },
  json: {
    email: 'ad32cd746018dbc0e3a9@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5bc68b4f272e9551fa4ecfa6ba91a6e3afc06a7cc846c9412d8c3190e4b58a43", ts="1705108844", nonce="BvEM90", hash="sBO3WPbmvr8ofCnnXLNSJhWFqts1jY/n/69Bf09Uvic=", mac="bYdylHBASIQWxiGgOUJuetKyatfgvHq2gDEaDnZh1F8="'
  },
  json: { code: '321126', email: 'ad32cd746018dbc0e3a9@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5bc68b4f272e9551fa4ecfa6ba91a6e3afc06a7cc846c9412d8c3190e4b58a43", ts="1705108844", nonce="aV_PtI", mac="ogTopQrOi+x15WOARjwT2FIaCwZik/n14vAMAbspfwY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6b3b4d329ed79c55ae91@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'ad32cd746018dbc0e3a9@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5bc68b4f272e9551fa4ecfa6ba91a6e3afc06a7cc846c9412d8c3190e4b58a43", ts="1705108844", nonce="uSIRhE", hash="7RhpLKOx6ddRFB8XYs+lCnD/hyKSeikqlZtfn1bt2hI=", mac="5kUGn7EIW954QzBONRd5jlWFAZqqMZs99DxOwmL6Tak="'
  },
  json: { email: 'ad32cd746018dbc0e3a9@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ad32cd746018dbc0e3a9@notrestmail.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'bd72baf80154bf49dda56a5b1509b7733d59ad6e987f749d9b1cff8d1d6606e6',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="84287b39057b802077f76ce3ceeaa3b3a68d708556f16b9f534d1e29a2c28bfc", ts="1705108844", nonce="dSLqFo", hash="SvxRInVYCjRrfkuc/XcIdZHHHKs9epVSMtkHkj9HEg0=", mac="74//caSb+pYY2eaKK+mc/4CgZy7h7sf3fH/7Dh3BFYU="'
  },
  json: {
    code: '647ab91a3a20d588f4b022b6e179fbaa',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '2f00b3a5da7d08ab56650c655ffad783f4d884c3d7ac3b25f85fcfeb87d70c5a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a26940a4a4a98e8178cf0fa82434538103c46881f111ba87b10232666fc6c406", ts="1705108844", nonce="7pWSDn", hash="ROncKdjcclmb5fwHgc5cLxU9Jv2Lylo70Ik0/09bJ3w=", mac="dMrwy9RCzWsmqJg+GgnbhIFCsu6cupA14im1SLYB6rg="'
  },
  json: {
    authPW: '941fbbe03d8c3525771fe775d32f572bfb2968d6d5b16a25c69598c2030be583',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'd921e9a3430140e785bec545d2c4d24e',
    sessionToken: '6e7e650efcebe0811728dedbc8a22fc2f2844c1de88ad4c81c2fdbd3fd8760ab',
    verified: true,
    authAt: 1705108844
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6b3b4d329ed79c55ae91@restmail.net',
    authPW: '941fbbe03d8c3525771fe775d32f572bfb2968d6d5b16a25c69598c2030be583',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'ad32cd746018dbc0e3a9@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd921e9a3430140e785bec545d2c4d24e',
    sessionToken: 'e9a30915c1774654698f64016e1b43fad9640810aeb8edcbf044fa7028423645',
    authAt: 1705108844,
    metricsEnabled: true,
    keyFetchToken: '05e18319abe27c414828fd4918e420d9b848afbf8ea2aa54a4ebdf3ab9f9ea1d',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '6b3b4d329ed79c55ae91@restmail.net',
    oldAuthPW: '941fbbe03d8c3525771fe775d32f572bfb2968d6d5b16a25c69598c2030be583'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'f8f96907a1f4289b52d1b8b8af1b985bbbda0f1eafaae5db1f08a635b63d3ce0',
    passwordChangeToken: 'acef6fdf1b1ba650390610cfaf14d0699e2edeca335ffb5987212cce3f08971d',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="53dd0184990b3c8fc5797f6ec0aedba5494e66defa8121eada6538c76f9ab85c", ts="1705108845", nonce="6ieZ-Y", mac="JDbXDzNPKoYO+RfgjwVh7FDlLh0hsylUwVIoDgEWGE4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b57b5f1a4cf93eb98a7cba2cf37f34ac0e5c1a510e195c1d6de7be265d9f985c8b389d8775b5284d6de92314c0f421c263fca2954bfada2299584671894e3bd5db3758ee04a876a5fa6a474eb96db112d338d3268639ab9b5f59e1b092c3cf73'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6b3b4d329ed79c55ae91@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a28782708cd708b7e44438bd49dac0ee4c3de20042b81ba0b08079e714cae2da", ts="1705108846", nonce="vS3iMx", hash="dt0z5bYGKpTlOzg5DbnykI1P6hQsMQqiKUK9jeAcojY=", mac="sjuRupnnWHLZBpmytwK9AdnkPjXvd33Y5lxUSwm8Lhc="'
  },
  json: {
    authPW: '941fbbe03d8c3525771fe775d32f572bfb2968d6d5b16a25c69598c2030be583',
    authPW2: 'c9db318f23e11eea9d5d5b30cc07000f54c08f905698aeb42b046c8ba62550fa',
    wrapKb: '67bd27c758b0a92c5828b0ffefd8490e090ba74282c62fe5748c8b160bf1904d',
    wrapKb2: 'fc603c4211a307f8d2288888f99f5018846bbe52cea2a4ff215e2a28cab512ba',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c93d9bb5e656f5607a4b1dcc23fd6031eb5e1f6d09bb2f821642d6ed2dfbd0ac'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ad32cd746018dbc0e3a9@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c93d9bb5e656f5607a4b1dcc23fd6031eb5e1f6d09bb2f821642d6ed2dfbd0ac',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c93d9bb5e656f5607a4b1dcc23fd6031eb5e1f6d09bb2f821642d6ed2dfbd0ac',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c93d9bb5e656f5607a4b1dcc23fd6031eb5e1f6d09bb2f821642d6ed2dfbd0ac',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '6b3b4d329ed79c55ae91@restmail.net',
    authPW: 'c9db318f23e11eea9d5d5b30cc07000f54c08f905698aeb42b046c8ba62550fa',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'ad32cd746018dbc0e3a9@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd921e9a3430140e785bec545d2c4d24e',
    sessionToken: 'fe2c399ab4f9994b4afb9128800b5fc7bf2307745798bebf2f1f64e6ab9f3ed7',
    authAt: 1705108845,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can reset password (1565ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'ca17bf7a6967fc85c3e1@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'ca17bf7a6967fc85c3e1@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ca17bf7a6967fc85c3e1@restmail.net',
    authPW: '2f50be3b6ade7c744440b5bc0c4507ba520841c205055b7ea11259ee26bdf9e5',
    authPW2: 'ab5cc2b1d6bb2af337058c6c95a8d6f95d3d453a474311dc135ca84de535232f',
    wrapKb: '20b399593f962f45535f00f665af78dc53b63eb37a8647ee67b093a09c5ea9be',
    wrapKb2: 'af1e839d83d986214a27c18b6d1c074b18572346d951d8d09fb1891fc9c7df05',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:de25300b0669b8c49c107cc2eb1dde717467616877ab1502354a144492e824a6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ce463f43e97e475db32add387b1531a4',
    sessionToken: '017591bc0794cdda1a6318897181026f2703c61c496fe6cba9646261dcc24d00',
    authAt: 1705108846
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ce463f43e97e475db32add387b1531a4',
    code: 'b60313306d205f5bf790f3c8fd5863d4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="bzlD3p", mac="rHZhu2hjB/GxIqRm4UEYqBLpu10ozfHQCKpLvyB3/Ao="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ca17bf7a6967fc85c3e1@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="gW1zCV", hash="iBkCe1zZIFC35ta3U8L4HZ6It4JR+TxQ2SXybXZim0c=", mac="e1oOMYNdyPv20jc3cVIFIkgIrYslmd5kxYeAO7idvgU="'
  },
  json: {
    email: '1c96744b1ef7bf2b5cc4@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="C472Y0", hash="I/HNmn3liM7gwYFh2puSyjecW/3n1XucBM7Dukf+Tfc=", mac="ykv447N/6KOGupsPqIpFqytFFexyTv6hKBYYkMn/NCM="'
  },
  json: { code: '410771', email: '1c96744b1ef7bf2b5cc4@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="s0_98G", mac="E0uN09EBc34rTXM5qVdnBCMkfEaUma7r0JQhle0cjcY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'ca17bf7a6967fc85c3e1@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1c96744b1ef7bf2b5cc4@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="2bGa6R", hash="iBkCe1zZIFC35ta3U8L4HZ6It4JR+TxQ2SXybXZim0c=", mac="k2ma7a/j6/DYyNFS7oyiSdmyKYm1WYAkKhIfT4hmJnc="'
  },
  json: { email: '1c96744b1ef7bf2b5cc4@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f7532383e753463660996c4c86d1269ae5ab2ff796db701c01ace673b26fccc9", ts="1705108846", nonce="qbOy5U", hash="216yaECXPe9b1qvxzNIKlQ94Z8ZkrK5V2pygVM2Cp0M=", mac="FZg20wvgrBBuhWCWU55h3A+CiaqErmXHXZicZU66LhU="'
  },
  json: {
    email: 'ca17bf7a6967fc85c3e1@restmail.net',
    authPW: 'ab5cc2b1d6bb2af337058c6c95a8d6f95d3d453a474311dc135ca84de535232f'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1c96744b1ef7bf2b5cc4@notrestmail.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1c96744b1ef7bf2b5cc4@notrestmail.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ca17bf7a6967fc85c3e1@restmail.net',
    authPW: '10407160b08285c825c9af1238172081f4a66ca98045764a13e10c530fa73e92',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '1c96744b1ef7bf2b5cc4@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1c96744b1ef7bf2b5cc4@notrestmail.com'
  }
}
      ✔ can delete account (382ms)
    change primary email, deletes old primary
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd65cba820eedfd7dda8a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd65cba820eedfd7dda8a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd65cba820eedfd7dda8a@restmail.net',
    authPW: '0e0514e75a78fa2170e6412f80a828260b81f3f808db55f82262e86637dc798f',
    authPW2: 'd9e8a9c3c1dbc46e12bfe26e340eb258baa74350afc7481544c0649fa5da8aff',
    wrapKb: 'c057ca853f4e30193138cda285bcf8add4ab54d29760b249728a2f73faa36cf6',
    wrapKb2: '979dfde5d6f30b1f9c3695aa0eb84b16bcd64bbe9e87d65801629a83e52f105e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6c3cb8b28d337cd4e1956dcd86a44cce2cb1a0f8502c203073351e528388100b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '875aa903019c49f2b2da4a74c6dfe528',
    sessionToken: '3e05b97a586e9c92e969175ce2535abb7a688926b436b687d3779d1ba32b9c69',
    authAt: 1705108847
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '875aa903019c49f2b2da4a74c6dfe528',
    code: 'd29147b337fb89112b8c81beb56008bf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="oRQ0Qx", mac="My010EwpGa6DuCM6tbpUK4YpmTLL/oy7K06UBevZBvY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd65cba820eedfd7dda8a@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="Aoe8gu", hash="oEb1J92pmIeGxKbb3jtEdXknu6Ak33N3IjCUqDCmsZ0=", mac="J5Aqv1qaEovQUuCcoraifufc+9sxIcyF2gRdniMIl/s="'
  },
  json: {
    email: '1ecd2362e4fa660e9701@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="VioGej", hash="NALkKmWeQcEpPIinG2vVSPw3eXgo4RbXSkPpiu9qaEE=", mac="NaIMIlaRNy+wSb3GFqaAawHGFRX5WUfzfJB6+NuD0KE="'
  },
  json: { code: '631056', email: '1ecd2362e4fa660e9701@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="lbWppA", mac="kulVhxTz0eTWyUGLQrzeF/ErTT3mitoqiaxs7Z6dsAY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'd65cba820eedfd7dda8a@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1ecd2362e4fa660e9701@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="6DcMpW", hash="oEb1J92pmIeGxKbb3jtEdXknu6Ak33N3IjCUqDCmsZ0=", mac="orWI9LY656tlVFhpbsgOvJuwkNecedV+LbH/SgjRl6w="'
  },
  json: { email: '1ecd2362e4fa660e9701@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="3akARW", hash="dy2FtfPTRrvKWlRrzHu2LVxw3qPTi8tZtjZd+sor/2o=", mac="vEh3HQnoCKJSwESElk8VJoNwgGkn8i3BwrKEMZ0hfbU="'
  },
  json: { email: 'd65cba820eedfd7dda8a@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1487017569a3d77d9e5df5aaa814f3896f45f045f78181491b75d029685b3039", ts="1705108847", nonce="qlmD44", mac="RW1Yg9QN3eNcgXzvtTOJKACul46HjOFA11ZCiQii9bQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '1ecd2362e4fa660e9701@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1ecd2362e4fa660e9701@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6c3cb8b28d337cd4e1956dcd86a44cce2cb1a0f8502c203073351e528388100b',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6c3cb8b28d337cd4e1956dcd86a44cce2cb1a0f8502c203073351e528388100b',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6c3cb8b28d337cd4e1956dcd86a44cce2cb1a0f8502c203073351e528388100b',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '1ecd2362e4fa660e9701@notrestmail.com',
    authPW: 'd9e8a9c3c1dbc46e12bfe26e340eb258baa74350afc7481544c0649fa5da8aff',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '875aa903019c49f2b2da4a74c6dfe528',
    sessionToken: '6d4b298af4ef507cc736a03ff9e0984e59628ffe2fe26be8932537bb463d1935',
    authAt: 1705108847,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can login (353ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a3cc92487b481c206229@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a3cc92487b481c206229@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3cc92487b481c206229@restmail.net',
    authPW: 'a373d74296849dc2c93697e3fcf7f425d72fb6b410b9c729d2c6faf276a626b6',
    authPW2: '74e3c2828d5a7449c0d0c76a2691763a81a866c88289780010a9041e2f8b8874',
    wrapKb: 'ea8f25661e049c53ecbb10160f0c77095887ec89eb96840e025bdc3fa38becfa',
    wrapKb2: '1a706450076ba868ffc0b7fab3779b5f552bc09079437247f327ec4b24f94fa5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '444bd95cde5b4b8da115e255b5ba5778',
    sessionToken: '579ab3cf3abc9a1e1cf28134a88e2790e618780e0c67b389f2852fb0a7e3d527',
    authAt: 1705108848
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '444bd95cde5b4b8da115e255b5ba5778',
    code: '4cbce13c63842a1d8d941db429f15811',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="hmxi7L", mac="bnFd2HXNsz6+GgOlES2N/oUB7E5o+8Klgh94jxN9USY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'a3cc92487b481c206229@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="hrYVL8", hash="OqQDQseXZULwFdWUnvZNgwGE+GuQmlfGRnNgfP8DcLs=", mac="suoeWfvei/KriZxub9crLLVR7HoaxVfH6LnbI49145U="'
  },
  json: {
    email: 'cff875b695bd7ab5559d@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="ED1ADl", hash="F0XnzeGAsogpnSiTOVQRBm8YP1MzIFQa1mBWifJh8N0=", mac="V+7BA48PIvgb7XTexOHuwsGJ49NIPtk5kl5Q35LoX4A="'
  },
  json: { code: '115323', email: 'cff875b695bd7ab5559d@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="Pv-kje", mac="hh6dxYzi+ug+twn/jQZK3VrAvSExVYEm8greBXN0zNo="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a3cc92487b481c206229@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'cff875b695bd7ab5559d@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="R_rHy3", hash="OqQDQseXZULwFdWUnvZNgwGE+GuQmlfGRnNgfP8DcLs=", mac="JSgX0EUhas+Kw4HmP+M156mwlQ/VVD0E5he+hYL4RKk="'
  },
  json: { email: 'cff875b695bd7ab5559d@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="ohxHrv", hash="5G5EFq4JZwyahX3u3odicsDKah8bCUf+RZut+Z5C29I=", mac="hHvbM6kaVtJyf+A/lmdTZ6pr+YQDfh3vcwI+1Mg27Nc="'
  },
  json: { email: 'a3cc92487b481c206229@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e8728a2e9f031fce998f54ee0a253a03a8902657ef17f52077cdb83201092350", ts="1705108848", nonce="fBdjlq", mac="uJqXLR02dQlx8NPWjqflo2X9D+2w/sVFUJ6/Qw1OxYI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cff875b695bd7ab5559d@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cff875b695bd7ab5559d@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3cc92487b481c206229@restmail.net',
    authPW: '74e3c2828d5a7449c0d0c76a2691763a81a866c88289780010a9041e2f8b8874',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'cff875b695bd7ab5559d@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '444bd95cde5b4b8da115e255b5ba5778',
    sessionToken: '27afd7d0fe10bb4fffa5f459864dd8d1e61aa2ea104ec38875f6f0490bb001c6',
    authAt: 1705108848,
    metricsEnabled: true,
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3cc92487b481c206229@restmail.net',
    oldAuthPW: 'a373d74296849dc2c93697e3fcf7f425d72fb6b410b9c729d2c6faf276a626b6',
    oldAuthPW2: '74e3c2828d5a7449c0d0c76a2691763a81a866c88289780010a9041e2f8b8874'
  }
}
!!! response success {
  body: {
    keyFetchToken: '41b2625f9eafc91c0387b11be569466faf2d61d1391e342d7b13442000f0bfd4',
    passwordChangeToken: 'eca48e2995ea5998bcf8de8c159be902e08170c0b4dafe425ae9412ba0d88b71',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e8189e09bc7a71bbc924b36f901b09ccc35d00853ae976c9ee36191f10d752e1", ts="1705108849", nonce="wtGPl1", mac="G++ZxGSKta+u0gLZmBMNB3/sEYWcbuW292ODA438CkQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '6bf8cf323ffb279cbb1c45819f52fbee4a261d4a63f0947b4051c28f7dd636ed26da774b339869007ad21bc0a9db14b72ccf423b2a8bc0a13a3d4ba3a77d5aefb3acfa26c92afc0816a788bda3f13c019f553ae0b6023bd505ac9924a4ccfa65'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a3cc92487b481c206229@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e76d69f77c6854379ff1f8cea829f8f0ba90f791603bf19a78aabf6b76defb2a", ts="1705108850", nonce="Q91j9b", hash="t0qmrKCfrxjJfrLoMeZqDcKzpkGFaGyfz3IQIL+KUpQ=", mac="IRSat1gyalt5uMWXySIAwu8jLD+L0gpin1E3nXG2ekc="'
  },
  json: {
    authPW: '65c4cc8712ef986fe9f7a1cc272b8e07b3a396edf2e9336e5e54cbe292309381',
    authPW2: '2d966b725b1d7471fc1e399d6fc9d11a686a2bbb02135ab12ecc6892de63187f',
    wrapKb: 'd66e83b3547e718bce2e460b24e7eddd24946b8904fbd675f533e3b8313966e2',
    wrapKb2: '0a829e609496f9334f4cc43002b904ecc8d80603b16e8c1de3be19b623933db8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cff875b695bd7ab5559d@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84fc4b5d512cc069d50c7ce043dc4c4273b4fe68114c3b5fc22882ba6383f190',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a3cc92487b481c206229@restmail.net',
    authPW: '2d966b725b1d7471fc1e399d6fc9d11a686a2bbb02135ab12ecc6892de63187f',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'cff875b695bd7ab5559d@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '444bd95cde5b4b8da115e255b5ba5778',
    sessionToken: 'bb03642dbbcb98e456e2f137c5f4bef46849021d1e7e8fecae337033cb8e9065',
    authAt: 1705108849,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can change password (1338ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '168eec49a2ffe2c084cb@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '168eec49a2ffe2c084cb@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '168eec49a2ffe2c084cb@restmail.net',
    authPW: 'e811d1fabd273307731255ba9a432cfa03323d3bd75799e9125bbc540c114460',
    authPW2: '118771c87588d9a901633e624b2b55c3dee26c65aff53ba5a858824885587fda',
    wrapKb: '1ac3a11a8b366466d9778325a3a8b41bdb95ea6e037ecef44de37d441f56697a',
    wrapKb2: '9b6c9ec3263dd5e880bb4e187bd6ec2ab024dea535d5c7532d2a80c37285ca95',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:66c009b91f07b8e6e777f423abc64fb08a87b7f51b4c1bd783de91df761fcfb5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8d59841a9175423eae66493a77f7dc37',
    sessionToken: 'b72b2420089e3ffebee0e8c3bbf95d98752ec3ea464d8e3255ac462ead69c3a2',
    authAt: 1705108850
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8d59841a9175423eae66493a77f7dc37',
    code: '957c1d207fd702eed73ebd55a0b1ea2a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="e4wbqN", mac="+LgUFg8qNwFTrV2ZpJKzMBZq45Tk2V+TmBBeGOChWYE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '168eec49a2ffe2c084cb@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="qDof3A", hash="R1GwA/iAFvjkZq7ObPAROz1z1wVhxGG3aw8AexKmvKg=", mac="Ug25QGbYRqnkNQHmL6uQWw0XisS/i3mLyhQT1DN8zmE="'
  },
  json: {
    email: 'b364d452e87eabfe56bd@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="fpqTz-", hash="oj/7Z0QNKbbcj9Tn1GZPu6xNm+htINfc8X0ROtHbw/M=", mac="yYYJLUl2vm1/LFdIqG/85K/hNOeb14/QrHkgnLd2qIU="'
  },
  json: { code: '422222', email: 'b364d452e87eabfe56bd@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="kAgoVP", mac="AvPeXdDuvaZNT8Mxdo4qv9Jv5NOIOmf3ZHfDxBlnSws="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '168eec49a2ffe2c084cb@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'b364d452e87eabfe56bd@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="fjXJfn", hash="R1GwA/iAFvjkZq7ObPAROz1z1wVhxGG3aw8AexKmvKg=", mac="hk+Nh6CMNL/32hZGVW2wwbWjDQbKRWiCrfMjdBVBNJE="'
  },
  json: { email: 'b364d452e87eabfe56bd@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="mJS78G", hash="97UX6U1X2ttEAmSs8Z2esN/NESUc2VBul0dHFmc9ThI=", mac="JDk7s/VgxCtcg9o0USFBP29qhZkAToMWuEmgD2M2saI="'
  },
  json: { email: '168eec49a2ffe2c084cb@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="22dccee0450fb24627bcff4ddc55be1206c63cd96942edd96ee62920a4710e6d", ts="1705108850", nonce="wcBjrG", mac="ACXjqAzYuOJtfvQ01gNJaT5JHyFrOU42NFIYyJh85Ek="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'b364d452e87eabfe56bd@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b364d452e87eabfe56bd@notrestmail.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '5935e15b53425a09eabfab0bb61dfd91328cab7af3823efeedc3407f5432e5e7',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff21da595aef5c37f3fa5385c1d80419ef6b1e45559e6a9709ba07bd409d3dc1", ts="1705108850", nonce="JnWfQV", hash="PPL3PqnSDY5YRKOMxmCSa28Abqn6+5GeIWhPE8S/w50=", mac="ZnIu4NJf6t2ej2/ZWidKFRh6+GefzCuqw93aVHeujrg="'
  },
  json: {
    code: '27e063c487daae3b72a1d01e85632655',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'e0aaec18b55be6d1b1e1202b01b264f26807b4769358b59146206c6a49ac5158'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b66e95aed127f642244c2792d0e2b44b0be8a05323f85a1b93b2456b663cb5bf", ts="1705108851", nonce="efCxV3", hash="s4XLjldxt3CS4MCpV6ah3c+NFAM87hY2IAmK2IQ6WQE=", mac="iWztVHYSRGVtvI/QP39FBA8V8U4wUuXCJW6dqV2eaJY="'
  },
  json: {
    authPW: '2f8f49682d8d1e206a348cd89dc8799c60ec6515c0971db125cf63c9b4784b51',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '8d59841a9175423eae66493a77f7dc37',
    sessionToken: '6ed95e0d45bed08e99acb71cda0e237f40e514c0725fff9605ca9f010b2ede28',
    verified: true,
    authAt: 1705108850
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '168eec49a2ffe2c084cb@restmail.net',
    authPW: '2f8f49682d8d1e206a348cd89dc8799c60ec6515c0971db125cf63c9b4784b51',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'b364d452e87eabfe56bd@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8d59841a9175423eae66493a77f7dc37',
    sessionToken: 'c6ae1f2bc779d6a6354446e69e7d4bd3264da31b2381c380073a684d0ed5d7df',
    authAt: 1705108850,
    metricsEnabled: true,
    keyFetchToken: '6ab16aa1e71f114d1f75b720b8bdf8dbe9979f8949933486d2e3c7b246f6e6d6',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '168eec49a2ffe2c084cb@restmail.net',
    oldAuthPW: '2f8f49682d8d1e206a348cd89dc8799c60ec6515c0971db125cf63c9b4784b51'
  }
}
!!! response success {
  body: {
    keyFetchToken: '74af0c24c057890476a09b9781cffc761ada39a5d42dae5a0af615926c3d8e82',
    passwordChangeToken: '998423412b2289d5479faecf9d41c4f5142bd07b69860e23d008108176bf63ab',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="23bfc44829108f5c1bf5ad873d55541622f0e82c8dffe01039e68734bc347312", ts="1705108851", nonce="bLZP-L", mac="Q5O/Yx+LS3IprI2I6o7+cCwDtUeiN2lGmCMmzVNikFQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '22f91479f42c2a53e2c91472e0355f4add78df0b2d7b7f11ea5c8e8eeb744c50c928c3a542d814007076808b7a4a542ff1d30dcd295e1aba56c5f6d5bd7248c78df00bc1c0d5de6c808f817ae89f23de76249d1b123b37df4e3337da380320b4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '168eec49a2ffe2c084cb@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e046f50e0f9d55ce7ebbbaf2ea7a01ad2c88163f39c8afe61e9c4028567ac705", ts="1705108851", nonce="0xr446", hash="6YQepIQS+XSahjECmam9Yv8Kku8ldOo5nLWp2EZZmmg=", mac="yEf05MEXqGeZLvO1AfBnPVqxdIbmQKmBenRzVWN2y8o="'
  },
  json: {
    authPW: '2f8f49682d8d1e206a348cd89dc8799c60ec6515c0971db125cf63c9b4784b51',
    authPW2: 'c45e7fc24b12a889ae9abe6cedcda9eaa601f60e5cb1c43884ce4745d4dd2cc7',
    wrapKb: '06328fffae9a12793ac80d366757c7ac586dce7c48d461c0daec143da2871354',
    wrapKb2: '7e11ee76d2564666d3d3fc65aa6704bfc9b98292417b53353f071c0778f83703',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9b2f036f878c7d5a66c63290bc676e3294b1851f85c490e2737860a2a2163e47'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b364d452e87eabfe56bd@notrestmail.com' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9b2f036f878c7d5a66c63290bc676e3294b1851f85c490e2737860a2a2163e47',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9b2f036f878c7d5a66c63290bc676e3294b1851f85c490e2737860a2a2163e47',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9b2f036f878c7d5a66c63290bc676e3294b1851f85c490e2737860a2a2163e47',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '168eec49a2ffe2c084cb@restmail.net',
    authPW: 'c45e7fc24b12a889ae9abe6cedcda9eaa601f60e5cb1c43884ce4745d4dd2cc7',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: 'b364d452e87eabfe56bd@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8d59841a9175423eae66493a77f7dc37',
    sessionToken: 'b3accbcaab402b36e7d5d3015a25ca21ae27d630e046b3ab2fdd4c830e8c93b5',
    authAt: 1705108851,
    metricsEnabled: true,
    verified: true
  }
}
      ✔ can reset password (1477ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '91ec86dfb9a7b927438e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '91ec86dfb9a7b927438e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '91ec86dfb9a7b927438e@restmail.net',
    authPW: 'd4d2600a0094a867253fd220a9fdb463f1f4fcafd3d8670643dce0ab175e43c8',
    authPW2: '228410993610b6235e98d8478debdf78c1ff0e31086d145d45527703b948410c',
    wrapKb: 'e71adf1ea479afbc6675378f1ba66ef592b767dd4f0abb20fa2b1af6cc268247',
    wrapKb2: '30f9bf5f7a7fc3072a324e2b9d153ebf859900318628e513ebe40824c046f1c4',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:63129d955892d5a82092cdd404485034a076e76e742a49b8ec11d3991cc62487',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'acefc3495d1543ceb91bc428fce541bf',
    sessionToken: 'ef624880e9582b0bf57db85e78b57a731a599c685a9889f4a473a76da1a61bfb',
    authAt: 1705108852
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'acefc3495d1543ceb91bc428fce541bf',
    code: 'a48a435fede5dfaec94fabfdee1d0945',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108852", nonce="G-MMAd", mac="JMDQ2G7LDtwpbK4anHXeP24qU0xCqc1QQ5hGUcCMl3s="'
  },
  json: true
}
!!! response success {
  body: {
    email: '91ec86dfb9a7b927438e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108852", nonce="BXtv6R", hash="rUBf/sU9rGOxQhX2LVgMT7FLDfKakM6sMw1Xan+TMuc=", mac="AwFOCc/itbzpRYHu5qB1ru59hv65WnTyirj/ExfTCHc="'
  },
  json: {
    email: '68e78901a3601fbee6d5@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108852", nonce="W1Skvk", hash="hCGFKrJpNs+aDCBkPnsA5YMd3IopMRb7wTN7uczWW9Y=", mac="CQCqmqiYrqb1hpLwrLLBC1MjXNBZJR6wYT8P0/3vKMQ="'
  },
  json: { code: '280115', email: '68e78901a3601fbee6d5@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108852", nonce="cvxdMe", mac="y6y5BPoU9Z6KiEBiB5uqCGvpx4jZ9p1T1FVv7/04x7o="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '91ec86dfb9a7b927438e@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '68e78901a3601fbee6d5@notrestmail.com',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/set_primary',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108852", nonce="Lsq0of", hash="rUBf/sU9rGOxQhX2LVgMT7FLDfKakM6sMw1Xan+TMuc=", mac="jKL6l114z2XkY3BXNbCq7LrelGriOj6hOpX1+F/v9U8="'
  },
  json: { email: '68e78901a3601fbee6d5@notrestmail.com' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108853", nonce="mUJomH", hash="RRNpb+cl9RlVHNNGQ/6uDl3RlXwSbK4kufqQ0paUTNk=", mac="IxAUut2sLiOizInTCj4r1yzZpTLobAkepLpC897XdFA="'
  },
  json: { email: '91ec86dfb9a7b927438e@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108853", nonce="Xvacze", mac="5d6/q8HL+x3rL4b15CfHJxIWFhgMd+RRg02w3dcuxnk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '68e78901a3601fbee6d5@notrestmail.com',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8e4d47a908c02bc3a7184461c9e8039bf825477461eabd0ea94177b56b5a913", ts="1705108853", nonce="w_z6js", hash="hNUBtP+S4rB2oJWc6aIloZAYylDgaG5ZKR9RTPUYosQ=", mac="rLKqO21tr2KK2dWccGsMov4usWdiDdo+mdsCoMfZhpo="'
  },
  json: {
    email: '91ec86dfb9a7b927438e@restmail.net',
    authPW: '228410993610b6235e98d8478debdf78c1ff0e31086d145d45527703b948410c'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '68e78901a3601fbee6d5@notrestmail.com' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '68e78901a3601fbee6d5@notrestmail.com'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: '91ec86dfb9a7b927438e@restmail.net',
    authPW: '74bd85d1c5c8fca162cd3087c7efb95ce63661b8d2c1f493d002ba09d62a9af5',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: '68e78901a3601fbee6d5@notrestmail.com',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '68e78901a3601fbee6d5@notrestmail.com'
  }
}
      ✔ can delete account (302ms)

  #integration - remote emails 
    should create and get additional email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0211d34872839aef8185@restmail.net',
    authPW: '00364863eb13249506db3e434de680c9f482c7cd63ab256da97aead818cd6ec3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b41522874bf94e8daf72235a618601bd',
    sessionToken: 'b7d2e48e25d0b98b73b35756f3888beb0d6eec7da5cf2cade58f1e12c0cf5686',
    authAt: 1705108853
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b41522874bf94e8daf72235a618601bd',
    code: '2d206cfb59f3a40642f5f3d7d28b0471',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="_mPFRo", mac="SgHVKTvn7EiqUbijm+dVqCxSPKUfCfqyUzGHpqliEnY="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0211d34872839aef8185@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="ee9kPJ", mac="cKc5ZQHsAE7ch307crDQ4DLkIkt3b5N51re6X3fa91w="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0211d34872839aef8185@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="M-6pf5", hash="cO9xnwzWsR31pDrGf5nm+tb6hhuHSQiP7vU3AQRkROc=", mac="YCeC7UU+ST//p1UnzzChOtYAtMF6w6xZm0eVVfoEh7U="'
  },
  json: {
    email: '91ff047860aeda5a992f@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="TsWC-V", mac="0RieY7UGBbNAgXObGJiMZei3jIUdXXVI2dkduDWnegU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0211d34872839aef8185@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '91ff047860aeda5a992f@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="9PtFAO", hash="mOdKkVYYVWW78bTL4Y0RNdsex1u/I6C8NHAHcLCVbq0=", mac="rHPFJhVUkzVRePUVnIj9ezzkb43cNjijOQwiOgDm1L0="'
  },
  json: {
    email: '41cf2fc2d0466054eaf3@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a84569cc105827705b9c889185d742539e17a0731016c0c640d4ffed22871a54", ts="1705108853", nonce="fUcbMX", mac="FE6Y6+wwaZTsu9Ph4t49nsEhizuZvpiPqIMU5mpEtEc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0211d34872839aef8185@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '91ff047860aeda5a992f@restmail.net',
      isPrimary: false,
      verified: false
    },
    {
      email: '41cf2fc2d0466054eaf3@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ can create (105ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4d9ed4ff62408569eb66@restmail.net',
    authPW: 'd3c3ce8e4b9d7882b7333e7421dc8d27d9485ebbbcd33f7a15206b041e82ca46',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c76784d2199b4a38b130163bf3bdf864',
    sessionToken: 'de5a1b52f4917d2326d862a8c1b7a27748d8698ac9fede37ff39a9eaa42b18e3',
    authAt: 1705108853
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c76784d2199b4a38b130163bf3bdf864',
    code: 'd467fbbf40039486b294da67906a6cab',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="19dbc3a79be7c48ff29001ee9318ae79a79934fc57ef2c5c4bc20ed9e43773b4", ts="1705108854", nonce="uRDv6v", mac="HBGIZM3Yk0upwtbFIwBXed+iVB1Cd/+G0PJsNj7C488="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4d9ed4ff62408569eb66@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="19dbc3a79be7c48ff29001ee9318ae79a79934fc57ef2c5c4bc20ed9e43773b4", ts="1705108854", nonce="2YGfUf", hash="OFDYnVh09e3OjNRTMdLn23LvJKGr2u/kBdkzTl9ofPs=", mac="n4FL3CD4xJz2xOKZCQBzDF5JgML/1p0XZbVlcGpzI28="'
  },
  json: {
    email: '85b8cf7bb77855b13b23@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="19dbc3a79be7c48ff29001ee9318ae79a79934fc57ef2c5c4bc20ed9e43773b4", ts="1705108854", nonce="ST8itN", mac="K4svCLNah2C8/9NFoDkRC9neI6IWkqC65o8SFqIh46U="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '4d9ed4ff62408569eb66@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '85b8cf7bb77855b13b23@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '169dd2cb398837196fef@restmail.net',
    authPW: '31c20de7deb22f809205b57490ee4fec48fcc804a59d65d3e16a0c75a7fb6809',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7af4b2d7a0d14b928e833a4d89507836',
    sessionToken: '721aa7f4f7fb16c3c0732cfc27d28e27698ada51cd064c8549975b11f3e852ac',
    authAt: 1705108853
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7af4b2d7a0d14b928e833a4d89507836',
    code: 'f3488904c9d7c587025fc7f80a1367e5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4a2c7bb27397fb656a4d018dcfaffe66ff18774f2624462e9193857f6184873f", ts="1705108854", nonce="DFGrjS", hash="OFDYnVh09e3OjNRTMdLn23LvJKGr2u/kBdkzTl9ofPs=", mac="evuz015qxbMDIRtZxmOvulH2mKJmJLg9PQWxvfmfLOc="'
  },
  json: {
    email: '85b8cf7bb77855b13b23@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="19dbc3a79be7c48ff29001ee9318ae79a79934fc57ef2c5c4bc20ed9e43773b4", ts="1705108854", nonce="GO-68v", mac="y6HW79BVRasmItD2Q10hEfQx09IcpgtRKbyG6H3XrRk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '4d9ed4ff62408569eb66@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4a2c7bb27397fb656a4d018dcfaffe66ff18774f2624462e9193857f6184873f", ts="1705108854", nonce="Bz26p9", mac="b2pnfwyrVAa/07h6O6Ij5JhDv6EG3f0eyZYeTbsucx4="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '169dd2cb398837196fef@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '85b8cf7bb77855b13b23@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ can create email if email is unverified on another account (318ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f0d8bfad51c08fc94742@restmail.net',
    authPW: '5fbb65ef5ddbe152ce35d9dfd7bac9ee4a61d5d84f56805ef46e33a9c5d7d9ab',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ecaa80f5744a43bf97cc2249280f2f91',
    sessionToken: 'b48ceb27815c20a253401feed75a6776e5e89be9ad59201c14d4c8330c8139fc',
    authAt: 1705108853
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ecaa80f5744a43bf97cc2249280f2f91',
    code: '2c87a57a08fefd47803445c4eec13058',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="68d3749e52d43e29232c9c94ab0643e1e77db3b1d85e4aa726f67acde1520a59", ts="1705108854", nonce="zRyFAL", mac="KcyUU3C1I1b6GQ6eGbXojflETOGp1aUAU5ZuiF4ZphE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'f0d8bfad51c08fc94742@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="68d3749e52d43e29232c9c94ab0643e1e77db3b1d85e4aa726f67acde1520a59", ts="1705108854", nonce="Np_3w4", hash="KSA9w63GhDAnYMumyR3Y2mzzadCzKx8GHLFJ9MaKLF4=", mac="LPbYru66tj6Kxn4pVb80f699O8ofozvya0gvmSli1DE="'
  },
  json: {
    email: 'f0d8bfad51c08fc94742@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 139,
    error: 'Bad Request',
    message: 'Can not add secondary email that is same as your primary',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email is user primary email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'dc66b8198e9b9814fb2a@restmail.net',
    authPW: '93c7730c2f22c0c00a9a05d4b02f9edfda90735bd0ba71c786a7812f548f9d5c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f788d972621d430997d621233129b62b',
    sessionToken: '88fd495577f369faa601cc30117306dfe11c7275bee2b1cc5ea2f0f4788c3485',
    authAt: 1705108854
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f788d972621d430997d621233129b62b',
    code: '118dc832c533ace0bc4e8a6c6bff076b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="18e6c3600aa0edc043645cb993d7b5c48ebb2b3afe3946b05018eddc62d91f91", ts="1705108854", nonce="WgY7_J", mac="u/DjfChlobnE8up3eL2XJNr6ksxVDFdil/532u981DY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'dc66b8198e9b9814fb2a@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="18e6c3600aa0edc043645cb993d7b5c48ebb2b3afe3946b05018eddc62d91f91", ts="1705108854", nonce="wlcjPU", hash="5DPyJOE0aWf8SysthVDY2fmmIq7FLLvm7FMrBLRbojk=", mac="mAHg+mQ0pKfw0CHRf3IuUJ+D1zu8kDHANzQDUByPZes="'
  },
  json: {
    email: '7235de3af38103ddc683@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="18e6c3600aa0edc043645cb993d7b5c48ebb2b3afe3946b05018eddc62d91f91", ts="1705108854", nonce="GcxWMW", hash="5DPyJOE0aWf8SysthVDY2fmmIq7FLLvm7FMrBLRbojk=", mac="Hn7CIaEqyrZFgbLY9zHOLjzZBIKiYiVROm3eP4tWcLA="'
  },
  json: {
    email: '7235de3af38103ddc683@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 189,
    error: 'Conflict',
    message: 'This email already exists on your account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email exists in user emails (44ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '49963fa489a88e301884@restmail.net',
    authPW: 'd4e3f1d9092e5dc52a3b93b583a15fbe5151c5da6ea1d03f6bc545ae6bf0de42',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ded8faa7ec1741ff8f7a290009464a3e',
    sessionToken: 'ddc74fd7d22a1036b535c47d82ddf7ea247feb4e5d8c48fbf7ad62fb75c07998',
    authAt: 1705108854
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ded8faa7ec1741ff8f7a290009464a3e',
    code: '17a65f2570fe4cf4b9871d5d26e3f86a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cd6dee6695553fde1323e06f98e1a193e50283e9fd8269ef13e4ce1a4aac65d9", ts="1705108855", nonce="f3yIVh", mac="4jmfXI2ylC8NLKfU6HBoT8ZJC0ZTqjJmzKOzlMY0iwg="'
  },
  json: true
}
!!! response success {
  body: {
    email: '49963fa489a88e301884@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6257bfcb50076855fec2@restmail.net',
    authPW: '552820e209968784acc9ebf917e0d8a88102a24c17ab3d5c429028bc87419002',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '124811d45f8b49eb92f70c141c414038',
    sessionToken: '29a8a5bed9a3d244f566b3fce602f41394db53a9bfedf4d9fefd2cfa6fc0633b',
    authAt: 1705108854
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '124811d45f8b49eb92f70c141c414038',
    code: '0a76703e2d811b36d76e3efe74389b80',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="61d7598a2083a91d3302c231542d8f91d8172b87bd12af6f91b1bc5a59d3f197", ts="1705108855", nonce="q6I1m4", hash="lyRQMbeK33KJE/4PjUr0nbPzbaRsanMYI4H5FaOdeDs=", mac="x+3vroSGivucvYfTHI8JUxTxbzUX5PjrPImT4dtdihY="'
  },
  json: {
    email: '73a11b186b0bc033d401@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="61d7598a2083a91d3302c231542d8f91d8172b87bd12af6f91b1bc5a59d3f197", ts="1705108855", nonce="_KW-So", hash="NN0I/Ojlpkkt4oP9uf8SilsNwyS4PNKURNqNXSgzgv0=", mac="r6pvAFfS8yXCRjXWrMZgHnx7bCenqksFyUL3XFAORW0="'
  },
  json: { code: '618858', email: '73a11b186b0bc033d401@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cd6dee6695553fde1323e06f98e1a193e50283e9fd8269ef13e4ce1a4aac65d9", ts="1705108855", nonce="iz_kef", hash="lyRQMbeK33KJE/4PjUr0nbPzbaRsanMYI4H5FaOdeDs=", mac="0aG20gB31iY5ZatAoez8hJ11JAk8MYTfOSn+MMUbmR8="'
  },
  json: {
    email: '73a11b186b0bc033d401@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 136,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when verified secondary email exists in other user account (312ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5e409a910323334a3488@restmail.net',
    authPW: '297b8854fd7e3143b0407c76f5c378df004afe653e27d0148e70cc927f015a0d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1141b51480bc4df3a704d4ee9235f208',
    sessionToken: '88ea4716118b0ac9d2694437f3518f9dbae7bab5ba56f57a5c9e5336908572e3',
    authAt: 1705108854
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1141b51480bc4df3a704d4ee9235f208',
    code: '1a857e66df800cb60ec62969a0d0de84',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ebb6ed09e273a3b59d2d35e5ffa9a33b1217b1556ff56b376e848787b7a0ae8b", ts="1705108855", nonce="qxYkwM", mac="MI2/YX/8Ux/7aoemcDvsxn01M+4na9RKn1SHqJTsL3c="'
  },
  json: true
}
!!! response success {
  body: {
    email: '5e409a910323334a3488@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '5e409a910323334a3488@restmail.net',
    authPW: '297b8854fd7e3143b0407c76f5c378df004afe653e27d0148e70cc927f015a0d',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1141b51480bc4df3a704d4ee9235f208',
    sessionToken: '116c9e9f84bcc4c7e0501a2ae4e91ea18e1f4eac0a70b31cb5f7402bcf386dbf',
    authAt: 1705108855,
    metricsEnabled: true,
    keyFetchToken: 'a88876a172ac7c362189049df509dcf8ada2109031bbf0b634ba3faad654d3e1',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="697f2bae2f8b0e2cf023b71337ae6b2a307597855fe7852c29d76c6cbf789355", ts="1705108855", nonce="RsW7TP", mac="0H4xChnjDJCTYePBUjz1PRihPCfHnThAeO5JR0HSUCg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '5e409a910323334a3488@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="697f2bae2f8b0e2cf023b71337ae6b2a307597855fe7852c29d76c6cbf789355", ts="1705108855", nonce="V5a7Ud", hash="0nYRsbzAt6wR2SuOyx51kbcej/pGn+wR9kQIhga+r5U=", mac="q4oD3xmmTHzE+rEx/jcTnOby1UaDC9wYKlts0Cqq+YE="'
  },
  json: {
    email: '0542f3fa90af256782ad@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails for unverified session (213ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ccfbf50f46071968067d@restmail.net',
    authPW: 'c8119d32893fae076bde15488bf8497735c7fe171f7d40267ed798579d5e7162',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2a401ad5319c4885bbb1659120f8b978',
    sessionToken: 'fa7b5768e4b0aab89bcff56124bfa7da61eab6b8dfc66ba29d32d36825ec64aa',
    authAt: 1705108855
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2a401ad5319c4885bbb1659120f8b978',
    code: '71453deed03f0ede1492408d8df7e763',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5e1dc35aee1c354df8f741e9ac850944a7e4980e8a125dc7980a413e7cf755b0", ts="1705108855", nonce="m2baWd", mac="TwxiM/pbO0MpE9J0oLcD+9OVRybjHzQMcvdShaXYVe4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ccfbf50f46071968067d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'adc1bca5670656a56c79@restmail.net',
    authPW: 'dc505d4bcf30dde9734697889c26145a7d46bec641da14152fa3fa1b03478831',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c5e89c772d6f4897bd33b6136a5714a1',
    sessionToken: 'c215eee927aabf5d5a295a9a784d711ece3544c10b0088b6651db1f278a322bc',
    authAt: 1705108855
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c5e89c772d6f4897bd33b6136a5714a1',
    code: 'b2d043749024553a972c0822734b579f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5e1dc35aee1c354df8f741e9ac850944a7e4980e8a125dc7980a413e7cf755b0", ts="1705108856", nonce="trHdHr", hash="1FppyN4IOn9Tyf4/O1QQsTFdJo/zK4BPEh8/KRNnZlk=", mac="t8b87CTHsiehYa6P4JkFjtdJJKIGnJYQMV6pU5ii1BM="'
  },
  json: {
    email: 'adc1bca5670656a56c79@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 140,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email is another users verified primary (209ms)
    should delete additional email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4bd5f0f28973708f2bb5@restmail.net',
    authPW: 'a303e2513e8b80573a750c605a9db4b2eecc5b2997e8fdf6b2654b99a38be6c8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2f8ea20ec3b949eca005f617b82ec0fa',
    sessionToken: 'd7ed31c6a5a4d8e723136cf94d3550368da44e7d3e20a25ad5135f72e8452ab5',
    authAt: 1705108855
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2f8ea20ec3b949eca005f617b82ec0fa',
    code: 'ea9463f4db8d78ac3acdef704c5ad427',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="6z4iec", mac="nEY+mNPxrxAnvYwr5tWQjcdw8+cZwYp8Sos8soFxy4M="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4bd5f0f28973708f2bb5@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="_3vFhB", hash="mtQGz9+Lrugg5KN0bYv57kIvDBhoN8iV2VvW34+xejM=", mac="iAMIKgYJw1lKr2eAuyKezaWLQk63xTWqhUSvu+UipFI="'
  },
  json: {
    email: 'ac1d61c6a10bdfc4daaa@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="GLDK4M", hash="Gmeygf1W72Hin4pUHMumgxP4VtS/PgaH8b0AwgrslUo=", mac="pyqpYLw1k+8DySVr5sRv41Le7Q6uM8VyiAhTpsiwnLA="'
  },
  json: { code: '675774', email: 'ac1d61c6a10bdfc4daaa@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="gv4yvM", mac="olnCBgjjakD5wMYImW7bnKJ+hP0wW+cy7MtExK8TyA8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '4bd5f0f28973708f2bb5@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'ac1d61c6a10bdfc4daaa@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="dQ2hhz", hash="mtQGz9+Lrugg5KN0bYv57kIvDBhoN8iV2VvW34+xejM=", mac="5SeFmtnfN4D0uH/h0ygNmmxADPHPcr0ak4SChFobZm8="'
  },
  json: { email: 'ac1d61c6a10bdfc4daaa@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eb6ee0850c57c652bef3af9381c29bc3c58f7d7ffe3dea2334a5eb0e276b23d5", ts="1705108856", nonce="55K7qK", mac="9nsVDi3QLAqsYzjP/xzJMsMI3JTP6/7oI1/jJR56Tug="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '4bd5f0f28973708f2bb5@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
      ✔ can delete (51ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ae61bb3a5a436c005d7c@restmail.net',
    authPW: '9515549aeb247bb9322c8e67fe1a9b278dbb175d0bb9d2a8cbf26a4aeb0c839d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '84e5b36db9ab41369f0c0281214702f1',
    sessionToken: '97bc1ce771c81b080a182559ce7a18b251f2712e87c4f1d8a3f91108cc296ef9',
    authAt: 1705108856
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '84e5b36db9ab41369f0c0281214702f1',
    code: '3966c3e4816a1a26c6c82b69f479c90b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="0IU_vz", mac="5kgsYkfmVZUvS80gZT3QGWBF2RyD0dcekSdtVw/RD/4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'ae61bb3a5a436c005d7c@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="L1F89Z", hash="DKBWMYaFNT+LtLnnxPNMSGw5iM2eAVkt6Ra+ame+juk=", mac="wTPd17Mtzm8pGn43AyhP+sFx60WFDl25C+uWOq7jXho="'
  },
  json: {
    email: 'dae514246ee630bb166a@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="HCLEJx", hash="5FLBjI25BBTOZXxAqQp8uiBlArSVAJ3QTWYnSo3+Jc0=", mac="zm7ZJiLa6dgJ6A0ZU/5CyekDhP874F/+iZdNTcFm9k8="'
  },
  json: { code: '345063', email: 'dae514246ee630bb166a@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="_3M0Wq", mac="k6wVRUJFP+CA8VwVdZ0IwwmLMS+VgDe+UpVGtvEZVsY="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'ae61bb3a5a436c005d7c@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'dae514246ee630bb166a@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ae61bb3a5a436c005d7c@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'f8b40e2536ee8d4323619f65dc5401e1ae8e1d3b74c1992f9e8b49e9dc98bb3b',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="VO5TKt", hash="DKBWMYaFNT+LtLnnxPNMSGw5iM2eAVkt6Ra+ame+juk=", mac="YSKUgsV+tvNP2iKp7KLgSR3j3wZlEBkfi1P9Ji01T88="'
  },
  json: { email: 'dae514246ee630bb166a@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ab2b942f387e2865e6d3b99adf0e571ae177745888e5b035a398af962e279fd9", ts="1705108856", nonce="ddbcef", mac="Mt0+SZbjtXJOT24lR5asBKV+OBA+636QaOfMbPx4RFg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'ae61bb3a5a436c005d7c@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d73e0acad2948f16ffc1ca1acc3d4c7944a022fa6dc3bc1bbba094b4d25b7c87", ts="1705108856", nonce="Ddv2vV", hash="JhQCSAeZfstdoM3271lpf3Ms50qHRdLJH95iocINvy4=", mac="pI1LiQTn3JTNC6pGPnAKNsgWu3rfR+EAFYdgDVTBDmY="'
  },
  json: {
    code: 'a8a0c0841604787ab5fda63e3217058a',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ resets account tokens when deleting an email (95ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8febd6db49833d81191d@restmail.net',
    authPW: '96f45b76f348325a3c7ca72bb939fbe3416434f69b37465dc4abf56ac01e407f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6eb4b7e90f1a466d857f5398f4d6829f',
    sessionToken: '4a2853d2541ce2b9b878578adaa14e98a169109b5b2aa7821b0d994bcac805dd',
    authAt: 1705108856
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6eb4b7e90f1a466d857f5398f4d6829f',
    code: '2ed6a51b52754c40e5fdba183d8d5f3a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="aefce21b69718e707cd17d0d43725cd9ce73f1ddd57f9497dddb17d98e8ee592", ts="1705108857", nonce="kqIgqJ", mac="RzWguXzVLAu087z7u0X5MNOV3cUrALJB1b+8iaOTZhA="'
  },
  json: true
}
!!! response success {
  body: {
    email: '8febd6db49833d81191d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="aefce21b69718e707cd17d0d43725cd9ce73f1ddd57f9497dddb17d98e8ee592", ts="1705108857", nonce="XWaVad", hash="x37TX+WwTDxSQ/hB6Y4s8/j9axvoi2irzyMb+mvlvd0=", mac="20yhuMj+k0VmBXJXfS6J5C2hOWtkFh1nee8DgbiGdZM="'
  },
  json: {
    email: '3330daf88b0ecfdc71de@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="aefce21b69718e707cd17d0d43725cd9ce73f1ddd57f9497dddb17d98e8ee592", ts="1705108857", nonce="-PWvR7", hash="YFyL9rgpqIfvQEQ9pxjSDluslmpPuZB9IYtsnnzK+G0=", mac="m9/76v483b7UJoSyZBHx1n5/UbL3RUJJ0Xtt6RDDCjo="'
  },
  json: { code: '577261', email: '3330daf88b0ecfdc71de@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="aefce21b69718e707cd17d0d43725cd9ce73f1ddd57f9497dddb17d98e8ee592", ts="1705108857", nonce="4wpyU8", mac="3Y1fdIvIbMcZFyJaHkr/L50GzupKRAq0tGPkexKwJ84="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '8febd6db49833d81191d@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '3330daf88b0ecfdc71de@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="aefce21b69718e707cd17d0d43725cd9ce73f1ddd57f9497dddb17d98e8ee592", ts="1705108857", nonce="XBD2UW", hash="TH7Ly2boI3aHfr/MdksRIiJvhg66JKgps+pF0OBOM60=", mac="A2U9+dp8DBd/IGC8sGy08p5oN3CAQ71lE7xESC2EANk="'
  },
  json: { email: 'fill@yourboots.com' }
}
!!! response success { body: {} }
      ✔ silient fail on delete non-existent email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4bb1bdea296a22666700@restmail.net',
    authPW: '05d72274961606ab4852fbd51e2334d5d31ee5b651597986b34ceda3e2b2355c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'faf2849d33ff493a82f54a5d263dbd89',
    sessionToken: 'bca39ebf2c2ea227731af2572a46d84e17b36e40193d0c5be3bca29040ce537a',
    authAt: 1705108856
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'faf2849d33ff493a82f54a5d263dbd89',
    code: 'e60eac9b8dbb2470b24083dcac3cf341',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4b98e3785e906d9b771d7b0b056083b6c176ae2ce6f575ae1fe3476c5dd626cd", ts="1705108857", nonce="Opu1cj", mac="3ERDSGJgxY6iDobXMRY9IzwWgYq8oCjCENmNJ6qClww="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4bb1bdea296a22666700@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4b98e3785e906d9b771d7b0b056083b6c176ae2ce6f575ae1fe3476c5dd626cd", ts="1705108857", nonce="fQppge", hash="JJjOrzWVkC1q13g1yyG1RGjVHwzp/ZmLYtvFOqVxVfo=", mac="wRThH8M1FoicQuHkdBhA4q1/83y1PLZ+L542ZtFvyXQ="'
  },
  json: {
    email: 'a715998b2151de112403@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4b98e3785e906d9b771d7b0b056083b6c176ae2ce6f575ae1fe3476c5dd626cd", ts="1705108857", nonce="O9ML2G", hash="9vFPKuJZzuY9rOrbQFtfwuokRkkxZ60sI/hHPbWOHMw=", mac="b6B/TGAWVw3CQNm25jNqi4m5oB1hJQHWEZbelhVED68="'
  },
  json: { code: '046380', email: 'a715998b2151de112403@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4b98e3785e906d9b771d7b0b056083b6c176ae2ce6f575ae1fe3476c5dd626cd", ts="1705108857", nonce="YhqZN8", mac="ir1ffjZzhlQZYOPxU9zL0nqAIUR0RyRks+wjmlU2Fto="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '4bb1bdea296a22666700@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'a715998b2151de112403@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4b98e3785e906d9b771d7b0b056083b6c176ae2ce6f575ae1fe3476c5dd626cd", ts="1705108857", nonce="rMfL19", hash="RStJ0I9UMWmVOXSn7kc/3saYPgBgtGK+vtIIT0sC3P8=", mac="OePj5b1vYbu7yVqwIq885YKxsZ6rXEiHSNCYwotWPdE="'
  },
  json: { email: '4bb1bdea296a22666700@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 137,
    error: 'Bad Request',
    message: 'Can not delete primary email',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails on delete primary account email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2249d3ae06e888e71cd6@restmail.net',
    authPW: '56c140c01bde12d55fb3104410a82c04832e7f7d9e5d7d173bcc739e91075cc0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd88f85b8ed754378a2a451a9d2f0990e',
    sessionToken: '537a48a6b26237e9cd10de179ac9a1eb10f24be27b59ea3ef141bdf73eed0587',
    authAt: 1705108857
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd88f85b8ed754378a2a451a9d2f0990e',
    code: '3fe22e0853cc4468987c64855f5de54b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="79468b7b94e2e1857b9d8b69cfd9c08212bda1f760d6ba5aa9187734efb67d3a", ts="1705108857", nonce="oeAJ21", mac="eguEbukbZJnoCtcHVmgoLp1lOtGdzT6X5ZJn83ark1s="'
  },
  json: true
}
!!! response success {
  body: {
    email: '2249d3ae06e888e71cd6@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="79468b7b94e2e1857b9d8b69cfd9c08212bda1f760d6ba5aa9187734efb67d3a", ts="1705108857", nonce="gg0urs", hash="jLzbuRMKCahlKj/SZZTEPhbHb24EOccbGvmTyymg+eo=", mac="KRO+q2oEqcyV08+7DjcecO98qber3Ukl5wrKEUHI27Y="'
  },
  json: {
    email: '9f0a5dfa18b4c93d8734@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="79468b7b94e2e1857b9d8b69cfd9c08212bda1f760d6ba5aa9187734efb67d3a", ts="1705108857", nonce="OqJ-C6", hash="SiYJB3kS7cwjYtDmXXh5s6iHNRMXH6u1dQROXHl7wFw=", mac="7HvvlqrxCHZ1f8Gf1ozcokHbKSpjR6g6BJSDqGO/qyk="'
  },
  json: { code: '806496', email: '9f0a5dfa18b4c93d8734@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="79468b7b94e2e1857b9d8b69cfd9c08212bda1f760d6ba5aa9187734efb67d3a", ts="1705108857", nonce="bcrDmy", mac="ylCv176eaPNDjzQ6jhVcEofjYjuSPBiaG4zg2vw45us="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2249d3ae06e888e71cd6@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '9f0a5dfa18b4c93d8734@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2249d3ae06e888e71cd6@restmail.net',
    authPW: '56c140c01bde12d55fb3104410a82c04832e7f7d9e5d7d173bcc739e91075cc0',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd88f85b8ed754378a2a451a9d2f0990e',
    sessionToken: '9b10bafde87a7c3f0d7963fad21acdb1b820340ad4c35b61de861a09560acd14',
    authAt: 1705108857,
    metricsEnabled: true,
    keyFetchToken: 'd76fc936729cd3efdcaab01b306b0fa7f2ee912ae6c3be44fb3fbdae346a091e',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3b803df572e6c8385685919df60486e49aa1b81590ae33d6150873a6659cd47b", ts="1705108858", nonce="35vKcO", mac="m/uD0LHj6K679updCECRx7jOz39p5wN2BE+yyKyg/2I="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2249d3ae06e888e71cd6@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '9f0a5dfa18b4c93d8734@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3b803df572e6c8385685919df60486e49aa1b81590ae33d6150873a6659cd47b", ts="1705108858", nonce="H_0Ub4", hash="jLzbuRMKCahlKj/SZZTEPhbHb24EOccbGvmTyymg+eo=", mac="GfKvza3LTwOjN9QO5/Bj4w3li85iHtBE8jFvNiCSmeA="'
  },
  json: { email: '9f0a5dfa18b4c93d8734@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails for unverified session (216ms)
    should receive emails on verified secondary emails
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '87396ae1d3d780bce96d@restmail.net',
    authPW: '9601a0d89290035929671da5ba088274653760755edefeb4a729cf5edc181388',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ee2262c8fb98421eb3d01e160d648506',
    sessionToken: 'a6c4093b5f800ff1fcd10e900f46d8799ab742c124e46c623be0b64c4c9f49dd',
    authAt: 1705108857
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ee2262c8fb98421eb3d01e160d648506',
    code: '610ec7a361c2b8aa830352f04d75a404',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4aec2e8dac02424d8832ed9225db964530bfb17f8f81e24e4e5b0b33d288e120", ts="1705108858", nonce="Wn2xgA", mac="3eO70/zPCdgYmlIjrdhBlrexZam3hc18x5CHpzzXUx4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '87396ae1d3d780bce96d@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4aec2e8dac02424d8832ed9225db964530bfb17f8f81e24e4e5b0b33d288e120", ts="1705108858", nonce="4KI-iG", hash="VFNrljo8bxHygWiBqRgzCyCHalzDWIV82F+uZJ9AJpA=", mac="41N8kIGznc0HG6mCYwpeRrbGLjmsm1spuEtvkkXdz10="'
  },
  json: {
    email: '4bff9fc1e097eccc3b4f@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4aec2e8dac02424d8832ed9225db964530bfb17f8f81e24e4e5b0b33d288e120", ts="1705108858", nonce="ZJk_IW", hash="25KRqvoNG0G2Hxk7nPIEulQYRghjfPc7w5DmbhKb+AY=", mac="XYkyN0LuZOp55uysHrYrOahYAmzKLntKtYL4T1UNLHk="'
  },
  json: { code: '452398', email: '4bff9fc1e097eccc3b4f@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4aec2e8dac02424d8832ed9225db964530bfb17f8f81e24e4e5b0b33d288e120", ts="1705108858", nonce="oDW1s3", mac="qqrCLwb+Z4itgjtuRXAi6syLPHojFmnM0FN03teaj4A="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '87396ae1d3d780bce96d@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '4bff9fc1e097eccc3b4f@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4aec2e8dac02424d8832ed9225db964530bfb17f8f81e24e4e5b0b33d288e120", ts="1705108858", nonce="n-2LS1", hash="XMO2Uy12fcCybvYKLdNT8r6cpBQUlZqf2Hp/Nx2Qyls=", mac="zRKvBXn8JUClSok92hKPLfleQdke15YFH/pS9Dr89LY="'
  },
  json: {
    email: 'd3c8851611a9aa6467ae@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '87396ae1d3d780bce96d@restmail.net',
    authPW: '9601a0d89290035929671da5ba088274653760755edefeb4a729cf5edc181388',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ee2262c8fb98421eb3d01e160d648506',
    sessionToken: '96f803280c8ccebc61335c77bbbc870709a0f7ef4a0b8e40fc0430bdb23ed719',
    authAt: 1705108858,
    metricsEnabled: true,
    keyFetchToken: 'a63f4f6f03387fb7d7fc285f1474849e0d655b4e6199935163b2ff759d7c0e87',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="75a3c3d5b2d138a630c5b4bc72f6fe74e6799d242ca85c9fcb6a689da724d38e", ts="1705108858", nonce="y82GbY", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="3s7lKeOw/ejM+CUMZd58unipRz7De+7ttoDwwa8h5KY="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
      ✔ receives sign-in confirmation email (242ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0d1eda3040ab8896c862@restmail.net',
    authPW: '5a4a66b909cd21d63e1100066aa6fe7623c4dadae8c4d0daaea86b14dd06bef6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1f25b7a0b90342e29d53b1819ebf2790',
    sessionToken: '201bcfedefaf8c8342f785df81957d4a4ab4d0002a642348fd5a869c730d6c6b',
    authAt: 1705108858
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1f25b7a0b90342e29d53b1819ebf2790',
    code: 'ea8ff493ef5ab2af348552e8f1165dde',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e384f0174c4a79a996cf02313036f7f09bdfafdc16d34f925d0c4c605298d92a", ts="1705108858", nonce="MH4KE8", mac="Rm+NvmsldLlCjxp8Zz7PWE7GGiz+j0T86bDEL/IgtzM="'
  },
  json: true
}
!!! response success {
  body: {
    email: '0d1eda3040ab8896c862@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e384f0174c4a79a996cf02313036f7f09bdfafdc16d34f925d0c4c605298d92a", ts="1705108858", nonce="oq-nVc", hash="ptpgodlVie/Bdrqtq3Vsz3/V05f7gV8a7jKofHdjbL4=", mac="i0UU9W2oC5Ca7WhXO3qfeyo0XQNl4VRO0fhJxhYiX+I="'
  },
  json: {
    email: 'a70614c6dc560c19ed91@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e384f0174c4a79a996cf02313036f7f09bdfafdc16d34f925d0c4c605298d92a", ts="1705108858", nonce="ZJq9Om", hash="EgRA50MJpWexj2AQW6OeYPG5VMbs2p7YKue6kWk/pmg=", mac="qWVGIXe2eoEty1zuqd8osQRR+zJ8+yanp/TenkfgWWU="'
  },
  json: { code: '162259', email: 'a70614c6dc560c19ed91@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e384f0174c4a79a996cf02313036f7f09bdfafdc16d34f925d0c4c605298d92a", ts="1705108859", nonce="xakpVj", mac="LsWrpndgbSlHKjvthDAW97g+2kDCY5JnltGpJpX58bg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '0d1eda3040ab8896c862@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'a70614c6dc560c19ed91@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e384f0174c4a79a996cf02313036f7f09bdfafdc16d34f925d0c4c605298d92a", ts="1705108859", nonce="xwriia", hash="y4bZt1zpnAHyXU0nhH7EeFOjuYYXjWNFkcbviyzOLSQ=", mac="iYf/4eG+sJgOSUbETFLZaJ9RDC9WZpxzm+wCEEb6xos="'
  },
  json: {
    email: '4c925e05ba0ec76fff98@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login/send_unblock_code',
  method: 'POST',
  headers: {},
  json: { email: '0d1eda3040ab8896c862@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login/send_unblock_code',
  method: 'POST',
  headers: {},
  json: { email: '0d1eda3040ab8896c862@restmail.net' }
}
!!! response success { body: {} }
      ✔ receives sign-in unblock email (81ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6320120d6d66ac9a8f43@restmail.net',
    authPW: '0947a481aadb8b859c62b0e778fedc299644ead430604d3540b3c7114572788f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0199a499275c4c2f92a537abe58a3208',
    sessionToken: 'd26611a08ed63e71c030c4499400bdb0ce856d559aab485d756cef8327438e01',
    authAt: 1705108858
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0199a499275c4c2f92a537abe58a3208',
    code: 'ba9e9bd8e664000e19e057ff7f3e908a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d6d225c8104637297c31a68de7b36c223601ec8aee89d8f89bd5250e17e0c876", ts="1705108859", nonce="2_r2p2", mac="oe9oHprOe0RWJkWWBwmBYyiDTej8H301QzZt85auUYM="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6320120d6d66ac9a8f43@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d6d225c8104637297c31a68de7b36c223601ec8aee89d8f89bd5250e17e0c876", ts="1705108859", nonce="Lhdd0f", hash="OiesKb/tyIOm/IUoqh3FeAJ1KvzIUgIpasA+PjQgEEI=", mac="C8LpFXrLO/xSR248DsQnPQ73kZGj3bHTCnJJgw5R8P4="'
  },
  json: {
    email: '02604a2cad936d8eed57@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d6d225c8104637297c31a68de7b36c223601ec8aee89d8f89bd5250e17e0c876", ts="1705108859", nonce="k0vzpS", hash="+g86iv0APVAZ8XB+eeONpqzpr6HIv7LBY9F5U8Bogi0=", mac="SDs0bcYJB1uqc3zk13axwhQkVaRvE/KiD77R049YhZM="'
  },
  json: { code: '797654', email: '02604a2cad936d8eed57@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d6d225c8104637297c31a68de7b36c223601ec8aee89d8f89bd5250e17e0c876", ts="1705108859", nonce="12F06T", mac="LuLLualbcVwMk2shYk88VgGgwZ4nJilm4wIQkd3j3qE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6320120d6d66ac9a8f43@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '02604a2cad936d8eed57@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d6d225c8104637297c31a68de7b36c223601ec8aee89d8f89bd5250e17e0c876", ts="1705108859", nonce="qoloEU", hash="9q8G5f7LNlWVIvo5RQqRcotmhTqlU225kVsLo4uVAlw=", mac="MpVlVAmOe27RKw4jKo04ZFcvSxpnECikhjA7o4HiUHw="'
  },
  json: {
    email: '4980fc55f49ab59c631b@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '6320120d6d66ac9a8f43@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '6984d5a91ce941ffe326d0790b05319cee84085b3adbee81386136380882ce97',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
      ✔ receives password reset email (41ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6e28eff3edd34b7d2096@restmail.net',
    authPW: '719a855092aab83332640cfd3d24dc9f8d7764ea15a4b3cddde8202013091cdc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ae5a55b733c04df6b16f4002025c8667',
    sessionToken: '581dc420c3c63267e79051655ed4abb2ee82090414417cc0a32f469825052784',
    authAt: 1705108859
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ae5a55b733c04df6b16f4002025c8667',
    code: '6932da5a4461cf5bb74bd0d07631cae3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f94a9e26b9ce56e97db357050288533839daa30de80ad6de08767fa1f86b7d13", ts="1705108859", nonce="2U4QUc", mac="M5joAEp44Kl7Q8L2aWS+F+nNFIR6xgf/HcQzgTrv8Uc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6e28eff3edd34b7d2096@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f94a9e26b9ce56e97db357050288533839daa30de80ad6de08767fa1f86b7d13", ts="1705108859", nonce="1Y_wmB", hash="l59iuZ2/D8ZsdG0crPHrf1eGHGeGiXoUt0nDEstDlmc=", mac="rpAXXsa4vd8g15izG9vN/Kn+JMI3R0GOzl2YIZB0GP8="'
  },
  json: {
    email: '84b1c689a5e9f0c87bff@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f94a9e26b9ce56e97db357050288533839daa30de80ad6de08767fa1f86b7d13", ts="1705108859", nonce="DLAMhu", hash="2BYy3gl1Qse/pfYbUNkZuN3FfmPy+2PBBjuQqBvSS1E=", mac="xTyDdB88TO3zuCuF0UOSDp2fDw2znj8jCQWWHthgfO8="'
  },
  json: { code: '689023', email: '84b1c689a5e9f0c87bff@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f94a9e26b9ce56e97db357050288533839daa30de80ad6de08767fa1f86b7d13", ts="1705108859", nonce="-bDP4z", mac="TBHfu7tvlPnLw31UiXY6qesrZlISXF2QXStWzi8ynnk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '6e28eff3edd34b7d2096@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '84b1c689a5e9f0c87bff@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f94a9e26b9ce56e97db357050288533839daa30de80ad6de08767fa1f86b7d13", ts="1705108859", nonce="Ajoytx", hash="HpW5KZ9hQfO0X2NtZROoUHwQlleUaPFFa+3Z3++bCHc=", mac="pFdurU18RK/YDMYEnxRnDB7riBBVTEMBI0D1GjcpBb8="'
  },
  json: {
    email: '77944d475373b6020232@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '6e28eff3edd34b7d2096@restmail.net',
    oldAuthPW: '719a855092aab83332640cfd3d24dc9f8d7764ea15a4b3cddde8202013091cdc'
  }
}
!!! response success {
  body: {
    keyFetchToken: '805e482111d3fe77367dc2b80be29b50b215a8d06b1dcfed203af85f7ada588e',
    passwordChangeToken: '1daaeb359acbd924f53090ecfe2cdf28da492da5a6e913be6591244aa334afec',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c7d76d2530961cb28d6e5bb38e371f4dd30090787590064f1a676cbd006f1898", ts="1705108859", nonce="bSC5vP", mac="vy3Z6NySC67oMJf0FJooVyI6Kw1OG77RJ/ojwHEDDdU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '01776749d2634b22b4b2765fda9cae2599f910340a57f40e6914f70a58f65b6762046521474e9589dbbbd0f9a1238fe0d8935f1d4955db284e3be45ff17e550097d28c186edb2fec373b6e62d736bb342ec266bfc1d3d501ca23a7a11b21b1df'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1b27a84df5064d56511cc830a57882cc2a36f3055dc47417869b7f5b3e22faab", ts="1705108860", nonce="GW-m6d", hash="aWzH0uSkWtGiX1d9jcJvEMKfLonXRM/FmOSXVLo7PT0=", mac="WZhAqx6reW6vs6kqRPh4tpKhe1FnZhOFM6IxxquBzwc="'
  },
  json: {
    authPW: '7f0a2fe6292c6b4d0589a67bc52c3b6cdcd25f067a0fda5781c0308dc6686b66',
    wrapKb: '63e5ed5401e5bf63711b44476095a13511171812e7391a4a539ad359193fd5b7'
  }
}
!!! response success { body: {} }
      ✔ receives change password notification (398ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '41103a51dad776c7ad2f@restmail.net',
    authPW: '066f32abb2d67c4fbed3cf0ed0e2f8b6218cc24eff94985f1f7ea03de892f1e9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '719e0e8d3e2c4df9a7cf2320fe96f460',
    sessionToken: 'bcf6cc1228400617855c7e5c87611884441de01a218114591d46036840c12cca',
    authAt: 1705108859
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '719e0e8d3e2c4df9a7cf2320fe96f460',
    code: '05e7ca38db2a716ed0dfcb541c828ea5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ea3ae73a96700df639960e308a1674f34b34088db5f0666bcc33993a80641774", ts="1705108860", nonce="nxnFHu", mac="1nScD5y3Be0lbAd1poE3nEv630aySqiSUzLiFPJi4kc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '41103a51dad776c7ad2f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ea3ae73a96700df639960e308a1674f34b34088db5f0666bcc33993a80641774", ts="1705108860", nonce="tXahvo", hash="fJPSgEd6Abry86EuxbxEQqyQ4hcofcbgbjrhpP3qXT8=", mac="zodO6MtvlzrknCVlNYqdd94Ug2GeICGjlrBFkKxY+ns="'
  },
  json: {
    email: '3c752493dc65991325a5@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ea3ae73a96700df639960e308a1674f34b34088db5f0666bcc33993a80641774", ts="1705108860", nonce="8ecKpJ", hash="wBS+z36ohPx2A4dA1B+hNrj8+dpFtvfE8hs+kNDLc2A=", mac="OcKiPLuHFAPvR5PJhWHntIX59uUGQzpZ++wWWJn1CkM="'
  },
  json: { code: '241535', email: '3c752493dc65991325a5@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ea3ae73a96700df639960e308a1674f34b34088db5f0666bcc33993a80641774", ts="1705108860", nonce="NCfyx9", mac="4vQ5MCewmm9BTMcP11pDRzkGccujSG0Bl7V3bbQsyV8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '41103a51dad776c7ad2f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '3c752493dc65991325a5@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ea3ae73a96700df639960e308a1674f34b34088db5f0666bcc33993a80641774", ts="1705108860", nonce="7Kjrkv", hash="Kbhvi+PpH55YgJ03e8vUL5WCicb9Qbk9vBmIUYo0Fds=", mac="38cTD5v/OPTuXnz3nGt0DLS3UI+ODBKYGhDKhYwWta0="'
  },
  json: {
    email: 'edef7ded83d073ec8bfe@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '41103a51dad776c7ad2f@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'd10e2ee83e380babf61b0b62f1e074790ab7fee3054d420b0076baf15a86eb69',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d97283021cecd8d3d9cef78008e595024cc86d9394d98e25e9ab661f1cba0232", ts="1705108860", nonce="kNmnCY", hash="sU9GyIPN2GTUL3WRFowxJmL2O/eeqvzjHQAE9PF3ViE=", mac="vqRLTc0NEOv82B9V/HABmAFHamm/VWqnLBqDbfn82g0="'
  },
  json: {
    code: 'e4173b165c54b44017b2c88ca2fd86e9',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '152474295a70d847e263c8bfb56a1c4b1cb7ab40e0b41829a185b0f0de3a1729'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fe5f2f5de0dce85e20ebb4a2c36fb89ce415e8cbab188daabc44bcc4d06029b0", ts="1705108860", nonce="0DurGT", hash="vYKslHV8nuDJAiAHF1sONIlqYG4MMv4DPJpF8vqHmmY=", mac="C+Krf1rMGgwX8WiSDH4Ygy+qtDpNsehhYOOih2TuASM="'
  },
  json: {
    authPW: '4ee4654c797fa73cbb9622c6788f49093ccff3caf8a1dc43d5fda08f67e9ab74',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '719e0e8d3e2c4df9a7cf2320fe96f460',
    sessionToken: '64d042353555be38ec9506c6bb4648caaf1a3e46fa57fdec0bf9393fb4e2b0d1',
    verified: true,
    authAt: 1705108860
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '41103a51dad776c7ad2f@restmail.net',
    authPW: '4ee4654c797fa73cbb9622c6788f49093ccff3caf8a1dc43d5fda08f67e9ab74',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '719e0e8d3e2c4df9a7cf2320fe96f460',
    sessionToken: 'f7d00ce41a8b00a3f67f386d77c482ac52c8de23d75fd371ee2c0961cc87157e',
    authAt: 1705108860,
    metricsEnabled: true,
    keyFetchToken: 'df88c0e26c3618cc1ca67f0a5c8be56ea50cf3dd81847c17410198853cfb0c51',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4c0d52c3510b7305db595f7aed75c5b6e673983c0578ebd3432b50bceed3c31e", ts="1705108861", nonce="C7RA3d", mac="Vsoz5M2yIDRfQlAxUWlwJ1zMw2G3UehiyVaYqw2hGFk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '41103a51dad776c7ad2f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '3c752493dc65991325a5@restmail.net',
      isPrimary: false,
      verified: true
    },
    {
      email: 'edef7ded83d073ec8bfe@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ receives password reset notification (477ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f0ccdcc561d8272cbd3e@restmail.net',
    authPW: '1e21979bd4ea215950f47299edac06a0d3bc5975725672c8a132bb731858214c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8b53836400364df7848d9eb0240cb6c0',
    sessionToken: 'ef707ca63a51f1dd7cc166f45c896cbc6d965165e579f45cba5f5b94cf09b0fd',
    authAt: 1705108860
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8b53836400364df7848d9eb0240cb6c0',
    code: 'b25ac29193434ade30bb8fe22865e648',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="yNXTRg", mac="y0ASeVlp5O1aXDdrvqAMOVlyAgl4YUu9xhRJvMTcxhA="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'f0ccdcc561d8272cbd3e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="74Lhbk", hash="oVxuYSlKnoJWvzMgL6fsfCE3kRkjmgK7fatyHlRxJRM=", mac="E4inkccCUpT35xlD3orCZgk6UqyZfd143B4vYt5+1DM="'
  },
  json: {
    email: 'a9e523ac813c8ede40bc@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="TDr5UV", hash="cT+oBQBLgrNQjDDdq/dDGS6XREphayIMb3bAqT++LO4=", mac="WpLqD0O+DbbTQEwSuWixm3vMp7Pc/v4Lh9FPwPnv7aE="'
  },
  json: { code: '104866', email: 'a9e523ac813c8ede40bc@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="6jTlWz", mac="sChG1Th0qG02gHGRdaFL04MzAj2wMgrOTNwNq201sSk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'f0ccdcc561d8272cbd3e@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'a9e523ac813c8ede40bc@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="41lLlk", hash="GmamTfhQIJVOFEC4zHbyLJFdBePhp2WpwnktY6LrYYI=", mac="/2Po3DcofznJu4ISVTE+6T29j12ChgWO3ff53UObwFo="'
  },
  json: {
    email: 'a98df2c0e0da5f95b1ff@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="28I8F8", hash="hnUNbtPCYv+cnpmsjtZam+mg+ZU7flwN6Y1/Jej56TU=", mac="RDJO6+mBHvFLcf+CFTd2ufJs/M1AKLBVgs7jsuCGdYQ="'
  },
  json: {
    email: '04bebd025c7cf7b9b1d8@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="Ma2Ocm", hash="dti8JTr5j4RZ0Usk7v3B5YDc04obAJlhu/k5bqznWxU=", mac="KWwy+ilErXRF0xExqDP2LQbWEaCkMcSLSnFbdT5C918="'
  },
  json: { code: '986069', email: '04bebd025c7cf7b9b1d8@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db570610bc65c5a42e8ce54a335bafa10dd929b772dd54813b66949c4757ae21", ts="1705108861", nonce="Du5O8h", hash="hnUNbtPCYv+cnpmsjtZam+mg+ZU7flwN6Y1/Jej56TU=", mac="+/xkjT6rm0vAwduJPdkfKx2pELbY+JsYJCPPxxrF5lc="'
  },
  json: { email: '04bebd025c7cf7b9b1d8@restmail.net' }
}
!!! response success { body: {} }
      ✔ receives secondary email removed notification (123ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c7278f20048df53cfe15@restmail.net',
    authPW: 'e051197c0c5980d9d8ee259aa619f4e8665c0df23a36b2a387b0c2505d0bc6f5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'db1d3fa2d76f4c319f12f78c8ca45aed',
    sessionToken: '518f5a43f674400b4fde074f9792bfdec9702fc080c5d71db189af4cbc0701b5',
    authAt: 1705108861
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'db1d3fa2d76f4c319f12f78c8ca45aed',
    code: 'b957ae396c419d56e179c63c667203eb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f8553549a167d8264a20022a138c381aa170fe467e369b53161474e6b2fb8edc", ts="1705108861", nonce="7OL-8y", mac="bY6hHBRZbUG2JDwTuApTr+gxq4iJXGqfIxb785x9220="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'c7278f20048df53cfe15@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f8553549a167d8264a20022a138c381aa170fe467e369b53161474e6b2fb8edc", ts="1705108861", nonce="UcNPDl", hash="VZh4q+fFWvPqff5bmpmzmrupDaCSEkUm/YrTUWf+YYM=", mac="7EVxOhdQooIKewWNbq7WL9ScdBVIn/zB74v4HuTKQys="'
  },
  json: {
    email: '51d6ea44e066f063573f@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f8553549a167d8264a20022a138c381aa170fe467e369b53161474e6b2fb8edc", ts="1705108861", nonce="DOvXg6", hash="XULL97vJdZ4796wHOwDHzrukVNVzKtIOImqFJiMYzOM=", mac="qAbys+4M7hPzomZsIcIoMd2bspzIzzycahsIdrERIAA="'
  },
  json: { code: '553310', email: '51d6ea44e066f063573f@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f8553549a167d8264a20022a138c381aa170fe467e369b53161474e6b2fb8edc", ts="1705108861", nonce="fCYcgf", mac="g/FsucZWk0Rhu/hDLah5Ug0LT5PH1Hiww+WNX/HSfH4="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'c7278f20048df53cfe15@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '51d6ea44e066f063573f@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f8553549a167d8264a20022a138c381aa170fe467e369b53161474e6b2fb8edc", ts="1705108861", nonce="Wo2OL0", hash="cmhSdaiL68TiMPdrpTz0V1BDzkTzI01owtWpg/uwHUQ=", mac="zyhZTz16nsU56CmLsCmaE9dl+io3DT+DqHcXFiBmRgM="'
  },
  json: {
    email: '248ba9792b78496d9547@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a1369f93e102894e07d9@restmail.net',
    authPW: '156aeac20668bf853533c3f20efc86c511ecb790e4ce4e15c0a1ecc7f4112784',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7ec32e8de1a44fd29655bcfc81aeb25d',
    sessionToken: 'f388c66450b9752bc63cd237d331d171439dea342883bfadba5d18c372b68547',
    authAt: 1705108861
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7ec32e8de1a44fd29655bcfc81aeb25d',
    code: 'e717132b20ab1c81058fd5029ee62a1f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eed16e7505bd9c6f9e8c5496f9a1d172857d7fc0c46707055900265b6b22a8dc", ts="1705108862", nonce="3QCVsq", hash="XSjD6TeicqHpADHYzoSKU95JPedjel73+eAomFtYwXc=", mac="qKRyoUjhhCs/uSn2Jp5AahnA7N3IdUabmSPc+suJq6E="'
  },
  json: {
    email: 'b1102aab645040959337@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eed16e7505bd9c6f9e8c5496f9a1d172857d7fc0c46707055900265b6b22a8dc", ts="1705108862", nonce="qIaHKM", hash="Rl+o+j6H7Dd1JEyckcCTi88yHRm72w7j0Twy2LcIXK4=", mac="r9azdY/O4SXvUWjzMnbGbETIJETeF1OafAYMC89ccnM="'
  },
  json: { code: '347444', email: 'b1102aab645040959337@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="eed16e7505bd9c6f9e8c5496f9a1d172857d7fc0c46707055900265b6b22a8dc", ts="1705108862", nonce="RgwMaz", hash="xvshPjuIdhS1uvKLN90R1DlmxUmJ77DOHxAWfwq/he4=", mac="56HFMlPCzp3VNZijqyyrPdt2FA1Yhv/3NKwPr0RQDpc="'
  },
  json: {
    email: '6f8292afa07e604a5d5a@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a1369f93e102894e07d9@restmail.net',
    authPW: '156aeac20668bf853533c3f20efc86c511ecb790e4ce4e15c0a1ecc7f4112784',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7ec32e8de1a44fd29655bcfc81aeb25d',
    sessionToken: '9f963f0edf93988644d979db2ac1c98663fcc34586bd78b5918f0102a08f6054',
    authAt: 1705108861,
    metricsEnabled: true,
    keyFetchToken: '206ee1f512d61daea4eb2e2657e54ed01395ff85e734fa4a23d0acea07aafee3',
    verified: true
  }
}
      ✔ receives new device sign-in email (573ms)
    shouldn't be able to initiate account reset from secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f6c9efdba07c281136d9@restmail.net',
    authPW: 'ada7fbef6e6928c967fd39c39719b2875e29b91ca4273b6aefd78ee51a5207d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '79e5e54b099e4d0f99a4942f112f40cb',
    sessionToken: '18367ff63e88e1e690ff0c0b98ed97fbe2c9ec8f73ee1d71461d43069dbe8b80',
    authAt: 1705108862
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '79e5e54b099e4d0f99a4942f112f40cb',
    code: '7062303f462548eb8eabbabc6e52b777',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2cf2cd1434679e82e862110ccf63e441b14d877daeb228981fd32d9680907d02", ts="1705108862", nonce="CJGRtk", mac="IsdaQvUPwBx/SzNb2dd0fdqkBBZsY5JhCOlGdituKuc="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'f6c9efdba07c281136d9@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2cf2cd1434679e82e862110ccf63e441b14d877daeb228981fd32d9680907d02", ts="1705108862", nonce="Dq0epy", hash="Mygfiegz+lyWF4F/XXajM37HbCgqm3fw1YUy+BzVEmM=", mac="E3A2zdbr8O44OKGQEuq7NiNsd1iJFXY/aMntIcWJYXc="'
  },
  json: {
    email: 'ea5d8895220b0bb869da@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2cf2cd1434679e82e862110ccf63e441b14d877daeb228981fd32d9680907d02", ts="1705108862", nonce="9vWm94", hash="Z/fdgfHiqhJO06BKxEgdKhpQvE3pYCKq47rGuAfVbPI=", mac="kJdFxkbyjlsw5EY5R09of/MZP42rl2Cd8ziO+loAu5A="'
  },
  json: { code: '298918', email: 'ea5d8895220b0bb869da@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'ea5d8895220b0bb869da@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 145,
    error: 'Bad Request',
    message: 'Reset password with this email type is not currently supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to initiate account reset with known secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '37eb960b13a0c32920c7@restmail.net',
    authPW: 'f751889d92ffdb9bed5c11ec26e3d92aefe6f4561b52cb845893e6680455eb6a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ff6a2274206646b29f807e820cdce7f0',
    sessionToken: '824a51f945ef393b007de572d4250b3a8ce6826da9caec43d518f11a3edfbe1a',
    authAt: 1705108862
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ff6a2274206646b29f807e820cdce7f0',
    code: '3b8ec1c5afdc694455b9de95558bb9ef',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ff274ea2ec46a14f3c5fe31e7a606d6b3954812cf8ce0cbd8c99c42a2777ba99", ts="1705108863", nonce="elnktT", mac="kElJ66xakgZX/5sI3+7DGTNwn5sQFx4j1JgE9qem3O4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '37eb960b13a0c32920c7@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff274ea2ec46a14f3c5fe31e7a606d6b3954812cf8ce0cbd8c99c42a2777ba99", ts="1705108863", nonce="Ryq8tx", hash="60R4B+sEnKj3a7jxQ/NsYioge2Vpfm7cF8Ldm0Ub6+o=", mac="4XDSxMJffrv+jk06KrA24On7nC6haLlEnM1Xn9Dd8YY="'
  },
  json: {
    email: '23c690127d715e4175ae@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff274ea2ec46a14f3c5fe31e7a606d6b3954812cf8ce0cbd8c99c42a2777ba99", ts="1705108863", nonce="4-Dal8", hash="zOz3aVy09PAbjSJnYgxJqLCXvSmwRua/Pj3jbbWK+bY=", mac="3x2n/VzlJ8RgOqCFyvf39Xb2MZIMpOxfm4fHZFpw99I="'
  },
  json: { code: '625984', email: '23c690127d715e4175ae@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'unknown@email.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'unknown@email.com'
  }
}
      ✔ returns account unknown error when using unknown email
    shouldn't be able to login with secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c0ab4b70a9f9249598cd@restmail.net',
    authPW: 'afe88e8d28dd3acc3dccc258d62ac29cafbd40d691442d553c57ecc04fde27da',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4a2b808335774b99ba83b055f383cd2e',
    sessionToken: '6992b75615bd0f59a20fc971930c1160b3611dd75280fe9303c4393cf4be28cd',
    authAt: 1705108862
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4a2b808335774b99ba83b055f383cd2e',
    code: 'd2363ba3670744e8fb96df8bd8310553',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="360dd0d75e47235f966e3b2fc3f7d31a746110cad2f811cfbec89f76ef38c9b0", ts="1705108863", nonce="Ha-hN-", mac="4eFUHTqp0gJs2+pQFQ+HeL7XUlL8QqcsZthjkiR0/og="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'c0ab4b70a9f9249598cd@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="360dd0d75e47235f966e3b2fc3f7d31a746110cad2f811cfbec89f76ef38c9b0", ts="1705108863", nonce="t3Sq3y", hash="ztjSb7nf1W+l16QPwc2HcOL82XTWS95TbIkJTvefVeE=", mac="8QJ7xuHhni8SQz6HC6p3vjT3rDrEwH1zy1ohGMrxJxc="'
  },
  json: {
    email: 'e018a7581852260ce808@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="360dd0d75e47235f966e3b2fc3f7d31a746110cad2f811cfbec89f76ef38c9b0", ts="1705108863", nonce="iT7l0r", hash="xBt6GZsj5LHVv4vrkDxpf5fMMp2I406GD8psHZcswkc=", mac="6vBfE4PY7F2nEkETuBpDLZCvAgneJGnS3NoJtQOo6rs="'
  },
  json: { code: '476371', email: 'e018a7581852260ce808@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="360dd0d75e47235f966e3b2fc3f7d31a746110cad2f811cfbec89f76ef38c9b0", ts="1705108863", nonce="Mtk-oT", mac="ZrmExHg027qeI1FpCjsUfqseiMCMNbCfDdadoSjD4Vs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'c0ab4b70a9f9249598cd@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'e018a7581852260ce808@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e018a7581852260ce808@restmail.net',
    authPW: '2804af61074be3920b44da74881089b227f09dca0a8362bd90994c56cbb72652',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 142,
    error: 'Bad Request',
    message: 'Sign in with this email type is not currently supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to login
    should handle account creation
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cbeab97c07886c052732@restmail.net',
    authPW: 'd39345bf7c67f2be75b4c386741fe47acf02658ba6998974a70043d5185eb894',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6bbe05f864644091871bdbaf0b619790',
    sessionToken: 'd0fb7dd9051353fc491cf0d785a315bfe1070be628af81025a02d8671a1b9de7',
    authAt: 1705108863
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6bbe05f864644091871bdbaf0b619790',
    code: '16ac91eb1ddb5b62e9b66b30629cc359',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b6e88f889b12cec90a2ed58510c497ef6cabb37667433540b843b273b6a62079", ts="1705108863", nonce="sXV1ko", mac="pX40P4F+lS14I69vvv5JxFZC1rNEY/KTCP9d6SZzF9c="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cbeab97c07886c052732@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b6e88f889b12cec90a2ed58510c497ef6cabb37667433540b843b273b6a62079", ts="1705108863", nonce="gWeLJj", hash="7if0OMXYd0ibD16OXAbauaJb2RpoDqYvky5dEKVJsug=", mac="U/YskvXuqpwMtr0HBIj6VHM+ccRJuDmZMumoJ0+Uwa8="'
  },
  json: {
    email: 'd5695393de11b72ab6a6@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b6e88f889b12cec90a2ed58510c497ef6cabb37667433540b843b273b6a62079", ts="1705108863", nonce="gXGcJt", hash="I4ASH6X8AiN026FCXo+8gFMRhuM/H7QE7FBpERZUkpc=", mac="0C9jCsepR8Kb4uGGgdRvbJ3Dr8hz1E7Q5OOkjivh1aI="'
  },
  json: { code: '795579', email: 'd5695393de11b72ab6a6@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b6e88f889b12cec90a2ed58510c497ef6cabb37667433540b843b273b6a62079", ts="1705108863", nonce="DmXE_S", mac="ZPWlixfeIbsPa/idT7mpTvw/xQ5BvJV/96CgmIkjmT8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cbeab97c07886c052732@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'd5695393de11b72ab6a6@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd5695393de11b72ab6a6@restmail.net',
    authPW: '41f5ec1be1a8f281958bf0eb4665312deb853e8c85674ff114880ecc5d832107',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 144,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to create account using verified secondary email (50ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2399a8e137e9f3dc5fef@restmail.net',
    authPW: '09e1f84e31c2a05ab0c28312ab4e087f2c6253fda8abb9bad3f9682f5a804996',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'afddcf73f52a4130b42684738b9f4794',
    sessionToken: '2e19b9deeab5c659c14b8eb2145040b2444e2c95d8cfad4767ab2a5ab292cb75',
    authAt: 1705108863
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'afddcf73f52a4130b42684738b9f4794',
    code: '6f5466297aaaae60fb6edd72fe4da38f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="932b94666bce1528a91dbd27d7cc8fa2bfa211845315d34b24bf52b2b54fb483", ts="1705108863", nonce="A5K3Wc", mac="n3zLIylhyvm726qiahYerpD+VTAuvpNGCB0GagK1R/w="'
  },
  json: true
}
!!! response success {
  body: {
    email: '2399a8e137e9f3dc5fef@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="932b94666bce1528a91dbd27d7cc8fa2bfa211845315d34b24bf52b2b54fb483", ts="1705108863", nonce="wr6yCA", hash="UmrSVyQR6fwc7Uux4ODDagPu/p0tiZtetkBTwsWk1iI=", mac="TaETXTpjMuorenrB5pdNjsJrT7EVpKrpOc7iKDmh4+s="'
  },
  json: {
    email: '70b29f9376f238518b92@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="932b94666bce1528a91dbd27d7cc8fa2bfa211845315d34b24bf52b2b54fb483", ts="1705108863", nonce="vZitVF", mac="9+ybxFjEfx63fQw7bJvMFeg2wRCCPYpVnzWDj6JTbiQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2399a8e137e9f3dc5fef@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '70b29f9376f238518b92@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '70b29f9376f238518b92@restmail.net',
    authPW: '193ab56cdf60e7033f83bcfc50d5e3d5afdcc5cc7a26780399fc4268f9adf460',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9ee7fde616cf42129243cdc11eab601f',
    sessionToken: '952a82f6c493eaa9440865615ecdd7c58e6d86cb96c22afaa91b2159e7694014',
    authAt: 1705108863
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9ee7fde616cf42129243cdc11eab601f',
    code: 'aa8be068d4172e8ba7418d6f4a1a3c03',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="932b94666bce1528a91dbd27d7cc8fa2bfa211845315d34b24bf52b2b54fb483", ts="1705108864", nonce="7CtIhe", mac="topS7KW1LjvnHXzZQpJZSCS57t9Liqn0umcxMcZYa+I="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2399a8e137e9f3dc5fef@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
      ✔ should create account with unverified secondary email and delete unverified secondary email (216ms)
    verify secondary email with code
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bcadc3b9fa47168dd93f@restmail.net',
    authPW: '06dbb454df52bd00139efeaacf7aa57ce8a43ae4b6f036e908064b1ffebd79a7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '74f98de18f8f4251a09b6781c8481553',
    sessionToken: '17f358cc82493c039fa9e608db96e934c556257c8e1dc826839cb410dd3dfde3',
    authAt: 1705108863
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '74f98de18f8f4251a09b6781c8481553',
    code: 'f63b4a668de910aa0ed4250ad9c26a11',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a9709e89c220d43c196689e3238b87a0c8d53b2b2c3602f0186180888905649c", ts="1705108864", nonce="lAIF7F", mac="hEz8Z1jfWMbpTTcJwVKubowKmfM1CKZLM9rtFv6QyWg="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bcadc3b9fa47168dd93f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a9709e89c220d43c196689e3238b87a0c8d53b2b2c3602f0186180888905649c", ts="1705108864", nonce="vrM-l8", hash="5GkcgPdoipAgyAN9y0AnXcc1USJwv9nDXViUS2DkJks=", mac="nni6G/0adS4J5W/PMNYWWbg/A0WkKVkSJg24d2NH3RQ="'
  },
  json: {
    email: '1b66e24f0497beed4bbb@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a9709e89c220d43c196689e3238b87a0c8d53b2b2c3602f0186180888905649c", ts="1705108864", nonce="Ul4YHp", mac="cpPvYQxgftqjM+KfZ9CVKcc5wse6d39SE5f1MmOBaPI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bcadc3b9fa47168dd93f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1b66e24f0497beed4bbb@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a9709e89c220d43c196689e3238b87a0c8d53b2b2c3602f0186180888905649c", ts="1705108864", nonce="GcecZ2", hash="0tP6bzBjnvrVBApKQLlfg1Lkze+p15IsERdUO2Ydufw=", mac="63kDBQ3l9eMF8QYNgCByd3+XvELsTUNoTq1K5jbhL/c="'
  },
  json: { code: '306479', email: '1b66e24f0497beed4bbb@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a9709e89c220d43c196689e3238b87a0c8d53b2b2c3602f0186180888905649c", ts="1705108864", nonce="yjRUWx", mac="h6LZF6ev7RCi+/hTJVgMO4r9KJLUyzdW+Big4ZZDlBQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bcadc3b9fa47168dd93f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1b66e24f0497beed4bbb@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can verify using a code (47ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '45d515cf69baf542c2fc@restmail.net',
    authPW: '6a0e518c09c9c97a95160c616d06d6573dd901e5fdf2631ccadf44a68492f454',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6a8aa97dd73845ddb215a68f07644cdf',
    sessionToken: '1fb82a16d3baa38f968fc278e21cb720fc3e441f1ac22b48f91c5040e6ab7570',
    authAt: 1705108864
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6a8aa97dd73845ddb215a68f07644cdf',
    code: 'f3c4ae1ef2f5ede6f0a6bc15094b1d4f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1c9605b5c5d9f3dcbb9d0004662adc26db898f0bb170c1972b51c6440dce8921", ts="1705108864", nonce="CJpfBw", mac="G1cZQd4X3/jsR/BZwpVNXwUUolMR9CrDYBAnIP0h3jc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '45d515cf69baf542c2fc@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1c9605b5c5d9f3dcbb9d0004662adc26db898f0bb170c1972b51c6440dce8921", ts="1705108864", nonce="rNwaiu", hash="2MNwzt1qel6Ty4zk8mTQ0j4FTePhJTOZ0lmg1UhAjOI=", mac="I4lSFuVkCci+VMnw4m/31/gs8O7+c1/H9+89j0/IEps="'
  },
  json: {
    email: 'cc2d1006e2ccacb4aca6@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1c9605b5c5d9f3dcbb9d0004662adc26db898f0bb170c1972b51c6440dce8921", ts="1705108864", nonce="kSbn0n", mac="CLpf5y//lBOygRZs1hdM16fG/FxQaoruX5FQbU0V1Q8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '45d515cf69baf542c2fc@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'cc2d1006e2ccacb4aca6@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1c9605b5c5d9f3dcbb9d0004662adc26db898f0bb170c1972b51c6440dce8921", ts="1705108864", nonce="BtZ8DE", hash="IHUlrR3n1zwcY3T3IX6+toJMu+/iSvx6BzSLhuuDqvk=", mac="xgj8jFO7IntoOs7NFatpAUkNGA87iRyF3XTBUgdaGi0="'
  },
  json: { code: '123123', email: 'cc2d1006e2ccacb4aca6@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ does not verify on random email code
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a2c6f07d5daf56917bb8@restmail.net',
    authPW: '573b0ea2eaed7a1beb2488acd187c59dc24cd2033169bbea4443c9928efbb3d1',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c075ef776a5a4328adaf98b72d6bb3c4',
    sessionToken: '04f9523168b2345d73a809efb531776171c1f15da3de50a7c8fb0578b50ac34b',
    authAt: 1705108864
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c075ef776a5a4328adaf98b72d6bb3c4',
    code: 'b17aa3454bd7088ee330481e363a53ff',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108864", nonce="JWk0pL", mac="WbanRbqIA0MH+R84kTtjrDu/MxhX2fprD6c7s9EmAF8="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'a2c6f07d5daf56917bb8@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108864", nonce="hNQvon", hash="niACexXyfZb2YnijXE6xkrq9eTeER50dtwpiPu59DAk=", mac="h9y8lvzWZAcfY9kDrMZ0FSvCCvkKvXT5OjcyYRlM+PA="'
  },
  json: {
    email: 'c53bf3619bae2b1f53e2@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108864", nonce="Rvqcwm", mac="Iru1DWJN4r3dLDKRrS54cGobWGD042KFoPds8Wlenqs="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a2c6f07d5daf56917bb8@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'c53bf3619bae2b1f53e2@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108864", nonce="cihBY_", hash="V1l1YFBj6twNP3SDercND0KThya+FqnM9Re88VJE/2s=", mac="XpHDt8u84SuX4WvuejiX48s/TDjrYMabnfSo39U5St4="'
  },
  json: { email: 'c53bf3619bae2b1f53e2@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108865", nonce="JfbkFF", hash="nlDU5cmjDjW95+HmxtL/NaisnGc8Yk3g9grrVdMx/6M=", mac="6RkyO7SJox9FmTUrIvNcvCqqKhIUU2bXo/xXLC1N3Os="'
  },
  json: { code: '924873', email: 'c53bf3619bae2b1f53e2@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="73cb50338f9f998ed1a511a780f39b8eb6b2492f85348e2b0edabfaa130ab2ba", ts="1705108865", nonce="VFKywN", mac="y8I6XIUoD468iGWIw286UVuvm6n3piPjTG6ySpXAIVA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a2c6f07d5daf56917bb8@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'c53bf3619bae2b1f53e2@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can resend verify email code (82ms)

  #integration - remote emails V2
    should create and get additional email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cca3af21367208becafa@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cca3af21367208becafa@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cca3af21367208becafa@restmail.net',
    authPW: '12f898cda9bcfe56fe4f806c6980199321d8cc85458bfb79157cd17af82516d0',
    authPW2: 'c1719714cfa4ba2eb27d43f06f4f63c551da35b1136664b101a57000ad819d64',
    wrapKb: '3bb16572b620cafea743cdac735b5cdd73e317ea05d9dc870d426e344b6721bf',
    wrapKb2: 'a8747ef18f05d15947dd5760fc7df80780c5606f32c1ff6c125f1ba85de91a84',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:58a474bbedbe80c643532709ae3f444484faf3de31b99a4294f970c4e3626ff0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ba386145409b45ff9f1df7a03ffeab83',
    sessionToken: '14debc59e3efed43584d5063c0d8c3a8155e4f79fd2df3cd7c11c456683f021e',
    authAt: 1705108865
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ba386145409b45ff9f1df7a03ffeab83',
    code: 'dbf793ccd6a04418cc3244a9f77d0231',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="AdrsqE", mac="TIAT3Zuuv2y0YAxuqwYR9GtJRLx6SkULw2/SS+HrHr4="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'cca3af21367208becafa@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="h4RuAH", mac="fRW4DB33b3qB++9R4DvmHDNOoHBenHxXrPB31oHLjGM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cca3af21367208becafa@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="IKDR5z", hash="x4lPXc9EclJN107GQDmvXYGUMXS6UwoSxxqIO+Yv0Hw=", mac="3F9HfccfXv5xqWNLvsCz+lQ9cY1voiXWJdL8r2ccfxs="'
  },
  json: {
    email: '19a2c285ca25e97ff91b@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="dTIicS", mac="ED5pMzsuad6EaX7Xt9Mmf/x4McuzIStxoJlrhUUelLE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cca3af21367208becafa@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '19a2c285ca25e97ff91b@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="EsroEK", hash="vZe2lyF86bIYtFl7rGaEBKbWOSoD7xjUILEz8CiiW5I=", mac="9avNY38z9rO8UccwM5Pbz7OPB9OnfZV/wwflWDQeCas="'
  },
  json: {
    email: '412599332e396a347365@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="00247ab954b8112781fa4c419eede19a5235303cd4056f669cb84852ad388f61", ts="1705108865", nonce="if8o3J", mac="ISzGjkirtWJlvvgRQR3iQypn0jOHgDoZ6tuJBtnyjjM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'cca3af21367208becafa@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '19a2c285ca25e97ff91b@restmail.net',
      isPrimary: false,
      verified: false
    },
    {
      email: '412599332e396a347365@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ can create (97ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8cd655933644695e555f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8cd655933644695e555f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8cd655933644695e555f@restmail.net',
    authPW: 'c6724481b086b33a3174f7efbba505092dbd90c394664bc8b697c3e00d5710f4',
    authPW2: 'ea50b6f4ecf71b6914fe1a13e5d22473f00f15744231c8267948572259318db2',
    wrapKb: '4af7f60a319d189848d9596aa970f0b651b9581f00e8c8366d190a35b5e93bb4',
    wrapKb2: '3eee6adcb7e244469b761e50af7281187665a0b4bc1515708aedb3db57df9ffc',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b82710f046197ebcb0dc5b27ff49bcb9bc9489a7d3a02b6e7bb23b2cec933c15',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4233e0ebb84c4a29b13ca3c14bd12c02',
    sessionToken: 'f9ff6c086a132ca989de681a634cc64ca6a486a1dcf9368f95b5f6beac3620b0',
    authAt: 1705108865
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4233e0ebb84c4a29b13ca3c14bd12c02',
    code: '861fa31a0d4aedca0a01124e26227701',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d4d0cf10f6c3ac7cf30743ac4b6ad4f6c8416017394a7050bf5dd071abefc913", ts="1705108866", nonce="V0sqs7", mac="pbQLlM1b8JvFijkfjt/aTWF1fhu9B3RZ8rAzi0OVCYc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '8cd655933644695e555f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d4d0cf10f6c3ac7cf30743ac4b6ad4f6c8416017394a7050bf5dd071abefc913", ts="1705108866", nonce="-h73FJ", hash="eRomlipkHdXfumHAVdMN3nHcTD9yfsWHZ5zbcaEdMcs=", mac="VKCf/CiD1LegXgjKhSkFU0TMYstLOLIzu+27c6u3oOs="'
  },
  json: {
    email: '141719c4434ac9036df0@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d4d0cf10f6c3ac7cf30743ac4b6ad4f6c8416017394a7050bf5dd071abefc913", ts="1705108866", nonce="xJg3tF", mac="fk/gFm40i47YZNzCgi9FVAu5wiHpF+wbTr2icodkTSc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '8cd655933644695e555f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '141719c4434ac9036df0@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd83c5c0ec13107ec756b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd83c5c0ec13107ec756b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd83c5c0ec13107ec756b@restmail.net',
    authPW: 'c4d92b71da8058f05160ab534fc9f388ab38df92e5414ec798a5356430650873',
    authPW2: '176e487ee335b98542b5eaf5ba333bebe8eb80115ac9b6883ff6bed886ac66cd',
    wrapKb: 'ee64d23fc5e81f656222ed2bbef180cd7636a583ee84f7125c0bc1f61dfe3d0c',
    wrapKb2: 'a5dca0d9c9b25a6067ac4be91b63a9c1ff504f073355f81812770bf07389c893',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d4aa455a79e336c998ed1fcab8e4b87a4802b3e61db685159e6675d099b46d96',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '57c8b25ed8794e159a3f86669a297d17',
    sessionToken: 'a6da1d2e764f21362f201c72fd5dd2e6c4c198a90c0eadb31a716bb8b41be39d',
    authAt: 1705108866
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '57c8b25ed8794e159a3f86669a297d17',
    code: 'd61dc6a750efa4ec306396309969e68f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="39e9ecb20f9a37d2ea016b4f677f0f4a3ef0e456b75b59c012e9e8b2e5c3f862", ts="1705108866", nonce="R0p9cz", hash="eRomlipkHdXfumHAVdMN3nHcTD9yfsWHZ5zbcaEdMcs=", mac="lBLYKZ990LLa5nDjxzLnhDBGDAJlm3x3GpWtKt8LU4s="'
  },
  json: {
    email: '141719c4434ac9036df0@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d4d0cf10f6c3ac7cf30743ac4b6ad4f6c8416017394a7050bf5dd071abefc913", ts="1705108867", nonce="2d-egX", mac="MYrQjzF9JMgrbOq3SH00b14Tk2kEQ2KBtJDgIeslrNw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '8cd655933644695e555f@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="39e9ecb20f9a37d2ea016b4f677f0f4a3ef0e456b75b59c012e9e8b2e5c3f862", ts="1705108866", nonce="TJ1D99", mac="5Z1xhWcy5z9f2qhyHbdANV+t46R/h4CP7IYsXNlggn0="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'd83c5c0ec13107ec756b@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '141719c4434ac9036df0@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ can create email if email is unverified on another account (570ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3748511424f6f0295600@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3748511424f6f0295600@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '3748511424f6f0295600@restmail.net',
    authPW: '8fecfcc4b7bd26743e44e5e43895c49bec2ebbdd3ca856a3b38e26abdc0e45be',
    authPW2: 'ecf2dabd8f727244f43a65bb0e02973f6229152c337938082e2478838e8db1c6',
    wrapKb: '66b7bcbef3f0f0e97f94215d269f953db73a3aff96b70e9074b49b66e5fd4fd8',
    wrapKb2: 'e21fe84c055c1a0fe646679dbbf7a67d5ab28b42638473b8d1df813b9dd8c067',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32735aeb0ea3c84bb1b8bcae58033b89b7994a14ca02097ce085f17f275be991',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '3f9d4016e54f49f29aa45d2dc5697e57',
    sessionToken: 'd2485dd47cc0f877d04a36409ae47e8e8a57a79268b1e1655146394658c355ab',
    authAt: 1705108866
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '3f9d4016e54f49f29aa45d2dc5697e57',
    code: '653d7a71bc5a21192745d1c0adf458ff',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1ee8e2b868d015fc93a8abadbecfc968f7be6b249a191af983c174adb58eda5e", ts="1705108867", nonce="SJcBtC", mac="IY1gBPieH4l2hjljinHgy9f9nTOoHmV3+4Ru2TGI4p4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '3748511424f6f0295600@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ee8e2b868d015fc93a8abadbecfc968f7be6b249a191af983c174adb58eda5e", ts="1705108867", nonce="l3mz34", hash="1cGCfJzd3oLTdzgHj9yvT+Z99Ci6OtdjHXMaNSSl9oo=", mac="neFnah0mQlJrP6oG7RYc/H+sZ9vq0frBbRRPRvHJ/Ek="'
  },
  json: {
    email: '3748511424f6f0295600@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 139,
    error: 'Bad Request',
    message: 'Can not add secondary email that is same as your primary',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email is user primary email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'fd09d0f2f00f287e84bb@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'fd09d0f2f00f287e84bb@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fd09d0f2f00f287e84bb@restmail.net',
    authPW: 'e95a11a4eb7b356a28067d1bd1cee6e4842e8e061eb45f44eec94afe723698bd',
    authPW2: 'a4660c9744dbcb5ed86df8e239ce1b3dabb7c6fc5509c175a38b8ddee17d32f7',
    wrapKb: '5f31b4fd1e53d4bbd920bff9f1deaf1e1058dbea63b365ecf2c6fe5fc0ac0a20',
    wrapKb2: 'a933173fade3421f63e33d3764dc163a9b3528996ede0c61e8c9aed10c6cca00',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:05f896d26a79079fbd76c4c8a4f8d97f23bbbe40d9731eb6d992cb8209aadfef',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bc210c92564648afad4de921b32583ea',
    sessionToken: '757abecb15ddede57b50dc74eb1f7d1c54f7057b24353497ed9077032b8f9308',
    authAt: 1705108867
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bc210c92564648afad4de921b32583ea',
    code: '852ddcbf9b843725d031e16f7c3884d4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="459baffc4b853c22b7cace33802463874be8d52b5008637839ad8b065ee9e402", ts="1705108867", nonce="T0gFQa", mac="Wiy5trkPGljC1MSZOZX9NbXOBFUw/nzWsimJmBrgjOE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'fd09d0f2f00f287e84bb@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="459baffc4b853c22b7cace33802463874be8d52b5008637839ad8b065ee9e402", ts="1705108867", nonce="FpUSru", hash="dvro2QnZ+c0ab8fcDgwm1gTRDrtMT5MH4d/2wiQK28I=", mac="eQrI+dR60B1HfPPM2nJL6o6VZu5OjgDh9LbxaPKb6kg="'
  },
  json: {
    email: 'cf710bf533a508f76875@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="459baffc4b853c22b7cace33802463874be8d52b5008637839ad8b065ee9e402", ts="1705108867", nonce="JzkPyq", hash="dvro2QnZ+c0ab8fcDgwm1gTRDrtMT5MH4d/2wiQK28I=", mac="sk4g1uw3d9i7Jddel8QbooHv/8hHhSD/0sM5PCvzh00="'
  },
  json: {
    email: 'cf710bf533a508f76875@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 189,
    error: 'Conflict',
    message: 'This email already exists on your account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email exists in user emails (44ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4537996f0190fe82856e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '4537996f0190fe82856e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4537996f0190fe82856e@restmail.net',
    authPW: 'ddb12616a310f29a8b4d161b990fd3843e2e3869806e6b6ffe706df92867bf74',
    authPW2: '853cc16e2cb67ee26f2d0cb9b665dd378d6b12da88b7331ee56d97adfe3e6a3c',
    wrapKb: '24f3074a25657cbedd0c60d6607cb4730dec87cd6ed8d285f2048b2d7950db80',
    wrapKb2: '18653414f0121214291d3d5965a976c7a56b5e84415f03de5dfb9fb7510ac589',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:41211e8fc95dd23a7fdd40a39ce4db6b6a9d72b389726e614c5e7669936cf0b3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '59948e3369024768866e6da8740e58c6',
    sessionToken: '4349da071fb551a93290e7bd2dba1a30c80097e2b4b65ae170d5159c3cff5b5b',
    authAt: 1705108867
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '59948e3369024768866e6da8740e58c6',
    code: '5854961684f3bb1a4e7c35d6771d6ce5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e7281397e1c4ae99981bde6474073f6acacbd889afd1e1e71169ba44db9e4ba6", ts="1705108868", nonce="jcBmom", mac="kjrXgoedgmgHxNnr0qOcx4alubcaSkTv5llrclFbfug="'
  },
  json: true
}
!!! response success {
  body: {
    email: '4537996f0190fe82856e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6e8b78679d8b4ead4b82@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6e8b78679d8b4ead4b82@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6e8b78679d8b4ead4b82@restmail.net',
    authPW: '813de75c26f7c1d9d8b0c57db4b784ee5748b980b5ecf78bf1e39619dae15421',
    authPW2: '43b9fa7ba419797faf56088190f2dec00a1c404cc4d1c4eee41e3083a3aab643',
    wrapKb: '4bafb14fd949fe30eb70aa5d88f3230b22028e06b947869b9007ed5751e2573a',
    wrapKb2: '03fad33b9c4ee02a8f2e2c78e877b4505a25d999dd6cb948b66ac58dc811b8c0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:97c78bf37509f0926a9f6588baf5c30fad173294c67cc98d9cbf559f68c696c3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cced2da4ae2f4770b860fc8c15727675',
    sessionToken: 'b5e3ab7ebdfd474b3602d07c6c6ce612afad0bbc711822df639a1210635cdc75',
    authAt: 1705108868
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'cced2da4ae2f4770b860fc8c15727675',
    code: '535fb531ec32bbe869aa58da78716a0e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="defbc64d46e3929f29c845a74bd5524593627e438a7d9d019c5736bb93a79604", ts="1705108868", nonce="vsG6HM", hash="LP6gq7nnwgHCcP9ahOS6WQmoJYeC9/gza6lssdRgdXc=", mac="kWVeNbhbgizbJqF0v0TQVHkzV5j4BWW7TrGDkih4MS0="'
  },
  json: {
    email: 'a2488568b5fae5fb9d63@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="defbc64d46e3929f29c845a74bd5524593627e438a7d9d019c5736bb93a79604", ts="1705108868", nonce="1CVBS3", hash="xqcEa4efZM84jFC+KHZ6lNJPdJO1TeS4chotSdjTiR8=", mac="5murmcAX3EvOjoiCfho5WiCpPQ8xxsWbIlGQ+ltlKsA="'
  },
  json: { code: '326985', email: 'a2488568b5fae5fb9d63@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e7281397e1c4ae99981bde6474073f6acacbd889afd1e1e71169ba44db9e4ba6", ts="1705108869", nonce="wkpsKo", hash="LP6gq7nnwgHCcP9ahOS6WQmoJYeC9/gza6lssdRgdXc=", mac="9XgpeAA73EZrOVJFWo3McVXP1WulQ4Qw6R0aJUiBLIA="'
  },
  json: {
    email: 'a2488568b5fae5fb9d63@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 136,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when verified secondary email exists in other user account (557ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'fe89b9f00bd05688d537@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'fe89b9f00bd05688d537@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'fe89b9f00bd05688d537@restmail.net',
    authPW: '3c02ebe04e46f1beedfca94fce537b275156c2c22d3ecabaa946fdf73f1f1be1',
    authPW2: '87560a3eb7f1950195287ca8732786343573509527c442c7b1bb12e9a1529b0b',
    wrapKb: '0bcd84a151fb48a03538d25b30cb7b205aed4c04402d6f4a12fb74401f1a1fff',
    wrapKb2: 'f7ba73d4d7d0fb794700ef461ac1a495d1a73a85af3827602685836cb81302ec',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:687b7733652c897a37b6d5ff16521d982f75702aa8de1ba980f6c1db43708adf',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b3739c061aad45aebcb35fd4cf3a1354',
    sessionToken: 'd0e53c14b7c31c6c94b62a77d4fde7061f8aa74422ccfba21778669f028c154a',
    authAt: 1705108868
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'b3739c061aad45aebcb35fd4cf3a1354',
    code: '774fdf778901952d7a783be28572a829',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="93ee6a9af201c09c44c0315b3adcd93daa905177a5ff1937d40c4dfc37d6b858", ts="1705108869", nonce="ZrVAdY", mac="88lKZeyXy1lwDOvGdCKZPoC7b5HwIPk1c0cuc+wfekU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'fe89b9f00bd05688d537@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'fe89b9f00bd05688d537@restmail.net',
    authPW: '87560a3eb7f1950195287ca8732786343573509527c442c7b1bb12e9a1529b0b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'b3739c061aad45aebcb35fd4cf3a1354',
    sessionToken: '7623eed56d48da324ee0c1a9b87cfeb93b793712cef575aab5c62a7e0b5b05f4',
    authAt: 1705108868,
    metricsEnabled: true,
    keyFetchToken2: '1800608405ec07c047ab719048ba505504059821bbe0aa0d5bbc1bd27b3f0737',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="618cc6eb639ca62c65d5cdc9d928a7212a53ebb9316105b952b6bb170ba1245b", ts="1705108869", nonce="Hv9C9h", mac="FtsBoa2yrQDJD465C3Y7ThruazHIHmOpaiB7WI91kkU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'fe89b9f00bd05688d537@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="618cc6eb639ca62c65d5cdc9d928a7212a53ebb9316105b952b6bb170ba1245b", ts="1705108869", nonce="u_H6Re", hash="QfnOwhH+o25FJWK2eD/TY03o26l74KR9pGv5NWYoF+A=", mac="bc3J3//6VpPaEO+MSZ/ksGt6uOg2yBaP6ab9fr+CocE="'
  },
  json: {
    email: '18659c1e6987081b056f@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails for unverified session (201ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6fcbdacbebc0194eba32@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6fcbdacbebc0194eba32@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6fcbdacbebc0194eba32@restmail.net',
    authPW: '249dd0ac8bab6a9884836ed4a16bed2d885e30f9380d1361788bfd30f1455db5',
    authPW2: '24e8ef9435c6936709142aa7f0b7cf77146f32d77911116959e2ce0796217ffc',
    wrapKb: '740b7037e721bb06fe9fb00287708b4fa47b9acad136610355089a6055a802bb',
    wrapKb2: '2e7214d8280213fcb14982e637d02ae0131546d23c31e871e267ec78ca35e333',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:120106757b99c9986f6b62b553c72e15c5d5193296e71fea7c735d7696e80e0d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e257df63ecff47f5bcfab95fb4f3e75f',
    sessionToken: '44fefaba1e1aa79ebf7e4bfe2f3d59c90c32b24445b342f1aed1ba678586abb3',
    authAt: 1705108869
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e257df63ecff47f5bcfab95fb4f3e75f',
    code: 'd459cbb6e22193e425cbb056a7022f12',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e499b241a8401f3de149cc242c99c5087556f53e67ded95cd0816d854cde9ef2", ts="1705108869", nonce="yUEH5r", mac="2oVxVLkvBzlk8dgXFHGCsNnk0SO+UofxKB71LpvIF2Y="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6fcbdacbebc0194eba32@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'eb1cad69c998635cb760@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'eb1cad69c998635cb760@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'eb1cad69c998635cb760@restmail.net',
    authPW: '98a8033951e70918b01637db4a7c5f4d52844d02c4abcb220eba99d81380585b',
    authPW2: 'bfb5045ae9c084d80b3fe097f0ee540a7db503391ca4f0f49608eb9f4c310844',
    wrapKb: 'ade54e45fa6cdbfb57c2907aac8a22e712c76e55dff37f9020cf0240e6d57237',
    wrapKb2: '5885e23dd885ff3c1736f788df2a1ef91191892fd382c1ae3ddef83d5af71869',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7da83b32155ec5b4d3825a7ba27388da635e62c21570467200b996819680e909',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6ccc51a230c5491e820b36157f9a0894',
    sessionToken: '344c1ac87e0ab6d819d2a25ea6a4598292ef3fbd44e480467107864e848c2eb5',
    authAt: 1705108869
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6ccc51a230c5491e820b36157f9a0894',
    code: 'f9594ff542eaef25c745dc3cc1f94c9e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e499b241a8401f3de149cc242c99c5087556f53e67ded95cd0816d854cde9ef2", ts="1705108870", nonce="g2skKS", hash="ky4DaOPH2Os01odPNrGKc/2cCRyzgMHNjanFlxZF3IM=", mac="5i8iQWVKPg8D+M7BJYjp1YEIphrCwM37S/QnObcHXhI="'
  },
  json: {
    email: 'eb1cad69c998635cb760@restmail.net',
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 140,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails create when email is another users verified primary (524ms)
    should delete additional email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'a5bdad7a32b09381b0c7@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'a5bdad7a32b09381b0c7@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'a5bdad7a32b09381b0c7@restmail.net',
    authPW: 'f66722d0484467235fba3b3ef1c7d50d3390d25d14c9ae36abac93f5d183dfaf',
    authPW2: 'b504c1466ef755cff63e22c2a83c6d2ec92246be4f738cdb217c32e9be495c79',
    wrapKb: '96528545de6703fe03b7e8c35449e8417df0defbe614e1b4cc1563331d53eebd',
    wrapKb2: 'e2f3ea059dec8e7c622cc4493fde4d837b7df0fcef319a4f33da6c8a53f5cdd8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f2fabe391377df4798cd8e48338112193eba91e5ec1e66ad18353a809123e15f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ddc3d2dd08654265b876430cc2ba2807',
    sessionToken: 'a26ba309e855d3f757580d6f9b8aaa1fca3cdfebf0b11f354016b583c42acb6b',
    authAt: 1705108870
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ddc3d2dd08654265b876430cc2ba2807',
    code: '9f7a4cfce666d76accfc1746ca04883f',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="2boZu4", mac="IiNQklR66xWwvb6KUBlLcKKth0oBa+DZrDGrzOdSBtA="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'a5bdad7a32b09381b0c7@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="B-lEWr", hash="8LiKymiB3ZLOb2GGA8hd4BRDW3ahWcxCg0zbqJlkeT8=", mac="bfpRsxIk080ykIXC5a9yGWcfVLCwxm2TqGEiN27vjtE="'
  },
  json: {
    email: '5e39fb9d5eb94ef4cb39@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="KrCHM0", hash="MaXqGl1oeROpYG2YtbCbwD4wezHWE/bayt55m9BtnZs=", mac="7b6VN1sfGNQfgnPp+RBYrCMcxLY3EoHDn/YUkovREes="'
  },
  json: { code: '438608', email: '5e39fb9d5eb94ef4cb39@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="4jyWic", mac="znLaIkFlYLFrG2EcPblL/0yAxi28Xs3VHAVganq52Ig="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a5bdad7a32b09381b0c7@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '5e39fb9d5eb94ef4cb39@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="GeoZfp", hash="8LiKymiB3ZLOb2GGA8hd4BRDW3ahWcxCg0zbqJlkeT8=", mac="FnmbUizo469vJHONLbE5/tXU9HHo/hy38dNig3SctQA="'
  },
  json: { email: '5e39fb9d5eb94ef4cb39@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="204de006acae0b70ac5da7e121a9daffb86506bc7c266dd6f5d794ab36e9531d", ts="1705108871", nonce="Jf4LLH", mac="FFu5jXgiFnerVV8QcJ6hVpmMo2TwXRkYdrsq2VACx/E="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'a5bdad7a32b09381b0c7@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
      ✔ can delete (54ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bb0acba27599e0025aed@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bb0acba27599e0025aed@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb0acba27599e0025aed@restmail.net',
    authPW: 'bc50dfd0dd8915367a2581aa9d74c6753b5c2023f50519c604f61fbb836a22e6',
    authPW2: '152c9a354adf6437659ed5a9e7f4f2dbad36511e5b5ff14d5ff78310de5303c6',
    wrapKb: 'b9b3f0cbf89576c98a1de047b0c41e7a0c4541d355c98d993e5f15315ba96a85',
    wrapKb2: 'd913a90635657b478b3956c9f48bd84628edc08b32a49df62d012c777fa593ce',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8268669a9dca396768566ad521f53541e2ca975ccc54473c36085837a104a967',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'cbd40f64a7e7433496c8ce7f11680343',
    sessionToken: 'a377ac8b5629e639e2e85f7a975870a57ba51f075bb332a23f076f52ed26180d',
    authAt: 1705108871
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'cbd40f64a7e7433496c8ce7f11680343',
    code: '8ab3291f0563be7a515b63967a6034c8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="QIqXeh", mac="B66yUAP3wZg7vJGw4pejvOJruEjtHL4bP7pEbU55tao="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bb0acba27599e0025aed@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="iHyyNj", hash="kdCikZvvg6jC9CSqY0Lfpzuh/nD7fi+HsB/WWFoP0pc=", mac="cV3Twl7+Wt9kbxbeOXhme6asALYPG5pnwj4LxLI5/m8="'
  },
  json: {
    email: '8f5cfa486be1dd678bc6@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="l6oVC0", hash="7J3eU6JpJH8kcJPlNGAAmVLQdCRTHTtmk+jC794V5YI=", mac="pcX2k9S6YdzxiPLodkwKdTL+2PtdyP4UCr8wvrdFoUg="'
  },
  json: { code: '620149', email: '8f5cfa486be1dd678bc6@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="bICB2o", mac="YhdhPsNO38tNH+GkRQt4HZauDPzDzKO0gbDX4KIWRwA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bb0acba27599e0025aed@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '8f5cfa486be1dd678bc6@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb0acba27599e0025aed@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'a4d9b97d72c19852fb558e18182067fc489911e029b0373f366b306b250baedc',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="kWyfjw", hash="kdCikZvvg6jC9CSqY0Lfpzuh/nD7fi+HsB/WWFoP0pc=", mac="Wwbj9jZXIr1aqZyqg1z/LI1u/2Y+tRH7EJvi8l89VyY="'
  },
  json: { email: '8f5cfa486be1dd678bc6@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9061e1fc105a6512d8b8670d83b5b3073852aadb4662cb4007bbd0ca3f5dd2f6", ts="1705108871", nonce="-S7zTs", mac="D9JDKo4kkL9QXFr3n4KtATcJRKecQ6e0pE/k7pnDmq8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bb0acba27599e0025aed@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="168c4caa0210fd07a03dc39c12a9b5de549578ff681c7dd22adb58a4b6b833a1", ts="1705108871", nonce="qeIETI", hash="rD+7gtJFBenz0IzA3K+CaNqbXNqR3/YexZHuGyBwv34=", mac="yTBSdb+FYqIw4bw7uTiqbw+R5HxeQo9NRTWISHKzxxU="'
  },
  json: {
    code: 'c849bed42604ac76552af632ee20ef36',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response err {
  statusCode: 401,
  err: {
    code: 401,
    errno: 110,
    error: 'Unauthorized',
    message: 'The authentication token could not be found',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ resets account tokens when deleting an email (108ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7784ba1fe7f1758e0bfe@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7784ba1fe7f1758e0bfe@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7784ba1fe7f1758e0bfe@restmail.net',
    authPW: 'f1ac59c78dab9fd539c1df1f557eb6e1acae0b02eab74fce45f220d57a1f1dc0',
    authPW2: '5eaf9e96d9063dc4fe65eda18630261bc4bef28322712782bbfa35a23f789755',
    wrapKb: 'def6e550bdf7e037fe77aa77c6d48559ddd926b917e2ed9eabaa5e9e037a28b7',
    wrapKb2: '30ff182e3654f6d83819ff92ba1851348d52890894a083113ca12984d4f6e9ee',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a2e4cecf2de76a7d02df6fbfc24be10252515ed1e04206e39bfec787e41261aa',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ef7937feba2a4969bb6a4b9685817d19',
    sessionToken: '4904822e97e41e4ad5bc8ff5b7658ed8fd2bb25deba4f8d49391ad5c55e105a2',
    authAt: 1705108871
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ef7937feba2a4969bb6a4b9685817d19',
    code: '07f9ab1800af655592522e358674a802',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="436e06c326d1ce6f5df53d468b8ad3bdb650c982fa3e65661206833b3889147e", ts="1705108872", nonce="DSxm2S", mac="5SrF1RSZdNCUFoST8iHQZG2MBaImkEfaNB8mmrtexns="'
  },
  json: true
}
!!! response success {
  body: {
    email: '7784ba1fe7f1758e0bfe@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="436e06c326d1ce6f5df53d468b8ad3bdb650c982fa3e65661206833b3889147e", ts="1705108872", nonce="56-BE3", hash="SvpYybWQoAdu0fEHf+QQICldSXSNjg20jZ90dvtzPrQ=", mac="0gGWC5Rneb6lvNS6HbTHAZZ9UW7UDn/TbVAP5TLAhnk="'
  },
  json: {
    email: 'ef41a3e1c733ef6ff956@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="436e06c326d1ce6f5df53d468b8ad3bdb650c982fa3e65661206833b3889147e", ts="1705108872", nonce="Bs8zo6", hash="BSNyuKhOVFqJhLZueaae7dX0GRgSfyj9kPelTczpFLs=", mac="F1Aok39JP0bUC8sY3gBNgCanC1kDFl1nrXYO+8WLoec="'
  },
  json: { code: '509505', email: 'ef41a3e1c733ef6ff956@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="436e06c326d1ce6f5df53d468b8ad3bdb650c982fa3e65661206833b3889147e", ts="1705108872", nonce="DlaIsG", mac="MHaC2UKBvBV6LYPsIZRFoKkW9xDY/2Lav4rLrfmP/Lo="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '7784ba1fe7f1758e0bfe@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'ef41a3e1c733ef6ff956@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="436e06c326d1ce6f5df53d468b8ad3bdb650c982fa3e65661206833b3889147e", ts="1705108872", nonce="DqU-0w", hash="TH7Ly2boI3aHfr/MdksRIiJvhg66JKgps+pF0OBOM60=", mac="p0KcOb/qh/nfkZucwHoXybhKci25aSBl9iaxCZGSqKA="'
  },
  json: { email: 'fill@yourboots.com' }
}
!!! response success { body: {} }
      ✔ silient fail on delete non-existent email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c29dc486994cb7366648@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c29dc486994cb7366648@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c29dc486994cb7366648@restmail.net',
    authPW: '2f793e9facbd4d60db6e5b02a276b79e2b569269664b96a7a04d436f64b0b290',
    authPW2: 'bc14aa8ef768bd59a60804abfdeab18c16a290dce6e00c434b974ee9f02b92b0',
    wrapKb: '4a5902d2f824ca5ec44769b2ab9f85f61dc92de8351caca0562f7cfa8051e9df',
    wrapKb2: 'c69d60f6c4a851f84c80afd5f444c9be9fe0f802f460438af763b84bf05c4fc6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:899bb5d6b85007db89ac0253554df91b1688937e746e2919e01f031bcb13d6d4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7e89d9b95dcf4cb598bca2d6d2dbb7b2',
    sessionToken: 'c1e16203d5a1eb098b762efe6881490ddf0f2992c797c393b9a16e70c5d4a7e5',
    authAt: 1705108872
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7e89d9b95dcf4cb598bca2d6d2dbb7b2',
    code: 'a4a3c73871c135f2025110d7ab714220',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8172fe0a43d770b1a300e7219039949dc9d6c6c1d3be7d013982232e7d88d1b0", ts="1705108873", nonce="hjzGu0", mac="MIWtjfLt1lKKarczs9Vo/VjJ2CNKLb4eBkdg5ShykQY="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'c29dc486994cb7366648@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8172fe0a43d770b1a300e7219039949dc9d6c6c1d3be7d013982232e7d88d1b0", ts="1705108873", nonce="9GwMNB", hash="q4FUxO7WqSDAJbodhNGi9wyXbVFFLi21NG9xXGZkDvE=", mac="+Ig10nrJIM/TtDYP9V2NvYVPtesDl5mFMiedsVgafGk="'
  },
  json: {
    email: '5b2cef2cb8775d9c3ae9@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8172fe0a43d770b1a300e7219039949dc9d6c6c1d3be7d013982232e7d88d1b0", ts="1705108873", nonce="tfHa3H", hash="460gpy/0sc1cgIY9Fa6zMlkpXDWqwNytX95P/PuD608=", mac="8ujH5fJg/4JOiNcdEfbOOduv9nYEX230mWjgl+NXLDw="'
  },
  json: { code: '193068', email: '5b2cef2cb8775d9c3ae9@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8172fe0a43d770b1a300e7219039949dc9d6c6c1d3be7d013982232e7d88d1b0", ts="1705108873", nonce="QegoXd", mac="VFfnkEX7CB6PE57vdbFYKnls0CcgZ9Ki/kZAHqu/0uI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'c29dc486994cb7366648@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '5b2cef2cb8775d9c3ae9@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8172fe0a43d770b1a300e7219039949dc9d6c6c1d3be7d013982232e7d88d1b0", ts="1705108873", nonce="gcxlt0", hash="D4j6xtZNxJuVzQSaahWw01L41UqVo2bTRMJNTeuL2/8=", mac="rnZOfa/rbKvVLIVmfDK/Fxm1A8pQAfApKC5E6UvVavg="'
  },
  json: { email: 'c29dc486994cb7366648@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 137,
    error: 'Bad Request',
    message: 'Can not delete primary email',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails on delete primary account email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '078204a2befe848b16a0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '078204a2befe848b16a0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '078204a2befe848b16a0@restmail.net',
    authPW: '02af12c65bb2edbb31f88c1f097fa51e3faebab82d99fd28943533dced0d12c9',
    authPW2: 'e8cb9e51f6b192e01b158cef91867278034eca31aed8d0d3b3e47948c6c4da88',
    wrapKb: '87844c0040cbbf9b044f822757832909bfad0954308ed7c43931c98d5dfdaeb4',
    wrapKb2: 'f0410dd7a7d4426ca551d1985ae1fa9092ccaa8905f423ca40eecae1b2feb123',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7e73589b607488cc44881da787f7cc7a77e77a19e25be73c8181676defe28cfb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e981af574bb94f5b8eb7e71a27a3d0d3',
    sessionToken: '9979b30584125e640785244415b28dd459d16fe9e66ed5ebbe2bfac4e92614ee',
    authAt: 1705108873
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e981af574bb94f5b8eb7e71a27a3d0d3',
    code: '058dd8744547664af69e367f6ecebec2',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a48e8e04958cddbafca2c597753581bc37b53592bcf7a77b28645e837c69ea0d", ts="1705108873", nonce="fSIqeW", mac="Ya90cLAngALkcvNNkw7Q3kWpdRDbiOwjwN3tzQJnNP4="'
  },
  json: true
}
!!! response success {
  body: {
    email: '078204a2befe848b16a0@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a48e8e04958cddbafca2c597753581bc37b53592bcf7a77b28645e837c69ea0d", ts="1705108873", nonce="jW5dSx", hash="6XheAwVSdu77Ac5Os17zXya4OvI5fj6wE5PM9PF1nZ0=", mac="DOOEAcpbCIgOBYUD1uhjnErQQ2pjHFixpLqTPVvn/TQ="'
  },
  json: {
    email: '1f52199c65b2b4b1694d@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a48e8e04958cddbafca2c597753581bc37b53592bcf7a77b28645e837c69ea0d", ts="1705108873", nonce="GcaRoE", hash="V6sXWb/D8kiKBkUAfdGCfq936SYCcE3xA3kWbiiw/Tc=", mac="46t1TQL7jcqjD68+nRKuJuiKqJ8u4pOoZxMn3DgBgWE="'
  },
  json: { code: '999250', email: '1f52199c65b2b4b1694d@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a48e8e04958cddbafca2c597753581bc37b53592bcf7a77b28645e837c69ea0d", ts="1705108873", nonce="hztFSu", mac="in0Nxe+8wyX5CFMPU3Yx3181LThzvl4jAGFEnVRYmqA="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '078204a2befe848b16a0@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1f52199c65b2b4b1694d@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '078204a2befe848b16a0@restmail.net',
    authPW: 'e8cb9e51f6b192e01b158cef91867278034eca31aed8d0d3b3e47948c6c4da88',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e981af574bb94f5b8eb7e71a27a3d0d3',
    sessionToken: 'c6bc2bead668a99b8e03a684dc7d547384aab1f63ead69be2db933245defd1c4',
    authAt: 1705108873,
    metricsEnabled: true,
    keyFetchToken2: '65cc9daa1d1f7358861561074fee7fbd9ffafe4812e886a1d6da83eec4810dd5',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="87563d16fd775daacc74e6d82a99a2aecfa35400f16ed8841022071bb96f687f", ts="1705108873", nonce="H2t62M", mac="7AjnBGTocTV++N2+Z0xRu0pez5to/+ys57A/9J5wrrU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '078204a2befe848b16a0@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '1f52199c65b2b4b1694d@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="87563d16fd775daacc74e6d82a99a2aecfa35400f16ed8841022071bb96f687f", ts="1705108873", nonce="jatQ1i", hash="6XheAwVSdu77Ac5Os17zXya4OvI5fj6wE5PM9PF1nZ0=", mac="+06d4rpNGknGcXKqh692thSwhphojPvGmo1o8MqN984="'
  },
  json: { email: '1f52199c65b2b4b1694d@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 138,
    error: 'Bad Request',
    message: 'Unconfirmed session',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails for unverified session (225ms)
    should receive emails on verified secondary emails
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd9736fbd2ebb1921d335@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd9736fbd2ebb1921d335@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd9736fbd2ebb1921d335@restmail.net',
    authPW: '2b0acc666ade82d22cd313884306a6ff4c3dd28619a44a127857119f083979fa',
    authPW2: '8a9bf8adc72aa61ed3805a9ba2fc39122debbd7abd2cd02f41c6686d1c17b242',
    wrapKb: '7ea6680909b6c053e29ef553267f796994dd036118b6c42e3c537a90eca12632',
    wrapKb2: 'ae40b1401c06ab33e2141a711595b5e4fe87498aa5af12d98b6a63378790673d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a52384523f9fc690ba4b33872ce49ed5f86709c8b79ab1941499756bc3f54f59',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7e3061dc527145fcab4df153fabc1040',
    sessionToken: '060ec7fb12dab9f7d636c1784cc875fc0d4d65b26e405db7698a5030f217de40',
    authAt: 1705108873
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7e3061dc527145fcab4df153fabc1040',
    code: '3a0a9d94a1851037fcc3bd320b765646',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e6109bfef739600471b211a0b73219f234f9596b7a7b3cf45fe1529222058c75", ts="1705108874", nonce="QI8PiE", mac="XwtlzS176asvfceL2FSIWgNU9vg8u/oOGZTIPSxGXtw="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd9736fbd2ebb1921d335@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e6109bfef739600471b211a0b73219f234f9596b7a7b3cf45fe1529222058c75", ts="1705108874", nonce="dLkC_9", hash="gl3Eqf4BNl8m97BYCLPhD16Ypgb817Kg8w6+5d3p6yQ=", mac="9a0r+e73WGCaHb7zxt1SuKh/MBST6msM0t4kNu+AP18="'
  },
  json: {
    email: 'e3dc6871e90a1733384d@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e6109bfef739600471b211a0b73219f234f9596b7a7b3cf45fe1529222058c75", ts="1705108874", nonce="27JrDR", hash="HTKtELY8IuqK3AUcMPX4J5Y8Ls2JblrhtPMPLjD7o+k=", mac="sc4jT7UooL/GoqdcTDA4A8jFV01skoaJRLCD+l7oExI="'
  },
  json: { code: '021222', email: 'e3dc6871e90a1733384d@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="e6109bfef739600471b211a0b73219f234f9596b7a7b3cf45fe1529222058c75", ts="1705108874", nonce="gnWd2b", mac="rinObCx+rTf6zkbtqnkJve8uGQQgMLZpmLa935Tdw8Q="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'd9736fbd2ebb1921d335@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'e3dc6871e90a1733384d@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e6109bfef739600471b211a0b73219f234f9596b7a7b3cf45fe1529222058c75", ts="1705108874", nonce="QTZqM6", hash="ZJG0prowoVKEatEJfBHawVxKkWj95mggD12t5z0V/MA=", mac="BzBkq9F5/1O+9Udry93lLfdmS4SVHwEIEBcVjjcHtOA="'
  },
  json: {
    email: 'b106e24bfdc91c79e6cb@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd9736fbd2ebb1921d335@restmail.net',
    authPW: '8a9bf8adc72aa61ed3805a9ba2fc39122debbd7abd2cd02f41c6686d1c17b242',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7e3061dc527145fcab4df153fabc1040',
    sessionToken: '863d35d204da1cfbdb773c6de70d4d54f80e73296d01831f224c2311da3a4e14',
    authAt: 1705108874,
    metricsEnabled: true,
    keyFetchToken2: '275e5d54fc17e486227076722d0511137073c71475c43b80991add5e38dae02e',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="612231e2abd961b3bb18901f88d2d8e51223006a3023201324d93a6d2ca9f41a", ts="1705108874", nonce="bOG2aV", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="FjLGXnpiWXnveilnu7sxd8Wtc96Et6ZWNxsYtNGI6DY="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
      ✔ receives sign-in confirmation email (236ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2f84f759f142724c96f3@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2f84f759f142724c96f3@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2f84f759f142724c96f3@restmail.net',
    authPW: 'b4f3017e489586cb50f05cd945e1e941dfd5fb663fba0e34eb7b98850d923d69',
    authPW2: '5b15a5781876f153cf32bf88bca9538624f2e26a9b118c2d08669dd8339f89ce',
    wrapKb: '31d4d9d75dd4d3c939243e991c77f7d8ae5536663a97369e40b53108c8d5823d',
    wrapKb2: 'f30bced48c937304cbd91e23f2974824d0761b387509b70a212fa24fc3641b23',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2ba8484a2e844d8a01d5844e3b4f39390feda9d3e45983e3cd0ed2155394430c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e6966ca27b834d8a9b6cb10bcc5ca85a',
    sessionToken: '8776dca5c69a858153f5888e376c661d7bb553726b0799a7a1a11602df99468f',
    authAt: 1705108874
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e6966ca27b834d8a9b6cb10bcc5ca85a',
    code: '3ab230dcd5e0d68a05538a2bc360d660',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3e60fb560047c4f6787678010a1feb574c9e6fc54a6901f33e4ebda25365d4e2", ts="1705108875", nonce="lLD2Ff", mac="nzPPLS9ERJtpRUuTJfEsavf25VEQoZHGWMzIlKEXQ5Q="'
  },
  json: true
}
!!! response success {
  body: {
    email: '2f84f759f142724c96f3@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3e60fb560047c4f6787678010a1feb574c9e6fc54a6901f33e4ebda25365d4e2", ts="1705108875", nonce="YAnfVr", hash="PD/m7uTfn6GaggrC9hHFSF6/BEGYDe8madEvxRAOCNQ=", mac="7EeiceZ3R4TBm9C46u5w2DfnrGQoQYRtMvGSC8bkn9k="'
  },
  json: {
    email: '90c394dbc2c57354b5ce@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3e60fb560047c4f6787678010a1feb574c9e6fc54a6901f33e4ebda25365d4e2", ts="1705108875", nonce="uKfJB0", hash="EavYgliS34Y1hCp5YDQW3G4RwM5HpoLTIHf2KUUAMqU=", mac="q/eaD3S/3SxvUAWoQN0RfPVMoN6VIDgcU8rmASjTHYY="'
  },
  json: { code: '085406', email: '90c394dbc2c57354b5ce@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="3e60fb560047c4f6787678010a1feb574c9e6fc54a6901f33e4ebda25365d4e2", ts="1705108875", nonce="Yxgon6", mac="2y68O8ESDYYKy7Ak8R6hQwwOu3eM5j3qUiPhJKC6UX8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2f84f759f142724c96f3@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '90c394dbc2c57354b5ce@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3e60fb560047c4f6787678010a1feb574c9e6fc54a6901f33e4ebda25365d4e2", ts="1705108875", nonce="snPeLf", hash="z2ge2iikCBaMSmYo4jLHZVL8+JCmDZO1Ms6HHoz1IDo=", mac="yW3BYIlaEyIDNTFoGEaTco40D9JX+z9tDY4jkqepb8k="'
  },
  json: {
    email: '542899cac060dc42b4c9@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login/send_unblock_code',
  method: 'POST',
  headers: {},
  json: { email: '2f84f759f142724c96f3@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login/send_unblock_code',
  method: 'POST',
  headers: {},
  json: { email: '2f84f759f142724c96f3@restmail.net' }
}
!!! response success { body: {} }
      ✔ receives sign-in unblock email (76ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f8d39dd94acf416b0443@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f8d39dd94acf416b0443@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f8d39dd94acf416b0443@restmail.net',
    authPW: '2a4b59781bee961eb7d04dc680766ad1c6e0ef68f8cc5743b1146b580815d20e',
    authPW2: 'c4cb7fc1b6f873284883e1587a96d569be7461f7c00f08a9d347976063f8de90',
    wrapKb: '5a8327badb657fbd130108386b0b1feb693ac2c4f69b47f93c74b2313ca86911',
    wrapKb2: '5f27ad4230015252647527d027e4848e075d94e0c7629065ed257599b2720345',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:84584f9c3a4ed79561c377757a8eca06c5c078484da8c9c682b91202f5f9ba68',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '14f124c297db460eb6ce1d7f245e955d',
    sessionToken: '6079a55b978f112be40264505d1b8a5383ac81a29a3d85705cfbac534b24481e',
    authAt: 1705108875
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '14f124c297db460eb6ce1d7f245e955d',
    code: 'e437477024ab2923f779859d8d5a36be',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c60b969f4ddefd2ff7172b29a2317fc6e6b4f9b5c1be974ceddfe4c09660eb38", ts="1705108876", nonce="Jjhw05", mac="uI02+rGelpqkadysSAjd6gk7NfeiWF4X/fc7F4xSk+Q="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'f8d39dd94acf416b0443@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c60b969f4ddefd2ff7172b29a2317fc6e6b4f9b5c1be974ceddfe4c09660eb38", ts="1705108876", nonce="U5bf_F", hash="cbzW/VUdVTb0plo7BZ9SHuoDOQ3nZOw2JCfF0MJCm20=", mac="LHCRjO+K2zyQLLqZQFPzfQWbuXUQV8zGI0OIMnvC3oc="'
  },
  json: {
    email: '02d20cd599cecc1c799c@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c60b969f4ddefd2ff7172b29a2317fc6e6b4f9b5c1be974ceddfe4c09660eb38", ts="1705108876", nonce="PP01Qm", hash="fh94pVtsS1FzONtAf54/Z3Eja7nv3Icv91Ola9OQEe8=", mac="h6Il8UR9JdPTXgd6yF7q5+jtLSJ6U0hRrX5JDv/LWJU="'
  },
  json: { code: '238070', email: '02d20cd599cecc1c799c@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c60b969f4ddefd2ff7172b29a2317fc6e6b4f9b5c1be974ceddfe4c09660eb38", ts="1705108876", nonce="UaQnkl", mac="v6TQYlH+ETNG7GRiL0HGy70++QPzXOvmQNxox9C8N/Q="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'f8d39dd94acf416b0443@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '02d20cd599cecc1c799c@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c60b969f4ddefd2ff7172b29a2317fc6e6b4f9b5c1be974ceddfe4c09660eb38", ts="1705108876", nonce="8H2iMj", hash="nqRt2ku+urwz/KG4PKZBUlDlIAI1WdZOFe9/U5I46ho=", mac="elOd9XUBfmhSHY0dMdS+wtv/gBzIxvnWfGpjdewrxY0="'
  },
  json: {
    email: '73ab6261d8e152027105@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f8d39dd94acf416b0443@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'a2c0719e1eceb04a37c3fd3ae0bc70b25c0bea13df6b02d8c1eefe3a8f8eb35d',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
      ✔ receives password reset email (41ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '54663bb34b248e2ddd95@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '54663bb34b248e2ddd95@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '54663bb34b248e2ddd95@restmail.net',
    authPW: 'f8158fb346095615e2547e1d2998a719da987399085a69576d5e856ae4b7b98e',
    authPW2: 'a506c375c379022e028269f393172165dea3a6582d61a4686efbad2307726b73',
    wrapKb: '9a4075fbe635e5e9c2fcf2ad88fa9a0ee6f679e0f33bd8e2c473f756d1528ca0',
    wrapKb2: '70f34c7926e1da96e7bf45b49b2ae581c8e2ba85943c30e352b989b86820d731',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:512a9d68eb40ed36d3c7c8ec403a00472ffddc4b4cf1e50dab74c9287de606bd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7a90a9c2439145fa8bf84d3c41737a4d',
    sessionToken: '0e82e13aca60ce6a3938f7e9793b10fde87dadecdee41aeabbcb5bab7f8e4485',
    authAt: 1705108876
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7a90a9c2439145fa8bf84d3c41737a4d',
    code: '98acfd24c46c5815778309012027fe35',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f6624cefd4d74d8776945ab9fb7a92af6c724513473a3fe11ff2f2372f31b694", ts="1705108876", nonce="lPe4vc", mac="jvzsHsEm2MGcLj0+xoiFCCoxtIjxx14ZXr9VsK7EFvo="'
  },
  json: true
}
!!! response success {
  body: {
    email: '54663bb34b248e2ddd95@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f6624cefd4d74d8776945ab9fb7a92af6c724513473a3fe11ff2f2372f31b694", ts="1705108876", nonce="cxPgOb", hash="127AfDnBV49URsX27F3YtGkU0eaNIkDJvUl6OukYUMk=", mac="f+bEDuhg6NEwVPAo5q0mR0fYUgDiVpIGTozQZyhSv2Q="'
  },
  json: {
    email: 'f87acb72f38daa0d52f1@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f6624cefd4d74d8776945ab9fb7a92af6c724513473a3fe11ff2f2372f31b694", ts="1705108876", nonce="Xto0Jf", hash="QFv0TR9vBmBDFfG9UJBSbDmbVjZ930TFcJJgaIjx2GA=", mac="6EwtZXkZNy8ybY5KbiMjeGJq1YHwSYjh24oGoaulj4E="'
  },
  json: { code: '657403', email: 'f87acb72f38daa0d52f1@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f6624cefd4d74d8776945ab9fb7a92af6c724513473a3fe11ff2f2372f31b694", ts="1705108876", nonce="rOpgx1", mac="L639txMFm++mIMU87rdFO8/h+W390QYDxMUyUudR+cE="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '54663bb34b248e2ddd95@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'f87acb72f38daa0d52f1@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f6624cefd4d74d8776945ab9fb7a92af6c724513473a3fe11ff2f2372f31b694", ts="1705108876", nonce="UAdHN1", hash="2V75BJWngnoORWRz2gE4EqW0N8g+HTDwllKadS94VxA=", mac="cMNX9BNev5jd7Qo7N4pFK6Mu8DrRUrz0/SWRUYPkPRA="'
  },
  json: {
    email: '4de87960cc7bf84247b6@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '54663bb34b248e2ddd95@restmail.net',
    oldAuthPW: 'f8158fb346095615e2547e1d2998a719da987399085a69576d5e856ae4b7b98e',
    oldAuthPW2: 'a506c375c379022e028269f393172165dea3a6582d61a4686efbad2307726b73'
  }
}
!!! response success {
  body: {
    keyFetchToken: 'b0c70373249b3d8223e3bda9ae305eecf0deb431932d8b323d279bba6fcf9b74',
    passwordChangeToken: 'bb13adb5861f90b748fe6d7bc2fe24f444fcee71e1f998436c491894076534dd',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5c15fbb5893e6db30992adeec43bf3f3877bdca0307762fb56be30519eff9d63", ts="1705108876", nonce="PjIKEN", mac="2XpXTQCMinBO1BBWY6I7IA3q0I0cj2sGkb6x9Nbk0nk="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '85b65aab0da997ebccfd57af4601fe44eda12abcfe5ca3f0e665ee034363f1d1a1d5b12b332104933e1bdcff06d6ace2280fce4350054c075458f3293a52e1e61046aaa980af168854fb4ac42701d32db278b576c966fd275b537bcd7f0e281b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '54663bb34b248e2ddd95@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:512a9d68eb40ed36d3c7c8ec403a00472ffddc4b4cf1e50dab74c9287de606bd',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:512a9d68eb40ed36d3c7c8ec403a00472ffddc4b4cf1e50dab74c9287de606bd',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:512a9d68eb40ed36d3c7c8ec403a00472ffddc4b4cf1e50dab74c9287de606bd',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="276c2b64aaea3a6b8ae5e112c93eb10d083e7e19e3776a1bc8cce7814a4effd8", ts="1705108877", nonce="oMvree", hash="1IXs0aoXJp0kbA5gaaU2zsnvhwIgVcM3oWrE2RH9P1M=", mac="1rLYiLTYtNH+YLoPaXbodOaSevS30erd1J0fkRYhzLg="'
  },
  json: {
    authPW: '86741fef815a68726c7965db9d071e2de4916a898269dd97f1bc7301441e38cd',
    authPW2: '617212442e824918d24d60d74418bf64a4755b51771b7c877c942a623d5226c7',
    wrapKb: '71a9bdefc809a31f89325485c791573b4a4d69034fb8529072ec64cf12b38858',
    wrapKb2: '5be9b225a2d95b9490ba48b4f8724d484f4fd49e6bb01aef744b5515d132aa72',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:512a9d68eb40ed36d3c7c8ec403a00472ffddc4b4cf1e50dab74c9287de606bd'
  }
}
!!! response success { body: {} }
      ✔ receives change password notification (666ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7b6f18660dc125adff85@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '7b6f18660dc125adff85@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7b6f18660dc125adff85@restmail.net',
    authPW: 'f6d122cac1ebb77fd40a1aafd5604dfe0ef4874b4eae0f7af0206cbc33d45d3c',
    authPW2: '87ebba4ba1c371c7deab5fc203276566cf7ed6b814edee12399a6da3d8f4a5d7',
    wrapKb: 'c2cf60147220c2f32a9cac98b542ee30a14aa8c3a4bb6ca17d945de29b60f506',
    wrapKb2: '5166f45f65a0c877ec143b42c0bea588a2b6c7f4eb86dc1f6624d538b3ffe1f0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:c4eb72a17746e0fb433aa3489505b501936a69077df087fc1a26856bb1f92d90',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0f281093c238449aa057bec2dc23b47e',
    sessionToken: 'f0862ed064ce1d1437ec4d7ed0f4fc79bcbc536f70e4abead19a3da586858d98',
    authAt: 1705108877
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0f281093c238449aa057bec2dc23b47e',
    code: 'e1d8abce2ee702c808808e2900778914',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="26c9e7b5305604c0f2644b949681c91fc2adf0977490ec426b668630a6f5ffce", ts="1705108877", nonce="kTxXSJ", mac="Uu4p/TLAayxKR3lSHlRsepqLQ0WwooljwE7q6wF2lZ8="'
  },
  json: true
}
!!! response success {
  body: {
    email: '7b6f18660dc125adff85@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="26c9e7b5305604c0f2644b949681c91fc2adf0977490ec426b668630a6f5ffce", ts="1705108877", nonce="pe9qjN", hash="0kdL/CSNaA+KgGgQbnU9T18EpMF5BFZj5a/BY5ClIDk=", mac="dlushkUUvAmvimzIMsw0WcalNssshfh6sVW6MeV3xkE="'
  },
  json: {
    email: '78562166c86fc2546c05@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="26c9e7b5305604c0f2644b949681c91fc2adf0977490ec426b668630a6f5ffce", ts="1705108878", nonce="ZnnLHW", hash="KCmi41QcKlTvIHX3v2cJSPmfH3u2OWk+SL6VmxraIQw=", mac="VtCJ48J4ti0nOq24OBGYbLV1l9TgtXxE7CIttWAdSm0="'
  },
  json: { code: '390279', email: '78562166c86fc2546c05@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="26c9e7b5305604c0f2644b949681c91fc2adf0977490ec426b668630a6f5ffce", ts="1705108878", nonce="UVn8Tb", mac="AaFI1I9p0onT2Us7+EfsDZkDJo222Bjdwp10xVy0aF4="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '7b6f18660dc125adff85@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '78562166c86fc2546c05@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="26c9e7b5305604c0f2644b949681c91fc2adf0977490ec426b668630a6f5ffce", ts="1705108878", nonce="MFC7Eo", hash="4c+9NIVX9ZuxmfHP0H0hWIhL5LS+pbrs3s3yrLN1g7M=", mac="jH6HfpZtkfTa0GuHy8fOebhoq+DFdHcIymIpfjsmT6I="'
  },
  json: {
    email: '34ffc67bd0536ef4d26d@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '7b6f18660dc125adff85@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '6aa328632a35dc7082ba0b6390e4c144bb39d6de422bf549fd2f7f13997f5525',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="25bf778630155cb6a2c8dfa43faf80cbcf502091eb3c9fa4cba864c5623c9684", ts="1705108878", nonce="At7Rgw", hash="1wRiJZjLWLB5wihfK6GcFZVj2UZglnJL1GNFBiP0aPA=", mac="F3q8JvqCNi8kgcIyLjQ+nrkjpKo3W5swhLLCp7gfZpg="'
  },
  json: {
    code: '44c0697a7f21c0fcb26ebcef5c50aa26',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '9bfe3ad3f0c994005300fa03b9ee181563d41dbe4987049583c258d3cfcdce21'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7ad96be9122e10ac94cff53ae777d0773edc4887ba8709d202a166f6ac8710e3", ts="1705108878", nonce="pmxO2D", hash="HA2qF/k9kz8AAyr3SNSLno+y+/Xlb9cs0lCgfzp22I0=", mac="VGfGoolFk4tUwFlvoGt9Nu+JjsvRCBvcIYLW2ksZnwc="'
  },
  json: {
    authPW: 'c3e0d3674fa0b036ca1cfcf3255e0ec7737a21f33f7d165d6556c810ea8fc3cf',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '0f281093c238449aa057bec2dc23b47e',
    sessionToken: '4babc15b7b598d7148c9e29ef6f9d0f88606f29589511c334854edf4da9d08b3',
    verified: true,
    authAt: 1705108877
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '7b6f18660dc125adff85@restmail.net',
    authPW: 'c3e0d3674fa0b036ca1cfcf3255e0ec7737a21f33f7d165d6556c810ea8fc3cf',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0f281093c238449aa057bec2dc23b47e',
    sessionToken: '867e39088c49a080aa23a2c11d360051e94d41c803e0433d7f9c0e7c4ac8306f',
    authAt: 1705108878,
    metricsEnabled: true,
    keyFetchToken: '0ebfffc799d5ac3151a1f7c22a492ad1351a2986953504c48b4ea7ce34bc3219',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/change/start',
  method: 'POST',
  headers: {},
  json: {
    email: '7b6f18660dc125adff85@restmail.net',
    oldAuthPW: 'c3e0d3674fa0b036ca1cfcf3255e0ec7737a21f33f7d165d6556c810ea8fc3cf'
  }
}
!!! response success {
  body: {
    keyFetchToken: '38db4b1ebe83d96d8aa05ed19aa94b01aa4c3576969a602b326ba28bead16952',
    passwordChangeToken: 'ee8e9f1c33b0b2b439cbd961654d8686a4929c31d1f5bfce1e7eef30b3fbec49',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="68d492171b706d87a76835114d79f254fb41f35af652c192d0dd81fface0f068", ts="1705108878", nonce="nxhbCF", mac="h9rqo8Xs9maili4FsVGEz7NwjDbFLaDNtgDVB3OqpI0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '488d9b9c61ee4a80d1a8efe239c55f720a6502599d65b802b9b6a7ae7ab035c5696a1a77505afa99f1d842db7d5f854fe6d5b1ba1518d52e024f4141365f1b0713a7ca5bd61831ebd6535484878297e23eb58df0b9bc515626b914a07a42147a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7b6f18660dc125adff85@restmail.net' }
}
!!! status2 {
  response: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
}
!!! response success { body: { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true } }
!!! response { currentVersion: 'v1', clientSalt: '', upgradeNeeded: true }
!!! request {
  url: 'http://localhost:9000/v1/password/change/finish?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5d4b428ab5eed1a92a92530efdccabbfb63999eaf2a591efac358a807fe2acf7", ts="1705108878", nonce="l8IrVT", hash="tQ54h0z7eKpN1aYiUb/DS1PSGnvHhFLKyPa2nV0DVpY=", mac="INzyHLQdCruFaJamTNf5r7GUqiLWw6fSB8S+X9sJFls="'
  },
  json: {
    authPW: 'c3e0d3674fa0b036ca1cfcf3255e0ec7737a21f33f7d165d6556c810ea8fc3cf',
    authPW2: 'f85e227a74a7ccfa0ab2a869fd2a6473689566fca6349c13ef4c34c5cd525e19',
    wrapKb: 'a8ea23e4210d85844d985ceda6c816a20b30cdf8332e5ba8224ebbf91f9050da',
    wrapKb2: 'c44a38f14e0e61d23a8b22e69f25ad6a1a6630b7b01024582d1f49becbc80d10',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dae851f6e101a107c2f52a52c95164c06cd8041bb093d85bbad1e5d943f05c0f'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '7b6f18660dc125adff85@restmail.net',
    authPW: 'c3e0d3674fa0b036ca1cfcf3255e0ec7737a21f33f7d165d6556c810ea8fc3cf',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0f281093c238449aa057bec2dc23b47e',
    sessionToken: '5e025903da9e64913c06e79cf78676f364f2353b22dabdd5a927ec564f85ce73',
    authAt: 1705108878,
    metricsEnabled: true,
    keyFetchToken: '5ccacb558b6af3e4a60dad78beea75b8f6b192badddc05334748f98a16037ac3',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="36d27386d8f6bfdd27178e64f81945587321c23b2e860361612941e9d6d2a976", ts="1705108879", nonce="vBa4bL", mac="7HdKXnlqhHREJUIHz7L2M3nEfuF7jv9+Kvnd6vSc5SI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '7b6f18660dc125adff85@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '78562166c86fc2546c05@restmail.net',
      isPrimary: false,
      verified: true
    },
    {
      email: '34ffc67bd0536ef4d26d@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
      ✔ receives password reset notification (1336ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c18450662c527928970f@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c18450662c527928970f@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c18450662c527928970f@restmail.net',
    authPW: '4b2b411e0075763bc762d4430c8f34e966925cdf8e0a9e8cfdaeddd13438e8ce',
    authPW2: '5fe582b42e48c47bf949a118ac082fd3b8686b6c947e0cd67128f88fca9c0e6b',
    wrapKb: '37f27528ba7b3be7b903217591c2c1780547cebc6f804f002ed342a51e836b9f',
    wrapKb2: 'c9ee37d00ead59adada1f35ead45d49a251eb86b8bb8a92fc33a8ea78b3fcdb7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7dee66741879eeeb61ed90554757d28045fca04aafbfa657e9a6128a5399f728',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0869112b41c94e75b932102c091f018e',
    sessionToken: '438959b11b6fa9bd2db2c9d3bb66052d339285f58590790c6316165a1d35036e',
    authAt: 1705108879
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0869112b41c94e75b932102c091f018e',
    code: 'bf573bedd114ef6e39165c54927cacf9',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108879", nonce="afiXwE", mac="HSLlgJr2yLQ2yYm2Yge5BU0iiO7FLWytIcAqUP9Pcl0="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'c18450662c527928970f@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108879", nonce="C4T3Hl", hash="T6IB+cCd6Mfy+jn8RQS4myTF8hg0dZswjJH2R/75QcQ=", mac="a2t3yc39gs28hrH1MUW2Z74KZSfV6U5Jfoq05lfgiDE="'
  },
  json: {
    email: 'a8d613332eb2133459cf@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108879", nonce="as8sC-", hash="yiqDX+DJUkdjDrNDcOkM47DJxuaGOL8rJWccHgXeoF0=", mac="11NHKyrjpLrzqpAOv7f8Qzjzfap0iNlUFffXKJtcvu8="'
  },
  json: { code: '690296', email: 'a8d613332eb2133459cf@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108879", nonce="ZHUVQ8", mac="YLNY68L1Z2ds7/UGNOOQp2maVKWm6s+r5aMXQWrYInk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'c18450662c527928970f@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'a8d613332eb2133459cf@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108880", nonce="TzIylI", hash="lfu2P92vEXNBN/4xhje+d+19rtOyBhVeJGRkqpgcdk0=", mac="UUv+0PwoOVJYEHunnGMFDu/xWbqADsWogC3U+cS91Ks="'
  },
  json: {
    email: 'db850abb2357d0c2e003@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108880", nonce="gLEon8", hash="A653nHPzkrbGREV1GD4gSBVQBS7EXb+Z819qebGPQo8=", mac="vrZMg1YUcQS7ulK5F/7PJEJJQrVIqexLHWrTdyQqmyM="'
  },
  json: {
    email: 'eb88e43fb022df2d49d0@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108880", nonce="LoJjJA", hash="+g2fXm6KJEwRREH7wb2dfSfBA070EbusjGZImQxW/zk=", mac="fSDmv2zNWvWoImzhg1sHFmH9t9sJeiAH4K+K1Ip2Ai8="'
  },
  json: { code: '840758', email: 'eb88e43fb022df2d49d0@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/destroy',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1ce150ff244dea5d2a659ed8232c6630e6ef4a0fdcb245bbe7db4e00124d2eb0", ts="1705108880", nonce="XvsSbi", hash="A653nHPzkrbGREV1GD4gSBVQBS7EXb+Z819qebGPQo8=", mac="yH0O5ODBg4TEMBr8E1GH7IlDNjLorvKtMmrcAUFSevo="'
  },
  json: { email: 'eb88e43fb022df2d49d0@restmail.net' }
}
!!! response success { body: {} }
      ✔ receives secondary email removed notification (123ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8a9f0e0d7723996e674c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '8a9f0e0d7723996e674c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8a9f0e0d7723996e674c@restmail.net',
    authPW: '22b08d22288b3d851602504e4244307a6d30b20bd11d08b5504f5f343770dc10',
    authPW2: '2cae42f078b2b52767c6227199db459b83ab39afbd9ddf29e297acf8a7d7b0c1',
    wrapKb: 'baad9da1463ec86a73c04cf7246375f603525da79136a88b71d2e88976ba4c05',
    wrapKb2: '99b7ad51d21058c51da878b5e82c0461647e282c3386bbd00d7efbf374176510',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:15aa02e38813e461e18b6d4af928bf6d9499eb98f1a015f9ea2598802d547296',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fda2ab5c504d46ec86bd7f83df643930',
    sessionToken: '520fc8ca545eff4077d372dae8083188779bae42f093d8751326f53484c746c2',
    authAt: 1705108880
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fda2ab5c504d46ec86bd7f83df643930',
    code: 'd2d7d0c3582e526fdbb2c378cfa061b6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="93b8b80e98da3e39596599512a6cb52fe26708eb92bbe9f57119caf52d7f17ce", ts="1705108880", nonce="TR7t28", mac="VbR9dpLFvmXEDn7avGOUyTiOQmD6cR8gk7//Dz3LiaE="'
  },
  json: true
}
!!! response success {
  body: {
    email: '8a9f0e0d7723996e674c@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="93b8b80e98da3e39596599512a6cb52fe26708eb92bbe9f57119caf52d7f17ce", ts="1705108880", nonce="03y2EO", hash="trTUPDyW+EY+SHd9HArzslOzVhV4PhbQ9s5yHDAGAqg=", mac="pzrIYFxXjdrDAj52/jDSngelj6ga7djdR4a1sFPx0aY="'
  },
  json: {
    email: 'd7ca72d9d9077c22da69@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="93b8b80e98da3e39596599512a6cb52fe26708eb92bbe9f57119caf52d7f17ce", ts="1705108880", nonce="j8uyda", hash="8wTD7y+KxxEYTy8yzdP9UZLqGeGDahWu2346hhc7vmE=", mac="ZiOXhCzP/8HFiE59sRcqcnOaO6MjFzBe30YUA5GbqHk="'
  },
  json: { code: '040249', email: 'd7ca72d9d9077c22da69@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="93b8b80e98da3e39596599512a6cb52fe26708eb92bbe9f57119caf52d7f17ce", ts="1705108880", nonce="NXV8kC", mac="U9YSDQvjO1vbZu4kqxZCknkThAyUI7NgSceWzHXwLa8="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '8a9f0e0d7723996e674c@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'd7ca72d9d9077c22da69@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="93b8b80e98da3e39596599512a6cb52fe26708eb92bbe9f57119caf52d7f17ce", ts="1705108880", nonce="WsZVBs", hash="KZLVwVJNAVPATynUlUODKs8bF/1A0nWmrmwpunYGMwM=", mac="4vSgr9faVRh0rTU/kPvtB+2cb6e9eoOgU0GPz3HYuDs="'
  },
  json: {
    email: '6578b7dd59df34944648@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6abdb0e2f5392d8f9761@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6abdb0e2f5392d8f9761@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6abdb0e2f5392d8f9761@restmail.net',
    authPW: 'dffccf689be1f8fabb1dfa4fae4e75788a27a4c715d679adeb151e94d99bed1e',
    authPW2: 'b86f828f125d7126a3cb910f960d7ea630d3bd2a86d6af21a8ff5cc9f5434e0c',
    wrapKb: '7aeabb53b73ddb6f565278de5675e50a82948ebe71a749f4242c8711b3b3d06d',
    wrapKb2: '35374130e5ab9bf840048bee3dbc0fa3aca80764db3a753e6b626b698ba48404',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:31ba2c84651e22e700067cfcb46e4a1441204f3259e92a68ca3e263a5e0b6f96',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0fd8dc49cc3a40f0a7ae10dcec68d1b4',
    sessionToken: '65ab9780f6f104ea74dec155669617f3cf188a772f48edf9c429ed81bea737ba',
    authAt: 1705108880
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '0fd8dc49cc3a40f0a7ae10dcec68d1b4',
    code: 'd2982427dace572f8afcdb1c2785ad52',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="80ab74ca07b8924af4a5d23c25d560f20736d2d0babe39325c1a0a65109b3165", ts="1705108881", nonce="dqhwZS", hash="duyOYI4x8c+plMJcquu2RvZK60vurDHalx2tsESHodY=", mac="WClh3w3JWo/SNqCODzJIPfvEH3rBDEzyol360uO5Gyc="'
  },
  json: {
    email: '3d28e04795403377d85a@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="80ab74ca07b8924af4a5d23c25d560f20736d2d0babe39325c1a0a65109b3165", ts="1705108881", nonce="bXFUJ8", hash="6MERaeF9WRuSQrST9rTcQLokBshLi981+pPafl4zfI4=", mac="DvlqZbfJ2HP+m07Fgym4rYn/li57lxZUm5j3RBEaIxk="'
  },
  json: { code: '432816', email: '3d28e04795403377d85a@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="80ab74ca07b8924af4a5d23c25d560f20736d2d0babe39325c1a0a65109b3165", ts="1705108881", nonce="Ci3qVF", hash="dAsHd7E09qNJMIIp8xcZuxuiqpCeof67RiMJ5F3k1Io=", mac="1oOBpYF91kI/X1Pl7hMbFbse4d0dv4VJOUrMKa+xXGI="'
  },
  json: {
    email: 'c7b3753387775b99ae84@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6abdb0e2f5392d8f9761@restmail.net',
    authPW: 'b86f828f125d7126a3cb910f960d7ea630d3bd2a86d6af21a8ff5cc9f5434e0c',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0fd8dc49cc3a40f0a7ae10dcec68d1b4',
    sessionToken: '62ac6ce00e8de1878f68f6b367c3fe41313938dc61bcef9fa5e79eb7ad1458f6',
    authAt: 1705108881,
    metricsEnabled: true,
    keyFetchToken2: 'c00c16847dd8d445a308391d63cddf6db5e5dedbf84922862c61da365c4ff942',
    verified: true
  }
}
      ✔ receives new device sign-in email (854ms)
    shouldn't be able to initiate account reset from secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e97e0e2dae752ec2887e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e97e0e2dae752ec2887e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e97e0e2dae752ec2887e@restmail.net',
    authPW: '27cea35a3b14225f19e93c508fb6394e3321d61e697f107b2f50b491f3412e94',
    authPW2: 'c39f8cfd1b6477e1dbe1addf97a93f899d9368b69c25c5a01721b9d8712ee071',
    wrapKb: '624da319c7fe62279785d8f692a16c034e98306ce36cd8f8afddc04b859f9df9',
    wrapKb2: '7ec90e5a7fa8d58db12d941c9c847857e9c06e409a11067fb24ad20a85b9a24f',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:951e751fcecbbd60ae13c85786763b3bfda8dedd0c264cb37e214c93b3465de3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '321552e890a849d38a40b1d0c2ca28f9',
    sessionToken: 'e22fa7206ccbcc6113d688a373482b15842d7017140186d33119c434e2ac0125',
    authAt: 1705108881
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '321552e890a849d38a40b1d0c2ca28f9',
    code: 'f55ad994780f0d1c31fa22c1814b390a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="04cbc9cab055da349761b199f2327501c55f0ada8cfe139b48edca18c258cb4d", ts="1705108882", nonce="02NiGj", mac="YTHKZwT1HOXe71xoWrM1xzdINcgo/l5JX7s1ckijrpI="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e97e0e2dae752ec2887e@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="04cbc9cab055da349761b199f2327501c55f0ada8cfe139b48edca18c258cb4d", ts="1705108882", nonce="cBsGS-", hash="7OCCcsRoXq+vPDwRrsPbXrkiSiiu4NVUlgbVokV7IuU=", mac="WHYhhfmSTlUytjp9dG5MJW9Odvac6BrocWWnjr0oTZ0="'
  },
  json: {
    email: '864f8aa17b7aa8df3dcc@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="04cbc9cab055da349761b199f2327501c55f0ada8cfe139b48edca18c258cb4d", ts="1705108882", nonce="HNB-xw", hash="FbFAY0Cb3hXO1twJCWdaDjqoU/moqgosmqnKI2ptQck=", mac="MPTfnFCPsw9suQs0YV6pNNROogs+ZLPle3MAyL/Q3ZE="'
  },
  json: { code: '767196', email: '864f8aa17b7aa8df3dcc@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '864f8aa17b7aa8df3dcc@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 145,
    error: 'Bad Request',
    message: 'Reset password with this email type is not currently supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to initiate account reset with known secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '591e064422b6eecf3788@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '591e064422b6eecf3788@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '591e064422b6eecf3788@restmail.net',
    authPW: '14bc61a730b4e2eaec3ab38a74ce3f5bc40fae1d0669378c42e56649f85b8c72',
    authPW2: 'ea105124cda1c573ac211da1bf8d257d66b730c7bdc06cc636dbca1a66da9fe4',
    wrapKb: '0afdb76f4d185292fcd85327047e01efaf765f2d022de4694b7357b9e5f2ab39',
    wrapKb2: '993e918641515686762b5f7b6b2ccc579f3f3f58b64c487be86deaba4edb6456',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:70bc482a828505846b3f9ecc96b81655c2b51e04a7316fe13e5c57237f117f3f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '66e59b052d2445d39b393bdb574b011e',
    sessionToken: 'd8b421de1ce08ed4cdc110c5920266b3a519340e2c4bff1e1ecf20f223e503cf',
    authAt: 1705108882
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '66e59b052d2445d39b393bdb574b011e',
    code: '38a6a18ad1e8c9982a18365710b4dfcb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a776d52d3a18a6b107f16eedf99f7411f4fc60c61fcf02642c19f54f71786522", ts="1705108882", nonce="P6FiP2", mac="KhDZzI+ipsE1dbZw7YsCCO4frCUl0pnkpSYOzSrkgfs="'
  },
  json: true
}
!!! response success {
  body: {
    email: '591e064422b6eecf3788@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a776d52d3a18a6b107f16eedf99f7411f4fc60c61fcf02642c19f54f71786522", ts="1705108882", nonce="Xh8U8U", hash="Zp9TaZwzi0eC7DXJ2OmFcmnt5OPwcOf0J7KeQgJPfAg=", mac="l4iseU8g4VJ2exrgOZKX41kCM0v+iz+uVS+HtWGVFLI="'
  },
  json: {
    email: 'f546a96cc6da24375518@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="a776d52d3a18a6b107f16eedf99f7411f4fc60c61fcf02642c19f54f71786522", ts="1705108882", nonce="XLtOci", hash="VfeMb1M157zA3RZ3jSmHWl7R4FpK1Y2rkg7cwW7V8fc=", mac="7oecydHb3au2KVwCK6fWVnVMPgll21i9YTfnc51eBtM="'
  },
  json: { code: '792626', email: 'f546a96cc6da24375518@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: 'unknown@email.com',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'unknown@email.com'
  }
}
      ✔ returns account unknown error when using unknown email
    shouldn't be able to login with secondary email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bb2e5628a021f134edab@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bb2e5628a021f134edab@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb2e5628a021f134edab@restmail.net',
    authPW: '46d886ba11f0df23ca190baebc3aae322de4adeb588c4052e70193a4e0067003',
    authPW2: 'be7ef57eb5d69e29cedf38a7c77270ab1c03e3d726cd8f671a9ad49166cc54e7',
    wrapKb: 'bf7b29a83ae0c8b72d886810bd4a759f197f681a65159ae84ca0f2106e296d9b',
    wrapKb2: '8da160da085bf4824392813461d5042e6b703395b4451ad26517a7bc0b708a77',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2435f2b58adec76e9dad74d15b910a319c8f1eee7028034efca263e3ef91c307',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '4dc176e3ad394b5fba9ca7d7f64a2a34',
    sessionToken: '2ef0866a6f39c1594667cb113c29bf696a9397b7477558a9c5994e72d70314a9',
    authAt: 1705108882
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '4dc176e3ad394b5fba9ca7d7f64a2a34',
    code: 'ef5903b200db1dc93c5dc323260a7bda',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="11869bf071f43cb6316a53546f7477f36d87bf97a488e740aa1deb94638b0bc6", ts="1705108883", nonce="Zkm41Z", mac="k1dh3vlv1ZUPP7k4k11EL5XyodaYWQX2tyegpAMZTXU="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bb2e5628a021f134edab@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="11869bf071f43cb6316a53546f7477f36d87bf97a488e740aa1deb94638b0bc6", ts="1705108883", nonce="PpMA6c", hash="Ib0UoQ0FLweXptjicJms4CnCduzW/kSlB34jpqNzZWw=", mac="Y76Uf81eeiPwlbKlcwj8YQXeG833NZ5oWqAbX+nJFIs="'
  },
  json: {
    email: 'd265a6495b16628926c3@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="11869bf071f43cb6316a53546f7477f36d87bf97a488e740aa1deb94638b0bc6", ts="1705108883", nonce="ddzCXY", hash="m1LRuBjuJ9797v4enZNfMhtj6Q+dMoQ+sHMSFvwZBJU=", mac="itO7MRQdgvDyy2Fjp/XRtdjgPoqgYgWeAKjjPIQ9J18="'
  },
  json: { code: '018730', email: 'd265a6495b16628926c3@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="11869bf071f43cb6316a53546f7477f36d87bf97a488e740aa1deb94638b0bc6", ts="1705108883", nonce="mLgXYJ", mac="JWl7O/8nigkx+PuIu0v6qsTzYvnM4C96iPLNHLwruuc="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bb2e5628a021f134edab@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'd265a6495b16628926c3@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd265a6495b16628926c3@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2435f2b58adec76e9dad74d15b910a319c8f1eee7028034efca263e3ef91c307',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2435f2b58adec76e9dad74d15b910a319c8f1eee7028034efca263e3ef91c307',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2435f2b58adec76e9dad74d15b910a319c8f1eee7028034efca263e3ef91c307',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd265a6495b16628926c3@restmail.net',
    authPW: 'be7ef57eb5d69e29cedf38a7c77270ab1c03e3d726cd8f671a9ad49166cc54e7',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 142,
    error: 'Bad Request',
    message: 'Sign in with this email type is not currently supported',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to login (150ms)
    should handle account creation
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'bb7ad380a3d97e534624@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'bb7ad380a3d97e534624@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bb7ad380a3d97e534624@restmail.net',
    authPW: '94805b2a239ebc49b198b81fa3c2366f12ea6ee12dfc1809c7d673a50066a6b5',
    authPW2: 'ffbb8de5c000c946a2732f7ea20a60a3936e2b5a61e66126cf66a016785c8635',
    wrapKb: '48923f8cc4d35c7fe0ca500a0ead8bb3cac481cce51787aac7a464c9f3c8d172',
    wrapKb2: '004170f3a0582046baaf2ce23b3b71555009f6a76321ea0da0cc789a7d23bccf',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1837ccda883067f526d90aa7d1390a2ddffb5e4cb998bff531960bd10b04c433',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ec3e5a0e39f940fab8909f8b4298b56b',
    sessionToken: '90961aded0d98412682c0ef4ee6841a4e5d91ef58f2ad4358900345a3b00fbcd',
    authAt: 1705108883
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ec3e5a0e39f940fab8909f8b4298b56b',
    code: '65b37eb53f9cd411ee648ff38100edd7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4abe4929b00d2ae44700944c3ffe3640ac129ae6071afc23d0890227078f0ffa", ts="1705108883", nonce="TVRNKK", mac="n+l1Yh6F12rlNS+GuHX+ca459BaVsp/zvVqZ4KiHZZo="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'bb7ad380a3d97e534624@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4abe4929b00d2ae44700944c3ffe3640ac129ae6071afc23d0890227078f0ffa", ts="1705108883", nonce="CzNTu-", hash="p4/kZCo3RR94ap1dG8L/18xIVMctO6Nmc3Zp8hQWbLI=", mac="mwIma0GW2bVwhZOijTz8XlfzM3guWjSxkQXgwj/3wGQ="'
  },
  json: {
    email: '4c0144fc9cdf9a98e718@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4abe4929b00d2ae44700944c3ffe3640ac129ae6071afc23d0890227078f0ffa", ts="1705108884", nonce="vtz2ff", hash="92XpDseC7JPfUIcdVYb8ggfBXZkeSHue3gmg9yT+dkw=", mac="Xsc7DsMRS9F7ewObXDlpYjtvEYkW+LcMPNXqjKtuZW0="'
  },
  json: { code: '944332', email: '4c0144fc9cdf9a98e718@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4abe4929b00d2ae44700944c3ffe3640ac129ae6071afc23d0890227078f0ffa", ts="1705108884", nonce="mLObUo", mac="Yq1J/61YfZxcRIuGVr9kzQgkHR2um3C8CCspJWq3AbQ="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: 'bb7ad380a3d97e534624@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '4c0144fc9cdf9a98e718@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4c0144fc9cdf9a98e718@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1837ccda883067f526d90aa7d1390a2ddffb5e4cb998bff531960bd10b04c433',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1837ccda883067f526d90aa7d1390a2ddffb5e4cb998bff531960bd10b04c433',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1837ccda883067f526d90aa7d1390a2ddffb5e4cb998bff531960bd10b04c433',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4c0144fc9cdf9a98e718@restmail.net',
    authPW: 'd7c5ca71ab2e5198a9a4b13e8cc937213d1d0f83a269093245942306c6e58170',
    authPW2: 'ffbb8de5c000c946a2732f7ea20a60a3936e2b5a61e66126cf66a016785c8635',
    wrapKb: '20495bef19374cd79babf4633994485f23c03f603530f1fe1a8b977ecfe4da27',
    wrapKb2: '846d381e11949f9ce53307b5c35ac570bd02bc8229c178a6cf12ee139c296ae5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:1837ccda883067f526d90aa7d1390a2ddffb5e4cb998bff531960bd10b04c433',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 144,
    error: 'Bad Request',
    message: 'Email already exists',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ fails to create account using verified secondary email (194ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '95d22d5ec9159d657021@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '95d22d5ec9159d657021@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '95d22d5ec9159d657021@restmail.net',
    authPW: '41645f12fff66a1ad121aa0be53f27fa6165ef2e3e3f2c51531480b76c097bfa',
    authPW2: 'efa395b1a8815f5640722abaffdce2dad671fba8be5d2d80cbe9c159435ee61e',
    wrapKb: '5bba219fddbd17ae47df552985417d5216a8157518608d426f021e0a726f5436',
    wrapKb2: '59f01728d889b7c12249fecfe50b11d466a5ab2d3cf75cf7949bbbeb9396722c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2511590facbb0c7adbca7c9d1fea35909b3bd3a195b4b54fc28e241a745eb262',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7737da1b4bb14acfad26fa24900fa1e2',
    sessionToken: '6936cdd292e7bacd40cd169481a558179c7adcc1cc2f7b6ccc0065546e4c33ac',
    authAt: 1705108884
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7737da1b4bb14acfad26fa24900fa1e2',
    code: '4d973e1c8632ef4912dae3f049bfa24e',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="75ab5af2f4ad99882f067a9b119c3001f8e38b66b0a3b7076d7eec8916897a3b", ts="1705108884", nonce="JDyxoO", mac="uEuYbdExflUEsoKfnzD/obaejMS0AcHxRGhPoeI8BfA="'
  },
  json: true
}
!!! response success {
  body: {
    email: '95d22d5ec9159d657021@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="75ab5af2f4ad99882f067a9b119c3001f8e38b66b0a3b7076d7eec8916897a3b", ts="1705108884", nonce="rOlzwf", hash="qVKNCZ2/7QP1lhFTUXB+u61ALD/PKMTOv54cL2GUtdE=", mac="moWvIroEoAe1BBwigf4jzUO1eEooytbgOtZiJQdN3+U="'
  },
  json: {
    email: 'cdddc88fcf1c2dce7ca7@restmail.net',
    verificationMethod: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="75ab5af2f4ad99882f067a9b119c3001f8e38b66b0a3b7076d7eec8916897a3b", ts="1705108884", nonce="SVndAe", mac="pB33LchPfe5xON4I/xOA8w6CRes+e0Deq6y7gLkNYRk="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '95d22d5ec9159d657021@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: 'cdddc88fcf1c2dce7ca7@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cdddc88fcf1c2dce7ca7@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2511590facbb0c7adbca7c9d1fea35909b3bd3a195b4b54fc28e241a745eb262',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2511590facbb0c7adbca7c9d1fea35909b3bd3a195b4b54fc28e241a745eb262',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2511590facbb0c7adbca7c9d1fea35909b3bd3a195b4b54fc28e241a745eb262',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cdddc88fcf1c2dce7ca7@restmail.net',
    authPW: 'f48ab06f87ee0446426669ad730ffbb8eff4060a82eea8ce6e3ceb7ece622091',
    authPW2: 'efa395b1a8815f5640722abaffdce2dad671fba8be5d2d80cbe9c159435ee61e',
    wrapKb: '2773ff513b4352f29ca5c1f4a31a7396126d40076a71b40643922c7f11a19bc0',
    wrapKb2: '45f363144e1fa5215edec9006fb7eade4f445a549d55dc09a7b09e3b989f491c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2511590facbb0c7adbca7c9d1fea35909b3bd3a195b4b54fc28e241a745eb262',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '7bd3760c8438423c8b3478ee434583a7',
    sessionToken: 'fbb551b5a53614603063ff4b2cb0afd2e47341aac63fa1731f5610f4db6bbb9d',
    authAt: 1705108884
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '7bd3760c8438423c8b3478ee434583a7',
    code: '6e120f1de9bb0de3abc71ffa5292d5cb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="75ab5af2f4ad99882f067a9b119c3001f8e38b66b0a3b7076d7eec8916897a3b", ts="1705108885", nonce="z1hEh1", mac="Y9cKqg7TMoPbhY6pzqCKdoLf+mzy3LCO2lXqwvsfWMI="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '95d22d5ec9159d657021@restmail.net',
      isPrimary: true,
      verified: true
    }
  ]
}
      ✔ should create account with unverified secondary email and delete unverified secondary email (519ms)
    verify secondary email with code
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '600ea5c42ae13462193a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '600ea5c42ae13462193a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '600ea5c42ae13462193a@restmail.net',
    authPW: '1c1b70a3db0eb869a177a74afd96b8258d349867523b69b5a270273caedc2824',
    authPW2: 'ecd3f1abeb2f89a5092b34d97ff3d5f84b699378969e6e716f5c17d5be510582',
    wrapKb: '9245da52e33950674fe113422e9e96cf60fcba8db8a7fc5e4b3f5950303f6a92',
    wrapKb2: '57baaeed67dd987c14e145a7b74c923f51c77c868e4c2ce0e19dc9503fe761a1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d5938525e6f7f83d3458db6bf23012afbe68d808f0645ebf61b013c59056c6d8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '09c674d949ea42b6b596aae39c598837',
    sessionToken: 'd6585b7ac6cacd810b965ad903243fe744d3bce60da5471dfb6c54f2e5ebd33d',
    authAt: 1705108885
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '09c674d949ea42b6b596aae39c598837',
    code: '5d04fa31322ada84003530239bb1d284',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ef9a271fc045131eac26d3ebb293c4bc18ab04efd940fc9b468c8e3401aca973", ts="1705108885", nonce="X5NGC2", mac="qd/ikrvQomw8JbrQ6gTkygBLV5mvbZQEXTS4FT39CrM="'
  },
  json: true
}
!!! response success {
  body: {
    email: '600ea5c42ae13462193a@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ef9a271fc045131eac26d3ebb293c4bc18ab04efd940fc9b468c8e3401aca973", ts="1705108885", nonce="2y-b8h", hash="hJAmDKHyfHZhzD2ooS7ttsMZhaZODvu30BouKx+e7/g=", mac="RzuWXBD3axRrILvJLeJJV55vQJywV5u0DOfdWr0QbFo="'
  },
  json: {
    email: '49ad50451e23184ecb14@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ef9a271fc045131eac26d3ebb293c4bc18ab04efd940fc9b468c8e3401aca973", ts="1705108885", nonce="gu0IQB", mac="cLuMAut2DXmWaObkeFBNK5WNp5ORLmkFNc6zjUvyMig="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '600ea5c42ae13462193a@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '49ad50451e23184ecb14@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ef9a271fc045131eac26d3ebb293c4bc18ab04efd940fc9b468c8e3401aca973", ts="1705108885", nonce="wLGxL0", hash="68s4VKh8mP+BDryqBNV2Pmc4qnG5Y/GUiGYvk+ojONE=", mac="p+fhnigSnRdCW8Kc20di+5QFZ+fRXQnjsX4zZQ1+uBc="'
  },
  json: { code: '744952', email: '49ad50451e23184ecb14@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ef9a271fc045131eac26d3ebb293c4bc18ab04efd940fc9b468c8e3401aca973", ts="1705108885", nonce="k208_c", mac="HeArCgMVve7Jxse2G74k6+m8Rdu3+uTMI2YU25VEs3A="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '600ea5c42ae13462193a@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '49ad50451e23184ecb14@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can verify using a code (48ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2531e8272f154f7df144@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2531e8272f154f7df144@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2531e8272f154f7df144@restmail.net',
    authPW: '661c2fb57bfcd550b28445a16ab66d551b491a647cf2a45b5df95b2477cdc106',
    authPW2: 'e3dbf45432ee1c751037877f4103f96b9af1bfd105c8e4c4c291478f7da653aa',
    wrapKb: 'e7a3cffb96a1c4401126b93f664b1ebb15d4e0d08fcd44f4c2f8474698735b70',
    wrapKb2: '5d1c58e63dc27e75c50a5e5197e9b80bd90a3173d40806829745954b36d6bb45',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f3bdee48564bb3996fd16eb8b4d231fdc6e41787496ddd25b2c2237d0897f43f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8e665bcd9ed04074be90f0aff2d8f4b3',
    sessionToken: '258b01fda0aaed11deccc964fdba57dcf82565e4d4f70e691e2098d3fd43973d',
    authAt: 1705108885
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8e665bcd9ed04074be90f0aff2d8f4b3',
    code: 'bfb14890f5d8e804342e81cca3ddce45',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1f73de08a51843d4e530b78f63663e08775f2abe7a637817ef06ec6633db1189", ts="1705108886", nonce="Rnqirm", mac="NkZN/pGfwJs4953vGe7+0nXiX53TFrlPNxc7+SSDkpY="'
  },
  json: true
}
!!! response success {
  body: {
    email: '2531e8272f154f7df144@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1f73de08a51843d4e530b78f63663e08775f2abe7a637817ef06ec6633db1189", ts="1705108886", nonce="36LTew", hash="l2uaxfDp+TS4bZxywFS0fm2I5R32QHf04YQDegnUIXM=", mac="fa5WV3maPo5tEoNv/KJBTTxGpoyQgfcdfiAKVCkB2lY="'
  },
  json: {
    email: '9c0bea7559a3f426bf85@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1f73de08a51843d4e530b78f63663e08775f2abe7a637817ef06ec6633db1189", ts="1705108886", nonce="MR7fO4", mac="6JOHbydHZvcfuHXFVVeTZjMBMfp8qBTZcKF5ES66BoM="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '2531e8272f154f7df144@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '9c0bea7559a3f426bf85@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1f73de08a51843d4e530b78f63663e08775f2abe7a637817ef06ec6633db1189", ts="1705108886", nonce="Fqkigo", hash="opqhIDuzA3HUHCmqrjlVgIfSMjbgy4U/UzBfZ6/U5m0=", mac="BzrS3As/GbZVaXoN42mn1/0ESygc+T1Uwlf1VneAY/U="'
  },
  json: { code: '123123', email: '9c0bea7559a3f426bf85@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
      ✔ does not verify on random email code
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '74fad54a49bf24b2315b@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '74fad54a49bf24b2315b@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '74fad54a49bf24b2315b@restmail.net',
    authPW: '39d33e61faedaa9e71308081c1ae5a17635f68338a0fe90f427de9a95ab0c224',
    authPW2: '55d79606bbc562bba19b5080cececd4c0136796fd75090142f65bae583ea16cd',
    wrapKb: 'ff9a5ff18283c4a3393f0ee094eeaa11a724b0e111da127508285917f1e7cf05',
    wrapKb2: '628ef1b73f1ffd344dbe9ce8e9c9c96706fbfbf80e854bac361ab37e66ec4e90',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:95c29a0988a12d6c2fd8ee347d16b714eaff79359c71189c6f1f7509f1feb2e7',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'faa2d03c09ff4344b3b3c84de15785d6',
    sessionToken: 'b623c3ff3f12b838696e1591a43de3200844575a10d565c0623ce44dab1be983',
    authAt: 1705108886
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'faa2d03c09ff4344b3b3c84de15785d6',
    code: 'a93e020915d5c7bbedbeda0a2a7d57cb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="PNr7cp", mac="XhV3enWlV6qAQkNGbOmaFbTD2bayDBFOG3whrFyKb9g="'
  },
  json: true
}
!!! response success {
  body: {
    email: '74fad54a49bf24b2315b@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="tx1QVz", hash="YQou7P3ug6l+GtP3rbV2ogmij/hxucd+K6s0Yt/okiM=", mac="LshncxtbNaag9KKuhxOixPdq/aXcSedZEHR0DxVPmQk="'
  },
  json: {
    email: '123586ae349239ec1ad1@restmail.net',
    verificationMethod: 'email-otp'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="pRJfui", mac="o8BJSF3flSl2DfvoxEYbkvchGWUNbympYPqE94wcJkU="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '74fad54a49bf24b2315b@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '123586ae349239ec1ad1@restmail.net',
      isPrimary: false,
      verified: false
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="9fTDCQ", hash="sCDjWv2n91GQDxtFsHpAc5y9mtgkCaD4h9hAowFUhbo=", mac="ECEgwYLH5y+c0aXyKHRtBLDDbpM5sJh83MX64eIkmaE="'
  },
  json: { email: '123586ae349239ec1ad1@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/secondary/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="anq7G0", hash="zhRdRX1nU5umTOcebU+va75vxBHD4Gqe/5YCjpIiQvU=", mac="5vOpbq0E5ZLDmraBs8s1uqOxDRwqChbv73kB4dk8Jes="'
  },
  json: { code: '723606', email: '123586ae349239ec1ad1@restmail.net' }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_emails',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ff4890985367498f88ca1cba36c65684e93459c713946ba95664cc35bd588a0f", ts="1705108886", nonce="Ovrglr", mac="qeQ54a0K5AsH5VWIEmi+iq0anJ7TYWGwcB4PfcYdN7U="'
  },
  json: true
}
!!! response success {
  body: [
    {
      email: '74fad54a49bf24b2315b@restmail.net',
      isPrimary: true,
      verified: true
    },
    {
      email: '123586ae349239ec1ad1@restmail.net',
      isPrimary: false,
      verified: true
    }
  ]
}
      ✔ can resend verify email code (83ms)

  #integration - remote recovery email resend code 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '68857dfc206cf2e56547@restmail.net',
    authPW: '8ca0862d68ae37b4820374cf7e1ea877e6503361cba65d105bfe0711dfe820c5',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5fd3baea6ed641d1871e7baa0e9c9745',
    sessionToken: 'e65815d003bf640aca460360e06fc9e518d07c70e7b8a087456f16eae7d4d2dd',
    authAt: 1705108886,
    keyFetchToken: 'f2ba81d151ad5be3b7820ac07f96a41b003fba7fe105e4a723c297529385024f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '68857dfc206cf2e56547@restmail.net',
    authPW: '8ca0862d68ae37b4820374cf7e1ea877e6503361cba65d105bfe0711dfe820c5',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5fd3baea6ed641d1871e7baa0e9c9745',
    sessionToken: '3866c4bfc034f2cf05c13b47e9e6aaef99a6434468ec44914141070f5cf5887c',
    authAt: 1705108886,
    metricsEnabled: true,
    keyFetchToken: 'e81f6dff711bf54398097d4cc13f3352b3d01dbe2966c120a5acc7fbf854a4a0',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="360a9a486544700977ae72b2617f9129c2a7075b320bca5bd4900a5cc0317caa", ts="1705108887", nonce="WhJRNK", hash="s3iDI27SbYXcE0+qq0FgOodrYo1bY3xXucpn9ZmN2PE=", mac="gagnsUffqLFv9FJxl+bFMbWXmU9Pdm4qFIkgBPuzmvY="'
  },
  json: {
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5fd3baea6ed641d1871e7baa0e9c9745',
    code: '71a18049443f065a5b6bc9fd6b3f49f1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="360a9a486544700977ae72b2617f9129c2a7075b320bca5bd4900a5cc0317caa", ts="1705108887", nonce="IuksMh", mac="WCNb4NnNF7BN4Iyfu5XuBmMWw/IZ/iIEmlDTZqDggi0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '68857dfc206cf2e56547@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ sign-in verification resend email verify code (476ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '5beb0da50a4780762c17@restmail.net',
    authPW: '6aa8ee76670e1bd897d5bbaea31f13691bb6a052846ffcef546f1801b90dce07',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '08196966f4b9454bb8f17651f41fbd4a',
    sessionToken: '85e9a67d4103a0103e8faf7ca30f3d8f81b0daf49fa79fc74e45c5f98b1c9065',
    authAt: 1705108887,
    keyFetchToken: 'ad4c8d0017b0d373fae63047d983d9c75d32516b6b689c794dfc03884e2b0c6f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '08196966f4b9454bb8f17651f41fbd4a',
    code: 'e9c69f596a4b44d768f060ca5c35fb28',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '5beb0da50a4780762c17@restmail.net',
    authPW: '6aa8ee76670e1bd897d5bbaea31f13691bb6a052846ffcef546f1801b90dce07',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '08196966f4b9454bb8f17651f41fbd4a',
    sessionToken: '32181f6daf1bdd7070716db30ca93c1c40ccba8b6a7da6a7801cbda7e8fb08ec',
    authAt: 1705108887,
    metricsEnabled: true,
    keyFetchToken: 'd0fd71df4bba0a79c2019b83ab787ab227e929ac91afb8ba82043c9527468aa9',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '5beb0da50a4780762c17@restmail.net',
    authPW: '6aa8ee76670e1bd897d5bbaea31f13691bb6a052846ffcef546f1801b90dce07',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '08196966f4b9454bb8f17651f41fbd4a',
    sessionToken: '421be1407c09cfaa9b4ce5f236e61c8b74cb323b6bb6f557ac7e29b7e56b5f7e',
    authAt: 1705108887,
    metricsEnabled: true,
    keyFetchToken: 'e404caff3bf664da9c81627b0f67ca6095f27707af41c49ffc4ee0ad2a0267f0',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="13a913546116df2360a50d8cfcb259b80e6d64ef186757ca47ea4e0353e54d4c", ts="1705108888", nonce="mxmuPP", hash="s3iDI27SbYXcE0+qq0FgOodrYo1bY3xXucpn9ZmN2PE=", mac="ymyOGjfE6pRtQt33qUrWyrIftXwVJwo3OmkZ0K43lDU="'
  },
  json: {
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '08196966f4b9454bb8f17651f41fbd4a',
    code: 'c8dd3250d91f95405a56b3e89a2afd67',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="13a913546116df2360a50d8cfcb259b80e6d64ef186757ca47ea4e0353e54d4c", ts="1705108888", nonce="GM0SyB", mac="k+H5Sffz6HcnX7DHw4CsSjPbYg1UYogvZyOqMpxIrPw="'
  },
  json: true
}
!!! response success {
  body: {
    email: '5beb0da50a4780762c17@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ sign-in verification resend login verify code (713ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '10d54f82ac7510bfea42@restmail.net',
    authPW: '9c1e0bde9ded0d03c52db86ef277b3c27386e6b27020ff882ef077e021f16454',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f99926af9bb0a000d520@restmail.net',
    authPW: 'f64e91f0ebe2c1003bcdb8c979d8da8811b2bffc780c0d478077243676a2f63b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '703e17138b2c4c3ab8c734e5293dc9e0',
    sessionToken: '875a4f01489450ce518d545dab9bab3fde85fa8e4a3230f5c619966429e6d23e',
    authAt: 1705108887,
    keyFetchToken: 'aed77754fbdf8d039046550f14b9b0854592af2d4bb328c5bcf0bf8bd1959da7'
  }
}
!!! response success {
  body: {
    uid: '309b9dbd84c64badaee046b81b41cae6',
    sessionToken: 'c640aab2ea812dd9920d38fdb14407dc98b7a189845ad83bc510ced57eaed787',
    authAt: 1705108887,
    keyFetchToken: '55d223c8315c37920f728dcf032b19aba49816f1c4cdc8045e22d12a136d2bc9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '309b9dbd84c64badaee046b81b41cae6',
    code: '1fb1c223a69960ab4cdc228ac834982c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="dc0db2140fce5432f8ac6ad85c6ede8a25fd2181b23497d7ae10526bf46b974b", ts="1705108888", nonce="9unEX_", hash="EXLQgpJbbM1ieR00zxUDMozvdgiNbkA8Nvf7caW27H8=", mac="3wEpOzY3+eYg1MoSxy2IS2mFO98SGKL9XaARZhMAHB0="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: '10d54f82ac7510bfea42@restmail.net',
    type: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 150,
    error: 'Bad Request',
    message: 'Can not resend email code to an email that does not belong to this account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ fail when resending verification email when not owned by account (248ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2cbad94e164a93ce361b@restmail.net',
    authPW: '9900da754e58ff2d249caa6fcf5118072db332b29f2f4f9879b63add90528729',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bf7eb43d7ac3491f9d8c679ec0667f08',
    sessionToken: '08832f03a9ada9b02f15dcbc014ffc0e21b48b06b6395454da32dcc8c7d07a29',
    authAt: 1705108888
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bf7eb43d7ac3491f9d8c679ec0667f08',
    code: 'd3e2625a7d59fcd0fb0ee88220972047',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2cbad94e164a93ce361b@restmail.net',
    authPW: '9900da754e58ff2d249caa6fcf5118072db332b29f2f4f9879b63add90528729',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bf7eb43d7ac3491f9d8c679ec0667f08',
    sessionToken: '8644f4d9ca54c346382fdfc29825e9df908f049002c3987fa1fb02c6f1599201',
    authAt: 1705108888,
    metricsEnabled: true,
    keyFetchToken: '44b9b745661e2062fbfe83ffb819c45da7af03273dec9c4923d3664e3648e04e',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6b10683ae5ac1ab562c22f732a2ff53c6046101817d036920f8793d9e01b775b", ts="1705108888", nonce="9DfKjb", mac="3OYwfwUp50UICrE/b5Q8vVRIXvT+G6OIaA3gtndzR9o="'
  },
  json: true
}
!!! response success {
  body: { state: 'unverified', uid: 'bf7eb43d7ac3491f9d8c679ec0667f08' }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="6b10683ae5ac1ab562c22f732a2ff53c6046101817d036920f8793d9e01b775b", ts="1705108888", nonce="KtM2v0", hash="6+og65GXwKF9EnygQjX46KAj9tvKxfiRYSNWwJ/X36o=", mac="slvBX4iz0Qy1/r8eq7qZPaa5QRjkUaAawTEANW3NCbk="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: 'upgradeSession'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bf7eb43d7ac3491f9d8c679ec0667f08',
    code: '23e8fa22bce8ece7214dab87736ddeca',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="6b10683ae5ac1ab562c22f732a2ff53c6046101817d036920f8793d9e01b775b", ts="1705108888", nonce="_iyvpZ", mac="XQ96YrwjtyPrTOjqY1DmVoCi4URfwg7XRrU3Bx/Zdc4="'
  },
  json: true
}
!!! response success {
  body: { state: 'verified', uid: 'bf7eb43d7ac3491f9d8c679ec0667f08' }
}
    ✔ should be able to upgrade unverified session to verified session (476ms)

  #integration - remote recovery email resend code V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6fbd944cbe0143ac8690@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '6fbd944cbe0143ac8690@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6fbd944cbe0143ac8690@restmail.net',
    authPW: '8e2f70311bc70ac1928180d8dbcfe7a6ab2aa4667a62690d48bd7238c7d838b1',
    authPW2: '8f60b972119653f7aa235631f43c86daf6f0cc0896333eae0f533f2e9a2bfbd9',
    wrapKb: 'ead7fae9c024a3025b444e514bb51b4eb00190853c06e8cc656ba816f2f3cbcc',
    wrapKb2: '83561074b0e665fa5f8f7d959a9b60677b45bed17ecfa329517d5d1b45eab78e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ba2fc5ce680d50175d5a4daf06bb4ded7678dfca8ac89cd27d552575b2e721a7',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c012df8d3ee24c9b8e749d1a66eafd85',
    sessionToken: '7192064f7695f6233081b3b41431e723e765acbc2f5c51316657439dc8010eb1',
    authAt: 1705108888,
    keyFetchToken: '757d292a5d49af1b4532018e8ef5997e8e92f3a7af4d93a4f8feea3974a865a9',
    keyFetchToken2: '1c875ef1a7aba7dfe58f796d4ce220b18a6656a627978da3d325a84a0042beb0'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6fbd944cbe0143ac8690@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ba2fc5ce680d50175d5a4daf06bb4ded7678dfca8ac89cd27d552575b2e721a7',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ba2fc5ce680d50175d5a4daf06bb4ded7678dfca8ac89cd27d552575b2e721a7',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ba2fc5ce680d50175d5a4daf06bb4ded7678dfca8ac89cd27d552575b2e721a7',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6fbd944cbe0143ac8690@restmail.net',
    authPW: '8f60b972119653f7aa235631f43c86daf6f0cc0896333eae0f533f2e9a2bfbd9',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c012df8d3ee24c9b8e749d1a66eafd85',
    sessionToken: '873af624e0f76f09f896b8d98576c64115afbc8da2a04984097724222bc984d3',
    authAt: 1705108889,
    metricsEnabled: true,
    keyFetchToken2: '0e213a471d7aecb9381318c96312ba832a3824c2ea2d70922c9c90a067609afd',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'signup'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="db0d9d9d67dff1ffba59542b9a52cb67b0d1e1b35159b9b8285fd7669b5071ac", ts="1705108889", nonce="FWNBX5", hash="s3iDI27SbYXcE0+qq0FgOodrYo1bY3xXucpn9ZmN2PE=", mac="lviAtS4F8dWKCUJK3tH4eIL7jvysgm3HJn6RjGwQzKI="'
  },
  json: {
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c012df8d3ee24c9b8e749d1a66eafd85',
    code: '09879d41be46f324d9f376cd43d4e776',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="db0d9d9d67dff1ffba59542b9a52cb67b0d1e1b35159b9b8285fd7669b5071ac", ts="1705108889", nonce="DbB-QN", mac="OpMeEk0/hl46NnvcfUXOH/H7KeJn8A5tcCUaGXy8yWc="'
  },
  json: true
}
!!! response success {
  body: {
    email: '6fbd944cbe0143ac8690@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ sign-in verification resend email verify code (935ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e001f299d401de744a86@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e001f299d401de744a86@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e001f299d401de744a86@restmail.net',
    authPW: '7d00c032695519743e740479900c18be9c96107f61a0de41430ca7971dc13849',
    authPW2: 'ba5a4eb0448ff608bc8339f0f092dd0d09ab528541f3efe3863164b08ba7f512',
    wrapKb: '82b113febff5fc3af46bf73dfb99e4267cc6e19701dea820c1457dcd7844abb8',
    wrapKb2: 'e36c86ab214a8d44b8bac80fda1469ac92e97120457bac46db3fbfbe8af7a113',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a58dda01119907346117379c5422085a272fe7e8d00fe096f9f82cd6dec95ddc',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8053563d0c704989a12923e586f80b4f',
    sessionToken: '72bc73875d9e5b81581ed1a071afad547247fec21416245b490cdce97919e202',
    authAt: 1705108889,
    keyFetchToken: '7b9ebb597ca1151db7726e34a3e61e3d0929ead29c94b5389fcdfbd36ccd1369',
    keyFetchToken2: '56606da645b20c764653d3e374fefb08f28f83f114ae30125fc3cbbdcc27ba44'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8053563d0c704989a12923e586f80b4f',
    code: '4b04659ca1680e3e624a6845e65e2300',
    service: 'sync',
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e001f299d401de744a86@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a58dda01119907346117379c5422085a272fe7e8d00fe096f9f82cd6dec95ddc',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a58dda01119907346117379c5422085a272fe7e8d00fe096f9f82cd6dec95ddc',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a58dda01119907346117379c5422085a272fe7e8d00fe096f9f82cd6dec95ddc',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e001f299d401de744a86@restmail.net',
    authPW: 'ba5a4eb0448ff608bc8339f0f092dd0d09ab528541f3efe3863164b08ba7f512',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8053563d0c704989a12923e586f80b4f',
    sessionToken: 'a2305c426dadbf154a953d602a70358e5c151354f5378314df870619f831b050',
    authAt: 1705108890,
    metricsEnabled: true,
    keyFetchToken2: '85c7b2147f6c174e7254a94c9fae55ca9ae4899fc3f22f324729527740219480',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e001f299d401de744a86@restmail.net',
    authPW: 'ba5a4eb0448ff608bc8339f0f092dd0d09ab528541f3efe3863164b08ba7f512',
    service: 'sync',
    resume: 'resumeToken',
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8053563d0c704989a12923e586f80b4f',
    sessionToken: '4540489cedc5b608de98ba88296b9765be2b9b1a34d1021b508c0f54bb1a09dc',
    authAt: 1705108890,
    metricsEnabled: true,
    keyFetchToken2: '80f6c09c34032ea976cecca341e93000d9332b325302e80be38e3eec6485a269',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b48845c2a85559b0235c54d009d5e41192b1486b7937abe34ae87f9faa31b867", ts="1705108890", nonce="IuWWed", hash="s3iDI27SbYXcE0+qq0FgOodrYo1bY3xXucpn9ZmN2PE=", mac="zuHoJ+CTSFjiP3t5TvH9/EEpaVqN5dwtGoJtf+P6/C0="'
  },
  json: {
    service: 'sync',
    redirectTo: 'https://sync.localhost',
    resume: 'resumeToken',
    email: undefined,
    type: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8053563d0c704989a12923e586f80b4f',
    code: '7fc1f8b19b6e32e45241ec053a4090b5',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="b48845c2a85559b0235c54d009d5e41192b1486b7937abe34ae87f9faa31b867", ts="1705108891", nonce="v2wgGy", mac="3RZ+j4JxuMkqT1vMtru0kVqUC5EBxvG0X0yl6BvGeNc="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'e001f299d401de744a86@restmail.net',
    verified: true,
    sessionVerified: true,
    emailVerified: true
  }
}
    ✔ sign-in verification resend login verify code (1200ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1c14454e2ff2fc43be99@restmail.net' }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e7216cd020a217c86450@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'e7216cd020a217c86450@restmail.net'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1c14454e2ff2fc43be99@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'e7216cd020a217c86450@restmail.net',
    authPW: 'cd3ee9c0aa58f1dc6858f4208120ad8fdfc815d80ee7672ccaeaf2068f924c70',
    authPW2: '353671fc6b799157d6c71c4fb6ed2621fc25e4654f32e221f92b6c097e17a473',
    wrapKb: '7bcf2e0d6125ea585bb268b07f13677ee2661ee697c98de62b85119364bec103',
    wrapKb2: 'b2c3fb696d5c32ae7ee387434b27beefe7c10a8791f118b0bc64a818bf7c7b41',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2d6ea617f299b3305c95ebf5099fae42e379d1ac366b3da09d1254a8c66d2c5d',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1c14454e2ff2fc43be99@restmail.net',
    authPW: '6dad5b1968e3ce004dd971be41b5beb4051d5b9ccff702bad9b2289ed4f1204f',
    authPW2: '1a8956fa02fd4e2c222353342375a573ac9810aeaea12c9d28879ecce0590c70',
    wrapKb: 'feafb60ad97aed4f523521ee1e9cbf76ac009b2c8f0a3c3bc0643cb6e831c34c',
    wrapKb2: '0ee1f9fe74df4367697bf3cf579ba8999b04cf55a744a52b3fd84517e13dd917',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5f7d5f1b8f31f34f072256a38f091ffecf8c12038b28655fb56a3ec8f65e40a5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9dab029b6143446e9a8b7421d908c1b4',
    sessionToken: '2e68d0007525b0022bd845b70c2c7532bf27987aeb53c1161d7f5a6f1915eaac',
    authAt: 1705108891,
    keyFetchToken: '108f9b0ec5afbfb485aa7fec3775ee08f4d3f9b2d528b85a443fd47bf6663e37',
    keyFetchToken2: '46d784ff52188371a40bec49ee05bd93befce2c0599e45aaafcd24d00e82ffaf'
  }
}
!!! response success {
  body: {
    uid: 'c83be691740047889981f25cd66e89a9',
    sessionToken: '71618afe6673df7d2c4e368a01c59a25d6787988327577c304fc59ea2ca7e93d',
    authAt: 1705108891,
    keyFetchToken: '7d316e383ed6044914205a9d8a2020587c547d1e2babd73d7097163984a0c395',
    keyFetchToken2: '31ced1e82439dd1404582da1cd38f5b050391a9930322c502f7b132aaed398de'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9dab029b6143446e9a8b7421d908c1b4',
    code: '8a095d44f8eef1d15a62486ad29294f4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fb56908eae23959aa94cd8077ab64a98f3cf9d7d11eed7c9398b3a6e0b22d574", ts="1705108891", nonce="WS8v88", hash="9F/N48zl0L1MScit2/EWJeHOg2jxles+fB3j4P/f12k=", mac="6lYkCDGnYBaDNaDsnKkg+3AVQhKRzFdwCZ2wj6erSZg="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: '1c14454e2ff2fc43be99@restmail.net',
    type: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 150,
    error: 'Bad Request',
    message: 'Can not resend email code to an email that does not belong to this account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ fail when resending verification email when not owned by account (525ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '98467e216b94dbabf662@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '98467e216b94dbabf662@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '98467e216b94dbabf662@restmail.net',
    authPW: '8743535cb6e83f6855cfef35a6f29969705e9d97d9a2fd0ea8c5a4818f212d96',
    authPW2: 'f2726f44a64f750e13d876d7704a0e718e5561c9832d7b9ddc1975cbf53d473a',
    wrapKb: 'c843d000d9d1fe0d3d1a483d1571fce18df70c002713feb57fbbd189ea586efb',
    wrapKb2: 'bb26dbc4943c576f1b265388b74f899b1d3650dc0e20b7f70948145c6bd5507c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a392bc74fdba2d6441bb5c1d6907980f4130273c370cf12b2a6b33626d55a337',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd1da8b96522e4c5499956a5ed297b83b',
    sessionToken: 'a6e8b56be48471916b40dbd6d3426e0370777f0f59e86171293888d21ef09fe7',
    authAt: 1705108891
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd1da8b96522e4c5499956a5ed297b83b',
    code: 'e183d531bc7ac5a46bbd84e637a29caa',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '98467e216b94dbabf662@restmail.net',
    authPW: 'f2726f44a64f750e13d876d7704a0e718e5561c9832d7b9ddc1975cbf53d473a',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd1da8b96522e4c5499956a5ed297b83b',
    sessionToken: '2ab6139c55ae7705f1db8d9a889cffb8352327ffa1f1fe97e9af816ad0ea8ae8',
    authAt: 1705108891,
    metricsEnabled: true,
    keyFetchToken2: 'f33e3ac9d21fdad6a22a0ef49f3cc6ef540af0d1a12c130f50ed2ce658b727c7',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33b5e560280757e532c7e95d710c329113370b0529708391b8ffca03a31039b0", ts="1705108892", nonce="OivbpV", mac="ASDqknobc2NQSd86Mg4pve+33q5O4BnDh7cpZevNEyA="'
  },
  json: true
}
!!! response success {
  body: { state: 'unverified', uid: 'd1da8b96522e4c5499956a5ed297b83b' }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/resend_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="33b5e560280757e532c7e95d710c329113370b0529708391b8ffca03a31039b0", ts="1705108892", nonce="XwamFE", hash="6+og65GXwKF9EnygQjX46KAj9tvKxfiRYSNWwJ/X36o=", mac="grXrPNMBmAI0NL/NUkOAjSB2sIPg+dcjavrApuPw320="'
  },
  json: {
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    email: undefined,
    type: 'upgradeSession'
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd1da8b96522e4c5499956a5ed297b83b',
    code: 'f03551b83867ca4a16fb3f1aa82e8baf',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="33b5e560280757e532c7e95d710c329113370b0529708391b8ffca03a31039b0", ts="1705108892", nonce="1JsT2c", mac="WDqvxGqTupHbYdM3TgRarwwookLK/j4e30lbfoznols="'
  },
  json: true
}
!!! response success {
  body: { state: 'verified', uid: 'd1da8b96522e4c5499956a5ed297b83b' }
}
    ✔ should be able to upgrade unverified session to verified session (850ms)

  #integration - remote recovery email verify 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd2ac7103097489a0d506@restmail.net',
    authPW: '9b254db76cd578e2e61c463dc65686924866861035bd2d3b87d1264f39b5eeb6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'f1debd3a2f6946df891c32d7c83d2ebd',
    sessionToken: '02a328576ff28a6c63f8b5a5b37568caba8db1cbeb5ebd0832f97caf42f5a652',
    authAt: 1705108892
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4527da68b965e74b8e9667dbbad12646f6ffe732fd531c25e38018e848f00f19", ts="1705108892", nonce="vLchqm", mac="vB6LmbBCrJq6mVHIEGp7YhmlrGtkrnfb2oJmmtUqBPo="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd2ac7103097489a0d506@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'f1debd3a2f6946df891c32d7c83d2ebd',
    code: '00000000000000000000000000000000',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4527da68b965e74b8e9667dbbad12646f6ffe732fd531c25e38018e848f00f19", ts="1705108892", nonce="BV9Ev-", mac="d+7o2mNnzy1wpF+Jk3+uDiaFVV/UGpP/L6lZD/KezYE="'
  },
  json: true
}
!!! response success {
  body: {
    email: 'd2ac7103097489a0d506@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
    ✔ create account verify with incorrect code (282ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2ad9116d60e1ca7c6322@restmail.net',
    authPW: 'cffa498e3e574dd2648d3d1b115d5ab2fc3f3c60f074a24765becbd07924595a',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '0c5ed76b6b2d48c3b7b04c99bc104a81',
    sessionToken: '0c7be5c25397ff63824b2c442ce01d4a76dd294fc06419eb78a3aaa26b3361f5',
    authAt: 1705108892
  }
}
    ✔ verification email link (218ms)

  #integration - remote recovery email verify V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5ff3a260c2231cb1c966@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5ff3a260c2231cb1c966@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5ff3a260c2231cb1c966@restmail.net',
    authPW: '5723ddd16bc9cde7112410863200ab41777df91750720dbeb640eac9a06fb7b5',
    authPW2: 'a55fe1bb749a585c904f1ae1991a7d0c73ba4736e8a5893b6b2ed93ab5742755',
    wrapKb: '39b79789ecbffa0cad5f4d75bea7cf748cd8eaa4f9e802d8e972065d06f24444',
    wrapKb2: '47f860f799741f0f0a5375b17990cb6b8d60f266b4e3d580948b68062a5916e7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:670789f5b90915eb6fc8cda3fa046fb5dd72b232b1a8526687dad221b9e77595',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '284bd92418b94662b57ce020d2905819',
    sessionToken: '254d4654e9a71743ffb5695b1d4b126afbd3eaa16d9ee83d4519928e3c83bab7',
    authAt: 1705108893
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="639314f14dbc380b77c085417928f7e486608974529656f4062f7d82aa2bd9fd", ts="1705108893", nonce="a3_LM_", mac="lms6cJguo1IwK6zXesaLVTbFov3Cgvn8Bif7nrFPNRo="'
  },
  json: true
}
!!! response success {
  body: {
    email: '5ff3a260c2231cb1c966@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '284bd92418b94662b57ce020d2905819',
    code: '00000000000000000000000000000000',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 105,
    error: 'Bad Request',
    message: 'Invalid confirmation code',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="639314f14dbc380b77c085417928f7e486608974529656f4062f7d82aa2bd9fd", ts="1705108893", nonce="aD-8Uh", mac="D4Nhqljua0pspDhf5Nx5E/c0ioLWRzVSaNfrn22dWm0="'
  },
  json: true
}
!!! response success {
  body: {
    email: '5ff3a260c2231cb1c966@restmail.net',
    verified: false,
    sessionVerified: false,
    emailVerified: false
  }
}
    ✔ create account verify with incorrect code (508ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0dd54bbe05466f1bd84a@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0dd54bbe05466f1bd84a@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0dd54bbe05466f1bd84a@restmail.net',
    authPW: '92a685f026a8231aa76ad357981b5db1ed0bedcc96e13f963b7ece46d067a38d',
    authPW2: '3f69b4118298d4e2ae6d121ca87857669edc5f53bcb6198c7dd3936333d8ba73',
    wrapKb: '8ae83102b72df8e72316510d1c28c399401448bd08cd0444439cca462d621a85',
    wrapKb2: '9fd81ec5b30a36b1f1a97558d49404dc493f16440f0409b71a0f09e303286adf',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:2efaf23ed28b7d7d0610e50f48ff72b1f7e923fa1f4768d2e64f8daead9cad88',
    preVerified: undefined,
    service: 'sync',
    redirectTo: 'https://sync.localhost/',
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c0f6819a392e4f15a64637a15d8dc7e2',
    sessionToken: 'd4ea8a7ffc6e785045fc40dbcce03dad3d74044235132d35f2f37422d317f90d',
    authAt: 1705108893
  }
}
    ✔ verification email link (486ms)

  #integration - remote recovery keys 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1734313e762825b3f8f2@restmail.net',
    authPW: 'bb2702bcdf7dac6f06f49262445a9d4b94968095b2204f2dede659abf0161ea6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ed4cef9587bd4cf4917608ac29c5e9a4',
    sessionToken: '01fa7f608ecce98dedabc452f19994b420afa6762684dc3745bb8e3db0e9065e',
    authAt: 1705108893,
    keyFetchToken: '0a59ac387024626c267c028120a035f93377eb1646d35fea6814b7a1ea6ea8ef'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ed4cef9587bd4cf4917608ac29c5e9a4',
    code: '8a1f0d5a26f0fd02e59cdbac96786be8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a395db26403b9de857b3d9f7c28fe11585c76e1a99446988d681911ce5092e9c", ts="1705108894", nonce="hZtc6l", mac="+XC6n7e7nHYLYky6X/zhrTqbUg4NqDzM3kiOAnuRjt0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '817dbab73902ac159e5ad7c085e0bd88052e9c1ac3367e106f9f04196b87c65f01882441fbfa9e030af606a793af0ecf1a702f3f96140b54719f235c0c67203b0e7d3639f6dd954617583117946890719df59013036971f2e4d93207fa8a5a00'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e40fc9115081e1dc8124966e54e070a799d92d9d98ac5575a498b49abe7d167d", ts="1705108894", nonce="Gn0LBq", hash="ry0+tg39ltN5nvL0dYh0I+RXpMl6mGyurxDUt4bqNXM=", mac="ETGLRmG0nM3lTXURpbJC9EK6L/0K4b6+RsEVCtLwczY="'
  },
  json: {
    recoveryKeyId: '05c5d9bc1959582f4e34e873fc87f3cc',
    recoveryData: 'a3494678de2d373dbc6da6e94b5c51b16b4b48cc07128f61abbdfa478f3a384d',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1734313e762825b3f8f2@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'fda3912efb6f57c6f410cf43602d975104b12b7c9efa57ab6fc049b382a8d633',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="11792cbad29f1357c95e7b925389fa2140788d118c4df45a4d7048ff59cf19be", ts="1705108894", nonce="ZIRbjD", hash="CO5JFv7rILPQouDbo3mLa5r0fsSC91GmRFH+0eK43Sg=", mac="bBdviA6wEJ/VYBwF5PoGaEI1Kq2S1ByYJQiPbg/AWJg="'
  },
  json: {
    code: 'be2b51234dc0bd30854f24f82c016cd0',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: 'a2fcd8d3a8d3a37bf9b061209393d0acc7627f72c759dd8a1861519b51f95bd0'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/05c5d9bc1959582f4e34e873fc87f3cc',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="603a37f396d1740bf2a70ff7e70bfb07da79468a491506b0360cb1b2d2f229d2", ts="1705108894", nonce="5r14Wv", mac="ao4NyuA19qYMH4Hm6nLThzk9hhhvZ8m8CncA3W/GsRs="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'a3494678de2d373dbc6da6e94b5c51b16b4b48cc07128f61abbdfa478f3a384d'
  }
}
    ✔ should get account recovery key (70ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '17461a0947b5ff02d413@restmail.net',
    authPW: 'a54c34ada0122362ab7838b33f245d9c5f9795c0841bed45369934935b3857e4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '2d7bd8019aa94a99a3b6572e63dc6b3e',
    sessionToken: '3e4c041c32a02429ca2c1b5a04d20d1b0e82bba36bc930f2ee5d48478501246a',
    authAt: 1705108894,
    keyFetchToken: 'bc2ffdfc0912120ea3594be781340842fa8fd5018f5cf130597ccaace88321fb'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '2d7bd8019aa94a99a3b6572e63dc6b3e',
    code: '00ba6e984ef2c08742a007bf7b3f480b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="2cbe9af23046f346eae164cdc528246d3eee7a248fffd5a4490c3e648e5f7f59", ts="1705108894", nonce="ik1XLv", mac="vRa6S6/+mJjIyvEudEYvLx5f+3QXJNUm6CH8xK4YtyE="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '726cdbe24c56dca143d9149d09660d2d10613fb10bb30ed5d5ebdc5730bf98238b8e71a289e28ce00accd6c32cb09c4c1f1e3837e0f1666f4bb5f366ba5d1af62d6c03a7c9149197d81f4448f108d7d6327b94b13a2d860132d5df641e7ff08e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="5cba914bdffed83b42554d60886091edd2fbd7530072d747479b1ee663d51375", ts="1705108894", nonce="sfnqjl", hash="EgdmQCS64skfXgVoMBfwlPnw2bN+9eWlGKtBUZx0cso=", mac="jZ6n4Y+pozEXTkk3XOtGP3XZXUE6Hdh7IiMCbFYbTYE="'
  },
  json: {
    recoveryKeyId: 'ce2a71bc09ce290e00d9f2102a057011',
    recoveryData: '964fc6d3250d7f8221d897a0cc940384f209630ce6282177f479abce8eab9121',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '17461a0947b5ff02d413@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'd3179fbc4ca031f76300c22078471b7644a18e4255fb38c9b756a5d4060f329c',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="564bc2f0a9150c1d5dcf82c58d386282fdc73c5599376e4de8599779af6645c3", ts="1705108895", nonce="ojKZ5i", hash="MJR0gls4msiCXy15iYccE22APs9fHZFsRkguLBW2mCg=", mac="FZl8H6COJ0yocODA1pt7s+xD6KMxIKr/MFHtxLaKgCc="'
  },
  json: {
    code: 'fec147f9bc339dccba74481262f96dea',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '8578e49970cc487af9faaae49e9c72ae737485e945dc03fdc9278897d1a79ed1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/abce1234567890',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="eebc8eee63aeaa051a61eabe178352b6c8940ccd565205f0dc16774cbec913f9", ts="1705108895", nonce="xgpDO5", mac="+qAwWuil5yYd/ZfO2HX5dN6PBX5Xer2/O18fTyTgYsk="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 159,
    error: 'Bad Request',
    message: 'Account recovery key is not valid.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to get unknown account recovery key (88ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '554cfb788290af1d8317@restmail.net',
    authPW: '72f0395681a1827d07dc1b0149bb381f77d70e685030605e975e671a3eb50b6b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '871101a83f5742728c99b5d8d4f66755',
    sessionToken: '21eb2196ca67d135a535b7b0f696d65c586c4e0a279faff71af77b4d5f463643',
    authAt: 1705108894,
    keyFetchToken: '788a07666cfc737b1f8588b11c7f8a0d39b980d446c1a96ac57c1d5e9eefc945'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '871101a83f5742728c99b5d8d4f66755',
    code: '09361b712eba776932e31733d2c3abc7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="5d7ea244d433fc11a091aed9d585b4db0ba1a2f0ff668dd28469e42454cfb668", ts="1705108895", nonce="r-p8PO", mac="UuLPZSjsbKCx433yvZ/FPlNWdeOF19f9HIYQ4kR9YdI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '0caa69954ab3e4f4dbf7f021e35e781de9b9a9eb81043ecf9cbc70470aad9c8d0c92670d46c9cfc7b6ecbb78a14fb1b1a723fd805bf031ff06aa82f6952f6e2d64486fced04a5609ab38b6a6190242ed70010fc8a0b7c4b203d79f661c07efe6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9042f5d345f99c057df30b520fd851221c71731e01daf83febb84548771bb68d", ts="1705108895", nonce="MNZjIU", hash="vF9DEEaUbzovhKkGbYYhJ4u4mZA8a4Gf62RBSM1OBDk=", mac="IY7VuniIgKnFioDE1lEcJxeJntbwn232DwQu3e1To24="'
  },
  json: {
    recoveryKeyId: 'e630663683f66e54f020c0f082b1ac1c',
    recoveryData: '71600a766cf18cb08f1ed84de2f9606594c474e055888129f0ec68de28944cf8',
    enabled: true
  }
}
!!! response success { body: {} }
    - should fail if wrapKb is missing and authPW2 is provided
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f2e94aef13a006b99151@restmail.net',
    authPW: '05b53ac903d540413eaaa891b6456e35c8e1550ecac40f15e3ff692262a12fcc',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd656321b83364cbd8e6aae00fc563022',
    sessionToken: '4f2aba0acef13a3cc3d90d86ebf2f7e7d772a904974a8416f2f85848f07e227a',
    authAt: 1705108895,
    keyFetchToken: 'a986ad50aa7c7ef1e83fabc672ee413bc18d218cc1b333b1a11e5fc27f374859'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd656321b83364cbd8e6aae00fc563022',
    code: 'c0e8e065d3aaf606a22546fa0aec1c83',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c3782460154dee5529e3637f91f4bb14eefcfb64a9d30ae9593ff7a78a24c0d3", ts="1705108895", nonce="O2yFAg", mac="cfxlOtZ+SNT5/MRLFG5LuldjlAaUbvIejFx7OR9qVLo="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b5d0b99832f6ebefc539afa593a0fb4535d80186696b790f7b36aa760961c643602f3e308e4ea61d3ce2ad1d91b35259fb8fb19aefa65734fbbee1637dbc9fd1e4d688c9213f5c062ce050479b67ddf8a8dde3f723f4d55823317e96b1219378'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bd817a21fd04732efb86fb0a31ea4a9b4614f73e9d311200f35f23f2b0bd76a5", ts="1705108895", nonce="WSG7KP", hash="N4n8O0AHJBfGUIFeASmGz4DjhSdAg/4MmaY4IeG6i7g=", mac="32CqaviGL+8HvgPZr4kPgYG78cBwd36UB/9wNO57p4c="'
  },
  json: {
    recoveryKeyId: '58cede233c3b28a9d52324b5c0e43bbc',
    recoveryData: '6c365e37e652f92bb3bd7731a8cb7277923bef2601702252e04fd77ab330e5ce',
    enabled: true
  }
}
!!! response success { body: {} }
    - should fail if wrapKb2 is missing and authPW2 is provided
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '6911da9cb24f4adebd9d@restmail.net',
    authPW: 'c36d4e766a8786aaa8c0bfe47181f1db89a987f67d8529f55bc6e88171b0473f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '09618b282062492ab16636338f452290',
    sessionToken: '5a81377358315820e10cddeffeb40fd63c6796758827685d830da63f28078fec',
    authAt: 1705108895,
    keyFetchToken: 'bab05e27d5f513f73a85bfc1885fa924eafe9ccab5d5488fb390e1b38d1463d9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '09618b282062492ab16636338f452290',
    code: '28d6a3dba64bb032a62d1b6c4d281151',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d8878ca12e6bfcb2f798604896996a899569efae6bae6e95dd8b3e5ecec5f8ba", ts="1705108895", nonce="Y3YRHO", mac="xfOFeMUeaNR7S/niDDTz+l3vkm9MibXgYOmPwbltmk4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '568f078ccfd93f65ee0b3b21685a5dd3612e0bd0be1d0c5fa89e86e9638239da375908f24b0feb74435497df18a088ef67dec0b5235046c69cd4a5404b8b5d5dcf6b5ccdf7aabe358bb1a72c5aa55bbc0be6dff7d464e7247278abd4934a6338'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="56467a1526279248ae252bbe826871e6aaf7abf14f2aa058b4433f4d5ebfa299", ts="1705108895", nonce="zukZKa", hash="8iy2TpaEvUC8i8RSKmdcrqdFfCSA7JrMIXNUzx5Fstw=", mac="QnshSEFZEi++KL99AuxbLdHK+Vim+sGTgMPm2PLwUgE="'
  },
  json: {
    recoveryKeyId: '3fd4b9dc0554f34735a54d1809382a9b',
    recoveryData: 'ea4954e32db09a87b8b2be2b42dbf873f04dc04d4d285cb1fb0286de3aac8039',
    enabled: true
  }
}
!!! response success { body: {} }
    - should fail if clientSalt is missing and authPW2 is provided
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4ba37aba5466a4bbe449@restmail.net',
    authPW: '3637184e2b553a8614723a7352010f04491dc7521010326c3e4151b6b956a852',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c42fc7a5e6de44a1992c1ddf9ffa9f7a',
    sessionToken: '38e3e591cfb652c3af74b090d8c7a7f58ad5cee85380afc5d28f7b107ee32731',
    authAt: 1705108895,
    keyFetchToken: 'a2c9d127e174d770f3636924a48a9a48cd9833b084c56a5f27a3ad58a308cd2c'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c42fc7a5e6de44a1992c1ddf9ffa9f7a',
    code: '70e1da4f7c59c65b2852e2bba5ea63b1',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a455130dceb35edd8dcbd46607df86fcd138f2a4d14af029c951f8ad6719ba21", ts="1705108896", nonce="Tzz18g", mac="tx+ujv3Ic1Ign9c86P3JdE3YBDoCJrlbxH5MiTajBOI="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '8b4d2049f4fea371e63be04a1c1c71d99cdf4f275cb3578c8e01f0b00390d7d94121c59861582cb1d4079d22c084fcc1ac390c74c2f3556a4f9916923663202d7d397b5988099fbc12d1a7dccb25d18d630fee6116c6820f2a8a6d1fcb6ae5e3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8a98b60211c6eb5947d5b95b672a687018d3191a28d0b3ee4a60293c73d254b", ts="1705108896", nonce="glVZtd", hash="d8TbF12F21LWqFg3iCUpDJFUHR7igVs9ieOiax6ntik=", mac="ToXQktHy9ER9u4W8/TGhB78FlOT+TDc4BBO31gWnMxY="'
  },
  json: {
    recoveryKeyId: '0a795e4f2f5981097a692d335d5b91fd',
    recoveryData: 'f8054d5d9141b03f31e4c9f655e9d16cbcb09bcf08fc52e375aa791425dd7c89',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4ba37aba5466a4bbe449@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '17ca04700991ce7d317cfdd29c5d96322f8306e49999131d1606ae5157668d69',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="7f20537868df7dfba3b67c3c9c2fb4e00c5ad42f4c3dc21f8c91c200ff8581a8", ts="1705108896", nonce="RJFU5S", hash="OIfqe9b3CjK+yjKLaOYr0ZLjqfdzIyOJr9JQQDYutq0=", mac="Fc4RI3JIxyhPfQL2UXTQ/DuY7nV0M3FMYWp6IZXimrE="'
  },
  json: {
    code: '7bb5d9ac919aa4e20cecaae7770b9efb',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: 'f58a12b81832e8306089e327b1550a9af4db7e058ac0435aee0f31e556cc722a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/0a795e4f2f5981097a692d335d5b91fd',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="bfe6999db02a4083593af6c1b2db026a9e554437f08dc3d29d2d2fa3cb2cfc6d", ts="1705108896", nonce="MG2RNn", mac="CsgjaZZiFEnO80XK5CmrI6vdPXtylSeKZWC0EU5BQ4Q="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'f8054d5d9141b03f31e4c9f655e9d16cbcb09bcf08fc52e375aa791425dd7c89'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="bfe6999db02a4083593af6c1b2db026a9e554437f08dc3d29d2d2fa3cb2cfc6d", ts="1705108896", nonce="CLK1D4", hash="YH2ersyMEf+VcTuuWP1CudfXE2TZ/8MMyMEs7JiF5DE=", mac="g8MXliQS90mrlUgQbyfSTsCMXUVh9rx0RnGzGr12DMU="'
  },
  json: {
    authPW: 'd87dc15e1104a59901495ae9c53253882f2be10e2f7186d5429de252d1540029',
    wrapKb: '3704fed7db462959de839c8c84bea66f39132aec6ff471c817f2b3f555931214',
    sessionToken: true,
    recoveryKeyId: undefined
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ should fail if recoveryKeyId is missing (67ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '240692d01b71fce3b5bb@restmail.net',
    authPW: 'fea2f37c6fd0ac486256c8a584453e5c3cf4606c15176f1aad95fb3c939d25b9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '283efb8fdde04227a67494e4f9c32d18',
    sessionToken: 'e074f8d723bfdbf718d9b6f921457f9598523a004756b3d819dd8b94a4534f37',
    authAt: 1705108895,
    keyFetchToken: 'dd1ee9f414301c1ae7af68250585338160da320577bca8834e14d4b4bbfed2d1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '283efb8fdde04227a67494e4f9c32d18',
    code: 'fbb3633e434589adb3709b1818b1683c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="beb435d7c92c6e19f0e5b72e1d252713532d6617eed3c487b9934dab396dc867", ts="1705108896", nonce="k1cRWf", mac="nRdWekFNhL/1E9Yf4Zpe0H6GtaWTug0Po+0JqmdkRGU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '7551cdb9eb05f7cb7460ddb0ea54c673bb719c741b713a5b02a367b6d40c253666cabdc606a771359ce344d42547e4affac55ecdac46347509af84f15cee76d763dd7f89778d5269a93f2b15bfab75c84225d30531a014ba3f4c15235d963fc0'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1c3d7846e0961a0af784f4cc631850a06fa07d38687aa9c1432d378041289b40", ts="1705108896", nonce="48HZWh", hash="cqOLniCXVzOkxokWu3fF86GvgBJ3JlBQjioLfxb2PDw=", mac="cH9XdmiTKG+d/B8+dt6oJVOViz+Ln53oJwyPNqSK144="'
  },
  json: {
    recoveryKeyId: '94aae1dd5d251a87da8168beb281fb19',
    recoveryData: '5232246c37f6700ab8c0d4e3e8a1fed64350a1049c8b18b802ae8f2337098110',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '240692d01b71fce3b5bb@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'bd23bcdf6c4f9d828420a23c331dd09e027e16369107724fc42ed6637cf39bd0',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b8d35dcd1fce5e644fc72e45d9335fdb40281aaf221e5a21562f4993598500ba", ts="1705108896", nonce="O2azTo", hash="bw1yWJjAxVgbe5oeiRWDtn+czgkmFpP5iPI+18Cn6Z0=", mac="ZanN74G26ETtV0JNdcZssAAWYgq2k//mjnWnx/IjE/s="'
  },
  json: {
    code: '29d3de27b54c1637f4aa26758c4f47e4',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: 'b312563a3ea34347b4ae753fd24809f4138c2705e5e3390b691e534c79a1fe9f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/94aae1dd5d251a87da8168beb281fb19',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="84b39534f83bc03ef4791bf4664e8181712e86368ef7c351b1c61c5d0e221b41", ts="1705108896", nonce="oHe_5w", mac="AnCux9jLXyGsLti2oGwfZpGrtEpvSJmjTc6USzQ+efQ="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: '5232246c37f6700ab8c0d4e3e8a1fed64350a1049c8b18b802ae8f2337098110'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="84b39534f83bc03ef4791bf4664e8181712e86368ef7c351b1c61c5d0e221b41", ts="1705108896", nonce="S4JYLd", hash="Os7hJ1RHXKTMcDk69ILztDyNFzOL2p2fhW8XjY8B5j4=", mac="h4qoELM8iYySk9Wxkj4D7yUwsBUJM1DCrKNeJKnPmL0="'
  },
  json: {
    authPW: '512be8908b8af4bd1d8386340e5968776fdf510f2b6915510a9a7cd4022f6c05',
    wrapKb: undefined,
    sessionToken: true,
    recoveryKeyId: '94aae1dd5d251a87da8168beb281fb19'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ should fail if wrapKb is missing (71ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4f7c620be346ae2657a3@restmail.net',
    authPW: '29eb35797b5f505fe3b23d11ba5df8ad01080250762be9209f3ebcb6438f6726',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '027f29ac776a4b21a5844a6dd776fa48',
    sessionToken: '87fe2c548ddd3fa30bd1b29e890aaf38e5558ae64a57302377958b9c1030f59e',
    authAt: 1705108896,
    keyFetchToken: '3faeaccc1e91e62fa5944e3277c52368a80c786aa31ac4195f90cd5626e96ee9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '027f29ac776a4b21a5844a6dd776fa48',
    code: 'fdec1001a0142f2fca2f16bd546bbd29',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4f0a9d0152b7df945316224308b5a2f719cb539db6f2d726584cbfb99222ab38", ts="1705108896", nonce="qaaoxH", mac="+FTjgnmIAU1gN4fLkFvfbPvg0NyY8mtg3yL+jo/9PKU="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '001587cf6ff6ed14efce40c91c39f0f8b6b218c2ca5c7a209d007a176a256ac5f7296f62b67ccb23becf851931dbd3583464ba56a67aa667e54f941996ce92adbd20b98a7024506e465a4583928e402da1f2e9d3e61fa9c72b37fbb033ff9085'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ebe46557136843702c5883bdd95fef4302782bdc51f1bf30ce46dabaa9d1da97", ts="1705108896", nonce="MHxtNO", hash="qaWJ7Gdf07bdXCdbuMwRXG6+ZdWlyHQBuCybjsfKmnw=", mac="Z9HQZirhsqFm+orH3nCM6RpgGrv69f6lbGbtdX32w0g="'
  },
  json: {
    recoveryKeyId: 'dff6ed4d10f295ea2a4d136b9ca10694',
    recoveryData: '8f1cdb8a76c35145ae94f755e2d409d65dc5c80c3269ff56f8ee934c5f2cc9db',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4f7c620be346ae2657a3@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'f6fd6af025779ccc436cd034a69af7090346d0da54fbc4f394cd85fc5359e54b',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d71f6575ad10ce8966242ab941de346a8ba0ffeb728ca83552be6b36a94afb14", ts="1705108897", nonce="YmtbMo", hash="byj8KPIx0ClVAqR8Qg+PwkwZiFSojVMtePHC7XDifPU=", mac="mfh7tUitHyEuh0hUIjQIwyvbv27sAggCzB0/7rS6waI="'
  },
  json: {
    code: '3c047213f18ea1e4b824cc7adb36c6a7',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '8981ea354e8dfb44f4f06d4745436455ca9d825244d02835d29c9c6dd2999e03'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/dff6ed4d10f295ea2a4d136b9ca10694',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="71bd631b930ed834b0f042d4e45cc605c1acb823ddc1d314c6a80905a2307903", ts="1705108897", nonce="2hGpYX", mac="WzKv3Ji+O8Mb9BwVPNEDOayERUtUaFhrn654ZPd/icI="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: '8f1cdb8a76c35145ae94f755e2d409d65dc5c80c3269ff56f8ee934c5f2cc9db'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ebe46557136843702c5883bdd95fef4302782bdc51f1bf30ce46dabaa9d1da97", ts="1705108897", nonce="hMcncW", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="9hQW+DGvsz2dKkxbPSdfaDhigIQLC558nbxA/luj5EE="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMDI3ZjI5YWM3NzZhNGIyMWE1ODQ0YTZkZDc3NmZhNDhAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4ODg2NTU3LCJleHAiOjE3MDUxOTUyOTY1NTcsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4ODk2MzEzLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODg5NiwiZnhhLXZlcmlmaWVkRW1haWwiOiI0ZjdjNjIwYmUzNDZhZTI2NTdhM0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiIxNDc2NWJjNGI0YTNiNWNjYjI2ZmYxNjgwMjNjOTc5OSIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4ODk2NDA2LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODg5NjMxMywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.G112KRXpGkXkJl6L-TYbPr7qUZngYsW8tZ60TekRneBUkjdujGj4eCmLHMfbaaJqlYRSDjNcHlWTiK4EfAro0DinhcRj5WdF-MOMUxvN-HHeV3q8RM6gC37rio4AlRBkOgkg3NUtpKc4aAbwOgJ1MTFFxJxf1pwBrM5dqkZVugCOQ1VcwsAszqrZ8yETFrRztWsDOZn2_TsvZJQnd9h910MFoY0Bg5LuDAElVn_U9sjsFp3MTgtio6WH0dMCYErYt5JmS4JCZdvKGEST73rxZCOHy_qetLqPRUnSOiHIo8jg2ebOCqIq9VjYbXUEFSid4DjmgJJZt9hJ-qpDeSSzQQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="71bd631b930ed834b0f042d4e45cc605c1acb823ddc1d314c6a80905a2307903", ts="1705108897", nonce="xaCvYM", hash="1cqv++tpw2jTBwQ60n0SQFFM0j0dpoLjKp3veVrR6Eg=", mac="549Aoj9K8Qu+bBrwVOzzrP2i/Ha6zmlWemyCyrewDPw="'
  },
  json: {
    authPW: 'c0054bfd2293a0914444c1d349ab6169a02d93c9ce1813394603423272d176ed',
    wrapKb: 'a0cbe9e84dc44104cde8a12b92c8ae441f1083d3d2cdb33373c47d527e186929',
    sessionToken: true,
    recoveryKeyId: 'dff6ed4d10f295ea2a4d136b9ca10694'
  }
}
!!! response success {
  body: {
    uid: '027f29ac776a4b21a5844a6dd776fa48',
    sessionToken: 'b8404eaa8ffefcef796145bc9b59a2324b102ce64a79cd136bc408cc621e304b',
    verified: true,
    authAt: 1705108896,
    keyFetchToken: 'f996c39030e106ebd44f35ad7316e9c86be8ed388b37ca77176165e6c2d5c8a4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="d4bfdb59a3e0a7acd690245388d0a9bb92a0297b0e0a42855ee182b1d6d5e8a2", ts="1705108897", nonce="1abyUQ", mac="0G9JxC5rLySDAkyQ8fahOLAnsvpR/7MuwZliyuaIOZc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '23f6d253a893a43c55a9c278e429974de0d10f242aa38bff8a59390147cae1f210fb5a3e363a1cd3398b33e661a639e05f7b14811b8ac6c115d365c5cbfe5a6ea30503ea2f8119c7695144e1fd6c0d88ead7e6461943573ff066ecf1f8790074'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4f7c620be346ae2657a3@restmail.net',
    authPW: 'c0054bfd2293a0914444c1d349ab6169a02d93c9ce1813394603423272d176ed',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '027f29ac776a4b21a5844a6dd776fa48',
    sessionToken: 'd0a66c2083e5ef57318f0023ae843e275fb158fadbc3728ed924de22bf7ed124',
    authAt: 1705108896,
    metricsEnabled: true,
    keyFetchToken: '9a79344e15f0edd4c9ac042b833cf74a95288781f2c647d341625620fb896a61',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="987e0dc11af33c4efae7cf8609f389f335eba84f568f30463ecd47de9dc3689d", ts="1705108897", nonce="uKlFKG", mac="Q1F+tMBtx5GZnY5fNK/Fmf/y+BGQW65ZnjDn0dIpDFc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '1744e665d2174428c86c4bafdc3728aae4670298c3e33da85467f4ff8a631bc9e34e71e6b42084488834adff887ff73721fa9c2efa0db6ffc6181762c7cb784b1c07d5f7468af861a353ffd44f82333953a72b494de6b1e9a0cdd79a202fdac4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="e829e4708b5810df44d1c2b355b5a60d5c7256377f38a6ca8c3ca18cb888ad5b", ts="1705108897", nonce="_tMBAW", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="51m3OSSkY13rLcCTUXHWXjDDNNKJCna80uI8m6qMvnU="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiMDI3ZjI5YWM3NzZhNGIyMWE1ODQ0YTZkZDc3NmZhNDhAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4ODg3MDExLCJleHAiOjE3MDUxOTUyOTcwMTEsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4ODk2NzAwLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODg5NiwiZnhhLXZlcmlmaWVkRW1haWwiOiI0ZjdjNjIwYmUzNDZhZTI2NTdhM0ByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJlMWFmMDUwMDkzYWRmYmQzMzliZDg4ZjM4NTQzNjJhMyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4ODk2NzAwLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODg5NjMxMywiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.SyEZQI5zSTew8m-znU2Ykfu55Siq5GajieMTFN8cCaZWtgfdl6zdgUrhvzQVn9whkbtEOX02GroHOpVB_tpTi326iWfAAsejTaGrdFN1XodvNI-9U4m8rdNWJYGUInqDm3GsBIxycQIFtGgAisGWuwPpb5MPlCqMzKIHnqOc8q1OC1QkmH7N5Lf4VF3Tkjb9Wlrjm6Iz9T25oE7n58l4DADRJBodj2ldVW1F45lGRSP9UEd-s3lOt_za6Jj_-Qk6Ss8eJKvuCg258u22jyW_O2CfMTAC03p2bOrovDK9jTZiBi6NxHgnya9-rGEeuV_89JdeVQWJA8ZTApuD2DU46A'
  }
}
    ✔ should reset password while keeping kB (546ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'a71c73339c0325e8e0a5@restmail.net',
    authPW: '10f9bbd7846f2930c1e1198d89d6401419d405f6fc609ba415fe439fbcf8c6e2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'bb7ff3c70c144c6f9f81c49e372abe27',
    sessionToken: '2ad8bdc83f4ba1a25aa497f815db328a16c0086997d16a06d0e61c8a5bd63571',
    authAt: 1705108897,
    keyFetchToken: '206fef8f402bad474e3fdc0a9e19997296df15584b85edcacba4dd13f2c130e8'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'bb7ff3c70c144c6f9f81c49e372abe27',
    code: '8a46b04a67ff25642e99d14c88fce7cd',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f468c1a0cf855a03532e7e214f79f7ff7d0fbc911868e7a30777eb8292885830", ts="1705108897", nonce="15fE35", mac="B4ozBYbHjavxcs2Fe64u8MSalh/xUohHii9Y1CbI//I="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '3096a153420ff8f0174000800d80fc83320ef311a0aeb87623cf88865186a4f5b3a4f4ba995dd627a06f75420e85a260c6b831c953456c0879e3e206af5e5f58e762cee5ddc4352e06cefe07dd13871c3674141af0a33c34c71dad7d66b3f63d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c0c2c85a8317470b3305617113aaac9451f3352b1d227ee755bf23942157982d", ts="1705108897", nonce="hwG7Y6", hash="pIhTfoeVLg23oShQsFdWBLHBfHWg1jr5siiLiJhnZP0=", mac="LI/czvahgYt5Pi3bAOgm6PB9f3DXLU2oGQ66geozSsA="'
  },
  json: {
    recoveryKeyId: '5702fe3f94e5b1345c9427f0c81f5573',
    recoveryData: 'c1b500e9e2d7f10ae493e551aa830321232ffb1f6e965061a6e3632baead7381',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'DELETE',
  headers: {
    Authorization: 'Hawk id="c0c2c85a8317470b3305617113aaac9451f3352b1d227ee755bf23942157982d", ts="1705108897", nonce="hwdmus", mac="KuyZasyN8Ho6Ky0DXBGGzzwa9IQ7SDS6U3RKLy5W7zQ="'
  },
  json: true
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c0c2c85a8317470b3305617113aaac9451f3352b1d227ee755bf23942157982d", ts="1705108897", nonce="9jQLTE", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="bYvU6IFnFHBJ4qeMwtin/zM3JUJ8Swvcmm/wB084u8g="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
    ✔ should delete account recovery key (48ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3aea41367ac0f259276b@restmail.net',
    authPW: 'bc7b7d41c0aca8c5ad5af4e64fbce2d9df071a811a680d5cff8eb2237b6db1af',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '1e22a22b67284c0093b321d78a909da5',
    sessionToken: 'b6c1ca25327d6b10650cae5c198e8b07eb5e30c5bcda551d3ef802466a82da42',
    authAt: 1705108897,
    keyFetchToken: '23199e1db894c372ef2b3906b328db125d162938cb5b89ffd69d477cd7e0ccdd'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '1e22a22b67284c0093b321d78a909da5',
    code: '1856c0add8f19fa50debecb366d3e481',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="feaa17abb9fffd42befd5b5454992669ba02d8a7ad677583efbd3e44eb45e8e7", ts="1705108898", nonce="P7XNOP", mac="MY9o1EHN1b7lpzOM1eZwtMxQQDinuUl2GjYafdquvX4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '33a7b7d322c4ecd864970d308a0e02616e71d5eb7d14a91cda20874dfb53f0300556a7a88a56fcd1dfdfb1d7bc75f7a804aac2987fd7715e68b7db55add17a6790dd42e0b61332350eaeadda9488d8a85eae9131b49a9ffc209c8a397df371d4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c32d1bfb7070a128ec197e857a111cf675b3c45ce2992f53b697fe747c878372", ts="1705108898", nonce="5tz6EB", hash="Ks0Sy0xi9GBXWvud2HuKoI8qZ9dDQBRet0yHkmOCLc4=", mac="D+J9dlJWja6WbRjZTc3bg5Nq8rxoh1fsvKkoqGdXrHc="'
  },
  json: {
    recoveryKeyId: 'b48acf1832c83d0869567d87d485293b',
    recoveryData: '901297567d7623aea81e52db87619b7defa57cdf2c6a7becce3cb15e3d06f852',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c32d1bfb7070a128ec197e857a111cf675b3c45ce2992f53b697fe747c878372", ts="1705108898", nonce="J7C1Fg", hash="AmIZCzmQLNCOv9OzT7YT3gpknwqGyEbrAoKMhwFwyD0=", mac="9sjtusgOFliMSZhtyqgcgubF0ZdsiWeBTPfXAvpJzWc="'
  },
  json: {
    recoveryKeyId: '6741e103b2379c4d7eead1675f406938',
    recoveryData: '67fbd9e4f8d22c88eecce5e0890645fc5c9775d6641026f3a3d8424a326a141f',
    enabled: true
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 161,
    error: 'Bad Request',
    message: 'Account recovery key already exists.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to create account recovery key when one already exists
    check account recovery key status
      with sessionToken
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '7bc2d08c6f7577f0def7@restmail.net',
    authPW: 'c9547b787f51274c5781f7f9930e8c48086f6bffaddb7837f1e63644018d0714',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '23ade650432f4575a5ce85cda3906e81',
    sessionToken: '628f3237f906185e2665dbd73c3fb39bf90d7f35b97dd175a935ceecfa3c9571',
    authAt: 1705108897,
    keyFetchToken: 'bb336064159d1fbc1c0b297bf219968b03823ff86f92b72b0dcb3bb07ff59d35'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '23ade650432f4575a5ce85cda3906e81',
    code: '20a81ca889a4ffd3e02d58f8ae7b83da',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="c6984ebbe510c7c4146c72626ae14b5e0bea2aa91d686111184a023797cda4d2", ts="1705108898", nonce="lDubUH", mac="qyeCBR3oRdSwimiIjAxmPx7XaxC1c18HZy0xEfE/sKs="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '66302564512b9863e8ff70644aaa0bbebe55d72701262b4b596f36e2c370c287e15b57b64187337be38804505db50c430ff028051eb0f947515cf3f9698e0cfcdf34f503f35a07cfafcbf45625bd93d29c7f3742beba899baea03f6aa70e2997'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="694592bc76baacb361270fd2f4f5f5a292819e2d7c14dc5170216641cbb22b47", ts="1705108898", nonce="KFD5WD", hash="PufIajqf4xmg0aJRu7wG083Hpoj79pTvaO2l0nj3Oe4=", mac="vD01GP3wXOKlcGPJm8jKdkjV3xL3/MnQ29inoltUwLU="'
  },
  json: {
    recoveryKeyId: '344fc4e7ac504bad4310a2ce2835ceab',
    recoveryData: 'b0410d61ffcd55407692714ec8b25fd654a69aefac632fda7106c8ed5377b3b7',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="694592bc76baacb361270fd2f4f5f5a292819e2d7c14dc5170216641cbb22b47", ts="1705108898", nonce="nXgyE4", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="lwjRA26ovKqAUuevw0BTHGA7bpWIhmgWsS/zL4fjMP4="'
  },
  json: {}
}
!!! response success { body: { exists: true } }
        ✔ should return true if account recovery key exists and enabled
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '7318be83928ca8403bd6@restmail.net',
    authPW: '851ad53c3ac913200cf1db708934e16efff32604fa6de07abb51bbfc9cb39a84',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9f5c151bbb1c4308b317644cf9453c56',
    sessionToken: '792e56ae8ac156dd6a28de924c107269172b6a5540c1528f5ea9a958ad6e6d41',
    authAt: 1705108898,
    keyFetchToken: '0ac7b53f655c4b1c6f2838327b251ff882f48cc81a1d06fc50a595d5db88bb9f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9f5c151bbb1c4308b317644cf9453c56',
    code: 'afb0ed2edb6316455e5479c646bce2a0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4d9004898da62d5c12dd476000ffab9bc9354775010639c8b94f4edbdc48ca39", ts="1705108898", nonce="Ts3W1q", mac="psu5KixUhCZ15B07vD4ytW20QRpHmFYWPaaDxfMu1bg="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '933daba0e6f3c07bb545a0f2f5a0942ea3aabe95fd33e43ea2ce5425d4bebf12d2b09b9698277e4ddaa63e0d0d231ad35fc178f79289219e66ce72a7bc3d90a4799e976d3805b2f03ba22746b6a3cda54401cdf35f77c4784b71d718e57d1c62'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="2a4355646f4ed6c2e336896935c074029832be19cee544d64fb3bc81c8c4aea3", ts="1705108898", nonce="NnmzGq", hash="Ya8WpwPDhO1yITIQVOfyFXp2771BJ7kKjL5QaCY52ZE=", mac="bxx7x/wOqI4e027XRaf5rmsSzyPmRgnWfdN6AltHBAg="'
  },
  json: {
    recoveryKeyId: '8e2703de99a21d08483be70e63d7e9c7',
    recoveryData: 'e8947e99eeb8ec0e1903a28da5d42bfbde7b85c4746f00eccb807fad9f483cb2',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f8c2feb3a15d10f0cc14@restmail.net',
    authPW: '235be43800b29ca245c8467a2e0948f4a5580f5631ef58850f3e6c86cb113d14',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c1de2d4fb2584f7f94cc2e767abb7015',
    sessionToken: '11a5e130a72b0300d84704eb6182b00220d68ec1f331b68fdf7dc8d89e888ad6',
    authAt: 1705108898,
    keyFetchToken: '3ef10880563da7055715a01aa287327ad47baa06ed2f693937b514513d354c16'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c1de2d4fb2584f7f94cc2e767abb7015',
    code: '0a7058e72e2c26d513a02d995cd072d7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8b7736617e5d1b53ce83020406944204a7f1efe7e4953a6c1b23ebc2b04a3640", ts="1705108899", nonce="MAmYTe", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="KJOM2soWCyOPWXGy8nYRmRSZ5owM/AF8ysGyqEXvHI8="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key doesn't exist (228ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9709a8aea978a08c6ba8@restmail.net',
    authPW: '9c6063c439734d02fa2447bc854ba0c34a6081480cde2538b34c0a99fce5234b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '486f359e6b594c11a813ea3d7ed8b67f',
    sessionToken: 'f61f20bf7297eee4278fcab54685dfdcff6943204965299be683db181ba250bf',
    authAt: 1705108898,
    keyFetchToken: 'fbfd3aa6473915c7ce64adfb5fc101ca7bcfbae4d0a7eab8bdf7dfc6e859999b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '486f359e6b594c11a813ea3d7ed8b67f',
    code: 'f33969a8ccf790bd3059a6d2a3b6b036',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="61026ec26519561dbe415bc7d7b31cc4b6cf0f43061b51452ee7f122c9292cd3", ts="1705108899", nonce="ZtgSwF", mac="ppvxXmwbhMd1swa1P9uZVBGSKYh8BMt0MilbeeqFu78="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'd97d6cb28d7d121b365565035bc838acb6f7cd7ebd524b2fdbf9dd80351a49b1f20cca4107d632aa0051451247422e41b73267b1a39ca96154cb2b7786837706d26c9f75be54539b07fae6aa29a49d2250a7f5b70c90395c1b0bef3f1b72bb97'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="522ee4e6d110df0757b9c4edc76fa4f02daa0f5f32c316cd0e7ab5eb03bf11dc", ts="1705108899", nonce="Q81OPG", hash="mz8rUrV2DcJMKvFiPjlm1KJUxa0G/1kq2FL+2PSDmVo=", mac="j474swtrLoGJeYU5L04QsMhrxmXv7eRCtLCPkEF0x8E="'
  },
  json: {
    recoveryKeyId: 'a98cca61db2a5ef46b39ccb5bc242e16',
    recoveryData: 'db2b6e969b967e5fdd92a8d9c38a359325c8f702d1583d3b2c10120e23048b16',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8f6fac16a6ffa453784a@restmail.net',
    authPW: 'b9088c2ba4cd4968a76142ef75293eef2edc5930baf0b3e2259f764b7dbc7282',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'e326752616e9437c9bdfdcc521ca9bc1',
    sessionToken: '75fd4b0cb055608765dccd62fbe6f85036023d960b5fd327739cf49bf21500ab',
    authAt: 1705108898,
    keyFetchToken: '37f201d03bfbd114366f13a5c1b180bed847b7f37f41f0d8960622d7a8952c20'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'e326752616e9437c9bdfdcc521ca9bc1',
    code: '678d8c31f68a0aa0be1bbc6d5c5cc3d8',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="47afc97a4ac35daf1b057e496df0da047d11ba7f9c75c15e4bbf289dda78f68d", ts="1705108899", nonce="fpSU7n", hash="UL/Y7quIS/pDyODfnbmX3T5wKG6ySgF4eRKoZNxUfvk=", mac="kLeHR+frA5D/o7GYMmLBMT8BB3g8OKgydS6aG6ndLYk="'
  },
  json: {
    recoveryKeyId: 'a006be6f39730d878111e49b9bf26b1b',
    recoveryData: 'd88b2a57ff7e63a18fa6b1b4718bd9b87b5f6c7e45b60da745eb8f36727ea468',
    enabled: false
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="47afc97a4ac35daf1b057e496df0da047d11ba7f9c75c15e4bbf289dda78f68d", ts="1705108899", nonce="xKWkWY", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="LKY/UkIKqvHThJPmtScUcxjhqBaP99AJwB+pnpNYxaw="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key exist but not enabled (234ms)
      with email
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '58d7740d0280245c2c27@restmail.net',
    authPW: 'ae259e8199c7a1b6a27019cc45fd214169a6f433630d10865b4d5b2c972a8499',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '726e85bc4e674d86b9f59e8ef01d1811',
    sessionToken: '0268cfa061441ae093e6ae718ca296c33323f6c8b3c984fa3b61047026dc4e5a',
    authAt: 1705108899,
    keyFetchToken: 'd7d4546b2e4560a29a515b7383fad511b6ff386b00575a32c2a98bac3d2d0173'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '726e85bc4e674d86b9f59e8ef01d1811',
    code: 'b9f68e730caa22714772aec2837c3693',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="035bb5fa7449a501bf93ae53adc67d3a9b21faef96dcf83d5659d78c6d7496de", ts="1705108899", nonce="kiYW0l", mac="4h07144w4Y/kUnzuKd4k9sT0c2v6oh/neE10Tk3HAGc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '2289284e87cdaa28f47bc672c6e1bae5383550d21426d4d35fa8f105ad8460be26ed3f575b750cb45ce368519493a5c1f47f785c94b5b04188eb4fd653655b81c28ba1ed1104115fd499dbdd3d7597ed390cf2d0ae56c22139663a484b06780d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="81be3dbb14a9dad8fc71cfda88aee42fd97e0badbcb36315abe84d87f5e73b7f", ts="1705108899", nonce="9O4thZ", hash="4Ii0md6S8UGOlk1u8RVNKHS46pIkY/l2kqD3gxJ/1Tc=", mac="UuG79gzbu09laBjuxPzqKEpIalYQIPvd2t1c81c7dT4="'
  },
  json: {
    recoveryKeyId: 'fd44942995be4afeb6ab3e538b125097',
    recoveryData: 'eea384aecc030581e8e127e4d04219bfb4c13c70cc952db502dcab9df0581817',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {},
  json: { email: '58d7740d0280245c2c27@restmail.net' }
}
!!! response success { body: { exists: true } }
        ✔ should return true if account recovery key exists
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '380e389b62cb4f7ff44b@restmail.net',
    authPW: '0b1d4b29f5c27cbea31582e72603993ba0ee38a8a3746c446db569f881347b06',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '6a5f65635a104427909e9c44f20141e8',
    sessionToken: 'e3678fe0bcb0077e8fa662a832d412be965159aa4a89693ccfe684890743ed3d',
    authAt: 1705108899,
    keyFetchToken: 'fabee48c7d3aa3651d07a6edd7af68cca8f39776e47f63e6d457d3d7d215a701'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '6a5f65635a104427909e9c44f20141e8',
    code: '9bd04723cf8179765f2c74fa6447e16b',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="99c5da86e0669da85f2cda83967b45e7702af1dd847f78e1dcd1895cef452523", ts="1705108900", nonce="JfGWu4", mac="54+1o3JkH7G98vj7kjb7Mb1dAa/Rv+nfNXvRMlbxSoQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'f5eb2bf49f473b5a23f1e54a2d6505538d1159ba05fd086904abc02e3124799518cb25e5d48b8517878972a059c86f73660dae37e1d054b157fb677f775a4b86943791423aa0903186563ffa4e588a191250d396b802276e74bca0ca5e1569e5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9858d40927cdfced87982d2ddf3f468526150877adbcb0e85076959472599d05", ts="1705108900", nonce="GwW4AB", hash="J1KLFxvGv/cnWCGn1xDCWjYWnGbR6K+W4rfoXgIf61s=", mac="Xx+bvJ0ky7QhjOjP1U7QqxdG0FHVGh2sKaOWti4IGzk="'
  },
  json: {
    recoveryKeyId: '4ec9b46720e63e7de750e85295c7c3c9',
    recoveryData: '8bbc8ed98a2f16187283d8c470a64316e4cc670afd1c09ed1b55f7e99787a3b2',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '928b0a661c9a129459d0@restmail.net',
    authPW: 'a7af20a69788e5183ffb3f5dbec1f1d51a9ed0585392a714befcda520b7d1b50',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5479be260f1543b98883929e653c1c39',
    sessionToken: 'c75dcfc0c537373dd7c75490bdebbd420fa498e34c36b11d2eaa72ce85a0ecd4',
    authAt: 1705108899,
    keyFetchToken: 'dcedb2b20f6b071fa5b2529b9796994f7644d02ca903471fe38541de27f4fb1a'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5479be260f1543b98883929e653c1c39',
    code: '93ef36cb69dcb78194d5127cea24223d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {},
  json: { email: '928b0a661c9a129459d0@restmail.net' }
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key doesn't exist (225ms)

  #integration - remote recovery keys V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0e33341c395898e9e87c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '0e33341c395898e9e87c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0e33341c395898e9e87c@restmail.net',
    authPW: 'e78e7a141cfa0ecaff5fe09cbb9974ed3461cd6379e3844432003f7caa9f6bdf',
    authPW2: '84efc76dfaa99bd2454573efda92ff3de38e5a68abbad194e01e4ebd2dc14a55',
    wrapKb: '072d9d3b6679072e4438cc846c94ea4c279bec296a769490ada24e6e346d815e',
    wrapKb2: '94a0f3847cdb4a29503b9d5bc9a385f3adf3d12891c705ea4aad0d147692151e',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ef62657dc05c1dfd62c1ea066b2472f193f0e6f614f9d68783a54525816142ff',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '845548a2625b408db3b4957bb4df8769',
    sessionToken: '3aa492605aa49d51ca040fdc22030ea3cb2cc36d580e6c4433e5c2f506dc3aad',
    authAt: 1705108900,
    keyFetchToken: '97528ab2e1e11e7819c084263d8bf5ab478ec9be3616096811aee01cf492512d',
    keyFetchToken2: '73b6912d9e33d575246edb7ffe4169ba7b8d880e60b059655a3ca099de1967a9'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '845548a2625b408db3b4957bb4df8769',
    code: 'a1aec6b758a10aa1a7bbe9bf6f987cfb',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="1dc407e6951c74109ac4857f7a1b3c259a9d41703471496fb7bb153834a65f99", ts="1705108900", nonce="0PW9Q6", mac="+7tyamVsBx231yq9ZTjqwU3y1WnhtlVSUzsusSme0xY="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '585267181c92a978a6965059ec6a33762c63c4517626b0ce333cbd7fb9ab6346c54a50a4e46c92bcac087cfb723a21cbbabcbb4935c49002837403031209f645a87fd3c012ef646c7e756a6694e44912524d8f545630dbf3e0acae7f250b6324'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="75e8c60acaebffb5eecc57a63b246cc6c5762db90dd2ad5b584f0d3536c20fdc", ts="1705108900", nonce="d3rO2g", hash="870gxrEfKWarHkpmO4i1r2vKd6WE0h1N8zHcVKfHEGw=", mac="Qi8TFfejzIjFhlYXTOnLBf+OrPF8VY3FqKnSw0zKEGQ="'
  },
  json: {
    recoveryKeyId: 'ac12add6c4eaccfb5fb864105fc09798',
    recoveryData: '3e9e77c4d0cf4e0e81078b5e3103e2fbc3a1b2d9699087af44dd34ccc59123b4',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0e33341c395898e9e87c@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '8ad3d8446c26db36988216762702b4b7c37c5219239c954e85aad6bf8f226eb3',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fc280483566a727bc1d555d13e4b9ae5fe3f9d293621d87c580d3d468e8df550", ts="1705108901", nonce="-Dn7qn", hash="tr0ohNbLb3a9qMQnBZ/f3A0fW5BWgNGERxPcKj56Erc=", mac="XqWefaw1ogvF83w2a/OfCwJDYzAQfoTGJPVxOytj2uU="'
  },
  json: {
    code: '1f6a616c9c858ef87050269e49feac6d',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '808d3034328d74327e10f4ab97c0f37f68732c8d39e9ceeead062bdbb91bb02d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/ac12add6c4eaccfb5fb864105fc09798',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="23e143adbf507dec2311a90042e9663094b85e722edb457000022a2c561475e5", ts="1705108901", nonce="okixYl", mac="ZjLKH6EYHPP5JPEnfWaX5YU2CFh2I2h2eW1Pb6sbgq4="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: '3e9e77c4d0cf4e0e81078b5e3103e2fbc3a1b2d9699087af44dd34ccc59123b4'
  }
}
    ✔ should get account recovery key (88ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2f0d8bf899ce443f8961@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2f0d8bf899ce443f8961@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2f0d8bf899ce443f8961@restmail.net',
    authPW: '922a76af2a46ed9070d8a8dcf6900c0999bf29173d2aad5c4a19739a599c4fef',
    authPW2: 'bed28a389fbb62cfb5c2c1e9783126cf5dc48f9f21a520a7fdca929e438b0451',
    wrapKb: 'ecc193edc00a5dc6ed7280a0942ad36b627c0b14686dd27d5e825853f05d6ec0',
    wrapKb2: 'ab0238e0d1f254a251e4eca73cb2d85f38b5727bd6a94c48ad20622cc5d94d71',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e9e54db5a6f2c031fb6802d7bb982cd0f8a5473ce0793b7186b802dc9a7cfae4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ca7d5b93c40240b28d6a236b8773fa4b',
    sessionToken: '3254cc0735ae3e8cab675c477513e02577c9914a87d0de187ac699f695b4d159',
    authAt: 1705108901,
    keyFetchToken: '72e957b4b8b09368d1d3ca4eed8a824c2bb3d23b1d4e5a94ad6d486fd056fe8d',
    keyFetchToken2: '98707c1e39ed3bc3132df0a5cee0aa5b0037609fb55bb9ce4a12dd6a300b70be'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ca7d5b93c40240b28d6a236b8773fa4b',
    code: '5576f73bcf6980e77322a879808b2f54',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7677949876a6ef7f93aab333ca9e8dd7912a1642955baeb7cf9050704e0747d0", ts="1705108901", nonce="IcDwzh", mac="pj8P9i1jwf7Clvp5g8qY3kQQ9hRmwBu6w0J2Tzlm2dQ="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '2ecb4f0943452e325656a27fe477f62fa7ee4404a18c8756788a1e021ca985e9d3483c4baca76df4a00d2b98fbc35561714196b2e182072d60768e69cc064a820a5d438f51f42317205a7ed308e86801fbee9d43554ff261b216446d93f4bff4'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c5903a01c8f1d8771e10998c892dfe9af8464dcc81bfecf1179132667a2475bf", ts="1705108901", nonce="Za4_gK", hash="9kPrh80KH4xI/kyRtP9rVXqi+NnX+zFepkYq7KL8pb0=", mac="cHNwZtKoFQVXFeK8uT6SjYuNY1MGU0xTsFMd1gYSXBQ="'
  },
  json: {
    recoveryKeyId: '3d93a6d081217a9b4652cdd26b6c18a5',
    recoveryData: '672e69adedd0021ae0d20b2f2cdcbac90044520a40e413ec3f48dc6725af4dc0',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2f0d8bf899ce443f8961@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '62d125120c793b1f5213916d5fd0aab813efebb0aa7555e32229428723fcaad1',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b993afa0c67a2891093ad0f549daad7f6f13ae321651d83cbf5130fc1c1f5b1c", ts="1705108901", nonce="Mmh3N_", hash="TQ3FicE0DqpAj2LX/y+0x9X1jfnmqVe1BEaFML8N6z8=", mac="nNCDL0wnj4fn/rjS93na6NRJBfKzlJn513TyPzSWA/Q="'
  },
  json: {
    code: '0c9178e2118ffa96618b7b19501e0587',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '2b9302f1c259f18ecdefa9272e5347f70432554a3a9dbccb84992683882d8993'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/abce1234567890',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cf1734a128fab24e72b559416ef70e1a7d3e55800e432726a6a290e95cd22a8a", ts="1705108901", nonce="OT68cc", mac="l5PYV+bLRXCQhoaIHY5mAwxjEkq3afYg2PiSxIJylVE="'
  },
  json: true
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 159,
    error: 'Bad Request',
    message: 'Account recovery key is not valid.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to get unknown account recovery key (69ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '98da0683e4e7a9a5eee5@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '98da0683e4e7a9a5eee5@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '98da0683e4e7a9a5eee5@restmail.net',
    authPW: 'e8ed51360a7ce8d363b577ac1fee4e8d7038c9a2892f19480a53bd812e8a50ad',
    authPW2: 'f82e06c9a99c8bf36b78cc0eeb53e0828fd153f123fe4134b4a5cf2f41a99f06',
    wrapKb: '24dab87e6842acc1db2682724c894f9294b26cb1ac3d218a48a9311f721abdac',
    wrapKb2: '660175f0ee57f6fe4a71539ed04ff5bc18659aa3cb50d7c79c414552378abb47',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f7c5b8b028a2abc1688c8a6191e0bfdf8facbca81741536ffd3b37a2aa6c9cc4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a3f5d8498d58433e9ea9aca7bd6ae339',
    sessionToken: 'c82c4344358d9a9f29f387635096c822cfdac2b55afbbb2dba238d8e79ddb662',
    authAt: 1705108901,
    keyFetchToken: '5a82108a330c4b746c360e86a45c8b076c854ba044226fa8a7a49a763f862925',
    keyFetchToken2: 'd013308e95fd6e9839edcdc52ae40060ad7e29d5d7f8ed886e833aa05b1ce38f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a3f5d8498d58433e9ea9aca7bd6ae339',
    code: 'c3a4dc0594b7d6aac56d9aefc2a4188a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cbb708692777cdd2d7c27a3615ff55675fd9ecbb2bff976acb3f82623de2dfe6", ts="1705108902", nonce="wjhAt1", mac="ZxdmEBV1GtoMk7RBMLhqc+VrcDv/wUo6nYfEM1B9CkY="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '294dfb6c76c7e6bfe9c940c3cc327f41fedfb41a5f7967e36ea01551559108e1583cdfba12f48ce5f810b9aa30cb0019def97edcd36681a59ef69a3fe0671a7a203b2d40f4970ddde583d44eb5dd5b35fd40ff0df133bc0e773ca53dcbdac8ea'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="b2b68efa6ba255d326f87d31c5f61622cd596b90626fb77dd2bd3de4448c1095", ts="1705108902", nonce="dfqKAH", hash="mzrBVk6dAMNKdkZQ05+mRaxwU+8468EbFgYsmaw/Lyk=", mac="JFR8snHAyL5i2GvcxkAz/vPg4DU3/KtS20prMoKBr4E="'
  },
  json: {
    recoveryKeyId: 'd9b5e4a4087deeee11e860a96e7fcd3d',
    recoveryData: 'ba48c3ac523813674ffb27fec91da0abf7d28339103ce2c6b2d0c7d8a6420fcf',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '98da0683e4e7a9a5eee5@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '67aba9416d450ab9068e08a8dda336892e4999ee2d5936ac346814b88eead9d3',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="288f1f14532b41b8de0833de7352d11896038f419561bce9de1238284adc6fd1", ts="1705108902", nonce="p9-Jc_", hash="FxLoiEbqAN6VIs8qDiLr29Fssp/ThndKA99KxS8rIq4=", mac="w8nZ+oM4BhIOC5D9tPyNBksVIdB/nQhJ24ZkRZQODFM="'
  },
  json: {
    code: 'ae4d3f75a289b3943e4544adeb39e1ff',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '48e8b9bd779a7a6b6c47514580c615d47feb91f9cc2a7535e9baeed45986a368'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/d9b5e4a4087deeee11e860a96e7fcd3d',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="8a50382cfb4742d46863d08c78e7b79b63325736f21b8ab909e0cfe0d7fed639", ts="1705108902", nonce="EN3-ST", mac="vII3Hgl0t9aDaB6CxtjO5CHheVOHPQc20bWfEUd+Vuc="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'ba48c3ac523813674ffb27fec91da0abf7d28339103ce2c6b2d0c7d8a6420fcf'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8a50382cfb4742d46863d08c78e7b79b63325736f21b8ab909e0cfe0d7fed639", ts="1705108902", nonce="ozmUBL", hash="70JpO/bYF37yQTkEtEqHAsI5FSBBtml/VbxMdzKbPxc=", mac="0j/oot0hpMJZWDQLP/UOUyzDD8PsVs84BaU7kHfYJjY="'
  },
  json: {
    authPW: 'e8ed51360a7ce8d363b577ac1fee4e8d7038c9a2892f19480a53bd812e8a50ad',
    authPW2: 'f82e06c9a99c8bf36b78cc0eeb53e0828fd153f123fe4134b4a5cf2f41a99f06',
    wrapKb: undefined,
    wrapKb2: '660175f0ee57f6fe4a71539ed04ff5bc18659aa3cb50d7c79c414552378abb47',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f7c5b8b028a2abc1688c8a6191e0bfdf8facbca81741536ffd3b37a2aa6c9cc4',
    sessionToken: true,
    recoveryKeyId: 'd9b5e4a4087deeee11e860a96e7fcd3d'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ should fail if wrapKb is missing and authPW2 is provided (66ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b6c3a3a9551726efeb69@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'b6c3a3a9551726efeb69@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b6c3a3a9551726efeb69@restmail.net',
    authPW: 'd24f08c9edcccd4aef6535ed1839baf6f013b68cdac72f956459f1474225d1f1',
    authPW2: 'cb81c1065a4405c5428bb5f5bd51ab2dac74e318afb732457a50f124ca4b5d7c',
    wrapKb: '0f175126c39bbf0b10bcf7986ef0d00f2bf9016c9989ca1b23a872831b823c9c',
    wrapKb2: '3e47218e5dff65307806b4bcca2987cebc202d4aff67191356dca8a817e7d46f',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32a7a4212f6ae0a151371d756dc9214ebf7f6fcf24dc3f863562077fc7dc5939',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '529bb6d957c6442b8b8145a5530f4a6c',
    sessionToken: 'fa0d0d527c5b8b1a45113099cba251ff69d6a0df8f72a4193a1e8eb8e98d9f03',
    authAt: 1705108902,
    keyFetchToken: '8bbf02d4813473d49c252d11b99c94c011fb383980d432608bb3aac586f88e96',
    keyFetchToken2: '3d7a4cebb6825ccf954e7c841874d3ab623e28576724caa8287b1043d799ec27'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '529bb6d957c6442b8b8145a5530f4a6c',
    code: '47d8d9d1af74dfa937ff20ad332d4d76',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f9ecd13dbc18bb0e9dd7b85d2c4baccbde0ba91474eb4c19a4bdf01758d46a67", ts="1705108902", nonce="Mxm_Jh", mac="19yNHQqrniUfxhxzwQPlcASw09vPol7ijNRCB+4vzck="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '396c2581b0e1df23cba25c5330402d46ffa890f56bdd6a6745c59c7b9922dcedac91a17e603ee4be7ffe627271248834863456330dc485a9f79f09bd0945d9d7fcf8f4971160cc144bdbb12dc35ed2859ad14be939954a29c28bde13ade9e627'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="c8768c11dfa06bc99d6b532628b86ab5b629df86f677d9a151dc389b9e3c2df5", ts="1705108902", nonce="F3cZ8W", hash="CbvAtGLTN32ZPfk3BtxxBEiWUWYGCm1Jn/1Q4z7ncpg=", mac="1S9cRtvaQsgRu/IGws62ey8HeBtJauv/jyEhNprjbnA="'
  },
  json: {
    recoveryKeyId: '3b94a19d834d9da47ea1462f4dbdc6a4',
    recoveryData: 'bb054457051e8094e051a4b077fdc52c6310ef77183474e23efba7c59afc89e0',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'b6c3a3a9551726efeb69@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'da0422e338c2908906ad27c1418871fa559075ae859abc1faca7a59d4e647993',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="402539339876919eec04cd101428e9510bb0a5e4e8eecd9157d377c8d680a94e", ts="1705108903", nonce="RSUCNx", hash="DcDCMMhHKMWQiE2BZ6Vpg2HiZaiLLsezhjyhcNsN67c=", mac="skL/0UhR6IfjNwWNV8Qx1splUXpJyqw8Vb16GIsDT9A="'
  },
  json: {
    code: '86b2f7a02c937cd9f157616a69f39b80',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '1d0693290f020b29f157181c65aecb6906b8f8088224e8abce391896770c4f96'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/3b94a19d834d9da47ea1462f4dbdc6a4',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="f573a0171fd7cab036e99a16f11b73f604d49f1754da1d1a15b641c789f932d1", ts="1705108903", nonce="fbbXcG", mac="xyjS4Mig4FdDc18+sSCCpVKdgsD0ADqyXfASsCOpyQM="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'bb054457051e8094e051a4b077fdc52c6310ef77183474e23efba7c59afc89e0'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="f573a0171fd7cab036e99a16f11b73f604d49f1754da1d1a15b641c789f932d1", ts="1705108903", nonce="gifbOm", hash="1J+z3o8qeTj308T0Ty6pqWuY+jaki2QP23QtZxr92Y0=", mac="SNvw4QqCKzdfqyELkShOSn/0lGy2W8A5DSazKSpHURc="'
  },
  json: {
    authPW: 'd24f08c9edcccd4aef6535ed1839baf6f013b68cdac72f956459f1474225d1f1',
    authPW2: 'cb81c1065a4405c5428bb5f5bd51ab2dac74e318afb732457a50f124ca4b5d7c',
    wrapKb: '0f175126c39bbf0b10bcf7986ef0d00f2bf9016c9989ca1b23a872831b823c9c',
    wrapKb2: undefined,
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:32a7a4212f6ae0a151371d756dc9214ebf7f6fcf24dc3f863562077fc7dc5939',
    sessionToken: true,
    recoveryKeyId: '3b94a19d834d9da47ea1462f4dbdc6a4'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ should fail if wrapKb2 is missing and authPW2 is provided (70ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '3970aba288c6d58c8e02@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '3970aba288c6d58c8e02@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3970aba288c6d58c8e02@restmail.net',
    authPW: '30da65782f6a483c76dc08e1ae32e173075ab0bddb5fc364a0b25e460f9dfd18',
    authPW2: '71c232fb6d949bf35ae832c8b5872b22cc19ba78301702999144b66035a50ff2',
    wrapKb: '6eb5afee9282de5c54a9b0f70dce6466ce3d87be9a825db152bc8dd3221bc9bb',
    wrapKb2: 'fc766cf85e07f4ca8fe4ff8db08c1b20abceb3290baa8e4393e35f2c16cdad1f',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:93e5efc3a70db5faad88947bf0320a65dfb0fedc547d77fcf3cdd1cb9225cda6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'fc5c557bb62346289150d7cd683ff62e',
    sessionToken: '31745ebdd23a8cf638711f6eae4c658a1c1709cb09904a8a28d21500a28ec321',
    authAt: 1705108902,
    keyFetchToken: '0350df235a60243ac4eba64fda4687ed29d886e9e1fe0a462b07cfc2504c26bf',
    keyFetchToken2: '9a7c782561f7472282879b6aa86f193e89263a97fd0bb32ac13b354270bfbf56'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'fc5c557bb62346289150d7cd683ff62e',
    code: 'aeabcabf4947b067387bfbf875ddfc4c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a2cfddef0f3e54cc0d3ddf97219387f762148d6ab5c9017b324b1c435de72959", ts="1705108903", nonce="CjkRMz", mac="PvcfuRnOVtDzarqVB6w7x35toCD3dCzqXkC0dFii394="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'ba513bf25a14e891306e03540bf90a3b9e064c7ffffe9354a51a50eaf919cccddb2bcae6c929e0dfdef3bb4ff30e207c19e78400992dbbb0d284daffd74a44ed9f9f97af8e280a91eec0ff303421fc65d97f0201a8272c6b7de9e99c85952757'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="4e6eccd8c582ad9feb4b0cc5766cd1d533eb43eb75f0c7d6252ef92e52e53915", ts="1705108903", nonce="OLOcWq", hash="g7iHUCBi2IK3Hfw7gIMGj6MUWny6JgiE3znldQQeyZM=", mac="a1hoO7rX5u+QDNi0VY0aEDjlqM00TuHNJG+RgHPrgBk="'
  },
  json: {
    recoveryKeyId: '95bda8875f515a3cea7230415e100398',
    recoveryData: 'a80a646a9a89a0dfb367c7d1fdc82b7340189a7827de331211b7336082a74d8e',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '3970aba288c6d58c8e02@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: 'b004bcde18e4b693f409133cc187b34899a36857b320c67b202d35b40a335b55',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d7b7fdc93e41dae2a78fe2470bb8a392b2744a58f121c940d807309178f5aaa2", ts="1705108903", nonce="hqPjO0", hash="9TmwTGFCF94xVhr2AMvdaDl+NDguhQ9vjs1sEkTdkRw=", mac="W5pHMG/CBhkfzvQRQLxkWuagraVMMjBrAIaLJGEjaps="'
  },
  json: {
    code: '1159a415473067f1ecfa80cec76f7267',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '183bacb5f5221f6730c651e0e609590895e6c41bf86242806a36a05b087133b1'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/95bda8875f515a3cea7230415e100398',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ac43e59b1818110ff4a8ad15799459272f474e9710dc31760cf168635b177d42", ts="1705108903", nonce="upfKbj", mac="1ilTX0CdSd2SwhfOgrK+R9UWp4apHKjetvqnq2YvQKM="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'a80a646a9a89a0dfb367c7d1fdc82b7340189a7827de331211b7336082a74d8e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ac43e59b1818110ff4a8ad15799459272f474e9710dc31760cf168635b177d42", ts="1705108903", nonce="KC4YKf", hash="Wz6/NFmOShG3tDHxfeHQlHun+YFty8qoYkJqtAC4XTA=", mac="DsUd/7sjh72YzuNpwvbgUSKWA9Gq/lnftvnecrBXxmY="'
  },
  json: {
    authPW: '30da65782f6a483c76dc08e1ae32e173075ab0bddb5fc364a0b25e460f9dfd18',
    authPW2: '71c232fb6d949bf35ae832c8b5872b22cc19ba78301702999144b66035a50ff2',
    wrapKb: '6eb5afee9282de5c54a9b0f70dce6466ce3d87be9a825db152bc8dd3221bc9bb',
    wrapKb2: 'fc766cf85e07f4ca8fe4ff8db08c1b20abceb3290baa8e4393e35f2c16cdad1f',
    clientSalt: undefined,
    sessionToken: true,
    recoveryKeyId: '95bda8875f515a3cea7230415e100398'
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 107,
    error: 'Bad Request',
    message: 'Invalid parameter in request body',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    validation: { source: 'payload', keys: [Array] }
  }
}
    ✔ should fail if clientSalt is missing and authPW2 is provided (67ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f3bb811eece27ffa3d2c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'f3bb811eece27ffa3d2c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'f3bb811eece27ffa3d2c@restmail.net',
    authPW: 'd3fb2ae0bda74cc5ec6cff1dfe800b39b0095900da0111b7c44bb8f30a82bbf0',
    authPW2: '937826227904d00a2348ca765ce1e45e65f6999bf9a67c1dc4e4f420bed48dc2',
    wrapKb: '70a29ef6c9fe676e6f060f5441f5f7874337e5b2ca63cead6deb17cdf4d3f029',
    wrapKb2: '9414494612eb60d58f2d83558622f98073efcdca890cfd5d3729417a628cbf61',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:ffc99119d27efc38178417bd8d81e0599b10ce49eb2659cd01c67b5a60a82e0a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '9e54ccb72318464ca6756011e0f639cb',
    sessionToken: 'f38246cb3e1f9305f94056d5171fe5cf14d347d67d4ce5d6aa81b80b6c73d778',
    authAt: 1705108903,
    keyFetchToken: '4abc3bdfed2dddd8f961974344054d2d04ea2737ab2c8026b317af617cee1c86',
    keyFetchToken2: 'f43e3e3d14a8b7824bedff1094dae7afceb5de9ced3916277d69cf543e9ba787'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '9e54ccb72318464ca6756011e0f639cb',
    code: 'a8aac4f6fe40a32b45facec85a2743b3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a44cfa89fd024bea48c40649b242e9a0122ed2fc20c7f45dbd95d6dce62a0458", ts="1705108904", nonce="gQJzDK", mac="CnHBBUFJTeT8oQ1J4cUe2QLzEDBjVoPqPNC9V/9mHCo="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '441d1594142aa6d25601462abd902e52606cdff5fa5a90d324ba7bded0c157af73734dfc2af91e27fffea6c6d9e2cd148ae039128bb897b1116eb44832f0cb9ea2b95b03de56960e00e467ef9c6686e8519f36ba2e38ab1206220a5c1c7ae541'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1abfcdb4d7d2f3efdb3eaef295dc615e01074109a26fe5fe21e71bd2ed6ff3b", ts="1705108904", nonce="-KOdR1", hash="meU1poCICunJI2W0pajo0H99hbn2nn9Cj8lDAgeJHvE=", mac="rwyMRLusqYx2hkM0Pq+LlJ+VTpCNFThZaqDnJ1kKCME="'
  },
  json: {
    recoveryKeyId: '5d2e1a3e59ffd4badd8ec79065760515',
    recoveryData: 'c7528fd8f9a417f40e1ea530e715969871047d2daf3761222fe516d025dbb5c2',
    enabled: true
  }
}
!!! response success { body: {} }
    ✔ should fail if recoveryKeyId is missing
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'efca58d5c552fd82c35e@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'efca58d5c552fd82c35e@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'efca58d5c552fd82c35e@restmail.net',
    authPW: '57b5b866ef60c74ca934c2ef23735800d443048fe1b6843971765f2ed3863ced',
    authPW2: 'db91737b80ad59c85829852439795d39508633615cd5767351abbd6a646057e4',
    wrapKb: 'd2cf1c8b9b411cb6dc2c661f0e8b438ef32b8ac28d412a07e2e1eaa45b7b5557',
    wrapKb2: '089881e07cbb6fab3cd79b6fedf995559c2cb7c908d41c4e8adb1b9ca5f31fda',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:8c55860912384a6dd76474f6f8c68ca667cf72b085979096f776a5d2562ac90c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'a61809af59254ab5affe8ceddc49c64c',
    sessionToken: '3b3209854de4b8590beae53841bdd06d3319d533d8b22ff59f367963bf67fbaf',
    authAt: 1705108904,
    keyFetchToken: '4d13b7713f6a0dc32713c559ba5e6e3cc59b45db72dfb9a79b2469bf071cf352',
    keyFetchToken2: '1c5bd4e9f5d50ea197d3d9ceda28529356d1a6d537e4409108f9ff6dbf5934d7'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'a61809af59254ab5affe8ceddc49c64c',
    code: 'b37c6489542d2bc3349178af9a8c4ea2',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="50caee27f6a8adc9e2eff3e335e542901c8c5c7cde62079d2856cd37b87fa262", ts="1705108904", nonce="H4Ebcr", mac="FS3hVxqVPcEs+87IQqBo54uapK63gb1FtxxzeNY3jo4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'bf81edc6981fa83cb65f5cf5bb237e980b854431c5a2a66975f562920fc3f3016ba3d50430985e2b9f4070ef67b141d7e752163fd580629e53cb7b6d8aa499d1176c77b22b433ca961c4a050935190d9618932af7f988b032d90ba53cd16c68e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="691c46627a7d271a6132d1ea8a1e336fdaaaba77b259032b005e586a07352254", ts="1705108904", nonce="tC1GQw", hash="GYzHhuAUWRb0TblL6GTvXlgxrPFS25go1IvPLGicDmQ=", mac="u8J1ZfBHgmJU41AK0nUb/wK2ja52WFpdrWZA3KpiYbk="'
  },
  json: {
    recoveryKeyId: '22b11ff1a36923ddc2903de5efe7c01c',
    recoveryData: 'dcbf712d8e20723194fb52e2dbc4c0af029b45f8f3fa8efb93cf23b349ccd4c8',
    enabled: true
  }
}
!!! response success { body: {} }
    ✔ should fail if wrapKb is missing
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1472efa6db02ab44acc2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '1472efa6db02ab44acc2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1472efa6db02ab44acc2@restmail.net',
    authPW: 'c4e774c8d2b62513a710509ae3461b02a1d5677e2224170bee19398c22dc100c',
    authPW2: '08e7379dc61ddd44b1027eec6391c94356bc1e67195f369f33e1fada4ad45638',
    wrapKb: '0e4bd4abba9481cf8749d36dac1a9109cd1ba570a536f62dda350a630d0304f1',
    wrapKb2: 'c94713d8882cbf1925661d1eca86018c559e0b3d84c19f74aab0ab8d824b5461',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5f11a0789ae04e8cb0ca06aec1ed9faf',
    sessionToken: '412dd7dba28f8cbceb22ba1f31692155b50b2dd1d3e1ef7d936eb472ba6e2409',
    authAt: 1705108904,
    keyFetchToken: '94619d5aa9a40906dbd44b7cac578f37a644ecd4a4b930949494422bb596317d',
    keyFetchToken2: '6b1349707af34d746d944f8cb9ebddae9ba0a1ad0f934df092296f6c2900959b'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '5f11a0789ae04e8cb0ca06aec1ed9faf',
    code: '4bf772d712635dab7f6c7ff87020076a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="7bde676dadd88e301f8b016322654259d2a42dd8e1115491f5eb425a07c4eada", ts="1705108905", nonce="3AtmZm", mac="gWuUrXLfXzSTL7KOZLjSZZwH7g8leQc+cBGTOxeod/A="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '0b6d14517a1bff3b6fc650acc779c9e85a2a6dd795c54157abdcca90b8b9e032c8077a73ff7aa01a44a0ff1ccd699d15e4fcf581fc476db4b30a001cc17f9a8281de47f7342aefedbb2ad1c3b97c95bb55242469de80efcbea6082971fde3e34'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="824771a1e02fceb879ea9b6e028ce0bb3443033191c09d74073f03374639362e", ts="1705108905", nonce="B79tn4", hash="POR7ocNuc+haGWbu82u3zYNrUv3l12RnIbA54TMcZG0=", mac="XJdvUmkrpitM3gu6ehOgsATXPCqjPoJ0hXeyuoSvbfM="'
  },
  json: {
    recoveryKeyId: '00c3a46257fb57f24b4ccf21da76f987',
    recoveryData: 'b5d3a569a2d463fc81475fae7e83447402995bb14309099ffb45f58e92a6a2d8',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1472efa6db02ab44acc2@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '4908950245e5c6e6855396ff964aafc07bda93ee868291e3801a88620e191db8',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="73dffcd957d643bf2819c3c7b86876c767dc0fd24bcfdd489b272f8a72bfa9a6", ts="1705108905", nonce="IWwFEG", hash="sGrAXvzCE3kQnJ+x63zXgSGWmTe8JBPpvBkqViVdFjk=", mac="VoTDGhkBmXNNFYf4yPIh93MjCA3Fj2xnSGiYnrPTZHU="'
  },
  json: {
    code: 'f29e7465b2f2207d8e6b810984507942',
    accountResetWithRecoveryKey: true
  }
}
!!! response success {
  body: {
    accountResetToken: '40d7e02109e0c1752b515cd067827ec80a6fc45a3eed742e0f6b486efd6c71e3'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/00c3a46257fb57f24b4ccf21da76f987',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="ebdc7aee692679b4fc11cd449129ea24fd453de6b5e7d1a6b830efe46f84e461", ts="1705108905", nonce="-qU1TS", mac="rCxsc1D9cLMFJAyaP5RvGtdUnlf+iqPcwIP71NxaZOw="'
  },
  json: true
}
!!! response success {
  body: {
    recoveryData: 'b5d3a569a2d463fc81475fae7e83447402995bb14309099ffb45f58e92a6a2d8'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="824771a1e02fceb879ea9b6e028ce0bb3443033191c09d74073f03374639362e", ts="1705108905", nonce="3etujY", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="YL7UoHPndU/h9Ltk9bDih81r5wa4aW3LV9cFcvY6QpI="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNWYxMWEwNzg5YWUwNGU4Y2IwY2EwNmFlYzFlZDlmYWZAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4ODk1MDUwLCJleHAiOjE3MDUxOTUzMDUwNTAsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4OTA0ODE4LCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODkwNCwiZnhhLXZlcmlmaWVkRW1haWwiOiIxNDcyZWZhNmRiMDJhYjQ0YWNjMkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJiNjU1YTBiMzVkNmUzMmEwN2YzYzZlYmU0NDg4NTRlNyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4OTA0OTE3LCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODkwNDgxOCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.oeQ0_81AwpP9j_2PYJGiGmeQPDVXvZbjNl0rjuVSlNSUVneFdRJKC51axR6ZTdLuysTtAv9GePR69DrEt_KaT9iYu4lCZlJ-lZNlHSTKWSeVvmMhlgyPpZKV3UgP-uX4so6VtRKYYVDIvLegG-scU6PbINg-dk6sg0yoQ06hqX9NnQRQk1YaFFGr-kKRp-wb7bnKqs7TaJd0yt3qBwrbu7xXHt25GOUMWuuL1Ske92TXDjBNKdr7kDKvY-kfqTAivj2Yh0_fP8cG85Q-ZdyzAimjrtIOtacU8gjl7mqo08hAPrijYB0J7dxwuip94fliG2Rn6fjOaulbdU-2vwwIFQ'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1472efa6db02ab44acc2@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?keys=true',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ebdc7aee692679b4fc11cd449129ea24fd453de6b5e7d1a6b830efe46f84e461", ts="1705108905", nonce="N5RBs0", hash="dSNWzalVq4GXZKLK5zutTOtyJNbr0lf6suZiAwMVR3Q=", mac="hrn4Tva4Lg3mord3Ah+7hRr90wuRaWQyQDzCz6tFE9o="'
  },
  json: {
    authPW: 'b24a03d2b2c08637edf9c03b86ef739ac82038847cbde4c1142191fda014c69f',
    authPW2: 'ab7f19ffeb86048cfadff7eace958976fb93f92c95e1980ec236d3977cc6fa65',
    wrapKb: '6c65295dc9d5affad59515e4424f1f3a083333fab82a3846521a742c870dc9c1',
    wrapKb2: '664b517c7526580840cc682ea142e331ceafd4634026b3a832c552058a8d3dd8',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    sessionToken: true,
    recoveryKeyId: '00c3a46257fb57f24b4ccf21da76f987'
  }
}
!!! response success {
  body: {
    uid: '5f11a0789ae04e8cb0ca06aec1ed9faf',
    sessionToken: 'b8b85d8610a9e6278eae43b7ff57ae721bae36cc3553294ba34443145a74ff46',
    verified: true,
    authAt: 1705108905,
    keyFetchToken: '257f9de8e6955fcc20c80b5938ec4a3924fc2f47d35556d1420be1aec49e8759'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1472efa6db02ab44acc2@restmail.net',
    authPW: 'ab7f19ffeb86048cfadff7eace958976fb93f92c95e1980ec236d3977cc6fa65',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5f11a0789ae04e8cb0ca06aec1ed9faf',
    sessionToken: 'e217ed116514952a83f30fff5378b0d182728ac47d9bf2ad83566e2179790996',
    authAt: 1705108905,
    metricsEnabled: true,
    keyFetchToken2: 'fcd3e22ae46998b14a39b5030fc1a05ca1de2cf9e439d38fbe8961864501f2b0',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="4a2474c1379214ab43607c94a64dd102c12d95be9c640e276546e3224b4c2ece", ts="1705108906", nonce="f1mMxe", mac="ERWF12/XL9PKMjkzX2WSpx8TvVJt3Rltsua8xW19oyA="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'b06636c34853598f84f3abc3eb79a98ec8284febc3d0a68a5ae59a75efdaaec4037d605b05e85e38d2cbb08629496966a70b60c70a636181377fed803cf92c24e55f730468e17fe4d42f16a43e3d477d2e1f2c392177bdee4158d3448d8881c8'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '1472efa6db02ab44acc2@restmail.net' }
}
!!! status2 {
  response: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    upgradeNeeded: true
  }
}
!!! response success {
  body: {
    currentVersion: 'v2',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
    upgradeNeeded: true
  }
}
!!! response {
  currentVersion: 'v2',
  clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:dd65fb3371ab5bf3ffa35453a05b4694f00b335b5c00a6e45baae5e70f33093a',
  upgradeNeeded: true
}
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '1472efa6db02ab44acc2@restmail.net',
    authPW: 'ab7f19ffeb86048cfadff7eace958976fb93f92c95e1980ec236d3977cc6fa65',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '5f11a0789ae04e8cb0ca06aec1ed9faf',
    sessionToken: '097e5bd27ac3f264236ce7a51d96faf461c5e24adc1dc4fef80919bcd89ecba8',
    authAt: 1705108906,
    metricsEnabled: true,
    keyFetchToken2: 'd92e0ecdfcdd75611de7c05a8fa8db95374fae5bbc89058cc7c560510067a6b5',
    verified: true
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="000abedca7c0e8b4021fb17a12d0834e2e7dc73032662640cf5dfa27cebd7420", ts="1705108906", nonce="GDAV18", mac="2Te6OQ9SvFEt2a2Cfm6SM1SzpxMKs4MrzoGQ7Ymttr0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '2f4657b2b8a2e1965c697c5aa65325fb249f16f23e3563b084c6cbbe49a19dd5f9c276fc05103bc0b9c76db85453945c485b1e565d40f713461bc0d897f2c9cac854eb794c06705baca3ca8271f2579dd759207f4f0198599e38c50c21e50cc5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/certificate/sign',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="ec0b5229b2040c273c5588692179dfaa7c2dea675a064bafb41954cb9b6a3ed6", ts="1705108906", nonce="zljHV8", hash="hrQdqQETZEw2FS3Fw9RyCgJIhXaDCvd3cN6rcUW2z0c=", mac="v72arD8vMZKQnu6rxiXak8MuiAfV33nEidgKw9lQGIE="'
  },
  json: {
    publicKey: {
      algorithm: 'RS',
      n: '4759385967235610503571494339196749614544606692567785790953934768202714280652973091341316862993582789079872007974809511698859885077002492642203267408776123',
      e: '65537'
    },
    duration: 86400000
  }
}
!!! response success {
  body: {
    cert: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjIwMjMtMDgtMTctY2RjZGE5M2JhNzAzZmExZWIyNjhkNTlmY2E3NTc1OTEifQ.eyJwdWJsaWMta2V5Ijp7ImFsZ29yaXRobSI6IlJTIiwibiI6IjQ3NTkzODU5NjcyMzU2MTA1MDM1NzE0OTQzMzkxOTY3NDk2MTQ1NDQ2MDY2OTI1Njc3ODU3OTA5NTM5MzQ3NjgyMDI3MTQyODA2NTI5NzMwOTEzNDEzMTY4NjI5OTM1ODI3ODkwNzk4NzIwMDc5NzQ4MDk1MTE2OTg4NTk4ODUwNzcwMDI0OTI2NDIyMDMyNjc0MDg3NzYxMjMiLCJlIjoiNjU1MzcifSwicHJpbmNpcGFsIjp7ImVtYWlsIjoiNWYxMWEwNzg5YWUwNGU4Y2IwY2EwNmFlYzFlZDlmYWZAbG9jYWxob3N0OjkwMDAifSwiaWF0IjoxNzA1MTA4ODk2MDk1LCJleHAiOjE3MDUxOTUzMDYwOTUsImZ4YS1nZW5lcmF0aW9uIjoxNzA1MTA4OTA1NDgxLCJmeGEtbGFzdEF1dGhBdCI6MTcwNTEwODkwNiwiZnhhLXZlcmlmaWVkRW1haWwiOiIxNDcyZWZhNmRiMDJhYjQ0YWNjMkByZXN0bWFpbC5uZXQiLCJmeGEtZGV2aWNlSWQiOiJkN2FmNGIyYzAxNjU1YWE4YjBlNDE3ZWVlNjhmODYxYyIsImZ4YS10b2tlblZlcmlmaWVkIjp0cnVlLCJmeGEtYW1yIjpbInB3ZCIsImVtYWlsIl0sImZ4YS1hYWwiOjEsImZ4YS1wcm9maWxlQ2hhbmdlZEF0IjoxNzA1MTA4OTA1NDgxLCJmeGEta2V5c0NoYW5nZWRBdCI6MTcwNTEwODkwNDgxOCwiaXNzIjoibG9jYWxob3N0OjkwMDAifQ.eFy7sHwuA4fuGz_as6jSbCW-vLYQvQfKgFcyL1wSsLLAmihagWCNABn4C9MLop9TDWgirZ-gUOVmufPHBX43wUEU9Xgo2yDQUwkJi1SOZ4p5j6d75uSfIYOI1tIYTzjBwJ4vZm4Jsq5DMDXPPgPAiI-kdrusJY-vWNmUtbT33STf58cr6c2hWkZzzYajwoe6DSDb2cZYprOlAkXP6nArqLmMZcQqQuCYoNT-hF3gyDA8cuz5dwIpd5uZrZDs6F57MuZ__xP0Ngo81b3hLPIoOwQbOPbPEYbd-m3jbtAW-7Wl-mb4y0paLsLR-2pU0SfoYj10s858BtsmmOSMR-Ij6g'
  }
}
    ✔ should reset password while keeping kB (1122ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'cf2a9727d80bbc713791@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'cf2a9727d80bbc713791@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf2a9727d80bbc713791@restmail.net',
    authPW: '65395711d8853c429349ad85ed57a37428f1bc93e1b18cefd99a3ce02c1ebce4',
    authPW2: '94a081d07526307b3208dd6cb321c2b4cdd3d9700ec6fb9c7a5aff69d89c3842',
    wrapKb: '016c454da01065796b9005149bd17238efb06c75474b2de960d60bb28e03dbbc',
    wrapKb2: '906f6dfbc3669b758fabbcdc497816abaf681f519dd8f2a2b6c142a2a8a2c5ea',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:67260e20aa35a1b41024031febbb6de641783f436c76839ab0ac300457029fd2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8884d7ba422d441dba4554048ff47b02',
    sessionToken: '84a9d510450cb75a8e26b6a5c3beb0755b73d3a65a952bb62ca5d792ff7e3a68',
    authAt: 1705108906,
    keyFetchToken: '60da3a277acb6c6beb30cb4adf6e575f1157e27e4a16bc78ed62c3d80943c1f1',
    keyFetchToken2: 'c4eb5da84e916a23182e20601c87118ed3eb1a54093893f04d7e3213c7c35d82'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8884d7ba422d441dba4554048ff47b02',
    code: '447c64f26c25c38b789a9edf0cc5572a',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a7bafab00bfd55748a73021b41678450b2eb05eae91a956d9f330abfd262dfb5", ts="1705108907", nonce="iKGtvO", mac="7NMt0e/yaMYBEXwA0fHkJJogFYnvC4APHxjqy2m66vc="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '86e0c93f2bebdbe04dcd798c921cc160bf7d73259bbc3e241d0dc6b7e411127cde39368d774d375568317fe28bce9255fe6d11d8851cad95ee0557af0fbe653558f2238ba1de0b09b50ad1aa989c1894e7edf1333da829e657c64eeeec6a5ced'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1380cc0dc8f3472838d122833a5214521fa07b7e18af34c915cdb24aa548513", ts="1705108907", nonce="dUR24w", hash="bjnM6dalQllb1ODmFmQT6NNPmSk5dLt2uQ+gKdbKtuU=", mac="F5dMNY3wlgHytEyAij26ZD9eruFpl5qUcLFwuE00+04="'
  },
  json: {
    recoveryKeyId: 'c5305bd89c973c9bce4bcc2bb0fcf3a0',
    recoveryData: '6a0c70f0703f46b4d4b0be8f93112561a371eefe33db5b5ae753d87e5db26731',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'DELETE',
  headers: {
    Authorization: 'Hawk id="d1380cc0dc8f3472838d122833a5214521fa07b7e18af34c915cdb24aa548513", ts="1705108907", nonce="lp74By", mac="N2kLRLE3BBRdurwbmbbbfUivVuJoZ5kkY4lXKWXCN/8="'
  },
  json: true
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="d1380cc0dc8f3472838d122833a5214521fa07b7e18af34c915cdb24aa548513", ts="1705108907", nonce="Rwj1_e", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="GzWf9kiavl6dHRS0N2LiYXSO627hQZgxBfs9QNKVNis="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
    ✔ should delete account recovery key (46ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '57006f780e12c2b79623@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '57006f780e12c2b79623@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '57006f780e12c2b79623@restmail.net',
    authPW: '80ca329409a154a125400d003b32e53cc90131f24b3e9d06c56cdb8d8e8ad82d',
    authPW2: 'a9527602ebf87d09e947a40dd572a590f2db1301abb09d53f7e2903d8e895fa9',
    wrapKb: '1ebfe2552f59b763302a8907c859c17edb813db4877f363143caf60480c71b1b',
    wrapKb2: '2c31faf5837320be9d2858f9ca2ce307eef80c6f6dd2846ef9ad2eee5288567d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:423a6048d27ed4267b07d2bdd18a2383417dfa5da1421136b9276d67a27e1c6a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '8e473273ec1a41eabde394f8d3df8e50',
    sessionToken: '089da2988b2185946b8af0aed0281b0f7aef517be541f262c9e49e614c4688ab',
    authAt: 1705108907,
    keyFetchToken: '12d3f2f3a5d969f973336f5f525fcc91a50435b493d04151bca3c1915e606f92',
    keyFetchToken2: 'f0bdbd5c366d96aaeabdd7b94f844371cb1bfb646e99834d35b2a2b924671141'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '8e473273ec1a41eabde394f8d3df8e50',
    code: '934d539d8f3be62329f68df8e18f75c2',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="166ccd765b8942416c1b0277098890702eaf5f67fba328a459668c802d2ae2e7", ts="1705108907", nonce="klvegT", mac="IdMIyN2P0Bh9kuHzCbHzcqdbnM0ftdXqX2VlxjYUCh4="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '9eed259fd4303a2ab83be0ebcd7934bad712b81511db9e18a45f0edb6fe372ad1000a065eb11bc757aa02e1459c2c2e69f419002b69edf37ec1b515da42017b882da0358a42ecadf734be3390c3b7c56fa5e69c585803bf1bf296dfdc5a8b7b5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="be098ade43ff5c73f0cbff4830236eebf015d59c8a943be94e8175b1717139ca", ts="1705108907", nonce="rcJwpP", hash="6Po2vbks2Uy5ZEa/buWGsSnKQj7pzS+tgoQPefGPebA=", mac="VfqwirZGBz4GLr53lUgZPGqT8qxPP7Gwh7VAgKnPeT4="'
  },
  json: {
    recoveryKeyId: '793ade5685b7b979ce29ed6621052a90',
    recoveryData: '28bd29ea61f7b123ad12285e7ba8a06491b63698cdf07accba7cd03511f3b3ca',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="be098ade43ff5c73f0cbff4830236eebf015d59c8a943be94e8175b1717139ca", ts="1705108907", nonce="FlA-Fe", hash="LRzHRCE0oToxNNR+YeQY5JBOJFxgnAvX56hyDUbMORE=", mac="gWGDUuQ5JzWLAjMZC1V1WPoH+TGTlClOaDZqAIsvov4="'
  },
  json: {
    recoveryKeyId: '0ad9737f2f788d8a05cbee65dbaed027',
    recoveryData: 'adca486c0143fdc4a450d6bf7b059c5220edc239ef93dd048c8be93359b01eb0',
    enabled: true
  }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 161,
    error: 'Bad Request',
    message: 'Account recovery key already exists.',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format'
  }
}
    ✔ should fail to create account recovery key when one already exists
    check account recovery key status
      with sessionToken
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '632f5610a937806ca78c@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '632f5610a937806ca78c@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '632f5610a937806ca78c@restmail.net',
    authPW: '6af54304cfbf7156b07b0808a4bfb91e13b8f29d6d041522b2215550e3c722bf',
    authPW2: '5927ff43dd490fd1ddbbaa4e5de6194ebc0f6dee49400f4fb947507bf0a433fb',
    wrapKb: '92575bdc22317ec4c37e75ae557311801aaed9bdea44fe6d5fdc7e7cd176ac56',
    wrapKb2: '0bffd95e22077d024e731d84fa54b0eba2764fa4f9a9603f2b0742df573c2bb3',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:99da1c79917fe3ebc89ca26c6a9e389dafb75b33dbb08836bf4388fb8d891cf4',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '77ef867080f849fe8e9d728f3b16a00c',
    sessionToken: 'dcc93113d6edf48d32262848a6bf889fdf51fcc1972ff2421a1eec6c9ffa5aea',
    authAt: 1705108907,
    keyFetchToken: '492971058f1db27a0128c68da3c2f0e38d5f3aeb583c992a5e41187406d895ad',
    keyFetchToken2: '33a22856c82ec176bbeec802fee33101c6434424355be61ebb9279679591544e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '77ef867080f849fe8e9d728f3b16a00c',
    code: '750cbae1744f07d3662b8f8e84f410af',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9adb2f3fd222009df8323293b0a3324c3d9d2f043045c576158ce6a50fafd05c", ts="1705108908", nonce="gKXeJa", mac="nizcKOHboXk4hRiuuBZCTA6Zu7jTEinFH8Lt/YoO5MY="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '0c02f62556a8d36492f9a9a587b156bcc2877d15941aabec7c52c893941e1d999b8881702e659adbb299b7b0f8a4fe274ea7ca638708ef7274c3f281040f52bd96de190b27ab08230bcee040f3d4774e617910b487afe2bbcaccd5469448361f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8437f1007e40aa376689604685aab9ffb30a6f7b78f8a6ba0399ac7a92d59463", ts="1705108908", nonce="NnxWla", hash="Uf2+wTTBT30zkuC/nwhfQXb7EPOPABYcIx8I7pHl9NE=", mac="rWzh/vtvd9zVtjv4XUOrifzMoBB4pE3O98ummMj5I/M="'
  },
  json: {
    recoveryKeyId: 'a1f7fcc397309762b76880ea5bbf3771',
    recoveryData: '657b6cb5b2253be28653714f1d415ab0160be636bf2d4e5be358783b0befc6e8',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="8437f1007e40aa376689604685aab9ffb30a6f7b78f8a6ba0399ac7a92d59463", ts="1705108908", nonce="H18hKe", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="bhp6bX3Jh+cj/Q/WRp1rQEQqFtTn4XhYy1MizBWh5cw="'
  },
  json: {}
}
!!! response success { body: { exists: true } }
        ✔ should return true if account recovery key exists and enabled
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4da7e98f353c53f3a1ba@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '4da7e98f353c53f3a1ba@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4da7e98f353c53f3a1ba@restmail.net',
    authPW: '8a9fac538f12f5b21698a76b3347211dd6a8ec2d35250cae8c0eb850869918d7',
    authPW2: '6817280d36b1ae6260620fbc41763079a095cfdbfc946f6a5280c91d4c0a8cf6',
    wrapKb: '55695e8ec6aeb700924e46c6a23ae327c95d23d63ed72d071003ff2f8636dcb5',
    wrapKb2: 'deb6f49ee78e9af353e2da757704a60c39aa35b6c8c5183c1415cc78a0257cfc',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:28946efb333f87155562db29f764fb5617b481cbce459342ade1f518165a8bc8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '23095cbf28154282946ea140decbeeb1',
    sessionToken: '5ae8ac601eea982323cf8be76f36c8cf59889afbc5d8c1425330f939904792a4',
    authAt: 1705108908,
    keyFetchToken: '877b4f8a9a2a79f6a1a92ed203f56ebfa580d24aab8fadc8b139ade512bef52b',
    keyFetchToken2: '5a5d1f05ba1b43c4efbafe3fd76755d76acef435cda98d32c0fac11075d6cdba'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '23095cbf28154282946ea140decbeeb1',
    code: '5aaebff6ffd548bb053e77b5ce20dbca',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a6af51fee4c375f9baa1e5de1fa88f5cab48637db6d7ac590ac6b596614e7092", ts="1705108908", nonce="u9IazZ", mac="VeqHY1qKrFHhRevQW7n3AjjUwWG658ChAH/6CWCUC/c="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '2a8217ce17288c032917d3fbe8918ab8ca18690b57b358fb02ce2a5023aff6e561088a754ca51a509643ec1f553159bb1cd115828db35269ed4ea3ba42016fd03ede21b1f2ad2667b50931a63f33612620eb3ef22c2fef6ce8a8da8bde40b509'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="01d6aa63d1e4410d35f2990906baf97da3a4bac9cb32382e145c45367fab32a8", ts="1705108908", nonce="JjezPx", hash="LtFYBGS5ZdtPnReQmKa095/pQa9fP98enNwY6H4guoE=", mac="V0xSbRy9v7Sj+vmf/5v8zTBRmDV5iMWfeYHg1xvB094="'
  },
  json: {
    recoveryKeyId: '6bb453aa8f562676b187843650f870f0',
    recoveryData: '0f8e9b3769f8e64a4ad7da48c55acafb7fb0966bc5137f5256cac60f05fbbf21',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '66181ec20f805d83c659@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '66181ec20f805d83c659@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '66181ec20f805d83c659@restmail.net',
    authPW: 'f460f99a3870e4c3f7bd93c3f2b7975a5671804c142d0fcbcf6a8b50c8a011d1',
    authPW2: 'c160d284e7b5cb9e862069b74534d5961cf0496e984d16e312712ddef4a52271',
    wrapKb: '4b29e9016949a13e3832bb11f088211b9f4c53366827be061232bb5e44a2a993',
    wrapKb2: '0c8f7536e36a33ec80a37fba97fcb3a0db9addff2a49421d9c95b72a19cfffba',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:791e41cde2c4ca6a908e7e18c57addc3227646916a6ee22bfb36cf138ed567c5',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ff3170ba317f4ca1970c87fd3f006aa9',
    sessionToken: 'f57063b876b825b284d537d3ca4089252e3f6cee0d10e423a8fe6dc8760f3c26',
    authAt: 1705108908,
    keyFetchToken: '6e72f53d8ccb21efec2c7a8475463584a9809d4cd4b762141f3d882c67694192',
    keyFetchToken2: '105d8740d1bfc965af927a4c19ccbb5667a980544daa51f4b3734277d6d212c6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ff3170ba317f4ca1970c87fd3f006aa9',
    code: '8234bbd95ae68781cee39bc71aed78ba',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="fda77cb4a6793dc1b168547ecf733873e6a1478e4c5ba2cba763fb0b668a320a", ts="1705108909", nonce="-BHTz5", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="FXdiMp0WuzUgrBXHPxS5Mz7nO34fwFFd2mUuf0+lsV4="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key doesn't exist (501ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'adedab48d179924f25d2@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'adedab48d179924f25d2@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'adedab48d179924f25d2@restmail.net',
    authPW: '80cc749880a9fce7447e42202b6dbe442efaa4872338e2405b0acbc19b48e3d9',
    authPW2: 'c9d30d99175342e61d77892e5a0ce5552a3584dac2f58acee020343578f0125e',
    wrapKb: '5443c4d978acba66a17d4620790a2cf338966d9d1011578f0f1a4e9b00ccdc9d',
    wrapKb2: '9a57a373ffe0e6deeff0f6c997fa9a76971345191eb71ea54e1bd1855d1c3381',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:017161acfeebe1ec20bef4a1cf8223cddfd080dc6190c956b369b720f14ed9cb',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'af784dfdc6f4408f80903a538134490a',
    sessionToken: 'f586349a8596439ca682cb374312fc843b9b60dc44aed93e828fffaedcf1b06e',
    authAt: 1705108909,
    keyFetchToken: '6407d427f849a6bc6aa8adcb287871d15fe899834f28bfd11b387b05153a0fec',
    keyFetchToken2: '4d8f12f4e4b4d5ce72551681e77e8f053016db2efc7e46d9ee03c03d8f3f593d'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'af784dfdc6f4408f80903a538134490a',
    code: '32842025ef9d1dda1bde34bed77eb91d',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="0640075f31a7f785353a3446d338c7f3f4836d7814842f228f194de4244d3e5f", ts="1705108909", nonce="jfDkB3", mac="exaK2eHIuFx8eUHHifsz43cTo01kVGH/+C//ApX1Yjw="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '93eff0c6bb8df095c081c7bb14c4375081029b3064cde1dd61d4fd951354b75ce968cd2d1d8067f13f28a21f181c2efeab5c8377109a857723ccb1fd31c064b7516e73af6c89bce04e96571c79a812f1a40543b2ec68a84059c617f6b4dbfed5'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="9ca0e64037f9dbf0e2ca602693bf9a27f30d5b6fb903e1e531d6cc9bbd3246a9", ts="1705108909", nonce="wk8Pdl", hash="B7w1ZRMg9fN7LjOtkiI94P+QDq8ynuulCoiij45a5FQ=", mac="Vz3RmTgdBlbnYCILS3YD5i4pyVnyACBz4Rq+QCRrqNo="'
  },
  json: {
    recoveryKeyId: '62da89753570319df0c43764dc8e37aa',
    recoveryData: 'a530b001dbac9b314e7ea182d5ca30790355438d2c1bafc6db425915862e62a4',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd7da702a7e4e400bd6f0@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'd7da702a7e4e400bd6f0@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd7da702a7e4e400bd6f0@restmail.net',
    authPW: '30ca354957a92182bef1308ec0bab73cec0ebe41afc727ed428044af241ff74f',
    authPW2: '6faac5a3d305124f200c0877cf9683338d4b04bde936e4aaaf74fcd5deaa93bf',
    wrapKb: 'd3154e526dd7160de34e8ce19595d292da52141129cf859b451aff363454e82e',
    wrapKb2: '628894736792654304282892c68576ce638e94ae2fe69364fac4df5b1d47b72d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e6e3058372cb68b1f46f95254871938df8bd56641dfed57a5ac6ed277f82cbe2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'eed1dba2de944c2596bcf2fa31e9277b',
    sessionToken: '6426d24cfd40f6d75885423ecac7745c9882c744931c5639e9498e5271e9e827',
    authAt: 1705108909,
    keyFetchToken: 'aeaa5cbadd68fba3da3bfcc7939621d5ff61d9c7e50258be96348564638d5c51',
    keyFetchToken2: 'e235662064a568ec3e7d68bed7da42c6b9614c49cf6f859a6a1b8dbb8d84a52e'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'eed1dba2de944c2596bcf2fa31e9277b',
    code: '9eff9c47e9f1ed9916568c8357f4867c',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="67310e19780d53513ebfe8f1da9e47ce8e4d4a95aed34ec933d2985840312b58", ts="1705108910", nonce="35WkIG", hash="y4o1lrvDIvqFQzVTI66CO5NYUdLRY0BKfzPFIgsS/7E=", mac="Cqd5Sma7yQ7ZKyAMdCoKfCtObC9JFbbBmiFH1GuworE="'
  },
  json: {
    recoveryKeyId: '75fd579de2da07fe163651aab83aca04',
    recoveryData: 'fc1771f894ad7febb93a8c25070237ef7b57ae5f5c78260ec94265afdb52baa7',
    enabled: false
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="67310e19780d53513ebfe8f1da9e47ce8e4d4a95aed34ec933d2985840312b58", ts="1705108910", nonce="5Acm5f", hash="vNZvU+y3rJKqH4hu1yxrNuaijNPgIJ2Rgj/sHzsQhXY=", mac="QQ0rMdhBx0JNgZ3MqqdxhI8ak5rYks+pkSjFmXa/V/g="'
  },
  json: {}
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key exist but not enabled (500ms)
      with email
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'c69acb093d279a671832@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: 'c69acb093d279a671832@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'c69acb093d279a671832@restmail.net',
    authPW: '1a9771dc644f4a6af23d2d1d626adefaf00963397af78ae48fcfada46dfd788c',
    authPW2: '2aa3ce05370328b52a7ca65e995fbe86916cb6b01a913b556f4c06731b97d886',
    wrapKb: '154622004da387e1effd340bf765f691f58077dd86479236e68a5dd6d2f32209',
    wrapKb2: '8f89405fec73aec12e73406fe2c13fb0be8c76947633ff7ec4a51d3df5729983',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bf140ff49f74a4cb6d7ed23dcaf42ea16aa48c78551849d01fd2c72535097bad',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '692191ef56cd47a89f497a4b3af50659',
    sessionToken: 'ca95d19cd1b024641da26731a96f18ff6f455a261640910d2361e3e5226ee202',
    authAt: 1705108910,
    keyFetchToken: 'a2963659c9ec2ca8935032925d33a1251cbdf441c37ac971c95e1df28d8a2e37',
    keyFetchToken2: '3baa43e08a516c373c02fa0636fbd93a8a349664312d3bcf6ad0c75fefcef0c6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '692191ef56cd47a89f497a4b3af50659',
    code: '33ef1493ed3ba5a9a1310ea46f5e44f3',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="cb56bb83bd8d44b4f4fc162a3acdff1f598e68add33c11018a5ecc153d5c72b0", ts="1705108911", nonce="K3UEMA", mac="0wfF4tjre5khLr91dk2xf47L53KYhsDRtU5byyD4M44="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: '977b9cea772b764de09ad20cb7c1c8b7eccb9290a1b9822d396416d3537d800e710cd59eb8b8c59c7315b41e4532b8c34a9dda51db9d5c6e5f1e86cfa918770be9bf7701262ed714309384c49a5a16724d36f2ab25c79b011d0a07a128c1d9e6'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="cd0e60fb2f28245bcfe089c401c8b05a9a4d7491021c80f67e6c451955c95740", ts="1705108911", nonce="G18IlH", hash="ogHHUh+wzTnyHSFmaLnHwY8AmB5snzkjKy4ypZJNIqk=", mac="ft90b3x9DAjC1uY7j0UjKg4qTmx082l32RMLmB1Khso="'
  },
  json: {
    recoveryKeyId: '36f84d7005492c6288515bc94088daa3',
    recoveryData: '3e19c78c23812b0d6c47fbc13fa4c9018d638473d254236f714ce7af883e2209',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {},
  json: { email: 'c69acb093d279a671832@restmail.net' }
}
!!! response success { body: { exists: true } }
        ✔ should return true if account recovery key exists
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '2b52bd668aab6fa29874@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '2b52bd668aab6fa29874@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '2b52bd668aab6fa29874@restmail.net',
    authPW: '6593baaa557ae65e4a310f999445f749ae04500d926664345442453e18d564cc',
    authPW2: '99528837e58c164aa2cb3dd5e19c118a026d5dea724604727b472680c060a8c0',
    wrapKb: 'e035ea243c86ab9cfd9766a2cf41097abe86b044d048089802c3127989add005',
    wrapKb2: 'b3d0e445c82665557f1276ce4c14a742f819db3ce163f67c26eb0a64885cbe3c',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7a905fbf34289cfe0bc41455cf9d5c9478427f25d7989d5284d76e46185a2dbf',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ff484d290791483584779b0337e3fb9d',
    sessionToken: '64d975bf65a1cf1b0ee22eafc6af3785a315d9d3fc1b14deee20ce63ca52e329',
    authAt: 1705108911,
    keyFetchToken: '1ecbe86f58ccdc4bfc0d31e1b8654f7f37182721453f6a0ca0f7f166afe2804d',
    keyFetchToken2: 'a99e9d5466965f2335ac570decd9c31ab31eb61c8af0465380624790318341ea'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ff484d290791483584779b0337e3fb9d',
    code: '906fd5cc99e266e7a4df21bf897bc4ea',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/keys',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="a1cc828ce92395c53c2d15abc1384a996dd5b4873be2317104b85efb4d72b30b", ts="1705108911", nonce="H_4EMT", mac="r2l0iX9XASgbIhT1JFROSxQ7c7QynKCoa9heiKJorR0="'
  },
  json: true
}
!!! response success {
  body: {
    bundle: 'd309bd66602ece094671cafb0d387c8c9f182cc9cab3d93565713476bfe87970cccc64227091190e957b56307f5c5ccdf767da9d0c8eed3638298b18cb38560cb4f563231f75fc0800f4bee924da35480eb53f9f9db04388cc226dbe7c400b78'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="39bf45b58595587747493bcab58aa0a6fbe68dd95c113a8690536729c61f2cd4", ts="1705108911", nonce="4IEDea", hash="ytMnYycslf3lxU7s1fuJ6ECxpshXgFnVf1XL5ZOyUvo=", mac="+3fuMjrBEaut4Enn8R3LoSpHUtgEIwJlAffyjSMLIew="'
  },
  json: {
    recoveryKeyId: 'ff0888e50f229ce23a5a5356bcffae97',
    recoveryData: '7bd6e87f6c99b534bea92fd5bbf78bfa5cc844f875de56463d2ae0279604a468',
    enabled: true
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '21004479f6146c6417db@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '21004479f6146c6417db@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '21004479f6146c6417db@restmail.net',
    authPW: '9f04236b6846c1cfb748f2d5a8499a33227ac36fa4b7d05fdaf836718290e756',
    authPW2: '1760c546875fb3044292ea99a6aa3d9d02094c9bc51c3bf9569615acfb945860',
    wrapKb: '44c1f5f7799ca1ba81221f8c481cf344d4ad694623f1c783fdd6859eb02bd05e',
    wrapKb2: 'b29b6cc43e832863389b822fe6cd532db95797bd3da7cbeb72ed4bbe5a553886',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:48a64d2ba2e989db0da030e3662d8dea8d4e2711a42b7fa738e865b5a753690a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '921314dbba0f45dc82a3fee56a40f089',
    sessionToken: '41ef252635ec5c13bb496f12f3ca4245e76b13a1eb60d20dd71a2e17e3bb3c70',
    authAt: 1705108911,
    keyFetchToken: 'f4daeb7a49f7a174ff418dd9fddba8f03c9470ab53c4229639a58e620e4fbc4f',
    keyFetchToken2: 'd5bdce2b1f84992de3eb34609aedf9b4bef76c2540ad08d6f58669df0f0e653f'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '921314dbba0f45dc82a3fee56a40f089',
    code: 'f25618c9270b95c4b0e1b9e7f897def0',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/recoveryKey/exists',
  method: 'POST',
  headers: {},
  json: { email: '21004479f6146c6417db@restmail.net' }
}
!!! response success { body: { exists: false } }
        ✔ should return false if account recovery key doesn't exist (555ms)

  #integration - remote securityEvents 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4950c690ce2fc53ff992@restmail.net',
    authPW: '4d80aa71a3cf7a9839b15b81f3e17b87e9e5e0e0d2f74f8d03925af3eed1c2be',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '53629ae351b649ccb68d826aaf406a69',
    sessionToken: 'ab6cf9b477d87a9d3179789bdb45f8b855de0e12fd4a8a8ef68c518610144196',
    authAt: 1705108911
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '53629ae351b649ccb68d826aaf406a69',
    code: 'bf85de5c802db6d5f1c59e4f6922e059',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '4950c690ce2fc53ff992@restmail.net',
    authPW: '4d80aa71a3cf7a9839b15b81f3e17b87e9e5e0e0d2f74f8d03925af3eed1c2be',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '53629ae351b649ccb68d826aaf406a69',
    sessionToken: '0fa6a8e04383e87a81ee792602c40946e2f6d0d169c1a60efe6ca757ab45a6cf',
    authAt: 1705108912,
    metricsEnabled: true,
    keyFetchToken: 'beedbc3a3b88d17fd4335d3ea7bc63d158d9a4670f2c184c36d4ecf35ba9c017',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="40b4f3110ebf8eef1d53a1d2040910581c0f17bca514d17b197a5f96e7eb3bba", ts="1705108913", nonce="qYnOBz", mac="LUrORznzYBNQifXKtQf+zMOi/W6MCeoi+wV9mPhAonw="'
  },
  json: true
}
!!! response success {
  body: [
    {
      name: 'account.login',
      verified: false,
      createdAt: 1705108912248
    },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108911975
    }
  ]
}
    ✔ returns securityEvents on creating and login into an account (1545ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf14a649afcf6932fb4c@restmail.net',
    authPW: 'abeaa93700e9c280db1b070a0468946e1643fd1e646ef7d26b60dc9ec09ce71b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd8cd7a56bc004c8b9bbfda4e0d9b1475',
    sessionToken: '72e8c30b31380c1127545bed7245a4754dc5b7c404cd6b67f3cf39c371c0f8e0',
    authAt: 1705108913
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'd8cd7a56bc004c8b9bbfda4e0d9b1475',
    code: 'afe23acd24b817c50b4eac29627885f7',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'cf14a649afcf6932fb4c@restmail.net',
    authPW: 'abeaa93700e9c280db1b070a0468946e1643fd1e646ef7d26b60dc9ec09ce71b',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'd8cd7a56bc004c8b9bbfda4e0d9b1475',
    sessionToken: '5312e194c1fb5ddde8ddb713390caa2c150c4b696f2862955c6a486ae504b81d',
    authAt: 1705108913,
    metricsEnabled: true,
    keyFetchToken: '57ff4a33b55adfbca6ffa744b105ac7285971a246afb8e21dc8436046f25e29a',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dcb8c182b9be0f9ed8cbd845aee7ceebecf0105375d02b2274e5c15fa8ac3b41", ts="1705108915", nonce="Gj4LqW", mac="X6OW6T7Wv/PUIJ/Ngh9VF9DsQE/HnSEBdwd8vU7VBss="'
  },
  json: true
}
!!! response success {
  body: [
    {
      name: 'account.login',
      verified: false,
      createdAt: 1705108913828
    },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108913575
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'DELETE',
  headers: {
    Authorization: 'Hawk id="dcb8c182b9be0f9ed8cbd845aee7ceebecf0105375d02b2274e5c15fa8ac3b41", ts="1705108915", nonce="jVjJWA", mac="8BPOnnnmGBIy/7brDJrIa/+ddZZcSB/XpkAZfU9XRzY="'
  },
  json: true
}
!!! response success { body: {} }
    ✔ returns no securityEvents after deleting them (1596ms)
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2e72e8460c8d54c7feac@restmail.net',
    authPW: 'cff507d5e3f8dca0f9ef8cff2c49a2be6633a438219f2bb4a5b104547b4de008',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'c8ebc28453214787a195552e88ec91ce',
    sessionToken: '49c4291e9133b79ea91c8418619ddb8cd9495f1785ff31873986e814645ce7b1',
    authAt: 1705108915
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'c8ebc28453214787a195552e88ec91ce',
    code: '880df464d5b8fa6ee647ae499b86c1be',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '2e72e8460c8d54c7feac@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '1c549cfb01c4856aba1a1b19752216b76520758ed4566f0873d160c989758043',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="1c0deb7e16e7a9e616eee7c5d50ed2fddd095f546d14f787a2ab5d3cd5fe7635", ts="1705108915", nonce="h235vT", hash="ciNNRPyMY0ByEWsiR7jUmF8amkoMODqf+UFT1I/z1Gk=", mac="TMGA1P7p5KRk0vSUJyJaCNBCzRtxYZDSl/n74wyjhNQ="'
  },
  json: {
    code: 'd5c7cfd3d4e2689b7e78faeb7b669e1b',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: 'f78e61809ce6ab156db644f7cb2369c01f13dd1f9b23f4432ebab19f3f1ef4fe'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="3014c0a17c8eccd5aed2c55805c49f2f783ceff8d9ad5cff8041b5d54e038440", ts="1705108915", nonce="7MlK7i", hash="wB2byk5RHv4RWGi6hl8DrsoevgAhdjh7BwNrXYFIDzc=", mac="PqZOfIZumXBIr9A/qhrxJ8KOiOv5eS1iF9HEA9T8zY8="'
  },
  json: {
    authPW: '4e01a182a30bf7da8cea0556eca478a65d37f85ba63e223a289ed42ef8700857',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: 'c8ebc28453214787a195552e88ec91ce',
    sessionToken: 'a94fafe204bd4cbbc5e81f044108551e60326de59f730efd3e4d1eb2ff8a4638',
    verified: true,
    authAt: 1705108915
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="dd8ef61c9abde49e33d74faa0171e01b623d4eb7cf64bc7870cb6d842a7f57cb", ts="1705108916", nonce="mt_wdP", mac="LR666t2ro0Rq+NaASG3z+kDIjnxSFyCiKD4bJOvG5Ls="'
  },
  json: true
}
!!! response success {
  body: [
    { name: 'account.reset', verified: true, createdAt: 1705108915485 },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108915164
    }
  ]
}
    ✔ returns security events after account reset w/o keys, with sessionToken (1606ms)

  #integration - remote securityEvents V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '94540b922feeb7f3d962@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '94540b922feeb7f3d962@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '94540b922feeb7f3d962@restmail.net',
    authPW: '0da84f7ec961affc53465a5489615f9ba3241bf714c64f88eae2728dec5bfd05',
    authPW2: '3b582e2f84eb79d2ffc449b47df8b2420428eb33aaf06c589b4c9e77becd1376',
    wrapKb: '7c075175307744b4f61c43ea32f6bfc9de9e9c6e62f88237b06ab037960efa6e',
    wrapKb2: '04707e3c11232d268ccaf2ad2ed01b5a4a2cd5c038fa72a9a233516b6caf0794',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a65aa41cf7ebbddd38ee7dccdaf320492c902029902c8b8975ea3ef25ea0e2db',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ce34d51889ce40f0bb35a95077fb16bb',
    sessionToken: 'bc1833afe95880f34376d3db07f5695202dbaead628d806ee4129860a4ddb28f',
    authAt: 1705108917
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: 'ce34d51889ce40f0bb35a95077fb16bb',
    code: '64d48ee8db78722c5d95858614b353a6',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '94540b922feeb7f3d962@restmail.net',
    authPW: '3b582e2f84eb79d2ffc449b47df8b2420428eb33aaf06c589b4c9e77becd1376',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: 'ce34d51889ce40f0bb35a95077fb16bb',
    sessionToken: '7016cbe631fb1d7d6412a41426a4ef91d3cdd4aa722cc44b14e3afab70bd1daa',
    authAt: 1705108917,
    metricsEnabled: true,
    keyFetchToken2: '60341122ddff53444c6fa4a022562ce506ed1160528c79db20e1bb799f0e35ee',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="489faf5febdc0dae56905f431b3370fb41ced762af80b1ee7a2db9b342de83f0", ts="1705108918", nonce="N9KqTN", mac="dHHsm6ccQ3thcpphEcnnxZFE/Kl40v68Vy5luCcgIz0="'
  },
  json: true
}
!!! response success {
  body: [
    {
      name: 'account.login',
      verified: false,
      createdAt: 1705108917327
    },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108917090
    }
  ]
}
    ✔ returns securityEvents on creating and login into an account (1791ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '209a46bb5a1757f30eda@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '209a46bb5a1757f30eda@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '209a46bb5a1757f30eda@restmail.net',
    authPW: 'ea6375bd717d18bc742829b27a1e87e78987aa6ee18565d7e11134dfb7b7cc90',
    authPW2: '65e2ead75496f2df412b94a4872752043eeb5aa5923e42b552c6664822a7a2a3',
    wrapKb: '9f40d5ead15840566b21c5eb214b24e445c68539f07e28b526931fe2d8d006bb',
    wrapKb2: '3426ce20aa4a8328c4c1b9b699f0c7a0f6885cd4a525199b9184632cf7026161',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:a44739e5ec94174a7d35b3ca2c27d1fd09759b024da068edb87f23de1a7f0978',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '43627b625bcd4e5a8911d6858e46538f',
    sessionToken: '8596f83c0b39141929c04e405ce46902988dcec80ea1aa57d01636ebbc1b1da3',
    authAt: 1705108918
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '43627b625bcd4e5a8911d6858e46538f',
    code: '045b6dfd35cbf86ba81e0887213fa040',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/account/login?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '209a46bb5a1757f30eda@restmail.net',
    authPW: '65e2ead75496f2df412b94a4872752043eeb5aa5923e42b552c6664822a7a2a3',
    service: undefined,
    resume: undefined,
    reason: undefined,
    device: undefined,
    metricsContext: undefined,
    originalLoginEmail: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '43627b625bcd4e5a8911d6858e46538f',
    sessionToken: '439f89f985b61f7c22fe21153f102003b9cb1529eccf578b8cddb4cf36209931',
    authAt: 1705108919,
    metricsEnabled: true,
    keyFetchToken2: '73bc1bdfa211c59c4529e95665269997142c2092b6288eca5c5fca10f86ba93c',
    verified: false,
    verificationMethod: 'email',
    verificationReason: 'login'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="42f4cbdb074167202733cae9fd401e9da09e0d7244f835df4c4c653b63c72b8a", ts="1705108920", nonce="sF9Xd5", mac="A8dRXKdVA4FjM0gl23DaLsJfxcph7JyjMZQv856ZSvg="'
  },
  json: true
}
!!! response success {
  body: [
    {
      name: 'account.login',
      verified: false,
      createdAt: 1705108919145
    },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108918922
    }
  ]
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'DELETE',
  headers: {
    Authorization: 'Hawk id="42f4cbdb074167202733cae9fd401e9da09e0d7244f835df4c4c653b63c72b8a", ts="1705108920", nonce="8RQqko", mac="v+3iZOhI9gaeFER1q54hhASsHmoK1pRRiOfnak3I5nE="'
  },
  json: true
}
!!! response success { body: {} }
    ✔ returns no securityEvents after deleting them (1825ms)
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '5c8e9b9da8af38bb73fa@restmail.net' }
}
!!! response err {
  statusCode: 400,
  err: {
    code: 400,
    errno: 102,
    error: 'Bad Request',
    message: 'Unknown account',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    email: '5c8e9b9da8af38bb73fa@restmail.net'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '5c8e9b9da8af38bb73fa@restmail.net',
    authPW: '7a7401c31752f1e3539d156df36fcb135183e8ad27def239126d32d7fd062e81',
    authPW2: 'f4b3566c4daa6095d26b6ad54d4847d1868dceb3a2c600d95cd558228c71f494',
    wrapKb: 'ed694043cc8eb95bb8f2cbfb1c66ef65fab39584cdb3248fd0b18fa6fce38e4b',
    wrapKb2: '3c95b13c7d8935ba8da5ef132f14115fddbf08b86a9d50c481879e0b125671c1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:6c8147b1550fa6a41d3b068fa776879da9745b33ed4c5fe79678edaaa3244dff',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response success {
  body: {
    uid: '960c9dc7f5334db281bc91089f62984b',
    sessionToken: '9aa982106322f475eb5016b542ad2d7a07e57bc92de4cabe837b3a36387615bd',
    authAt: 1705108920
  }
}
!!! request {
  url: 'http://localhost:9000/v1/recovery_email/verify_code',
  method: 'POST',
  headers: {},
  json: {
    uid: '960c9dc7f5334db281bc91089f62984b',
    code: '53f1e9ca5d13cdfb257f8369ac00fcb4',
    service: undefined,
    type: undefined,
    verifiedEmail: undefined,
    style: undefined,
    newsletters: undefined
  }
}
!!! response success { body: {} }
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/send_code?',
  method: 'POST',
  headers: {},
  json: {
    email: '5c8e9b9da8af38bb73fa@restmail.net',
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    metricsContext: undefined
  }
}
!!! response success {
  body: {
    passwordForgotToken: '1950a0d62ae6212249a0dfe80c6d4ee0baaecbb4b66cccf307bc5eab1d598ba2',
    ttl: 86400,
    codeLength: 32,
    tries: 3
  }
}
!!! request {
  url: 'http://localhost:9000/v1/password/forgot/verify_code',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="066dda68b536a7fd54d090561a93f883ca271601ff8d39bb8472a4e5dcd644b0", ts="1705108921", nonce="2k3GNM", hash="aQV6pWcdQA6kdl0DJQBv9Bj9CC5S+m3LLxPXtIxvsSY=", mac="oLE+px8LBblh3B4Zz+iVj1lj7zqEjBqoyp8ldMuOfmA="'
  },
  json: {
    code: '5b11ddb832ffb8d828d72b121fee49fe',
    accountResetWithRecoveryKey: undefined
  }
}
!!! response success {
  body: {
    accountResetToken: '092aa9cfe955fd4b14329ba1bf7f0e51a617fdaa3998ad7487865b1fe369b8f2'
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/reset?',
  method: 'POST',
  headers: {
    Authorization: 'Hawk id="089e9ec4cfb3af8bba3ecbf777e12371382e26f7e816418f2a330f65eb07374b", ts="1705108921", nonce="Q8vZZg", hash="h3G7Edl7OclRYi0ll33AimcJtxSlhxdpKPEGvigN4IE=", mac="K7go2TYrdCQv6lT+mDJuBy18k59jhrypX7NSA40cRd0="'
  },
  json: {
    authPW: '69f56678def18b289384fa6638e897a51231a11ce084f32761959d0c5e2d600b',
    sessionToken: true
  }
}
!!! response success {
  body: {
    uid: '960c9dc7f5334db281bc91089f62984b',
    sessionToken: '80dfb709c9bb302faa3fb2ac07e2ddc960107503b536e406a0542f41a6f27592',
    verified: true,
    authAt: 1705108921
  }
}
!!! request {
  url: 'http://localhost:9000/v1/securityEvents',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="330d49dee8deaa9c49d3ad759bf6dcfd7342b04aa185fc2d1339aca65477116a", ts="1705108922", nonce="2tYSLS", mac="BuhNANzvbxPXCDosq+8spbr9HmcWurbC+0HbpbK1/Nw="'
  },
  json: true
}
!!! response success {
  body: [
    { name: 'account.reset', verified: true, createdAt: 1705108921023 },
    {
      name: 'account.create',
      verified: true,
      createdAt: 1705108920719
    }
  ]
}
    ✔ returns security events after account reset w/o keys, with sessionToken (1839ms)

  #integration - remote session 
    destroy
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c9404ce87db27f201b0a@restmail.net',
    authPW: 'db3862b7666a4f11301d1f7122a1eb72c8bded3836632bf8fa059d5e0c0fdd01',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      1) deletes a valid session
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bd073f9c11fd22135d38@restmail.net',
    authPW: 'f6ba642e3cb829faeac460d390dc21e5364de19847ab654c7604fd855b3dbb6e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      2) deletes a different custom token
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4dc2ec016c4627eee762@restmail.net',
    authPW: '93b3d5ba85955c5456fafeb719946ead9557bf7fd6dbbf4a738061d2ca97321b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      3) fails with a bad custom token
    duplicate
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd6fbec9baf22385c1c83@restmail.net',
    authPW: '83db4b1dde2a3c4b2a7ebef7a55052c7dc9ddd560a723768ff0f13c07a48e897',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      4) duplicates a valid session into a new, independent session
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '84cf49c756463003279b@restmail.net',
    authPW: '8b78d2976a353e521a554173f469d4701258fc2a36e60ab82bb52b4cfc0de029',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      5) creates independent verification state for the new token
    reauth
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: 'd1d96e2192b0ac94a6a9@restmail.net',
    authPW: 'e5207f52cb7775c2605a5771ff39d9f5add5c4eab9a95e345c6a58f7cffc36bd',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: {},
      headers: [Object]
    }
  }
}
      6) allocates a new keyFetchToken
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c1a63c5da8295ad8c10b@restmail.net',
    authPW: 'e2244d9e7136edc4f171fa525fa68a8a2d621710dddceca2e75478e8f29b5b7c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      7) updates the last-auth time
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '7befc6e6afa989006464@restmail.net',
    authPW: '1dfea3ab3f90bedafeb9b19709be309f3c67d70781047e8274f8c24dd503cd75',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      8) rejects incorrect passwords
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'c0ca62c04d942299d95c@restmail.net',
    authPW: 'd41eca3ca1a0f550cd38c67c9570340c2ee2f85b79ef70132608821ae06cf957',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      9) has sane account-verification behaviour
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4923f97b1318d048eed9@restmail.net',
    authPW: '66c8db2277711b47baaf08d4191a9c3c9a21490fc00d47221fc4212c2b616dad',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      10) has sane session-verification behaviour
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '8b6e4d698821d322dece@restmail.net',
    authPW: '956a1d390eb1f42e5a4d25d758c1b7a36fe0bdf82546eb90f4cd86cb04acd1d2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: {},
      headers: [Object]
    }
  }
}
      11) does not send notification emails on verified sessions
    status
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '2dc9bab315b3b1160a87@restmail.net',
    authPW: 'd20f2129ae4c4140a70307d24ffc47cc1c232a394114cb0f1f7416cea6223591',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      12) succeeds with valid token
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9e3323815d7a6215f314f7b9cea1506cbbc960684d87919de21c3b8ff14bc914", ts="1705108922", nonce="EPH0cU", mac="Ja3dmKH3NFeHbUPLA+c7hZi4FWFV8SteZFPKGz5itpw="'
  },
  json: true
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'get',
      path: '/v1/session/status',
      query: {},
      headers: [Object]
    }
  }
}
      13) errors with invalid token

  #integration - remote session V2
    destroy
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b9a99d62a1f717557ac8@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b9a99d62a1f717557ac8@restmail.net',
    authPW: '38e596b6ffd95b75a9b561d3588c37987761235978fa60a6933e40d26e7781de',
    authPW2: 'c61362fbf535f696e328f76ac7c2592842c0c3a352088672a85b6378652803c7',
    wrapKb: '303b2e99fa7546aca1d54917ebd9fa24a8cf80634873483a7763f4ef156ed45d',
    wrapKb2: 'dfa85c71f3180f1a9cd25a4da7292283a9a88bf319b9b03629682f7edc7773c5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d8af73cfcbbc62e54d48baf5f81d11b1dc2d59b4e1fc6301cdea084b6394198a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      14) deletes a valid session
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd70e75e64a83f3c41768@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd70e75e64a83f3c41768@restmail.net',
    authPW: '0a44b0a8d0ffebb8f45cd47a154c76e798c087335a7bb5b47c2bf6819af9fb68',
    authPW2: '74799bb242862f41c56f613533a9201cf07c4f2124cbf283bafc71ae82822c30',
    wrapKb: 'e2bbd56b26af20546e846afac475bb4213c67ebc6dbbbcc0d3ca6b19243843f2',
    wrapKb2: '074439ada2ff9e4b92bbe4cf8e8c82edfca6c4b580c8ce393ae0b6981bb24b8a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:b70bb4d264192f9c09eb7ea8f89a86a3f9ba230356102c89dcb1001304e281d3',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      15) deletes a different custom token
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8d12679a8e95864d476b@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8d12679a8e95864d476b@restmail.net',
    authPW: '533d6b7feafcc07677b08cbbf662ae9538f2b67ce73f860601ff2bcfef056256',
    authPW2: '6fcb19c613790bc51ae101a1b05f1e22ab9cf8e9732a7070d06d7b2194605aca',
    wrapKb: '2a0c924a13284cfd445a4d20b19c981e3b6a96c56b364f1428b66c681d27a840',
    wrapKb2: 'a487d3fa37a069c665d9d7e1fa961f94ac99145241ff92896f9356560b8d7d82',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:11d9d44a4e64ae540e453c8908bfdacf69cbbc2eae19d971eaea9b886306d040',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      16) fails with a bad custom token
    duplicate
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'b2e8880b2dd44aa4c015@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'b2e8880b2dd44aa4c015@restmail.net',
    authPW: '5724ecee724bd0e478bde8acfae3fe377c088d7dd87b0f6f60a44d8f4f7ab9ff',
    authPW2: '7a504348f8f219b1fe39536ccdf8e2ffaa413e85b05c58672af4cf8488d44e7d',
    wrapKb: 'af7ffde7aa11eefd2c021729f678abc3546ef09f91e59725f8d9eeff52c269e3',
    wrapKb2: 'd067f8a45e45a973d8d9ecafa5faaa7cd2d340858907a47d0ebb65953e49efe5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d5b668ec505b0408dccb465a87bc19940f116b53601ef65da2c14f4e66a1b347',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      17) duplicates a valid session into a new, independent session
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '6b15d5359538ccd6a7f5@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '6b15d5359538ccd6a7f5@restmail.net',
    authPW: '69bbb5b94bc6f0153a93c2b137cb44bc902f03796d46241013a1af987eebdfea',
    authPW2: 'ebba6074b3f9e9eea97c006c02bcdf3120a53d1dc65b93e1186e61614097ef40',
    wrapKb: '5196542ae966fba5b616dc86dca2ab67a8a9c76f2d89a53fbb057bc7f09b167c',
    wrapKb2: '1ce82780bce0845f9cd0481bb39192237aaf67ffd932d2e5ade3c4504ad047c0',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:4d5dd7c20ec5724a8c1cfc9b1a3894c9fefabf1f0cbc8591812d0a23e458cb4f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      18) creates independent verification state for the new token
    reauth
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '9e0d08200191af09c9cf@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '9e0d08200191af09c9cf@restmail.net',
    authPW: '377c4eaeab0e6f95a146fb2ae31aa97d6e1f356191f70988b88d8e621543046e',
    authPW2: '0cbf6d25624027b515b0207aec704a30692e31e96bea1d3e63cd542c48bdcb36',
    wrapKb: 'd069abad69e1c1e421ca9dfe58ff345a1abf471eb79818e820e736788a368de3',
    wrapKb2: '6efb6e35d96a5ad1f6bbfbb512e26a497b267531098d8a119fef08918c533f22',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:702763175ff8518b85b1e038f754af572a3f862125069fa116b86e15573f9b8c',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: {},
      headers: [Object]
    }
  }
}
      19) allocates a new keyFetchToken
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '16eee14aa7f7efa5b69d@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '16eee14aa7f7efa5b69d@restmail.net',
    authPW: '870ea2eaa806804e8147d373f24910973962bb1b609a0d0e85596a9d8700e43b',
    authPW2: 'f0e85835fc312bc00b949269847a46df7ceceba4a273734576730bb521d706e9',
    wrapKb: 'a1d2196ff6e5bf8059dedb1ead179c62f263b3aa0ed9c038a627fe0ce36edff0',
    wrapKb2: '546065bb5ef46dfa2a08f83bd162f2b0ae62c1f3eed4d9df77f52aeddaf789c6',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f2f62f36ad5c3fd13767bd86e1a93460ea0bee667ecb7b3f9f6dd689e2e363c0',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      20) updates the last-auth time
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e533bc4d2a71cf9fcb0a@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e533bc4d2a71cf9fcb0a@restmail.net',
    authPW: 'e49642bf6250bd3418c1739987e8e5ac70f62a39c1d5e2696f470db245c73187',
    authPW2: '085803ec31ec352fdb085d41dade60d3c01a2a3b68f82f39775e1f5bec367212',
    wrapKb: 'c84b2516703ae7d114b75ad3f591af968725504973115956ba947f2de6e7816f',
    wrapKb2: '17838fb5689d15faa925723344472ba0d078d58ede7bb9531b27797b86662907',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:f8557b464543cabd35e93993d44cf58b80f88f37ed6950c0277ef6d25b4729da',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      21) rejects incorrect passwords
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'db62dc8c0f067b6fe6fe@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'db62dc8c0f067b6fe6fe@restmail.net',
    authPW: 'fa8ec8685d92d335751d75d9a65871d0abf1da582c1336237b6555e381602302',
    authPW2: 'a6ee77e41f9a3e38938f31db97fe663907355dac4b645cb10b424f68412e6181',
    wrapKb: 'c1491af5ae4b9f99b41d8e81a41fc97c65aa8c374e1f05f5162749d963e7bcf9',
    wrapKb2: '983ff0b07e5a3b09f41cf5d535cb3079a50c46f63e0d15f5f6346afea9ac10b7',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:9f15f817a3c5447face6bf033e8b46439de1d5b48dd6f52ee9c5180b0a65473a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      22) has sane account-verification behaviour
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '07fdca22c12dbccdc54a@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '07fdca22c12dbccdc54a@restmail.net',
    authPW: '4bf7b30c2f4e5fbb5625def32ec14ae62ec5dfe2bbba858c6a76fd910aab7e6e',
    authPW2: 'efd15329cc1480fe4329eccceb0692f40c9e9b8b785a74e3ad90056dd062dae9',
    wrapKb: '813647ba7ec00f34a9d3f9715228cfc0efe33ede5e5a1be8be9a20d141a3a12e',
    wrapKb2: 'e187209af13ffe0c8b255324fc9c4c57867ebf87a6fffb7a292c33811bc561c5',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:d5cb802392a09ecc505bb8daebf60af0bc53e0c612eb0753405ff123eb92656e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      23) has sane session-verification behaviour
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '7ced05e46fb5b245bd74@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '7ced05e46fb5b245bd74@restmail.net',
    authPW: '66aeae80b3a0065baa729491a7b6177abda7a61192113b577f82d7d8d06b86b1',
    authPW2: '96dc1a07bfb68e51d50ef0671299e29b3c1266c586b4848e6f800828a528b96b',
    wrapKb: '416c132fa8f463dd13fc6b98dad0555bd4e7bc54fb767fbc548ca03ee24d8529',
    wrapKb2: 'e75d9271784a8dae4b281719979315b7987aaaa030dd5e782838ac78b1790a67',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3bf2a0c62f410fb274f1e7cb1af4808e26565f78cf729a615f7aaf95c70727f9',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: {},
      headers: [Object]
    }
  }
}
      24) does not send notification emails on verified sessions
    status
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '4d1b00ec4be1eaa9dcb3@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '4d1b00ec4be1eaa9dcb3@restmail.net',
    authPW: 'bbbdf4d445f8cc0f6bfed5abe31d1d3529108b7d80a9eaaeac37882550927661',
    authPW2: '7dff9d78e22d7b462c0876674a10da4827e9e04f1b4c683572b9c24976cae306',
    wrapKb: '5b74735ac37e96197cc112e95bc4d03415a4f93e28e367da82b6a6af891a7bef',
    wrapKb2: '64177363d6e898cfb462742cd58ebb5cf0d64055ff242dbeb9e7528da2ae2258',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e06a8491819f1e94d8351271277216f9af9cb2ca83abc12ea4e792a382d12993',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      25) succeeds with valid token
!!! request {
  url: 'http://localhost:9000/v1/session/status',
  method: 'GET',
  headers: {
    Authorization: 'Hawk id="9e3323815d7a6215f314f7b9cea1506cbbc960684d87919de21c3b8ff14bc914", ts="1705108924", nonce="wFjjsg", mac="GXB1p2yTyJi6iPhXSUcYKW0Me58v9oiLJO6cdswBeRw="'
  },
  json: true
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'get',
      path: '/v1/session/status',
      query: {},
      headers: [Object]
    }
  }
}
      26) errors with invalid token

  #integration - remote sign key
    ✔ .well-known/browserid has keys

  #integration - remote subscriptions: 
    config.subscriptions.enabled = true and direct stripe access:
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '65dbe15d9e8a05a6c0df@restmail.net',
    authPW: '7741327857d81c6bacde9c5b557641618ffab456de6a36a234352324d8cf9351',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      27) "before each" hook for "should return client capabilities with shared secret"
    config.subscriptions.enabled = false:
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '53e97e5095b431f85f22@restmail.net',
    authPW: 'a69995f0743289a6a6eac0916111eb83af70bf1a39bfb44fed8a412f325f702f',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      28) "before each" hook for "should not include subscriptions with session token"

  #integration - remote subscriptions: V2
    config.subscriptions.enabled = true and direct stripe access:
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'e689bf014e56236ad844@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'e689bf014e56236ad844@restmail.net',
    authPW: '6fd315f08a9d8a823a34cf9c6e20ca718200db21d77bf14670a191b5636adab6',
    authPW2: '0328fa2cf852f6d02012fce696c00c188e733ffedc1f1da1ac7919c60e8268db',
    wrapKb: 'a6038c091318c277e1c7adfaa56e8e230206068307fbcb181dee48b88a1749b0',
    wrapKb2: '4f4a04e7610a88bea70cb3edea6a2d2f99cc5d5710df5514eb04121698010994',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:5dd7acd112b98150fd71de52682022bfcaed7333066f49843785559d6f569760',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      29) "before each" hook for "should return client capabilities with shared secret"
    config.subscriptions.enabled = false:
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '8679d03089d864c86dd7@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '8679d03089d864c86dd7@restmail.net',
    authPW: '138b98712e29c08f2eb3b1f107cadd9c6d801ac45f0b13e27559fdb475556401',
    authPW2: 'a9adfb5b12684f685b01ca1033271535bf559129024f2c13e2222d1df4e03f31',
    wrapKb: '417b76217a56baece6036cd6c3ef47123759137749a904d23c2f7a5714e8d353',
    wrapKb2: '801dff07e34cdd3ab2816402d4cf9b3f1545448ca5c0645bbfc427e56b906e8b',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:0836fcb867089d106f3bfb109669b76507c521a1a9811f96049ef3d8acba77c8',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
      30) "before each" hook for "should not include subscriptions with session token"

  #integration - remote tokenCodes 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'aab8d69b200fcf37c942@mozilla.com',
    authPW: 'f5c9ea6a16bea6b218a1b5133ce232d9a5c29c954c1b479b84d38e3a4c79ab9e',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    31) "before each" hook for "should error with invalid code"

  #integration - remote tokenCodes V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'f11c2e68bd1ede6b940d@mozilla.com' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'f11c2e68bd1ede6b940d@mozilla.com',
    authPW: '241101c27382adab651e0fbfc259223c3fd64dc788f7248e5decab7accc2de50',
    authPW2: 'f5698523935aace89187de26ad99d7edc0130c91d37dd0ffef0f018b8e5c3780',
    wrapKb: '066762d976f5f3497540d554c2ac79edc08a9f671d2605c1ae8c79af1f622d69',
    wrapKb2: '013709a62b353e67fbcb434a45fcdc6ffcc1423f229d76820b36c8c2efa0398d',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:7b5f312506603da8495c96af25017cc715a214d519489839f082c4e6d0a9aee2',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    32) "before each" hook for "should error with invalid code"

  #integration - remote token expiry 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.7465452802868311@example.com',
    authPW: 'c9ebdf966ce57673c7867ea417848c19151e82c89c968edbdbf7d94862573b87',
    preVerified: true,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: [Object],
      headers: [Object]
    }
  }
}
    33) token expiry
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.7050942485144904@example.com',
    authPW: '7ebc3bfcd6d5f2730e8bcc0b12fb433c254eab2e95dc24dd4270a926516482f6',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    34) session token expires

  #integration - remote token expiry V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0.8089696613431099@example.com' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.8089696613431099@example.com',
    authPW: 'd939af5b8c64217cc37add71091b11b7d2e1a27f6dc0b8a3b0b50ef9b204b834',
    authPW2: '73f3cf8f7be1e7bcc0878baba515f33a209cfe9e5c8a4b9a25e5ea43d5f3bd70',
    wrapKb: '7f9af16e15a4b88c7e46f1c8c3764e17c80b02fe71e9bc9f660ed1175092e493',
    wrapKb2: 'd0b63b28d192855d91944074917b6daa198c8b84bde79d875f33afd9b4149021',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:cccff1144cf2d4c54fb69cfb56b3a2f2a2c16346d6fe05f6eba04a64cbe24048',
    preVerified: true,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: [Object],
      headers: [Object]
    }
  }
}
    35) token expiry
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0.08940892549083723@example.com' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: '0.08940892549083723@example.com',
    authPW: '7abfe5683d15693ca90d713b14e3216827aed102795010ce4f8991d33c9226a3',
    authPW2: 'a42ac4bcaf271a73293ee0ddca45b11a4ec3c3f9a5a8855776078514d98efba6',
    wrapKb: 'a683d4b0b997449dc84f67429eb9dbff24b94224b37d4d3d16c0a800d8909e34',
    wrapKb2: 'c41ee87127dc2e2bc3fb8ec12433a7ca1edfef3703580321dca8728e18430425',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:3556b710b8b036ae2f129e33dd1a7b15d4c97a19b22d5e5b20f21e40d6ec140b',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    36) session token expires

  #integration - remote totp 
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'bea3d765fed34fcd706d@restmail.net',
    authPW: '71ec32825a46bf955cf247b999de4fdd711a6e53e8e8dce56e5d04363cc24594',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    37) "before each" hook for "should create totp token"

  #integration - remote totp V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: 'd9355fac8bedf7bf69ce@restmail.net' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?',
  method: 'POST',
  headers: {},
  json: {
    email: 'd9355fac8bedf7bf69ce@restmail.net',
    authPW: '73d6ffe1bfb0198b354c4a947c824719435fb31221b910b8b1edb2a063999f17',
    authPW2: 'b21913062d1bffc8770cf93a62ee76bef01628d65498d4d9bdf81c3746bbdb4b',
    wrapKb: '59b7392541f1cb9ee2d2533ef6dd5bcd58c003aa21c2eb9483f456437e19f135',
    wrapKb2: 'bd5ae96054ac4f882de0b3da557189d850a497ba13964efe0d323d4b9c4e652a',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:e23e78abbf5061406bf36ac83cc3b42059ada44a9488846eead42d7f185f0e8a',
    preVerified: undefined,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
    38) "before each" hook for "should create totp token"

  #integration - remote verifier upgrade 
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0.3735032707457404@example.com',
    authPW: 'fc90dd9c36db5c3a8f367268ec3bb3165bb8578f34b6baf2182ed255e52bc1f4',
    preVerified: true,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: [Object],
      headers: [Object]
    }
  }
}
    39) upgrading verifierVersion upgrades the account on password change

  #integration - remote verifier upgrade V2
!!! request {
  url: 'http://localhost:9000/v1/account/credentials/status',
  method: 'POST',
  headers: {},
  json: { email: '0.987519825663782@example.com' }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/credentials/status',
      query: {},
      payload: {},
      headers: [Object]
    }
  }
}
!!! request {
  url: 'http://localhost:9000/v1/account/create?keys=true',
  method: 'POST',
  headers: {},
  json: {
    email: '0.987519825663782@example.com',
    authPW: '1e6109d2162c8ae8cf5202dd4be3e40c672effc643b722565c69a58a0a15c96c',
    authPW2: 'a16368864e6b3696e72f184157660d680ead0b90372815aa4dc72416361b3c2b',
    wrapKb: '7f6e9d7a7df568ddda60c58c4d6d271096f51ec0c6bc5797502c476bcd9d72a6',
    wrapKb2: 'c77e26f817325f9bd355b21d01197ff15423b27271350730b13bca9c2834a6e1',
    clientSalt: 'identity.mozilla.com/picl/v1/quickStretchV2:bf1ef73633e9d6388a6fb7170d259864e9b64ff3560c5a66d81924e2a74e9702',
    preVerified: true,
    service: undefined,
    redirectTo: undefined,
    resume: undefined,
    device: undefined,
    metricsContext: undefined,
    style: undefined,
    verificationMethod: undefined
  }
}
!!! response err {
  statusCode: 500,
  err: {
    code: 500,
    errno: 999,
    error: 'Internal Server Error',
    message: 'An internal server error occurred',
    info: 'https://mozilla.github.io/ecosystem-platform/api#section/Response-format',
    request: {
      locale: 'en',
      userAgent: [Object],
      method: 'post',
      path: '/v1/account/create',
      query: [Object],
      payload: [Object],
      headers: [Object]
    }
  }
}
    40) upgrading verifierVersion upgrades the account on password change


  562 passing (5m)
  5 pending
  40 failing

  1) #integration - remote session 
       destroy
         deletes a valid session:

      session is invalid
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:64:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  2) #integration - remote session 
       destroy
         deletes a different custom token:

      AssertionError: expected 500 to equal 401
      + expected - actual

      -500
      +401
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:105:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  3) #integration - remote session 
       destroy
         fails with a bad custom token:

      AssertionError: expected 500 to equal 401
      + expected - actual

      -500
      +401
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:141:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  4) #integration - remote session 
       duplicate
         duplicates a valid session into a new, independent session:
     AssertionError: expected undefined to equal 401
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:205:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  5) #integration - remote session 
       duplicate
         creates independent verification state for the new token:
     An internal server error occurred
  

  6) #integration - remote session 
       reauth
         allocates a new keyFetchToken:
     An internal server error occurred
  

  7) #integration - remote session 
       reauth
         updates the last-auth time:
     An internal server error occurred
  

  8) #integration - remote session 
       reauth
         rejects incorrect passwords:

      AssertionError: expected 500 to equal 400
      + expected - actual

      -500
      +400
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:398:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  9) #integration - remote session 
       reauth
         has sane account-verification behaviour:
     An internal server error occurred
  

  10) #integration - remote session 
       reauth
         has sane session-verification behaviour:
     An internal server error occurred
  

  11) #integration - remote session 
       reauth
         does not send notification emails on verified sessions:
     An internal server error occurred
  

  12) #integration - remote session 
       status
         succeeds with valid token:
     An internal server error occurred
  

  13) #integration - remote session 
       status
         errors with invalid token:

      invalid token
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:605:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  14) #integration - remote session V2
       destroy
         deletes a valid session:

      session is invalid
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:64:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  15) #integration - remote session V2
       destroy
         deletes a different custom token:

      AssertionError: expected 500 to equal 401
      + expected - actual

      -500
      +401
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:105:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  16) #integration - remote session V2
       destroy
         fails with a bad custom token:

      AssertionError: expected 500 to equal 401
      + expected - actual

      -500
      +401
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:141:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  17) #integration - remote session V2
       duplicate
         duplicates a valid session into a new, independent session:
     AssertionError: expected undefined to equal 401
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:205:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  18) #integration - remote session V2
       duplicate
         creates independent verification state for the new token:
     An internal server error occurred
  

  19) #integration - remote session V2
       reauth
         allocates a new keyFetchToken:
     An internal server error occurred
  

  20) #integration - remote session V2
       reauth
         updates the last-auth time:
     An internal server error occurred
  

  21) #integration - remote session V2
       reauth
         rejects incorrect passwords:

      AssertionError: expected 500 to equal 400
      + expected - actual

      -500
      +400
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:398:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  22) #integration - remote session V2
       reauth
         has sane account-verification behaviour:
     An internal server error occurred
  

  23) #integration - remote session V2
       reauth
         has sane session-verification behaviour:
     An internal server error occurred
  

  24) #integration - remote session V2
       reauth
         does not send notification emails on verified sessions:
     An internal server error occurred
  

  25) #integration - remote session V2
       status
         succeeds with valid token:
     An internal server error occurred
  

  26) #integration - remote session V2
       status
         errors with invalid token:

      invalid token
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/session_tests.js:605:20
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  27) #integration - remote subscriptions: 
       config.subscriptions.enabled = true and direct stripe access:
         "before each" hook for "should return client capabilities with shared secret":
     An internal server error occurred
  

  28) #integration - remote subscriptions: 
       config.subscriptions.enabled = false:
         "before each" hook for "should not include subscriptions with session token":
     An internal server error occurred
  

  29) #integration - remote subscriptions: V2
       config.subscriptions.enabled = true and direct stripe access:
         "before each" hook for "should return client capabilities with shared secret":
     An internal server error occurred
  

  30) #integration - remote subscriptions: V2
       config.subscriptions.enabled = false:
         "before each" hook for "should not include subscriptions with session token":
     An internal server error occurred
  

  31) #integration - remote tokenCodes 
       "before each" hook for "should error with invalid code":
     An internal server error occurred
  

  32) #integration - remote tokenCodes V2
       "before each" hook for "should error with invalid code":
     An internal server error occurred
  

  33) #integration - remote token expiry 
       token expiry:

      invalid token
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/token_expiry_tests.js:52:16
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  34) #integration - remote token expiry 
       session token expires:
     An internal server error occurred
  

  35) #integration - remote token expiry V2
       token expiry:

      invalid token
      + expected - actual

      -999
      +110
      
      at /Users/dschomburg/Documents/code/mozilla/project/packages/fxa-auth-server/test/remote/token_expiry_tests.js:52:16
      at processTicksAndRejections (node:internal/process/task_queues:95:5)

  36) #integration - remote token expiry V2
       session token expires:
     An internal server error occurred
  

  37) #integration - remote totp 
       "before each" hook for "should create totp token":
     An internal server error occurred
  

  38) #integration - remote totp V2
       "before each" hook for "should create totp token":
     An internal server error occurred
  

  39) #integration - remote verifier upgrade 
       upgrading verifierVersion upgrades the account on password change:
     An internal server error occurred
  

  40) #integration - remote verifier upgrade V2
       upgrading verifierVersion upgrades the account on password change:
     An internal server error occurred
  



